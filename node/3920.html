<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/3920 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:43:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Using RFu with RFM12B | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Using RFu with RFM12B</h3>
        <span class="submitted">Submitted by <a href="../user/5022.html" title="View user profile.">cybergibbons</a> on Mon, 24/02/2014 - 23:36</span>
        <div class="content"><p>I&#39;m a little confused about what I should need to do to get an RFM12B working with a RFu.</p>
<p>This page <a href="http://openmicros.org/index.php/articles/88-ciseco-product-documentation/268">here</a> suggests that if I had a v1.1 board I might need to remove two resistors and place a jumper to use the RFu with an RFM12B. Does this mean I don&#39;t need to make this change on a v1.2 RFu?</p>
<p>Do I still need to use a modified version of Jeelib (github.com/openenergymonitor/RFu_jeelib/blob/master/README.md) or can I use the normal one?</p>
  <div class="forum-topic-navigation clear-block">
          <a href="4390.html" class="topic-previous" title="Go to previous forum topic">‹ map() from Arduino library is expensive in terms of flash and time</a>
              <a href="4332.html" class="topic-next" title="Go to next forum topic">which board kits are for sale? ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-18746"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using RFu with RFM12B</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Tue, 25/02/2014 - 07:28.</div>
    <div class="content">
     <p>Hi,&nbsp;</p>
<p>If your have bought a&nbsp;RFu328 board (V1.1 or V1.2) from Ciseco you will need to remove the resistors and or spin one around as detailed here:&nbsp;http://openmicros.org/index.php/articles/88-ciseco-product-documentation/268.</p>
<p>Yes, you will need to use the RFu_JeeLib library instead of the standard JeeLib on the RFM12B. It you have the V1.1 it&#39;s critical&nbsp;that you don&#39;t ever upload the standard JeeLib since this puts the board into a reset loop which can only be recovered from with a bootloder&nbsp;flash. This nasty bug was fixed on V1.2</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-18748"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5022.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="cybergibbons&#039;s picture" title="cybergibbons&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using RFu with RFM12B</h3>

    <div class="submitted">Submitted by <a href="../user/5022.html" title="View user profile.">cybergibbons</a> on Tue, 25/02/2014 - 08:15.</div>
    <div class="content">
     <p>Thanks Glyn - yes, I made the mod to one board and it worked. I thought I might have been missing something as the Ciseco&nbsp;page suggests you don&#39;t <em>always</em> have to do it.</p>
<p>I like these little boards, I hadn&#39;t considered them until I bought OpenEnergyMonitor gear.</p>
<p><img alt="" src="../../../i.imgur.com/Pp2rpDh.jpg" style="height: 742px; width: 800px;" /></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19720"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="elaz&#039;s picture" title="elaz&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Using RFu with RFM12B</h3>

    <div class="submitted">Submitted by elaz (not verified) on Mon, 24/03/2014 - 08:38.</div>
    <div class="content">
     <p>Hi,</p>
<p>let me ask one question about RFu328 v1.3 and RFM12B (with modified Jeelib).</p>
<p>Because I really have problems to make it work proper.</p>
<p>I followed instructions on <a href="http://openmicros.org/index.php/articles/88-ciseco-product-documentation/268-adding-a-rfm12b-to-the-r013-rfu-328-bare" title="http://openmicros.org/index.php/articles/88-ciseco-product-documentation/268-adding-a-rfm12b-to-the-r013-rfu-328-bare">http://openmicros.org/index.php/articles/88-ciseco-product-documentation...</a> (it just about the resistors which has to change a little)</p>
<p>and</p>
<p><a href="https://github.com/openenergymonitor/RFu_jeelib" title="https://github.com/openenergymonitor/RFu_jeelib">https://github.com/openenergymonitor/RFu_jeelib</a>.</p>
<p>After uploading the RF12demo.ino from modified jeelib to my RFu326 v1.3 (with RFM12B on it) it did not work.</p>
<p>I mean It does not enter in a reset loop( like in version v1.1), but it did not recieve or send anything. After looking into the code from modified jeelib I found out that:</p>
<p>Setting for nINT/VDI pin to always be an input, was not set.</p>
<p>&nbsp;&nbsp;&nbsp; rf12_xfer(0x90A2); // nINT,FAST,134kHz,0dBm,-91dBm - set nINT/VDI pin as output to stop it interfering with RFu reset</p>
<p>So I add this line on line 599 inside RFu_RF12.cpp. This makes RFu328 work with the demo-sketch for sending out testpackeages. (option &quot;t&quot; in the dialolg of RFM12B configuration)</p>
<p>But it did not recieve packages correctly. Only &quot;?0&quot; was recieved instead of correct data (which is correct because I double check this on an old openenreryMonitor board (<a href="http://wiki.openenergymonitor.org/index.php?title=Raspberry_Pi" title="http://wiki.openenergymonitor.org/index.php?title=Raspberry_Pi">http://wiki.openenergymonitor.org/index.php?title=Raspberry_Pi</a>))</p>
<p>That brings me to the question: Did I make something wrong or are there more differences to the &quot;normal&quot; setup which are may be not documented?</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19728"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using RFu with RFM12B</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Mon, 24/03/2014 - 09:32.</div>
    <div class="content">
     <p>Are you sure yor using RFu_JeeLib? Have you changed #define at the top of RF12 demo to be&nbsp;#include &lt;RFu_JeeLib.h&gt;. This was actually set as JeeLib&nbsp;by default, I&#39;ve just made change on GitHub</p>
<p>I&#39;ve just checked and nINT&nbsp;is indeed set as output in RFu_JeeLib, see line 580:</p>
<p><a href="https://github.com/openenergymonitor/RFu_jeelib/blob/master/RFu_RF12.cpp" title="https://github.com/openenergymonitor/RFu_jeelib/blob/master/RFu_RF12.cpp">https://github.com/openenergymonitor/RFu_jeelib/blob/master/RFu_RF12.cpp</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19741"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="elaz&#039;s picture" title="elaz&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Using RFu with RFM12B</h3>

    <div class="submitted">Submitted by elaz (not verified) on Mon, 24/03/2014 - 12:29.</div>
    <div class="content">
     <p>Hi thank you for your fast reply :-D, this is GREAT!</p>
<p>Comming back to your question: Yes I&#39;ve changed the #include in the demo sketch to read the modified version. hmmm ... so it looks like that this is not the problem.</p>
<p>Mmay be it is better to delete my current RFu_jeelib and download and install it again, to be sure that I did not do anything strange here.</p>
<p>Let me try this again this evening.... (hopefully I did not burn the RFM12B modul in the times I uploaded the first sketch via FDTI 3,3V wire to my rfu328. May this little overvoltage could also explain the strange behaviour of this setup......</p>
<p>I used a FTDI wire (5V VCC-3.3V I/O)&nbsp; <a href="http://www.exp-tech.de/Shields/Schnittstelle/FTDI-Kabel-5V-VCC-3-3V-I-O.html" title="http://www.exp-tech.de/Shields/Schnittstelle/FTDI-Kabel-5V-VCC-3-3V-I-O.html">http://www.exp-tech.de/Shields/Schnittstelle/FTDI-Kabel-5V-VCC-3-3V-I-O....</a> which outputs 4,1V to VCC and not 3,3V as described in the manual,I realized this later, may be too late :-(&nbsp; ). And may be my RF12B is half burned now. (Is there a way to figure out that tjhe RFM12B is still full functional ?)</p>
<p>Let me ask one more question please: does the modified version of jeelib supports command &quot;sendnow(0,&amp;stuct, sizeof(struct))&quot; from the original jeelib?</p>
<p>I just wanted to know because I use this command in all my other sketches, which are installed on some other devices like jeelabs Micro (ATTiny) and on a Arduino mini pro with an RF12B attached, or the lovely old school board kit for the rapsberryPI from Martin 3 yeas ago.</p>
<p>&nbsp;</p>
<p>Just as a footnote:</p>
<p>An other strange thing was that I follow this guide here <a href="http://openmicros.org/index.php/component/kunena/10-ciseco-support/7007-ftdi-gg-rfu-328-wiring?Itemid=0" title="http://openmicros.org/index.php/component/kunena/10-ciseco-support/7007-ftdi-gg-rfu-328-wiring?Itemid=0">http://openmicros.org/index.php/component/kunena/10-ciseco-support/7007-...</a> to wire my FDTI and found out that I need 0.2uF capcitor to let the upload run on rfu328.</p>
<p>If I use only 0.1uF it will not reset. -&gt; Do you think I may be have a &quot;monday prodction&quot; which is may be little worse, because may things with this board are a little bit beside documentation in this time.</p>
<p>Best Regards from germany</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19762"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="elaz&#039;s picture" title="elaz&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Using RFu with RFM12B</h3>

    <div class="submitted">Submitted by elaz (not verified) on Mon, 24/03/2014 - 19:49.</div>
    <div class="content">
     <p>Hi again,</p>
<p>after reinstalling RFu_jeelib from github nothing changes. But I read the Rfu_RF12.cpp and uncomment the line reffering to RFu328. The behaviour is the same as before.</p>
<p>I leave this one with as comment because if I uncomment this it stops working the demosketch</p>
<p>// pin change interrupts are currently only supported on ATmega328&#39;s<br />
	//#define PINCHG_IRQ 1&nbsp;&nbsp;&nbsp; // uncomment this to use pin-change interrupts</p>
<p>After triing to use my own sketches starting which normally starts with an&nbsp; init f.e.&nbsp; this:</p>
<p>#include &lt;RFu_JeeLib.h&gt;</p>
<p>.</p>
<p>Serial.begin(9600);<br />
	&nbsp; rf12_initialize(6,RF12_868MHZ,210); // NodeID, Frequency, Group<br />
	&nbsp; Serial.print(&quot;RFu328_RFM12B&quot;);</p>
<p>nothing happens on recieve or send.....:-(</p>
<p>&nbsp;it does&nbsp; not looks&nbsp; good to go on with this board. Or am I wrong?!</p>
<p>&nbsp;May be you have any Ideas which could help running my programmed sketches on this hardware? or explain why a trival initialization will not work.</p>
<p>Best Regards</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19783"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="elaz&#039;s picture" title="elaz&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Using RFu with RFM12B</h3>

    <div class="submitted">Submitted by elaz (not verified) on Tue, 25/03/2014 - 07:27.</div>
    <div class="content">
     <p>Hurray suddenly it works !!! (after changing the the Rfu_RF12.cpp.</p>
<p>Rfu328 is recieving and sending well formed packages via rfm12B.</p>
<p>One question left: Do you know why the function rf12_initialize() doesn&#39;t work?</p>
<p>Or is there on other function who can setup the nodeID, frequenzy and group while sketch is running?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/3920"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-vxfnHX8J8J5q26BSNgTRRFO9rE0mKOoH2wkFZywB1rU" value="form-vxfnHX8J8J5q26BSNgTRRFO9rE0mKOoH2wkFZywB1rU"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/3920 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:43:34 GMT -->
</html>
