<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/88?page=1 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:31:12 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>emoncms | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
          <span class="submitted"></span>
      <div class="taxonomy"></div>
      <div class="content"><h2>Web Logging and Graphing</h2>
<p><em>First draft created: 27th September 2010</em></p>
<p><em>by Trystan Lea</em></p>
<h3>Note: new version of emoncms (v2) can be found here:&nbsp;<a href="../emoncms.html">http://openenergymonitor.org/emon/emoncms</a></h3>
<p>This is a mini guide on how to create a web connected energy monitor and starts from where the guide for building the non-invasive mains AC v3 energy monitor leaves off.</p>
<p>...</p>
<p><strong>JSON and automatic website setup</strong></p>
<p>One of the main features of this implementation is the use of JSON to send data from the arduino to the website. Sending data in a JSON is really nice, I wont go into it in detail here but it makes it possible for the website to automatically setup variables. A simple JSON string looks like this:</p>
<p>{&quot;Voltage&quot;:&quot;240.0&quot;}</p>
<p>The website recieves this and if it doesn't already have a Voltage table, will create one and enter the value into the table. This means you can almost configure the website from the arduino, if you want to graph more variables just send them from the arduino and the website should take care of it self.</p>
<p>...</p>
<p>
<meta http-equiv="content-type" content="text/html; charset=utf-8" /></p>
<h3>Arduino side</h3>
<p><strong>1)</strong> Download:</p>
<p>
<meta http-equiv="content-type" content="text/html; charset=utf-8">           </meta>
</p>
<p>Arduino Sketch (Nuelectronics shield): <a href="../sites/default/files/emonEthernet.tar.gz">emonEthernet.tar.gz</a></p>
<p><em>Browse software in repository&nbsp;:&nbsp;</em><em><a href="../software.html">software repository</a></em></p>
<p>
<meta http-equiv="content-type" content="text/html; charset=utf-8" /></p>
<p><strong>2) </strong>Open the sketch</p>
<p>- enter energy monitor calibration values as in mains AC v3 guide</p>
<p>- enter arduino ip, gateway ip and server ip</p>
<p><strong>3)</strong> Upload the sketch to the arduino</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>Server side</h3>
<p>At the moment this is more of a tech demo than a fully fledged graphing and logging website, Were working on a larger site, more information to come. But for those of you who are learning to program php, ajax, jquery (like me) this might be useful, its also super easy to setup if your not an avid programmer:</p>
<p><strong>1)</strong> download: <a href="../sites/default/files/emoncms01.zip">emoncms01.zip</a></p>
<p><em>Browse software in repository&nbsp;:&nbsp;</em><em><a href="../software.html">software repository</a></em></p>
<p>
<meta http-equiv="content-type" content="text/html; charset=utf-8" /></p>
<p><strong>2)</strong> unzip into your server directory&nbsp;(can be web based or local computer, search for LAMP server installation guides)</p>
<p><strong>3) </strong>Create a database (I use phpmyadmin)&nbsp;</p>
<p><strong>4) </strong>Enter the <strong>database name</strong>, <strong>username</strong>, <strong>password</strong> and <strong>host</strong> into <em>database.config</em> in the emoncms directory</p>
<p><strong>5) </strong>Load emoncms in your browser, if you see the following then congratulations! your ready to log and graph! :)</p>
<p><img width="600" alt="" src="../sites/default/files/start.png" /></p>
<p>You can at this point try the example data posting link, to see how sending a json string automatically sets up variables on the website.&nbsp;</p>
<p>Or if your energy monitoring arduino is all ready to go and pointing at the website, fire it up and you should see the following variables appear automatically updated in real-time :)</p>
<p><img width="600" alt="" src="../sites/default/files/variables.png" /></p>
<p>To see a graph of the variable click on Graph:view:</p>
<p><img width="600" alt="" src="../sites/default/files/graph-3.png" /></p>
<p>The graphs also update in real-time, using ajax and jquery.</p>
<p><strong>There we are for now, more to come soon!</strong></p>
<p>May be useful to understand how the above works:</p>
<p>&nbsp;</p>
<p>
<meta http-equiv="content-type" content="text/html; charset=utf-8"> </meta>
</p>
<p><a href="107.html">Using JQuery AJAX and php to fetch data from a mysql database</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>
<meta http-equiv="content-type" content="text/html; charset=utf-8" /></p>
</div>
    
    
      </div>
<div id="comments">
  <div class="indented"><a id="comment-1660"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 13/04/2011 - 21:49.</div>
    <div class="content">
     <p>Hello arena, what is the error you are getting? the code above should work with Andrew Lindsays library here: <a href="http://blog.thiseldo.co.uk/?p=504" title="http://blog.thiseldo.co.uk/?p=504">http://blog.thiseldo.co.uk/?p=504</a> You may need to change the capitals on the start of the file includes?</p>
<p>Let me know if you get any luck</p>
<p>Trystan</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-1666"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="arena&#039;s picture" title="arena&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms</h3>

    <div class="submitted">Submitted by arena (not verified) on Thu, 14/04/2011 - 07:21.</div>
    <div class="content">
     <p>it works!!<br />
thank you very much!!</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
</div></div><div class="item-list"><ul class="pager"><li class="pager-first first"><a href="88.html" title="Go to first page" class="active">« first</a></li>
<li class="pager-previous"><a href="88.html" title="Go to previous page" class="active">‹ previous</a></li>
<li class="pager-item"><a href="88.html" title="Go to page 1" class="active">1</a></li>
<li class="pager-current last">2</li>
</ul></div></div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
