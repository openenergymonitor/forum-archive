<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/56 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:17:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Input modules | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
          <span class="submitted"></span>
      <div class="taxonomy"></div>
      <div class="content"><p>&nbsp;</p>
<p>&nbsp;</p>
<div style="background-color:#eee; padding: 10px; border: 1px solid #AAA;">
	This page (Input modules) has been merged with output modules and replaced by&nbsp;<a href="../buildingblocks.html">Building Blocks</a></p>
<p>	<a href="http://openenergymonitor.blogspot.com/2012/02/documentation-reorganisation.html">See Documentation reorganisation proposal</a></div>
<p>&nbsp;</p>
<p>&nbsp;</p>
</div>
    
    
      </div>
<div id="comments">
  <a id="comment-2712"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Edro&#039;s picture" title="Edro&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Input modules</h3>

    <div class="submitted">Submitted by Edro (not verified) on Fri, 13/01/2012 - 04:49.</div>
    <div class="content">
     <p>Do you have a complete list of materials for both the input and output and all other caveats?&nbsp; We'd like to build our own, but want to make sure we get all of the appropriate materials.&nbsp; Thanks!</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<a id="comment-1654"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="voodoo&#039;s picture" title="voodoo&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Input modules</h3>

    <div class="submitted">Submitted by voodoo (not verified) on Tue, 12/04/2011 - 02:16.</div>
    <div class="content">
     <p>Can you recommend me which Hardware I require to develop a small project to measure Energy saved not too dissimliar to yours.</p>
<p>Having read your forum I'm already thinking you will save me a lot of work since the system you have is not too dissimar but I have not purchase any hardware yet and it looks like the arduino route is the way to go but which one ?</p>
<p>I have a system which currently switches off AC and lighting circuits for rental homes when the client is out of the premisses using a simple keyfob Timer and Relay circuit. I would like to develop a monitoring systems to show me energy saved using the efergy sensors which I already own.</p>
<p>I wish to Measure 2 analogue sources of Current (like 2x 110v on each line) using a small loop sensor which give me a small voltage change. Then I need to record the values and compare them to values obtained prior to them removing the keyfob which generates another signal to tell me to start counting time and multiplying that by time elapsed and the energy used thus giving me the amount of KWH saved between Client out and Client In.</p>
<p>I wish to store the results to show me how much energy has been saved since the last reset say and display this on a LCD (Louis project with 16 x2 chars LCD should do) which could also show me lapsed energy saved until the key is returned on the keyfob.</p>
<p>I have looked at the Arduino Uno option with Makershield but there are other options which seems more attractive given that I will want a more permanent solution once developped.</p>
<p>1) Ardweeny + Protoshield<br />
2) Prototino<br />
3) Boardwino</p>
<p>I Have yet to purchase any of these but would like guidance as to which combination I should use to develop then build my boards--- given that I might want to make about 20 of these to hand out to my clients. The Programming side looks fairly comprehensible as I was a C programmer.</p>
<p>I will start with building a dual Current sensor module using your code as guidance and see how I do before I need help.</p>
<p>Background : I'm Responsible for switching over 100KW of energy (Client cannot leave without taking key and AC and lights switch off automatically once they are gone) in 25 rental homes in a tourist town in Costa Rica and live here during the UK winters - this project is to pay for my beers and to give something back to the environment !</p>
<p>Jean</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<a id="comment-1338"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Stelios&#039;s picture" title="Stelios&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Input modules</h3>

    <div class="submitted">Submitted by Stelios (not verified) on Sat, 19/06/2010 - 11:22.</div>
    <div class="content">
     <p>Hello Trystan.<br />
I would like to try and replicate your project but using a different uC.<br />
I haven't figured out how fast you need to sample the ADC for the CT clamp. I would like to know this number since it will help me select a proper uC.</p>
<p>Thanks,<br />
Stelios</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-1340"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Input modules</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Fri, 25/06/2010 - 09:45.</div>
    <div class="content">
     <p>Hello Stelios</p>
<p>In the sketch the part&nbsp;</p>
<p>for (int n=0; n&lt;numberOfSamples; n++)&nbsp;{&nbsp;...&nbsp;}</p>
<p>takes 1121ms for 3000 readings = 2674Hz</p>
<p>But this included all the analog reading, summing, multiplying, digital high pass etc</p>
<p>The ADC sample rate of the ATmega 328 is set at its default rate which corresponds to about 9600Hz.</p>
<p>Trystan</p>
<p>
<meta http-equiv="content-type" content="text/html; charset=utf-8" /></p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
</div><a id="comment-1332"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dave&#039;s picture" title="Dave&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Input modules</h3>

    <div class="submitted">Submitted by Dave (not verified) on Tue, 15/06/2010 - 00:27.</div>
    <div class="content">
     <p>I just started working on this, I have it breadboarded for a single CT (100A) and managed to calibrate it for current.  I can't find the sketch for version 3.  I am having a ton of trouble calibrating it under version 2.  I'm in the US and where I live we have peak demand metering.  This means that during peak periods they take the highest hour's KWH usage and charge you a ton for that single hour.  Needless to say a meter that tells me the instantaneous usage would save me a ton of money.  My plan is to use contactors to shed load as the load increases.  I already shed the water heater during peak periods but I need to be able to tell what is being used NOW, not an hour ago like the meter reading tells me.  When I can get the device calibrated somewhat I'll add a second CT and move it to the meter location.</p>
<p>Help me find the version 3 sketch please.</p>
<p>dave</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-1333"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Input modules</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Tue, 15/06/2010 - 09:07.</div>
    <div class="content">
     <p>Hello Dave</p>
<p>Its on the how to build it page. But here is the link to save time:&nbsp;<a href="../sites/default/files/basicmonitor.tar.gz">basicmonitor.tar.gz</a></p>
<p>All the best with your project!</p>
<p>Trystan</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-1334"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dave&#039;s picture" title="Dave&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Input modules</h3>

    <div class="submitted">Submitted by Dave (not verified) on Wed, 16/06/2010 - 20:33.</div>
    <div class="content">
     <p>Thanks, got the files and completed the breadboard for a single CT.  Works great.  Power factor is an annoying item.  I went through the same iterations as you in integrating voltage and current and getting a good figure for real power.  Similarly, I integrated power and then averaged it and tried to calculate the power factor.  What a royal pain in the butt.  I agree with you that the CT sensor and the power transformer both add inductance to the circuit that affect the power factor measurement.  Interestingly, I did some checking on the killawatt and found that it has trouble with power factor, especially when the power levels are low.</p>
<p>Now a question.  In your opinion should I just tie the two CTs in series and adjust the burden resistor for the split phase power in the US, or should I integrate the two of them separately?  There's trade offs to both methods, but the big one seems to be processing time since we have to use float in the various calculations.</p>
<p>Also, the low pass filter you discovered and implemented is fantastic.  That thing adjusts itself and removes the harmonics from the digital sampling really well.  I implemented a complete measurement program without it and worked through the calibration and had exactly the same problems you did with various noise sources making the readings erratic.  That filter eliminated that problem completely.</p>
<p>Really good job on this, thanks again.</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
</div></div><a id="comment-1281"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Michael&#039;s picture" title="Michael&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Input modules</h3>

    <div class="submitted">Submitted by Michael (not verified) on Mon, 19/04/2010 - 12:18.</div>
    <div class="content">
     <p>Hi Tristan,</p>
<p>Excellent website - have build a PDU (PowerDistributionUnit) for 19" Racks based on your code with 10<br />
Current Transformers.<br />
Data is polled by a Perl script and stored in a RRD Database. Graphs are generated by rrd.cgi on a Webserver...</p>
<p><a href="http://www.komputer.de/wordpress/?p=8">http://www.komputer.de/wordpress/?p=8</a></p>
<p>Sorry but it's in german</p>
<p>Michael</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-1288"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Input modules</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Tue, 27/04/2010 - 15:47.</div>
    <div class="content">
     <p>Hey Micheal, that's really cool, excellent work! Google translate works really well so I can follow what your doing. Like I said to Ben below, and I know you have your own site, but if you ever want to use the openenergymonitor blog to tell people about your work, even just a link through to your site you would be welcome, just email me.</p>
<p>Trystan</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
</div><a id="comment-1280"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Guest&#039;s picture" title="Guest&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Input modules</h3>

    <div class="submitted">Submitted by <a href="http://bbarker.co.uk/energy/energy.php" rel="nofollow">Guest</a> (not verified) on Sat, 17/04/2010 - 14:35.</div>
    <div class="content">
     <p>Fantastic project. I have built it up and started logging data to mySQL using an ethernet shield. I've also brought your "scope" code into the main monitoring code, so I can see the waveform while monitoring. </p>
<p><a href="http://energy.bbarker.co.uk/" title="http://energy.bbarker.co.uk">http://energy.bbarker.co.uk</a></p>
<p>I think I may try a display unit next - I've been looking at how you built yours. </p>
<p>Thanks for the writeup,</p>
<p>Ben</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="item-list"><ul class="pager"><li class="pager-current first">1</li>
<li class="pager-item"><a href="../input2679.html?page=1" title="Go to page 2" class="active">2</a></li>
<li class="pager-next"><a href="../input2679.html?page=1" title="Go to next page" class="active">next ›</a></li>
<li class="pager-last last"><a href="../input2679.html?page=1" title="Go to last page" class="active">last »</a></li>
</ul></div></div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/56 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:17:33 GMT -->
</html>
