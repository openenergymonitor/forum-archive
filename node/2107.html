<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/2107 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:07:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Trouble with CT Sensors | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Trouble with CT Sensors</h3>
        <span class="submitted">Submitted by Guest on Sat, 09/03/2013 - 00:56</span>
        <div class="content"><p>Hi There,</p>
<p>So I&#39;ve been struggling with this problem for a while, and decided that I should defer to the experts. &nbsp;I&#39;ve attached a picture of my circuit.</p>
<p>V+ =3.3V</p>
<p>I&#39;m using an ECS1030-L72 Split Core Current Transformer with a 10 Ohm load resistor. &nbsp;My peak volatage coming out of the op amp can&#39;t be any higher than 1.2V. &nbsp;I built this in multisim and it worked fine, then I built the same circuit in real life and it doesn&#39;t work at all.</p>
<p>Though the CT can measure a max of 30 amps, I don&#39;t need to go about 20A rms. &nbsp;</p>
<p>I&#39;m wondering if it might be the LM358 op amp itself? &nbsp;Should I use an LMV358, or maybe an LMV321? &nbsp;</p>
<p>I&#39;ve seen similar circuits that use a voltage divider, then allow the AC output from the CT to go through the full sine wave, hovering around half of their max input value, but I&#39;m using an XBee chip and I wanted to increase accuracy so I put it through a Voltage Rectifier, allowing the full 1.2V as my max amplitude.</p>
<p>Any help would be greatly appreciated.</p>
<p>&nbsp;</p>
<p>Cheers,</p>
<p>Gear</p>
  <div class="forum-topic-navigation clear-block">
          <a href="2114.html" class="topic-previous" title="Go to previous forum topic">‹ Rasp Pi configuration - Answered</a>
              <a href="2104.html" class="topic-next" title="Go to next forum topic">I&#039;ve given up! ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-10393"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dBC&#039;s picture" title="dBC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Sat, 09/03/2013 - 03:26.</div>
    <div class="content">
     <p>I&#39;m guessing the small swing from your CT output (0.3Vp) is not enough to get past the forward bias voltage of the diodes.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10399"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 09/03/2013 - 17:54.</div>
    <div class="content">
     <p>I second that. I don&#39;t expect it to work at that voltage either. There&#39;s probably nothing wrong with the amplifier itself, if your simulation program misleads you like this, you need a better one, or maybe you&#39;re not using it properly.</p>
<p>You need to include the rectifier in the feedback loop so that the op.amp. compensates for the forward drop. Try Google and &quot;perfect rectifier&quot; or &quot;precision rectifier&quot;. A full-wave version will cost you two op.amps and some close-tolerance resistors.</p>
<p>But why do you want to rectify the c.t. output anyway? If you use the emonTx input configuration, the rectification is done in the software (though you can still amplify the c.t. output first if you want to).</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10400"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Gear171&#039;s picture" title="Gear171&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by Gear171 (not verified) on Sat, 09/03/2013 - 19:51.</div>
    <div class="content">
     <p>In running the output from the circuit into a Zigbee&nbsp;Series 2 chip. &nbsp;On the analog inputs, the firmware on the chip will convert the value 0-1.2V to 0.1,023 via the formula</p>
<p>Vin/1.2V = x/1023</p>
<p>By increasing the overall amplitude of the wave and taking sample over the whole wave, it allows for the difference between steps to be half of what it would be if the output swung back and forth over the .6V line.&nbsp;</p>
<p>I hope I explained that well enough...</p>
<p>Anyway, if I&#39;m understanding you properly, I won&#39;t be able to use the lm358&nbsp;op-amp in this circuit, because the ct output is too small. &nbsp;Switching to the LMV358 wouldn&#39;t fix this?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10401"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dBC&#039;s picture" title="dBC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Sat, 09/03/2013 - 21:40.</div>
    <div class="content">
     <p>What do you plan doing with this I reading at the far end? &nbsp;If you just plan using it to calculate Irms then rectifying it probably doesn&#39;t hurt, and as you say increases your A/D resolution. &nbsp;But if you want to be able to calculate real power, then the sign of I is important detail that you&#39;ll have lost in the rectification process. &nbsp;There&#39;ll be times when I and V are on the same side of 0 (adding to your bill) and times when they&#39;re on opposite sides (subtracting from your bill). &nbsp;</p>
<p>I&#39;m guessing by the time your I reading gets to the far end of the XBee&nbsp;link there&#39;ll be enough jitter that there&#39;ll be no chance of associating it with any particular V reading, in which case Irms is probably the best you can hope for.</p>
<p><em>Anyway, if I&#39;m understanding you properly, I won&#39;t be able to use the lm358&nbsp;op-amp in this circuit, because the ct output is too small. &nbsp;Switching to the LMV358 wouldn&#39;t fix this?</em></p>
<p>It&#39;s more to do with where you&#39;ve put your diodes then your choice of op-amp. &nbsp;Follow Robert&#39;s googling advice and you&#39;ll find some circuits that do exactly what you want, and are only slightly more complicated than your current one.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10402"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Gear171&#039;s picture" title="Gear171&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by Gear171 (not verified) on Sat, 09/03/2013 - 21:46.</div>
    <div class="content">
     <p>I&#39;m planning to install this into a power strip style device, then sending the data to my computer wirelessly. &nbsp;I only need the current, as all the wall outlets in my house run on 120V&nbsp;Single Phase power, and I&#39;m installing the meter before any power supplies that may be plugged into the strip..</p>
<p>I may as well ask, since I have your attention. &nbsp;Will this work, or do I need a voltage reading as well, then to run a phase-correction algorithm in order to get the wattage going through the circuit? &nbsp;I&#39;m reasonably sure I should be ok with just the current meter, but my professors gave convoluted and unspecific answers (meaning they didn&#39;t know either...)</p>
<p>Thanks!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10403"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 09/03/2013 - 21:54.</div>
    <div class="content">
     <p><em>&quot;the LMV358 wouldn&#39;t fix this?</em>&quot; No. The principal problem isn&#39;t with the op.amp at all. The LM358 will only swing to within 1.5 V of the positive rail, which leaves you with 1.8 V. But as you only want 0 - 1.2 V, that is OK.</p>
<p>The problem is the diodes. If you study the characteristic curve of a diode - the relationship between the voltage across the junction and the current passing through it, you&#39;ll find it is highly non-linear - <a href="http://en.wikipedia.org/wiki/Diode">see Fig. 5 here</a>. The section immediately above the diagram explains what is going on. For a common silicon diode, <strong>Vd</strong> is about 0.65 V. That&#39;s what dbC called the forward bias voltage and what I call the forward drop. As you&#39;ve got two of those - 1.3 V worth - in series with your 0.3 V generator, there is nothing going in to your amplifier which is why you can see nothing out. If you try putting a load on the rectifier in your simulation (say a 10 kOhm resistor between the non-inverting op.amp input and ground), you&#39;ll see the output falls to a very low value - probably microvolts. You cannot implicitly trust a simulation - it&#39;s a common problem and you need to be very careful to watch out for situations like this one.</p>
<p>Have you read up on &quot;perfect rectifier&quot; or &quot;precision rectifier&quot;? That is going to be your answer. You can have one with gain, so you&#39;ll have a perfect full-wave rectifier with gain using two op.amps.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10404"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 09/03/2013 - 22:19.</div>
    <div class="content">
     <p>Hmm. While I was writing the above...</p>
<p>What you will read is current (obviously!). If you calculate the rms value of the current and multiply that by the rms voltage, <u><em>and if the two are in phase</em><strong>,</strong></u> you get power (real power - Watts). If they aren&#39;t in phase, you get apparent power, or VA (volt-amperes).</p>
<p>The trouble is, if you have something like a SMPS (in a computer), voltage and current aren&#39;t necessarily in phase (the device has a poor power factor) and so the real power - the quantity that the supplier charges you for - will be somewhat less than the apparent power you calculate.</p>
<p>So:</p>
<ol>
<li>
		Poor: estimated apparent power = measure the current and multiply by a constant that you think reflects the average voltage and power factor.</li>
<li>
		Better: measured apparent power = measure the average current and the average voltage and multiply them.</li>
<li>
		Best: measured real power = sample voltage and current many times per cycle, multiply each pair of readings and then average the result.</li>
</ol>
<p>Have you read the Building Blocks articles on AC Power?&nbsp; (I take it you haven&#39;t got this far in your studies yet!)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10405"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dBC&#039;s picture" title="dBC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Sat, 09/03/2013 - 22:39.</div>
    <div class="content">
     <p>What sort of sampling rate do you hope to achieve on each CT, over the Xbee link?</p>
<p>At 60Hz, your half cycles are going to come around every ~8msecs, and you want to be taking as many samples as you can during that 8msecs.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10406"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 09/03/2013 - 22:45.</div>
    <div class="content">
     <p>If you&#39;re building this into a power strip, you&#39;ve got perfectly safe access to break into one of the conductors, so why are you having a split-core c.t.? A ring core should be smaller, cheaper and more accurate.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10407"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Gear171&#039;s picture" title="Gear171&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by Gear171 (not verified) on Sat, 09/03/2013 - 22:54.</div>
    <div class="content">
     <p>Awesome, thank you for your help. &nbsp;For whatever reason I didn&#39;t really understand the first time the diode thing was explained, now it makes perfect sense.</p>
<p>&nbsp;</p>
<p>So I guess here&#39;s my next couple questions (if you don&#39;t mind)</p>
<p>the XBee limits sample rate to a maximum of 500 sample/second. &nbsp;Are loads (both current and voltage) running off of a standard household socket sinusoidal enough to apply the rms formula in the attachment with a good degree of accuracy if applied over one cycle, a several times a second?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10408"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Gear171&#039;s picture" title="Gear171&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by Gear171 (not verified) on Sat, 09/03/2013 - 22:56.</div>
    <div class="content">
     <p>In response to the split core CT question;</p>
<p>Because I have one. &nbsp;If it works with split core, it&#39;ll work with a ring core, and I have an extremely limited budget to make this prototype, so I wanted versatility. &nbsp;Once I&#39;ve nailed it down, I plan to switch to a ring core.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10409"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Gear171&#039;s picture" title="Gear171&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by Gear171 (not verified) on Sat, 09/03/2013 - 23:21.</div>
    <div class="content">
     <p>also, just out of curiosity, would I be able to use a voltage divider, positioned between the positive and negative plug terminals, set so that at 120Vrms&nbsp;(max out of the wall), the middle of the divider would only output 1.2V pk? &nbsp;I can&#39;t think of any reason this wouldn&#39;t work, unless I&#39;m missing something major.... Using the same sampling method/RMS&nbsp;formula, could I figure out the phase angle of the circuit? &nbsp;This seems like a far easier and more straightforward way of measuring the voltage than the ac-ac power adaptor, as long as you know that Vrms is exactly 120V AC.</p>
<p>Sorry, just spit balling. &nbsp;Before I go and blow up a wall socket/burn my apartment down, I wanted to check and see if that&#39;s a realistic possibility, or if I&#39;m overlooking something (obviously I&#39;m not dumb enough to do the first test of a prototype in my apartment, that would be insane.... I&#39;ll go over to my friend&#39;s place and do it there).</p>
<p>P.S. Sorry for the triple post.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10410"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 09/03/2013 - 23:30.</div>
    <div class="content">
     <p><em>Because I have one.</em>&nbsp; A pretty good reason!</p>
<p>(Don&#39;t fall into the trap of passing the whole cable through your c.t! It&#39;s amazing how often that question crops up.)</p>
<p><em>the XBee limits sample rate to a maximum of 500 sample/second.</em>&nbsp; Ouch! But are you sure: I read 1000? That&#39;s 8 1/3 samples per cycle. I&#39;d say that really isn&#39;t good enough even if you&#39;re only sampling one quantity (current). If you&#39;re measuring voltage at the same time you&#39;re down to 4 samples per cycle - not accurate at all, especially as I assume you won&#39;t know where in the cycle you are taking the samples. You could very easily construct a spreadsheet (using that formula) to evaluate the extent of the error.</p>
<p>By comparison, the emonTx using interrupts and a free-running ADC can manage around 8 times that.</p>
<p>On that basis, I think you&#39;re stuck with apparent power, maybe you want to consider taking the average of voltage and current in hardware before you transmit the values. That could be quite accurate given a resistive (heater) load and possibly quite inaccurate otherwise (though a thorough evaluation of the sources and extent of the inaccuracy for various appliances could earn you bonus points!).</p>
<p>Regarding the voltage: <span style="font-weight: bold; color: red">you need to remember first and foremost that you&#39;ll be debugging and testing live equipment, so you&#39;ll have to be very careful or you <u>will</u> blow up your modules or your computer or yourself</span>. And everything must be double-insulated once it is assembled. Having got that out of the way, you can measure voltage directly, the main point to watch is the voltage rating of the resistors. You should be OK at 120 V, here we struggle and it&#39;s necessary to use two or three in series to get the voltage rating. Even so, I&#39;d recommend using two or three same-value resistors in the high-voltage leg. And keep the values as high as reasonably possible to limit the power and temperature rise.</p>
<p>Go and read the Atmel AVR465 App Note (doc2566.pdf). That&#39;s all about their processor but it contains a lot of useful data about designing an energy meter (which is essentially what you&#39;re doing), including power supplies.</p>
<p>If you&#39;re sampling both voltage and current, you measure voltage and current (ideally at the same instant) and you don&#39;t use&nbsp; phase angle at all - the average (as I said earlier) is real power.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10411"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Gear171&#039;s picture" title="Gear171&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by Gear171 (not verified) on Sun, 10/03/2013 - 00:13.</div>
    <div class="content">
     <p>I only need to put one leg of the cable through the CT, correct?</p>
<p>The XBee chips have a max of 1,000, but when I get into the programming, the best it can do for analog pins is a sample every 50 ms.... shoot, that&#39;s only 20 samples a second....&nbsp; There has to be some way to speed that up.&nbsp; I will look into it.&nbsp; If nothing else, I can throw an AT Mega 644 in there or something and have that run the algorithm and the sampling.&nbsp; I know that there are &quot;programmable&quot; XBee chips as well, though I&#39;m not teribbly familiar with their capabilities.</p>
<p>Here&#39;s the brief description given in the terminal program;</p>
<p>Set the IO sampling rate to enable periodic sampling. If set &gt;0, all enabled digital IO and analog inputs will be sampled and transmitted every IR milliseconds.</p>
<p>RANGE:0,0X32-0XFFFF&nbsp;&nbsp; X 1 MS</p>
<p>I did just check, the digital pins can have a sampling rate of up to 1,000 (makes sense, since they only see on/off).</p>
<p>Anyway, I think I could actually do 2 &quot;arcs&quot; as a single cycle for the purposes of the calculation, seeing as they&#39;re the absolute value of the amplitude anyway which, when squared will yield the same result.&nbsp; Might help with the lower sampling rates.</p>
<p>Thanks for the safety tips, I will be sure to keep them in mind.</p>
<p>I&#39;ll give that a read later this evening and see what it says. &nbsp;</p>
<p>Thanks again, you&#39;re a life-saver (potentially literally)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10412"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 10/03/2013 - 01:17.</div>
    <div class="content">
     <p><em>I only need to put one leg of the cable through the CT, correct?</em> Correct. Think about the currents in the cable and the magnetic fields around them, because it&#39;s the magnetic field that a c.t. picks up.</p>
<p>Sampling rate: 20/s is the maximum recommended by the designers, I&#39;ve discovered. That&#39;s one every 3 cycles to you (2&frac12; cycles for me). Sample the wave? !!!&nbsp; I think you need to stand back and look at other ways of solving the problem. My first thought is to look at the dedicated meter ICs. Second is to get the rectified averages using analogue electronics. (All &#39;budget&#39; multimeters display the rectified average reading, scaled to rms for a sine wave.)&nbsp; Either way you&#39;d be transmitting the answer rather than the raw data, and a few times per second should be plenty.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10415"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Gear171&#039;s picture" title="Gear171&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by Gear171 (not verified) on Sun, 10/03/2013 - 14:13.</div>
    <div class="content">
     <p>probably better off transmitting the answer, anyway. &nbsp;Less bandwidth. &nbsp;Any chance you have a link to one of the dedicated meter IC&#39;s that would work? &nbsp;I poked around but I&#39;m not sure which one to go with, and I&#39;d rather not spend money on one that won&#39;t work.</p>
<p>Cheers</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10416"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Trouble with CT Sensors</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 10/03/2013 - 14:30.</div>
    <div class="content">
     <p>Sorry, no. You know now (I think!) what you need, so download some of the data sheets and check to see what is on offer. On the input side you know the voltage and max current that you&#39;re interested in, on the output side you know what input your link will accept. One that satisfies both those requirements is looking hopeful. You might even find one that measures the current directly, not needing the c.t.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/2107"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-Jy2IfKP6sybyY4ukyRvO6E9uC047cP4x6_i2-3DDVFI" value="form-Jy2IfKP6sybyY4ukyRvO6E9uC047cP4x6_i2-3DDVFI"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
