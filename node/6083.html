<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/6083 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:40:40 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Multiple emonTx&#039;s using 1 AC adapter | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Multiple emonTx&#039;s using 1 AC adapter</h3>
        <span class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sun, 09/11/2014 - 00:16</span>
        <div class="content"><p>I currently have 3 emonTx&nbsp;v2&#39;s&nbsp;with 9 cts, all measuring AC via 1 AC adapter, they seem to function ok but I&#39;m un sure how to calculate how&nbsp;many emonTx&#39;s&nbsp;could potentially use 1 AC adapter without a noticeable impact on&nbsp;the voltage or waveform. Is there a way of calculating or<span style="line-height:1.6">&nbsp;</span>guestimating<span style="line-height:1.6">&nbsp;how many could be used on 1 std OEM shop sold UK AC adapter ?</span></p>
<p><span style="line-height:1.6">Paul</span></p>
  <div class="forum-topic-navigation clear-block">
          <a href="6107.html" class="topic-previous" title="Go to previous forum topic">‹ Basic CT Questions</a>
              <a href="6100.html" class="topic-next" title="Go to next forum topic">Newbie Question.... ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-25050"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multiple emonTx's using 1 AC adapter</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 09/11/2014 - 12:15.</div>
    <div class="content">
     <p>A lot - too many to count. There is no problem with waveform distortion (as there is with the V3 when powering it via the ac adapter) because the only load on the adapter is the 100 k&Omega; or so of the voltage divider chain. That represents approx. 100 &mu;A of load, and the adapter is rated at 9 V, 6va, which means the maximum load current is 666 mA. Divide the first into the second and there's your answer! (Though after the first few dozen you'll need to recalibrate the voltage.)</p>
<p>[I must make it clear that we're talking about emonTx V2. You can only do the same with the V3 <b>provided</b> that the link is removed and the V3 is powered by an external 5 V supply. Otherwise, you must have one adapter for each emonTx V3.]</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25051"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multiple emonTx's using 1 AC adapter</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sun, 09/11/2014 - 14:17.</div>
    <div class="content">
     <p>Thanks for that Robert, I was indeed only&nbsp;referring to emonTx v2&#39;s at the&nbsp;time. I am currently using 3 x&nbsp;v2&#39;s but I want to expand the number for testing purposes, so&nbsp;I am actually adding 3 arduino mini pro&#39;s to the mix, they&nbsp;have voltage regs built in and are not powered via the AC/AC&nbsp;adapter and&nbsp;the measurements they make serve no purpose beyond testing the software and communication timing etc.</p>
<p>I was intending adding an ac voltage divider to each but now I&#39;m wondering if 1 voltage divider could serve all 3 ac adc&#39;s&nbsp;as&nbsp;they are all mounted on 1 vero&nbsp;board. I would also like to simulate the additional 9 ct inputs and I assume I&nbsp;might&nbsp;get away with just using&nbsp;1 or more&nbsp;voltage dividers on&nbsp;the 5vdc&nbsp;rail to give the 9 ADC&#39;s between 0 and 1v&nbsp;or is that not the case ??</p>
<p>This is just to create a test rig to test I&sup2;C comms and develop the sketch I&#39;m adapting for this&nbsp;purpose, I&#39;m using MartinR&#39;s&nbsp;PLL as I&#39;m familiar with it and it doesn&#39;t use external libs for comms and measurements (ie jeelib and emonlib) and I&#39;m concerned about the impact of another&nbsp;interrupt&nbsp;(TWI)&nbsp;and the calculations being now being triggered by emonHub&nbsp;over I&sup2;C rather than just&nbsp;every 5secs by the sketches main loop()..</p>
<p>So far it has worked well with 3 Tx&#39;s but with the potential to get synchronized data from&nbsp;around&nbsp;120&nbsp;nodes, the testing does seem&nbsp;quite feeble at this stage :-)</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25052"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multiple emonTx's using 1 AC adapter</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 09/11/2014 - 15:33.</div>
    <div class="content">
     <p><i>"I was intending adding an ac voltage divider to each but now I'm wondering if 1 voltage divider could serve all 3 ac adc's as they are all mounted on 1 vero board."</i></p>
<p>I don't see why not. But one slight advantage of separate dividers - component tolerances should give you slightly different values for each, that would differentiate them. (Or you could deliberately make the dividers different for the same purpose.)</p>
<p><i>"I would also like to simulate the additional 9 ct inputs and I assume I might get away with just using 1 or more voltage dividers on the 5vdc rail to give the 9 ADC's between 0 and 1v or is that not the case ??"</i></p>
<p><strike>Not the case. The software filter will take the dc component out and you'll be left with nothing. If you want real c.t. signals, you can link the 'test' ADC inputs to a real c.t. input pin, or you can use a separate transformer and voltage divider (adjustable?) to give you 0 - 1 V ac simulating 0 - 100 A (approx) of current, connected where the burden resistor would be, i.e. you replace ct + burden with a 0 - 1 V alternating voltage, biased to sit at 1/2 rail as before. Again, you might want to fiddle the voltage to give you different numbers for each.</strike></p>
<p>[I put the note re the V3's in case someone reading it thought they could do the same - but they can't!]</p>
<p>EDIT:<br />
I've just thought to check your sketch - I should have done that first! You could indeed feed a dc signal into the current input, because Martin only subtracts an offset before multiplying by V for power or squaring for Irms.</p>
<p>But it only needs to go one side of the offset (mid-rail, hopefully) voltage.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25057"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multiple emonTx's using 1 AC adapter</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sun, 09/11/2014 - 21:18.</div>
    <div class="content">
     <p>So for the CT circuits could I in&nbsp;fact&nbsp;just do away with the mid-rail and apply a DC voltage relative to vcc/2 ? ie a voltage divider of 2 equal value resistors would in theory simulate&nbsp;0amps and something like a 5:1 ratio divider would give me almost&nbsp;full scale&nbsp;in which ever direction it&#39;s biased and the value simulated dependent on &quot;Ical&quot; in the sketch.&nbsp;</p>
<p>I also need to offset the ratio&#39;s 5:3&nbsp;for 5v rather than 3.3v so maybe a gnd connected variable resistor in series with a fixed resistor&nbsp;<s>2/5&#39;s</s>&nbsp;2/3rds&nbsp;the size (of the VR)&nbsp;to 5v rail and connect the ADC&#39;s to the VR&#39;s wiper would be better ? does that sound right ???</p>
<p>Good news about the AC/AC as if I&#39;m stacking v2&#39;s to work on a single phase&nbsp;I can just omit the voltage divider, mid-point components and the AC connector&nbsp;on all but one v2 and use a stackable header for&nbsp;AIO2.</p>
<p>​Paul</p>
<p>EDIT: corrected the confusing ratio reference</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25060"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multiple emonTx's using 1 AC adapter</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 09/11/2014 - 21:44.</div>
    <div class="content">
     <p>What you suggest should be OK for current but of course it will always give you zero average real power with the maths that you have. Of course, that doesn't matter if all you need is a set of numbers to test the interface, you just lie and and use apparent power instead!</p>
<p>If you look at the maths in the sketch, all should become clear. The long-term average (i.e. the quiescent voltage on the input pin) is subtracted from the present sample to give newI. That is squared for rms - that's OK, but when you multiply by newV (obtained similarly) to get instantaneous power, that will average to zero because V is alternately positive and negative each half-cycle while newI is always one or the other.</p>
<p>So if you need real power, you need an alternating voltage as I wrote above: use a separate transformer and voltage divider (adjustable?) to give you 0 - 1 V ac (1.6 V rms max if you have 5 V rails) simulating 0 - 100 A (approx) of current, connected where the burden resistor would be, i.e. you replace ct + burden with a 0 - 1.6 V alternating voltage, biased to sit at 1/2 rail as before.</p>
<p>To be honest, if I were to need test data, I wouldn't bother with the current inputs front end. I'd feed all current inputs with the voltage signal so as to give the ADC something to do, I'd run the maths to give a representative loading on the processor, and simply fudge the numbers it transmitted to give recognizable values to test the interface.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25062"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multiple emonTx's using 1 AC adapter</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sun, 09/11/2014 - 23:40.</div>
    <div class="content">
     <blockquote><p><em>&quot;that will average to zero because V is alternately positive and negative each half-cycle while newI is always one or the other&quot;</em></p>
</blockquote>
<p>I hadn&#39;t considered the lop sided averaging, not that it&#39;s really much of a concern</p>
<blockquote><p><em>&quot;I&#39;d feed all current inputs with the voltage signal so as to give the ADC something to do,&quot;</em></p>
</blockquote>
<p>if I could just link <u>all</u> the ADC&#39;s together to load the calculations I would be happy, I have no need for the results, we know the calculations work and as long as all the devices are loaded and working, I have proper emontx&#39;s&nbsp;I can put anywhere in the chain to test actual measured results.</p>
<p>I currently report the interval&nbsp;since last poll&nbsp;in mSecs&nbsp;and the time taken for calcVIPF() to complete in uSecs plus an accumulating &quot;energy&quot; value calculated from the interval timer and a fixed &quot;power&quot; value, so the calculated results are being over written anyway.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25063"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multiple emonTx's using 1 AC adapter</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 10/11/2014 - 01:51.</div>
    <div class="content">
     <p><i>"if I could just link all the ADC's together to load the calculations I would be happy"</i><br />
You <i><u>can</u></i> be happy then! Here's what to do: </p>
<p>1 voltage front end,<br />
all the processors have the same supply bus (0 V &amp; 5 V rails)<br />
link all the ADC inputs together</p>
<p>I don't see any harm there, nor any side effects (none that matter anyway).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25117"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multiple emonTx's using 1 AC adapter</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Fri, 14/11/2014 - 01:27.</div>
    <div class="content">
     <p>Cheers Robert, this is good news, I haven&#39;t had a chance to try it yet but I hope to very soon.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/6083"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-y70nfNPvnoR_xjEtQemtchEA0jpLe4Zh6RRffgwfpdI" value="form-y70nfNPvnoR_xjEtQemtchEA0jpLe4Zh6RRffgwfpdI"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/6083 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:40:40 GMT -->
</html>
