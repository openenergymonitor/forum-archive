<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/12087 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:55:53 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>emonhub.conf not reporting to emoncms.org? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">emonhub.conf not reporting to emoncms.org?</h3>
        <span class="submitted">Submitted by <a href="../user/9367.html" title="View user profile.">rpjg51</a> on Tue, 26/01/2016 - 18:09</span>
        <div class="content"><p>Thanks to those who have got me this far with my quest to monitor my PV and home electricity status using emonTx&nbsp;v3 with a R Pi/RFM69. &nbsp;I&#39;m almost there but the last hurdle of getting my data to emoncms.org eludes me. &nbsp;</p>
<p>This is a copy of the log</p>
<pre>
2016-01-26 17:51:27,652 INFO emonCMS sending: <a href="http://localhost/emoncms/input" title="http://localhost/emoncms/input">http://localhost/emoncms/input</a>
/bulk.json?apikey=E-M-O-N-C-M-S-A-P-I-K-E-Y&amp;
data=[[1453830687.53,8,3,540,0,0,24232,3000,3000,3000,3000,3000,3000,1,0,-
38]]&amp;sentat=1453830687

2016-01-26 17:51:27,719 DEBUG emonCMS acknowledged receipt with &#39;ok&#39; from 
<a href="http://localhost/emoncms" title="http://localhost/emoncms">http://localhost/emoncms</a>

2016-01-26 17:51:37,337 DEBUG 983 NEW FRAME : 1453830697.34 OK 8 2 0 29 2 0 0 0 
0 93 94 184 11 184 11 184 11 184 11 184 11 184 11 1 0 0 0 (-41) 

2016-01-26 17:51:37,341 DEBUG 983 Timestamp : 1453830697.34

2016-01-26 17:51:37,342 DEBUG 983      Node : 8

2016-01-26 17:51:37,343 DEBUG 983    Values : [2, 541, 0, 0, 24157, 3000, 3000, 
3000, 3000, 3000, 3000, 1, 0]

2016-01-26 17:51:37,345 DEBUG 983      RSSI : -41

2016-01-26 17:51:37,350 DEBUG 983 Append to &#39;emonCMS&#39; buffer =&gt; time: 
1453830697.34, data: [8, 2, 541, 0, 0, 24157, 3000, 3000, 3000, 3000, 3000, 
3000, 1, 0, -41], ref: 983</pre><p>and this is my emon.conf file (with the&nbsp;API&nbsp;keys blanked</p>
<pre>
# SPECIMEN emonHub configuration file
# Note that when installed from apt, a new config file is written
# by the debian/postinst script, so changing this file will do
# nothing in and of itself.

# Each Interfacer and each Reporter has
# - a [[name]]: a unique string
# - a type: the name of the class it instantiates
# - a set of init_settings (depends on the type)
# - a set of runtimesettings (depends on the type)
# Both init_settings and runtimesettings sections must be defined,
# even if empty. Init settings are used at initialization,
# and runtime settings are refreshed on a regular basis.

# All lines beginning with a &#39;#&#39; are comments and can be safely removed.

#######################################################################
#######################    emonHub  settings    #######################
#######################################################################
[hub]

# loglevel must be one of DEBUG, INFO, WARNING, ERROR, and CRITICAL
# see here : <a href="http://docs.python.org/2/library/logging.html" title="http://docs.python.org/2/library/logging.html">http://docs.python.org/2/library/logging.html</a>
loglevel = DEBUG

#######################################################################
#######################        Reporters        #######################
#######################################################################
[reporters]

# This reporter sends data to emonCMS
[[emonCMS]]
    Type = EmonHubEmoncmsReporter
    [[[init_settings]]]
    [[[runtimesettings]]]
        url = <a href="http://localhost/emoncms" title="http://localhost/emoncms">http://localhost/emoncms</a> #(defaults to emoncms.org)
        apikey = xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

[[emoncmsorg]]
    Type = EmonHubEmoncmsHTTPInterfacer
    [[[init_settings]]]
    [[[runtimesettings]]]
        pubchannels = ToRFM12,
        subchannels = ToEmonCMS,
        url = <a href="http://emoncms.org/" title="http://emoncms.org">http://emoncms.org</a> [1]
        apikey = xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        senddata = 1
        sendstatus = 1

#######################################################################
#######################       Interfacers       #######################
#######################################################################
[interfacers]

# This interfacer manages the RFM2Pi module
[[RFM2Pi]]
    Type = EmonHubJeeInterfacer
    [[[init_settings]]]
        com_port = /dev/ttyAMA0
    [[[runtimesettings]]]
        group = 210
        frequency = 433
        baseid = 15

#######################################################################
#######################          Nodes          #######################
#######################################################################
[nodes]

# List of nodes by node ID
# &#39;datacode&#39; is default for node and &#39;datacodes&#39; are per value data codes.
# if both are present &#39;datacode&#39; is ignored in favour of &#39;datacodes&#39;
[[10]]

Please will someone look at my emonhub.conf file and see if any errors can be spotted.</pre><p><em>Edit - wrapped long lines - Moderator, BT</em></p>
  <div class="forum-topic-navigation clear-block">
          <a href="11953.html" class="topic-previous" title="Go to previous forum topic">‹ 22dec image WiFi issues</a>
              <a href="12086.html" class="topic-next" title="Go to next forum topic">No emoncms.org updates ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-38756"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub.conf not reporting to emoncms.org?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 26/01/2016 - 18:22.</div>
    <div class="content">
     <p>You have filled in your <strong>Read &amp; Write </strong>APIkey in the real file, haven&#39;t you?</p>
<p>And what is the<strong> [1]</strong> doing on the end of the URL?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38758"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/9367.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rpjg51&#039;s picture" title="rpjg51&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub.conf not reporting to emoncms.org?</h3>

    <div class="submitted">Submitted by <a href="../user/9367.html" title="View user profile.">rpjg51</a> on Tue, 26/01/2016 - 18:51.</div>
    <div class="content">
     <p>Hi Rob</p>
<p>Thank you, yes I have put in the API keys. &nbsp;I know not how the&nbsp;[1] at the end of the URL was copied in, however, I have removed it and it has not made any difference to the log report.</p>
<p>Could it be anything to do with nodes and datacodes?&nbsp; I have played around with a bunch of these to varying effect.</p>
<p>Changing the [[10]] to [[8]] (as one would expect to be correct as the log refers to node 8, causes nothing to be updated on my localhost/emoncms. &nbsp;</p>
<p>Including &nbsp; &nbsp; &nbsp;&nbsp;</p>
<p>datacodes = L, h, h, h, h, l, l, l, l &nbsp;</p>
<p>as recommended by the support documentation,&nbsp; &nbsp;produces in the log a WARNING that these codes are not sufficient for the 26 bites of information being supplied.</p>
<p>​I have found&nbsp;better results excluding the data codes. &nbsp;At least I get local reporting then.</p>
<p>Thanks for your interest</p>
<p>Rob</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38761"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub.conf not reporting to emoncms.org?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 26/01/2016 - 19:57.</div>
    <div class="content">
     <p>To solve the datacodes question, you need to go back to your emonTx and determine what its NodeID is and which sketch it is running, from which we can put together the requisite strings. If there is any inconsistency, the packet gets rejected by emonhub, and won&#39;t get sent to either emoncms.org or to your local emoncms. By excluding &quot;datacodes = &quot;, you actually used the default &quot;datacode = h&quot;, meaning the data stream was interpreted as all signed integers.</p>
<p><a href="11950.html#comment-37981" title="http://openenergymonitor.org/emon/node/11950#comment-37981">http://openenergymonitor.org/emon/node/11950#comment-37981</a> and Paul&#39;s follow-up below it might help a little.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38763"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub.conf not reporting to emoncms.org?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 26/01/2016 - 20:53.</div>
    <div class="content">
     <p>The main issue here is the &quot;EmonHubEmoncmsHTTPInterfacer&quot; in the [reporters] section. Change</p>
<p>[[emoncmsorg]]&nbsp;<br />
&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; Type =&nbsp;EmonHubEmoncms<strong>HTTPInterfacer</strong>&nbsp;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;<span style="line-height: 1.6;">[[[</span><span style="line-height: 1.6;">init</span><span style="line-height: 1.6;">_settings</span><span style="line-height: 1.6;">]</span><span style="line-height: 1.6;">]]&nbsp;</span><br />
<span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;[[[runtimesettings]]]</span><br />
<strong><span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;pubchannels&nbsp;=&nbsp;ToRFM12,&nbsp;</span><br />
<span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;subchannels&nbsp;=&nbsp;ToEmonCMS,</span></strong><br />
<span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;url = http://emoncms.org</span><br />
<span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;apikey&nbsp;=&nbsp;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br />
<span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<strong>senddata&nbsp;= 1</strong></span><br />
<strong><span style="line-height: 1.6;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;sendstatus&nbsp;=&nbsp;1</span></strong></p>
<p><span style="line-height: 1.6;">To</span></p>
<p><span style="line-height: 1.6;">[[emoncmsorg]]&nbsp;<br />
&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Type =&nbsp;EmonHubEmoncms<strong>Reporter</strong>&nbsp;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;[[[init_settings]]]&nbsp;<br />
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;[[[runtimesettings]]]<br />
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;url&nbsp;= <a href="http://emoncms.org/" title="http://emoncms.org">http://emoncms.org</a><br />
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;apikey&nbsp;=&nbsp;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span></p>
<p><span style="line-height: 1.6;">​The &quot;emon-pi&quot; variant doesn&#39;t have &quot;reporters&quot; and the original version of emonHub doesn&#39;t have &quot;EmonHubEmoncmsHTTPInterfacers&quot;.</span></p>
<p><span style="line-height: 1.6;">Assuming you are using v1.2 (original) emonhub&nbsp;and a &quot;stock&quot; emontx&nbsp;v3 you shouldn&#39;t need to define the node, you can if you wish but it shouldn&#39;t be mandatory as it&#39;s payload only has signed integers so no other datatypes force the need for defining the node. Plus you are not using the nodes module and the input module doesn&#39;t make defining nodes mandatory either, so you should be good with an empty [nodes] section.</span></p>
<p><span style="line-height: 1.6;">Paul</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38768"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/9367.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rpjg51&#039;s picture" title="rpjg51&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub.conf not reporting to emoncms.org?</h3>

    <div class="submitted">Submitted by <a href="../user/9367.html" title="View user profile.">rpjg51</a> on Tue, 26/01/2016 - 21:26.</div>
    <div class="content">
     <p>Hi Paul,</p>
<p>This is brilliant. &nbsp;It works! &nbsp;Thank you so much</p>
<p>Rob</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/12087"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-IM4Gm7h-wBHminvqOtUA1-sifs1wvr5w1PSV-CsASqY" value="form-IM4Gm7h-wBHminvqOtUA1-sifs1wvr5w1PSV-CsASqY"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
