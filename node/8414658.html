<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Mk2 PV Controller, with triac | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/emon/sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="/emon/modules/node/node.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/defaults.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/system.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/system-menus.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/user/user.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/modules/mollom/mollom.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/forum/forum.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/modules/views/css/views.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/comment/comment.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/themes/emon3/style.css?r" />
<style type="text/css" media="all">@import "/emon/sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="/emon/" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="/emon/">Home</a> » <a href="/emon/forum">Forums</a> » <a href="/emon/forum/3">Archived: General Discussion</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Mk2 PV Controller, with triac</h3>
        <span class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sun, 15/07/2012 - 16:03</span>
        <div class="content"><p><a href="http://openenergymonitor.org/emon/sites/default/files/IMGP9704.s.jpg"><img alt="" height="225" src="http://openenergymonitor.org/emon/sites/default/files/IMGP9704.s.jpg" width="300" /></a></p>
<p>&gt;&gt;&gt; Before committing to this design, please read my comments about the burden resistor value <a href="http://openenergymonitor.org/emon/node/870#comment-5610">here</a> &lt;&lt;&lt;</p>
<p><span lang="EN-US" style="font-size: 10pt; font-family: Arial;"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">Based on the standard V&amp;I sketch which uses calcVI() in EmonLib, I&rsquo;ve had a system in place for the last couple of months which diverts surplus PV power to our immersion heater.<span style="">&nbsp; </span>This system has proved to be both effective and reliable, and I am most grateful for everyone who has helped me along the way.<span style="">&nbsp; </span>The main downside to this arrangement is that it requires an expensive item of third-party kit to distribute the power.<span style="">&nbsp; </span>(I know that others have found cheaper ways, but my Carlo Gavazzi unit cost me &pound;70).</span></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">Other contributors to this forum have shown that a standard triac can be easily controlled by an Arduino.<span style="">&nbsp; </span>By using a zero-crossing detector such as the Motorola MOC3041, it should be possible for the Arduino to allocate mains cycles directly to the load rather than delegating this task to a separate device.</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">A Mk2 system of this type has been working in our garage for the last few days.<span style="">&nbsp; </span>The sketch and a schematic diagram are attached, its main features being:</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">- a comprehensive &#39;debug&#39; mode which allows real world conditions to be simulated ;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">- a continuous mode of operation, for both measurement and distribution of power;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">- an &quot;energy bucket&quot; concept which gives precise control of surplus power;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">- interleaved windows for measurement and generation, each only 20mS;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">- a rapid response time to changing conditions (&lt;50mS);</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">- suitable timing for &#39;arming&#39; a zero-crossing trigger device;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">- a single LPF which determines the dc-offset of raw V&amp;I samples;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">- a programmable safety margin for biassing import v. export;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">- minimal calibration is required.</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">As supplied, the sketch is in &lsquo;debug&rsquo; mode.<span style="">&nbsp; </span>This allows the code to be put through its paces without requiring any additional hardware &ndash; just the Arduino.<span style="">&nbsp; </span>When running in this mode, voltage and current samples are synthesized, as is the operation of the triac.<span style="">&nbsp;&nbsp; </span>To convert it to &lsquo;normal&rsquo; mode, just comment out the <b>#define DEBUG</b></span><span lang="EN-US" style="font-size: 10pt; font-family: Arial;"> statement.</span><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">&nbsp;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">The algorithms for measuring and distributing power are linked by an &lsquo;energy bucket&rsquo; variable.<span style="">&nbsp; </span>Surplus energy, as measured at the supply point, is recorded in this variable, and power is only allocated to the immersion heater when the available energy has reached a pre-determined level.<span style="">&nbsp; </span>The energy bucket is updated after each complete cycle of the mains, and a decision is then taken as to whether the triac should be &lsquo;on&rsquo; or &lsquo;off&rsquo; during the next cycle.</span><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">&nbsp;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">To minimise the response time, the single-cycle (20mS) windows for measuring and distributing power are interleaved.<span style="">&nbsp; </span>If sufficient energy is not available, the triac will be &lsquo;off&rsquo; from the next zero-crossing point, just 10mS after that information has been gained.</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">In the standard EmonLib code, there is a separate high-pass filter (HPF) on each of the voltage and current streams.<span style="">&nbsp; </span>I&rsquo;ve taken a different approach (thanks Robert for the suggestion), and have instead implemented a single LP filter which allows the DC bias to be accurately determined.<span style="">&nbsp; </span>By updating the LPF only once per mains cycle (my idea!), its performance is nigh-on perfect, with no attenuation or phase shift.</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">Too good to believe?<span style="">&nbsp; </span>Well, the LPF is not acting alone.<span style="">&nbsp; </span>There is also a standard HP filter which acts just on the voltage stream.<span style="">&nbsp; </span>The purpose of this secondary filter is to group the voltage samples into cycles so that the LPF can be accurately updated.<span style="">&nbsp;&nbsp; </span>Unlike the LPF, the HPF can always be relied upon to start up correctly.<span style="">&nbsp; </span>Together, they form a great combination.</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">A single (buffered) reference is used for both the voltage and current sensor as shown on the schematic diagram.<span style="">&nbsp; </span>The LM358 runs from the Arduino&rsquo;s 5V rail and provides a rock-steady reference point.<span style="">&nbsp; </span>If separate reference circuits were to be used, the single LPF approach would then not be appropriate.<span style="">&nbsp;</span></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;"><span style=""><em>[Update:&nbsp; If measuring only &quot;real power&quot;, which is what the utility meter does, the single LPF would be fine when using separate references.&nbsp; This is because any DC offset in the current samples is removed by the maths.&nbsp; For other calculations such as Power Factor or Irms, the dc-offset of each sensor must be dealt with independently.]</em></span></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">The energy bucket has a nominal capacity of 3600J, or 0.001kWh, with power only being allocated when it is at least half-full.<span style="">&nbsp;&nbsp; </span>To ensure that a small amount of export to the grid is maintained, a programmable safety margin has been included; this acts as a leak in the bucket thereby reducing the rate that &lsquo;on&rsquo; cycles can be allocated to the immersion.<span style="">&nbsp; </span>For anyone with a nervous disposition, just increase the value of <b>safetyMargin_watts. </b></span><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">&nbsp;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">So how accurate does this system need to be?<span style="">&nbsp; </span>Not very, is the short answer.<span style="">&nbsp; </span>Because there is only one place where current is measured (flowing into and out from the grid), any inaccuracy will be cancelled out.<span style="">&nbsp; </span>Once the distribution algorithm has reached the operating point, &lsquo;on&rsquo; cycles will be allocated at the appropriate rate for the prevailing conditions regardless of any absolute error in the measurement system (it just needs to be linear).</span><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">&nbsp;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">In a place such as this, if I were to suggest that no calibration is required at all, I&rsquo;d probably get shot down in flames.<span style="">&nbsp; </span>So, here&rsquo;s how it works:</span><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">&nbsp;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">In &lsquo;debug&rsquo; mode,<span style="">&nbsp; </span>the synthesized values are directly equivalent to Volts and Amps.<span style="">&nbsp; </span>By mutiplying pairs of V&amp;I samples together, this gives the instantaneous power in Watts.<span style="">&nbsp; </span>By adding a mains cycles&rsquo; worth of instP values together, and dividing by the number of samples,<span style="">&nbsp; </span>this gives the average power during that mains cycle, also in Watts.<span style="">&nbsp; </span>Dividing by <b>cyclesPerSecond = 50</b></span><span lang="EN-US" style="font-size: 10pt; font-family: Arial;"> gives the energy gained or lost during that individual mains cycle, in Joules.<span style="">&nbsp; </span>This energy contribution is then added to the existing contents of the bucket without need for further calibration.&nbsp; In debug mode, POWERCAL = 1.</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">In &lsquo;normal&rsquo; mode, the sensitivity of the measurement system is affected by a variety factors.<span style="">&nbsp; </span>My simplistic approach, however, says that it is only &ldquo;energy&rdquo; that needs to be calibrated.<span style="">&nbsp; </span>By experimenting with a few small loads, I soon found that a value of<span style=""> </span>about 0.085 allows my system to track real-world energy flow.<span style="">&nbsp; </span>With a 40W bulb connected, my bucket &lsquo;fills&rsquo; at around 40J per second.<span style="">&nbsp;&nbsp; </span>Moreover, when the light goes off, the bucket&rsquo;s value remains constant to within a few tenths of a Joule per second &ndash; there&#39;s minimal unintended leakage.<span style="">&nbsp; </span>So, before adding my measured power contributions into the energy bucket, they are multiplied </span><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">by POWERCAL = 0.085.<span style="">&nbsp; </span>The units of this parameter are Joules per ADC-unit squared, but what about its value?</span><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">&nbsp;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">Using any of tools that have been posted recently for recording the range of raw sample values, the extent to which voltage and current are being over- or under-read in terms of ADC units can be determined.<span style="">&nbsp; </span>From the voltage and current samples taken while powering my 3kW kettle, I appears that I am &lsquo;under-reading&rsquo; voltage by 471/678.8 and &lsquo;over-reading&rsquo; current by 535/35.36.<span style="">&nbsp; </span>Taking the inverse of each of these ratios gives an overall value of 0.095, which is close enough to 0.085 for my purposes.</span><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">&nbsp;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">One final bit of calibration is needed, this being to determine an appropriate moment for arming the external trigger device.<span style="">&nbsp; </span>Because my system under-reads voltage by a factor of 471/678.8, my voltage samples (after removal of the DC-offset) need to be multiplied by the inverse of this ratio to obtain the correct value in Volts.<span style="">&nbsp; </span>VOLTAGECAL = 1.441 is therefore applied before checking whether the voltage is at a suitable value for arming the trigger (for the MOC3041, this is a minimum of 20V beyond the +ve going z/c point.)</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-size: 10pt; font-family: Arial;">The hardware is entirely straightforward, photo attached.<span style="">&nbsp; </span>The input circuitry is still on breadboard but will no doubt be transferred to strip-board in due course.<span style="">&nbsp; </span>With the 40W triac bolted to an offcut of aluminium tubing, it gets pleasantly warm when the PV gets going, but is rarely too hot to touch.<span style="">&nbsp; </span>A better heatsink, with vertical fins, would be a nice addition.</span></p>
  <div class="forum-topic-navigation clear-block">
          <a href="/emon/node/2605" class="topic-previous" title="Go to previous forum topic">‹ SolarMax 2000S Inverters &amp; EmonCMS</a>
              <a href="/emon/node/12236" class="topic-next" title="Go to next forum topic">Forum thread comments newest first?  ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-9059"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Sat, 12/01/2013 - 19:31.</div>
    <div class="content">
     <p>just spotted this:</p>
<p><a href="http://www.united-automation.com/f175-25a-filter-module-230v-25amp/" title="http://www.united-automation.com/f175-25a-filter-module-230v-25amp/">http://www.united-automation.com/f175-25a-filter-module-230v-25amp/</a></p>
<p>is it something that could be used if using it in phase angle mode to get round the&nbsp;RFI or am i looking at it too simply?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9062"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1774" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1774.jpg" alt="PaulOckenden&#039;s picture" title="PaulOckenden&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1774" title="View user profile.">PaulOckenden</a> on Sat, 12/01/2013 - 20:21.</div>
    <div class="content">
     <p>Looks perfect!</p>
<p>&nbsp;</p>
<p>P.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9066"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sun, 13/01/2013 - 10:58.</div>
    <div class="content">
     <p>Nice one.&nbsp; I look forward to hearing how this EMC-suppression unit works with the phase-angle variant that I released a while back.&nbsp; There was a lot of interest in phase-angle at that time, that being the obvious way to avoid flicker.&nbsp; I wonder if anyone has actually tried that version yet?&nbsp; According to my &#39;sticky&#39; index, the details are:</p>
<p><strong>Mk2_PV_phaseAngle</strong>.&nbsp; A phase-angle controlled variant.&nbsp; This requires a trigger which acts immediately rather than a zero-crossing one.&nbsp;&nbsp;&nbsp; Originally posted, with full supporting information, on 01/11/12 at <a href="841#comment-6990" title="http://openenergymonitor.org/emon/node/841#comment-6990">http://openenergymonitor.org/emon/node/841#comment-6990</a>, this code is available at<br />
	<a href="../sites/default/files/Mk2_PV_phaseAngle.ino_.zip" title="http://openenergymonitor.org/emon/sites/default/files/Mk2_PV_phaseAngle.ino_.zip">http://openenergymonitor.org/emon/sites/default/files/Mk2_PV_phaseAngle....</a></p>
<p>PS. With some sunshine today, I&#39;ve just checked in the garage and our PV is generating around 1300W.&nbsp; I assumed that the neon for the dump load would be flashing away as usual, but it wasn&#39;t.&nbsp; Instead, it was lazily cycling on and off every few seconds.&nbsp; &quot;What can be wrong?&quot; was my initial reaction.&nbsp; Then I realised that this must be the anti-flicker mode, working for real.&nbsp; Having previously said that I like my system to flicker, this alternative behaviour actually feels rather soothing - it&#39;s as if it is breathing.&nbsp; If less surplus power were available, however, the system would no doubt look as though it&#39;s simply off.&nbsp; A more complex a/f algorithm could perhaps combine the best features of both power-diversion modes.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9072"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Sun, 13/01/2013 - 12:41.</div>
    <div class="content">
     <p>As I&#39;m yet to build either, though&nbsp;I have the parts on order, I&#39;m not sure which way to go. Both probably!</p>
<p>I love the anti flicker mode as it enables the use of loads other than just heating elements or light bulbs. I was looking at battery chargers for one. The tumble dryer was another&nbsp;I was looking at- but that&nbsp;I may do with some internal modification. (heating element through MK2 and a voltage sensitive relay to give a full 240v supply to the controls).</p>
<p>I was also thinking of the 3 phase use of your designs. Looking at comments re the energy bucket in 3 phase meters&nbsp;I have come to the conclusion that the way to do it is just to put all&nbsp;the 3 live meter tails&nbsp;through the one&nbsp;CT. (It would mean unbalanced loads but in the context of 3Kw&nbsp;I don&#39;t think that&#39;s going to be a disaster).&nbsp;&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9074"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Sun, 13/01/2013 - 13:04.</div>
    <div class="content">
     <p><em>I have come to the conclusion that the way to do it is just to put all the 3 live meter tails through the one CT</em></p>
<p>mmm, don&#39;t think that&#39;s going to work. For one thing it would have to be an enormous CT to go around 3 meter tails and then there&#39;s the issue of the 3 currents being out of phase so you would&nbsp;just see the vector sum of the 3 currents.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9075"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Sun, 13/01/2013 - 13:20.</div>
    <div class="content">
     <p>The CT isn&#39;t a problem size wise, they are made in all sorts of sizes. the one Robin already&nbsp;uses would fit the 3 tails in.&nbsp;&nbsp;&nbsp;The vector sum is what you want isn&#39;t it?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9076"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Sun, 13/01/2013 - 13:35.</div>
    <div class="content">
     <p><em>the one Robin already uses would fit the 3 tails in.</em>&nbsp;&nbsp;</p>
<p>I doubt that</p>
<p><em>The vector sum is what you want isn&#39;t it?</em></p>
<p>No. Imagine a point where 2 phases overlap with one negative and the other equally positive. The vector sum of these currents will be zero but both phases will be consuming power.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9078"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Sun, 13/01/2013 - 14:12.</div>
    <div class="content">
     <p><em>I doubt that</em></p>
<p>Just physically tried it and no they don&#39;t quite, you&#39;d need the 1&quot; not the 3/4&quot;</p>
<p>Yes see your point on the vector sum, Same as putting the CT round the neutral.</p>
<p>&nbsp;</p>
<p>Just been thinking,&nbsp;I have a 3 phase generator and that has a ct on each phase which then feeds into another electronic unit that&nbsp;shows the power to a single&nbsp;Kw moving coil meter.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9080"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1165" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="richmc&#039;s picture" title="richmc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1165" title="View user profile.">richmc</a> on Sun, 13/01/2013 - 15:44.</div>
    <div class="content">
     <p>A three phase system still has only one neutral, put your CT around that? Will that show the current summed?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9081"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Sun, 13/01/2013 - 15:54.</div>
    <div class="content">
     <p>Please read what i said again.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9085"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sun, 13/01/2013 - 17:11.</div>
    <div class="content">
     <p>&quot;<em>Just been thinking,&nbsp;I have a 3 phase generator and that has a ct on each phase which then feeds into another electronic unit that&nbsp;shows the power to a single&nbsp;Kw moving coil meter.</em>&quot;</p>
<p>I imagine the electronic unit is 3 rectifiers, averaging and summing to drive a d.c milliammeter or voltmeter. Basically, you need one wattmeter less then the number of wires. So for 3 phases and neutral you need 3 wattmeters. If you don&#39;t have a neutral, you need 2. For &#39;wattmeter&#39; you can of course substitute a c.t and v.t to input to whatever electronic instrument you care to name. I know of no way to directly combine the outputs of 3 phase c.t&#39;s to give the arithmetic total of the currents, as distinct from the vector sum.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9087"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sun, 13/01/2013 - 17:30.</div>
    <div class="content">
     <p>To get good results for 3-phase power, I take it that one would need to measure both voltage and current on all three phases (as Martin does with his 3-tier system)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9096"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Mon, 14/01/2013 - 01:11.</div>
    <div class="content">
     <p>If you have a 4-wire system, yes. If you have a totally balanced system and no neutral, two pairs of voltage &amp; current measurements would suffice. (<a href="http://en.wikipedia.org/wiki/Blondel%27s_theorem">Blondel&#39;s theorem</a>).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9100"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Mon, 14/01/2013 - 08:19.</div>
    <div class="content">
     <p>That&#39;s interesting.&nbsp; The Wiki article appears to be saying that a single measurement of voltage is standard practice for 3-phase utility meters.&nbsp; It was the need to measure voltage separately for each phase that I was interested in, because that will determine how much work a single Arduino would have to do.&nbsp;</p>
<p>If voltage need only be measured once, then the total workload would then be only around twice that of a standard single phase system.&nbsp; With approx 90 sample pairs per mains cycle for my Mk2a Router, that would give around 45 for a 3-phase system, which sounds feasible.&nbsp; It would certainly save a lot of hardware if the output from all four sensors could be processed using just one Arduino.</p>
<p>Problem: how could the direction of flow be determined unless voltage is measured for each phase?&nbsp; It probably couldn&#39;t :(</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9103"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Mon, 14/01/2013 - 10:14.</div>
    <div class="content">
     <p><em>The Wiki article appears to be saying that a single measurement of voltage is standard practice for 3-phase utility meters</em></p>
<p>I don&#39;t think that&#39;s true for the UK as they wouldn&#39;t be able to meet the accuracy requirements. Both my house meter and the PV total generation meter definitely measure voltage on all 3 phases as they can both display all 3 values.</p>
<p>However, for diversion only the accuracy is not important, especially with a single threshold system, so 1 voltage measurement would be fine. In fact I don&#39;t think you really need to measure voltage at all for diversion only, even signal phase , all you need is a phase reference and an estimated voltage.</p>
<p>Once you have a phase reference for one phase you know the other voltages are 120 apart so you can determine their phase too. The PLL approach is ideal for this as you know the phase of every single sample.</p>
<p>It should be possible to design a 3-phase diversion only (i.e. no accurate power measurement) using a single, unmodified emonTX (or Robin&#39;s design with 2 extra CTs).</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9105"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Mon, 14/01/2013 - 11:06.</div>
    <div class="content">
     <p>Having thought about this a bit more I think there would be an issue if the voltage changed between import and export, as it might well do since the solar voltage has to be higher than the supply. This would then create a bias in one direction or the other.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9113"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1165" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="richmc&#039;s picture" title="richmc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1165" title="View user profile.">richmc</a> on Mon, 14/01/2013 - 13:29.</div>
    <div class="content">
     <p>Thinking out loud here</p>
<p><em>&quot;If you have a 4-wire system, yes. If you have a totally balanced system and no neutral, two pairs of voltage &amp; current measurements would suffice.&quot;</em></p>
<p>I&#39;ve only seen in the UK 3 phase Wye (star) with neutral are there any domestic/light industrial conditions that would allow an installation without a neutral as the load would need to be balanced?</p>
<p>Would there be neutral less systems outside of very specific applications in the UK?</p>
<p>So a system that looked at whats going through the neutral with software to identify each 120deg of phase difference could calculate total load.</p>
<p>The only instances of systems without a&nbsp;neutral in Wye or delta configurations I&#39;ve seen have been on board R.N ships and submarines.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9115"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Mon, 14/01/2013 - 14:45.</div>
    <div class="content">
     <p><em>So a system that looked at whats going through the neutral with software to identify each 120deg of phase difference could calculate total load.</em></p>
<p>What will that tell you? Look hard at the animated diagrams <a href="http://openenergymonitor.org/emon/buildingblocks/3-phase-power">here</a> and think where the currents circulate.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9119"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1165" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="richmc&#039;s picture" title="richmc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1165" title="View user profile.">richmc</a> on Mon, 14/01/2013 - 16:03.</div>
    <div class="content">
     <p>Yes i see&nbsp; you need to monitor voltage and current on each phase and calculate the power from there and&nbsp;add the three together. Is it not possible do this from the neutral line?</p>
<p>It&#39;s a long time since I looked at three phase!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9121"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Mon, 14/01/2013 - 16:05.</div>
    <div class="content">
     <p><em>However, for diversion only the accuracy is not important, especially with a single threshold system, so 1 voltage measurement would be fine. In fact I don&#39;t think you really need to measure voltage at all for diversion only, even signal phase , all you need is a phase reference and an estimated voltage.</em></p>
<p>	Whether or not to measure voltage when calculating power/energy is a moot point.&nbsp; When surplus power is to be diverted, a measurement of the voltage allows the direction of flow to be determined, so I have always thought it sensible to use the voltage sample stream to improve the accuracy of the calculated value.&nbsp; Some systems, such as the Eco Eye, only use a nominal value for voltage.&nbsp; In that case, the direction of flow is detected by using a capacitive sensor that&#39;s taped to the Live wire.</p>
<p>	Producing values for voltage that are offset by 120 degrees will be interesting.&nbsp; Perhaps this could be done using a set of sinusoidal samples stored in an array.&nbsp; By determining the RMS value of the voltage on one phase, all samples taken from the array could then be calibrated for the actual voltage at that time.&nbsp; The necessary phase-offsets would be achieved by selecting the appropriate index from the array.&nbsp; Using a PLL, with a fixed number of samples per mains cycle, would be convenient for this, preferably divisible by 3.&nbsp; 51 maybe?</p>
<p>	With four analogue sensors on the go, processing time would be at a premium.&nbsp; My fastest Mk2 code to date has just been posted at <a href="http://openenergymonitor.org/emon/node/1912" title="http://openenergymonitor.org/emon/node/1912">http://openenergymonitor.org/emon/node/1912</a> &nbsp; By allowing the ADC to be free-running, and using interrupts to co-ordinate its activity with that of the main processor, around 95 sample pairs per mains cycle is achieved.&nbsp; The same code can also be run using a fixed rate timer for the ADC.&nbsp;&nbsp;<br />
	&nbsp;&nbsp;&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9126"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Mon, 14/01/2013 - 21:32.</div>
    <div class="content">
     <p>I suggest that for accuracy, especially as it has been shown that a 3-phase digital meter behaves in exactly the same way as an analogue one, i.e. export on one phase can balance import on another, then it <strong><em>is</em></strong> necessary to measure both voltage and current on each phase. Some assert that the voltage on the 3 phases is always the same, and that the phase-neutral voltages are always 120&deg; apart, but in the real world this simply isn&#39;t true. Whether it is an acceptable approximation is a different question that can only be answered when you know how significant the error will be. Bear in mind that if you don&#39;t measure a voltage, because power is proportional to voltage<sup>2</sup>, the power error will be very nearly twice the voltage error.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9129"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Mon, 14/01/2013 - 23:37.</div>
    <div class="content">
     <p>Although I&#39;ve never taken any formal results, my readings of power taken with an Arduino rig do appear to change by several percent at different times of the day.&nbsp; Similarly for the mains frequency.&nbsp; With a 125uS hardware timer, the build I&#39;ve been working on recently has sometimes recorded 80 sample pairs per mains cycle, as expected, and sometimes only around 78.5</p>
<p>If the only purpose of the exercise is to identify and divert any surplus power, then it is probably less important to measure voltage.&nbsp; Because the system is always aiming for the condition where import and export are balanced, it is only the reduction in the voltage value that is caused by the triac turning on that is of importance.&nbsp; Changing the absolute value of the RMS voltage will have minimal effect because the import and export power values will both be increased by the same amount and cancel themselves out.</p>
<p>When decent weather returns, it would be interesting to see how a Mk2 build behaves if only current is measured.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9131"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 15/01/2013 - 00:13.</div>
    <div class="content">
     <p>The short-term frequency stability is at worst +/- 1% (0.5 Hz), but the long-term is a whole lot better and I believe that it is checked against the national standard of time held by the NPL, so that clocks that count mains cycles do not drift from day to day.</p>
<p>If you install MartinR&#39;s PLL controller, you can watch the frequency change over the course of a day, dropping at times of high demand and rising when demand is low. Or you can go to <a href="http://www.nationalgrid.com/uk/Electricity/Data/Realtime/">the National Grid website</a> to get up to date data.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9134"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Tue, 15/01/2013 - 09:25.</div>
    <div class="content">
     <p><em>If you install MartinR&#39;s PLL controller, you can watch the frequency change over the course of a day, dropping at times of high demand and rising when demand is low.&nbsp; </em></p>
<p>Alternatively, I can simply check how the number of samples that I&#39;m seeing per mains cycle drifts during the day.&nbsp; My Mk2x PV Router code already displays this information in its calibration mode.&nbsp; With a fixed ADC timer rate of 200uS, there will be around 50 pairs of samples per mains cycle (the same as Martin&#39;s PLL code).&nbsp; As the mains frequency varies, so will this number.&nbsp; Both methods rely on the stability of the Arduino&#39;s clock, so are equally valid.</p>
<p>(Sorry if this sounds a bit grumpy.&nbsp; But this is <em>my</em> thread, and <em>my</em> code works just as well, IMHO!)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9136"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1774" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1774.jpg" alt="PaulOckenden&#039;s picture" title="PaulOckenden&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1774" title="View user profile.">PaulOckenden</a> on Tue, 15/01/2013 - 11:29.</div>
    <div class="content">
     <p>Robert, this is a great website if you&#39;re interested in power stats:</p>
<p><a href="http://www.gridwatch.templar.co.uk/" title="http://www.gridwatch.templar.co.uk/">http://www.gridwatch.templar.co.uk/</a></p>
<p>(e.g. look at the weekly Nuclear/Coal/Gas graph - it demonstrates in just a few pixels how important the controlability of gas is to our energy mix. Nuclear is on and constant. Coal can be controlled a bit, but only slowly. But gas is what allows the supply to match the demand (and by doing so, I guess, keep the frequency needle close to 50Hz).</p>
<p>Sorry Robin, your code is brilliant. Your thread is brilliant. etc. etc. etc.</p>
<p>P.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9137"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Tue, 15/01/2013 - 12:06.</div>
    <div class="content">
     <p><em>Alternatively, I can simply check how the number of samples that I&#39;m seeing per mains cycle drifts during the day.</em></p>
<p>It&#39;s not really the same though Robin. The PLL technique is capable of measuring the period between zero crossings to within one 16MHz clock period.</p>
<p>It&#39;s probably not important but I also believe the Arduino UNO uses a ceramic resonator which won&#39;t be as accurate as the crystal used on the emonTx.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9138"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 15/01/2013 - 14:09.</div>
    <div class="content">
     <p>If we&#39;re going down that route, I ought to have added &quot;subject of course to the accuracy and stability of your frequency reference&quot;.&nbsp; &micro;P crystals tend to be cut for best short-term jitter, not long-term stability, so aren&#39;t inherently &quot;best&quot; for stable frequency measurement.</p>
<p>I guess you could calibrate it by counting the number of mains cycles over a period of several days, as (as I wrote above) I believe the grid is over time locked to the national time standard. You&#39;d need to time for well over 2 years <img alt="" src="http://s.codeproject.com/script/Forums/Images/smiley_omg.gif " />&nbsp; before you broke a 32-bit integer value, so do-able, but I&#39;m not volunteering. Also, you&#39;d need to be well clear of auto-reclosers and other momentary switching breaks, not to mention longer supply interruptions. You&#39;d presumably need <a href="http://www.jarkman.co.uk/catalog/robots/msftime.htm">one of these</a>, too. Oh, and anyone who complains that this suggestion is outrageous hasn&#39;t got a working tongue-in-cheek detector.</p>
<p>A much more sensible way to calibrate would be to log the frequency you read and compare afterwards with the published national record.</p>
<p>(I simply named MartinR&#39;s sketch because it outputs the frequency <em>as a number - e.g. 49.98 - </em>directly comparable with the published data)<em>.</em></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9140"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Tue, 15/01/2013 - 14:56.</div>
    <div class="content">
     <p>Not so tongue-in-cheek Robert, I already have one of those PV Electronics MSF receivers in my system to distribute time...</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9141"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Tue, 15/01/2013 - 17:11.</div>
    <div class="content">
     <p>OK guys, thanks for the feedback.&nbsp; I&#39;m probably about to get out of my depth here ...</p>
<p>Recording how the mains frequency varies during a 24H period might be a fun thing for my spare rig to do.&nbsp; Without easy access to &#39;standard time&#39;, I would not wish to report any absolute values, but I would hope that my results would track those of the National Grid pretty closely.</p>
<p>You stated, Martin, that the PLL technique is capable of measuring the period between zero crossings to within one 16MHz clock period.&nbsp; Given that the CT is essentially ac-coupled, I&#39;m intrigued that you feel able to make such a claim.&nbsp; How can you know to such precision when these elusive zero-crossings occur?&nbsp;</p>
<p>Or maybe you are saying that over a suitable period of time you can determine the <em>average</em> duration of each mains cycle to this accuracy.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9142"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Tue, 15/01/2013 - 18:04.</div>
    <div class="content">
     <p>Is your issue that the DC offset might not be perfect? If so, it doesn&#39;t matter, so long as you measure time between the same point in the mains cycle each time the frequency will be accurate. Also, don&#39;t forget we are talking voltage here where the asymmetry is nowhere near as bad as it can be for current.</p>
<p>I do average the frequency for display but only because there&#39;s lots of cycles between prints.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9146"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Tue, 15/01/2013 - 20:42.</div>
    <div class="content">
     <p><em>Is your issue that the DC offset might not be perfect? If so, it doesn&#39;t matter, so long as you measure time between the same point in the mains cycle each time the frequency will be accurate. Also, don&#39;t forget we are talking voltage here where the asymmetry is nowhere near as bad as it can be for current.</em></p>
<p>Yes, I agree with those points, Martin. &nbsp;I was just responding to your specific claim that&nbsp;<em>&quot;The PLL technique is capable of measuring the period between zero crossings to within one 16MHz clock period.&quot; &nbsp;</em></p>
<p>By &quot;zero crossing&quot;, it seems that you you actually mean &quot;any fixed point on the waveform&quot;. &nbsp;This is presumably after the standard HP filter. &nbsp;The signal from your voltage sensor will only remain fixed DC-wise if conditions in the vicinity remain constant. &nbsp;If my Bosch hot air gun were to be switched on nearby, or Jack&#39;s wife&#39; s hair&nbsp;dryer, your voltage waveform &nbsp;would undoubtedly shift up or down a bit. &nbsp;Easy to detect no doubt with the level of accuracy that you have at your disposal.</p>
<p>First results from my mains checker sketch suggest that our 50Hz supply pretty much spot-on. &nbsp;With a fixed rate ADC timer of 125uS, I would expect to see 480K&nbsp;voltage samples per minute:</p>
<p>-------------------------------------<br />
	Sketch ID:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MainsFreqChecker.ino<br />
	ADC mode:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 125uS fixed timer<br />
	Extra Features: none<br />
	one period has passed, sample count = 480331<br />
	one period has passed, sample count = 480757<br />
	one period has passed, sample count = 481335<br />
	one period has passed, sample count = 480688<br />
	one period has passed, sample count = 480660</p>
<p>In practice, I expect that some processing cycles will be lost between each ADC operation. &nbsp;At 8pm, the mains is probably running slow, hence the higher numbers that I&#39;m seeing. &nbsp;In due course, I hope to leave it running for 24 hours and then plot the results. &nbsp;Any trends will hopefully align with published data.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9159"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="ljfaragher&#039;s picture" title="ljfaragher&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by ljfaragher (not verified) on Wed, 16/01/2013 - 14:22.</div>
    <div class="content">
     <p><em>&gt;I also believe the Arduino UNO uses a ceramic resonator which won&#39;t be as accurate as the crystal used on the emonTx</em>.</p>
<p>My UNO r3 has a crystal.&nbsp;</p>
<p>As regards 50Hz mains drift.&nbsp; I understand accuracy over a period of time is maintained acurately.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9160"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Wed, 16/01/2013 - 14:28.</div>
    <div class="content">
     <p><em>My UNO r3 has a crystal.</em></p>
<p>That will be for the USB-UART chip. If you look near pins 9 and 10 of the ATMEGA you will see the little ceramic resonator for the processor.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9219"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="ljfaragher&#039;s picture" title="ljfaragher&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by ljfaragher (not verified) on Fri, 18/01/2013 - 11:53.</div>
    <div class="content">
     <p>Hi Martin</p>
<p>Hmm, metal cased device but&nbsp;with 3 smt pads reminiscent of a resonator but seems to have 2 smt caps to ground.&nbsp; Official Arduino website schematic for UNO R3 has crystal with caps as clock for Atmega328p. My dim and distant recollection of RS232 specification was the 1% baudrate discrepancy was well within the RS232 spec and&nbsp; resonator should be well with this %.&nbsp; Curious why USB Uart would have crystal yet clock for MPU would have resonator.&nbsp; Must be more to it.</p>
<p>I stand by my claim that 50hz mains frequency is/was tightly controlled.&nbsp;&nbsp; I have a friend who was&nbsp;technical salesrep selling power station control installations from GEC, to all over the world.&nbsp;&nbsp; They certainly used to control and correct it accurately over a period of time but who knows what commercial pressures dictate these days.</p>
<p>Anyway, lets not get sidetracked from the focus of this forum.</p>
<p>Laurence</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9575"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Markus&#039;s picture" title="Markus&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by Markus (not verified) on Sat, 02/02/2013 - 18:13.</div>
    <div class="content">
     <p>Hello</p>
<p>I&#39;m&nbsp;new in this forum, just read everything and it&#39;s all very interesting and I&#39;m thinking to build the MK2</p>
<p>Just have a doubt, we in Spain have 50Hz&nbsp;&nbsp;230Volt but &nbsp;2x120Vphase&nbsp;system and no neutral, will the MK2 work here?</p>
<p>Thanks</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9578"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sat, 02/02/2013 - 22:05.</div>
    <div class="content">
     <p>Just to clarify, you have 2 line feeds, each measuring 115 V to earth and 230 V line to line?</p>
<p>I don&#39;t see why not. You measure the voltage between lines (230 V) and the current in one line only. You install your triac in one line only, but caution - the immersion heater is live even when the triac is off.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9603"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Markus&#039;s picture" title="Markus&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by Markus (not verified) on Mon, 04/02/2013 - 14:47.</div>
    <div class="content">
     <p>Thanks Robert</p>
<p>Today I build it but it&#39;s not working, I tried with a bulb connected&nbsp;on the triac, it triggers the triac only to on or off, in debug mode the triac&nbsp;is working fine.I don&#39;t know what to do?</p>
<p>Here is the serial output</p>
<p>in NORMAL mode ...</p>
<p></p>
<p>&nbsp;</p>
<p>cyc# 5, sampleV 378, fltdV 11.00, sampleV-dc -141, cumVdeltas -1751.89, prevDCoffset 537.36, refFltdV 519.84, enInBkt 0.00<br />
	cyc# 505, sampleV 523, fltdV 26.55, sampleV-dc 13, cumVdeltas 16.92, prevDCoffset 508.84, refFltdV 509.01, enInBkt 0.00<br />
	cyc# 1005, sampleV 524, fltdV 27.50, sampleV-dc 14, cumVdeltas -10.34, prevDCoffset 509.14, refFltdV 509.03, enInBkt 0.00<br />
	cyc# 1505, sampleV 504, fltdV 6.78, sampleV-dc -5, cumVdeltas -24.09, prevDCoffset 510.08, refFltdV 509.84, enInBkt 252.34<br />
	cyc# 2005, sampleV 518, fltdV 21.20, sampleV-dc 8, cumVdeltas -41.82, prevDCoffset 509.93, refFltdV 509.51, enInBkt 1590.04<br />
	cyc# 2505, sampleV 516, fltdV 19.83, sampleV-dc 7, cumVdeltas -3.31, prevDCoffset 508.96, refFltdV 508.92, enInBkt 3600.00<br />
	cyc# 3005, sampleV 522, fltdV 25.82, sampleV-dc 13, cumVdeltas -19.39, prevDCoffset 509.06, refFltdV 508.86, enInBkt 3600.00</p>
<p>The first 3 lines are with no inyecting&nbsp;to the grid the last lines is with inverter turned on, the triac turns full on or off at the right moment bur without flickering.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9606"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1165" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="richmc&#039;s picture" title="richmc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1165" title="View user profile.">richmc</a> on Mon, 04/02/2013 - 17:03.</div>
    <div class="content">
     <p>That look right what are you actually measuring with the CT? My test rig is a&nbsp;heater with the CT around the live lead and as you have the triac powering a bulb. In debug the light will switch on and off (as you noted). with debug disabled if you then put the CT round the live of a heater etc and switch on the bucket will fill till the lamp comes on and will stay on till you reverse (phisically) the CT on the lead. If you just switch off the heater the bucket stay at the same value and the light will stay on.</p>
<p>When you wire the system into the &quot;real world&quot; you will have a feedback loop</p>
<p>sun comes out - bucket fills and fires the triac - bucket empties slightly so the triac switches off - the sun tops up the bucket so it switches on.</p>
<p>The system needs the feedback to switch the triac on and off.</p>
<p>from what I can see your system is working.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9611"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Mon, 04/02/2013 - 21:56.</div>
    <div class="content">
     <p>Yes, I agree.&nbsp; That display looks fine.&nbsp; Now you need to run the sketch in normal mode (without the #define DEBUG line), and pass one core of the cable which supplies you your load through the CT.&nbsp; You will then have some feedback so the load should flicker.&nbsp;</p>
<p>I&#39;ve posted a couple of videos about this, as listed on my Mk2 summary page (the top entry in the General forum area).</p>
<p>You may find the <strong>Mk2_PV_Router_mini.ino</strong> sketch a bit easier to follow.&nbsp; It&#39;s a lot smaller than the original one.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9671"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1088" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="fewyatt&#039;s picture" title="fewyatt&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1088" title="View user profile.">fewyatt</a> on Fri, 08/02/2013 - 12:45.</div>
    <div class="content">
     <p>Can I go back to first principles and confirm that that the correct way to calculate power is:</p>
<p>Take current and voltage samples many times a mains cycle, giving the samples I1, I2.&hellip; and V1, V2&hellip;.</p>
<p>Real power = (I1 x V1 + I2 x V2 &hellip;&hellip;&hellip;)/number of samples</p>
<p>RMS current =&nbsp; SQRT ((I1^2 + I2^2 + &hellip;.)/number of samples)</p>
<p>RMS voltage = SQRT ((V1^2 + V2^2 + &hellip;.)/number of samples)</p>
<p>VA = RMS voltage x RMS current</p>
<p>Power factor = Real power/VA</p>
<p>Does this also work if there is large voltage to current phase shift caused say by heavy inductance or capacitance in house loads? I think it should because, if say there is a 90 degree current shift on pure sine waves, the above real power will be zero but the VA will be normal sized.</p>
<p>And is this exactly the same method used by digital utility meters? I ask because if say you use phase control there is heavy distortion of the mains current caused by the non sinusoidal current and the ringing caused by the sharp current transitions. So the solar diverter has to use the same calculation method as the meter or else a balanced condition on the diverter will not equal 0W on the meter.</p>
<p>I am ignoring here any approximations caused by the sampling not being an infinite number per cycle and any voltage phase shift if you use a transformer to sense voltage.</p>
<p>I do wonder if wheel meters are quite so accurate in making this measurement as I suspect they are rather assuming the waveform is sinusoidal.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9673"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Fri, 08/02/2013 - 12:07.</div>
    <div class="content">
     <p>This all looks OK to me, but I&#39;m no expert!</p>
<p>(I presume that &quot;VA&quot; is the same as &quot;apparent power&quot;)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9674"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1165" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="richmc&#039;s picture" title="richmc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1165" title="View user profile.">richmc</a> on Fri, 08/02/2013 - 14:00.</div>
    <div class="content">
     <p><em>&quot;I do wonder if wheel meters are quite so accurate in making this measurement as I suspect they are rather assuming the waveform is sinusoidal.&quot;</em></p>
<p>They were invented many many years before light dimmers, drill speed controllers, switched mode power supplies etc. that do very odd things to the current waveform, so I guess not. And the volt sense transformer is being used at minimal current draw so distortion will be minimal and phase shift&nbsp;can be compensated for.&nbsp;</p>
<p>A 90deg phase shift would be unlikely although I wouldn&#39;t mind a 180deg phase shift on my major appliances though my energy supplier would be a bit miffed!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9687"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Markus&#039;s picture" title="Markus&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by Markus (not verified) on Fri, 08/02/2013 - 20:17.</div>
    <div class="content">
     <p>Yes eureka system is working fine after connecting the load of a 2Kw heater.</p>
<p>Our problem here in Spain&nbsp;is that electricity companies have programmed their digital meters to sum the exported energy&nbsp;on your bill, they see PV energy as a&nbsp;competition&nbsp;on the market and do everything to kill it.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9690"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Fri, 08/02/2013 - 21:07.</div>
    <div class="content">
     <p>OUCH!&nbsp; There&#39;s a distinct lack of understanding of basic principles in some of the above posts.</p>
<p>1. VA (Volt.Amperes) is the same as apparent power. There&#39;s Power (real power), the quadrature component is reactive power (I was taught &#39;imaginary power&#39; which is a much more self-explanatory term) or vars (Volt.Amperes reactive), and the resultant of those two is apparent power (V.A) which is what you get when you read an ammeter and a voltmeter and multiply the two numbers.</p>
<p>2. Phase shift doesn&#39;t affect the maths because there are no approximations in there. It might well affect your ability to measure it accurately though without the right gear.</p>
<p>3. An induction/Ferraris/disc meter does the multiplication by the magnetic field acting on a current. So it is pure physics. If you do the theory, the only approximation is the current in the voltage coil isn&#39;t quite at 90&deg; to the voltage (because you can&#39;t have a pure inductance without some resistance), so the magnet has a shading ring fitted to correct this. You&#39;ll find that the equation for torque doesn&#39;t have a frequency term in it, so harmonics don&#39;t enter the picture. (But note, that doesn&#39;t meant that this type of meter will work on d.c - it won&#39;t!)</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10225"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Markus&#039;s picture" title="Markus&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by Markus (not verified) on Sat, 02/03/2013 - 10:50.</div>
    <div class="content">
     <p>My latest creation</p>
<p><img alt="" src="http://revosolar.com/solar-shop/374-thickbox_default/inhibidor-inyectar-a-la-red.jpg" style="width: 400px; height: 400px;" /></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10226"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sat, 02/03/2013 - 11:49.</div>
    <div class="content">
     <p>Very neat, Markus.&nbsp; Any chance of a photo to show how the triac and heatsink are fitted?</p>
<p>Nice looking PCB.&nbsp; Are you able to supply these for others to use too?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10230"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2867" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="9fingers&#039;s picture" title="9fingers&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2867" title="View user profile.">9fingers</a> on Sat, 02/03/2013 - 12:37.</div>
    <div class="content">
     <p>Was there a reason in the main design for not using a packaged solidstate relay with zero crossing opto isolation built in?</p>
<p>They are so cheap on ebay now and would do away with one of the pcbs in the two board solution.</p>
<p>&nbsp;</p>
<p>Bob</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10231"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sat, 02/03/2013 - 13:37.</div>
    <div class="content">
     <p><em>Was there a reason in the main design for not using a packaged solidstate relay with zero crossing opto isolation built in?</em></p>
<p>Not really.&nbsp; As soon as I saw Paul&#39;s video of a triac silently switching a lamp on and off, I knew that&#39;s what I wanted to do.&nbsp; By using a standard triac and trigger, I was able to forget about the HV side and concentrate just on LV things. &nbsp;&nbsp;</p>
<p>If the trigger and triac are in the same package, why would that affect the pcb?&nbsp; 240V still has be present on the board somewhere.&nbsp; Or would you be wiring direct to the pins of your SSR?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10234"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Sat, 02/03/2013 - 15:05.</div>
    <div class="content">
     <p><em>Was there a reason in the main design for not using a packaged solidstate relay with zero crossing opto isolation built in?</em></p>
<p><em>They are so cheap on ebay now and would do away with one of the pcbs in the two board solution.</em></p>
<p>The logical extension to that question is why not use an emonTx instead of a Uno and get rid of both PCBs? That way you also have the option of adding wireless monitoring if you want to. A 3V SSR plus an emonTx is all you need.</p>
<p>That&#39;s not to take anything away from Markus&#39;s design, that&#39;s a very professional looking solution - well done!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10235"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sat, 02/03/2013 - 15:32.</div>
    <div class="content">
     <p><em>The logical extension to that question is why not use an emonTx instead of a Uno and get rid of both PCBs?&nbsp; </em></p>
<p>I had two reasons for not using the emonTx:&nbsp; i)&nbsp; I wanted my 2.5V Vref rail to be buffered and shared, and ii) I already had a pair of Uno R3s.&nbsp;&nbsp;</p>
<p>An emonTx has no space for output circuitry, so some kind of mounting would still be needed for the SSR and any associated components.&nbsp; Or is the idea that the SSR is mounted on a heatsink, as per the triac, with control wires coming straight from the emonTx?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10236"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Sat, 02/03/2013 - 15:42.</div>
    <div class="content">
     <p>The buffered reference is a valid point but I don&#39;t think it&#39;s very significant. You can get remarkably accurate results from a standard emonTx.</p>
<p>Most SSRs have a built-in heatsink so you would put that safely away somewhere and just run the low voltage wires to the emonTx.</p>
<p>It may even be a cheaper solution if you have to buy everything??</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10238"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="willatpenru&#039;s picture" title="willatpenru&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by willatpenru (not verified) on Sat, 02/03/2013 - 16:49.</div>
    <div class="content">
     <p>Hi,</p>
<p>I have an SMA Sunnyboy 4000TL&nbsp;in an offgrid&nbsp;property in Wales. In conjunction with a SMA Sunny Island 2224 Inverter/Charger, it supplies our house with 240ac and charges a 24 volt dc battery bank. &nbsp;The System regulates overproduction during periods of low load by using Frequncy&nbsp;Shift Power Control (FSPC). When the battery is full and there is no load but lots of sun the Sunny Island raises the grid Frequency from 50hz to 52 in 0.1hz increments. At 52hz the Sunnyboy produces 0 power to prevent overcharging of the battery.</p>
<p>I&#39;d like to modify Robins design to use frequency rather than current as the control input to activate an immersion heater....trouble is I have no idea what im doing!</p>
<p>&nbsp;I have very limited experience of programming Campbell Scientific data loggers and have bought an Arduino Nano&nbsp;starter kit and have learnt (copy and paste) how to program some button controlled LED programs.&nbsp;</p>
<p>&nbsp;It seems to me that it wouldnt be too much of a leap and hoped some of the brain power in this forum could help me out or suggest some reading. &nbsp;Am I right in understanding that the Triac is efficient by literally allowing an unprocessed AC wave through or not. So if there was 1kw of excess pv and you had a 2kw immersoin heater it would let through 50% of the ac cycles?</p>
<p>The only thing I can bring to the table is the concept that this could be developed into a commercial product for Offgrid installations that use FSPC....</p>
<p>Any feedback much appreciated.</p>
<p>Will</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10239"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2867" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="9fingers&#039;s picture" title="9fingers&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2867" title="View user profile.">9fingers</a> on Sat, 02/03/2013 - 16:27.</div>
    <div class="content">
     <div class="content">
<p><em>Was there a reason in the main design for not using a packaged solidstate relay with zero crossing opto isolation built in?</em></p>
<p><em>Not really.&nbsp; As soon as I saw Paul&#39;s video of a triac silently switching a lamp on and off, I knew that&#39;s what I wanted to do.&nbsp; By using a standard triac and trigger, I was able to forget about the HV side and concentrate just on LV things. &nbsp;&nbsp;</em></p>
<p><em>If the trigger and triac are in the same package, why would that affect the pcb?&nbsp; 240V still has be present on the board somewhere.&nbsp; Or would you be wiring direct to the pins of your SSR?</em></p>
<p>&nbsp;</p>
<p>Yes exactly that, most SSRs come with two hefty screw terminals for the power and 2 smaller screws for the drive which can easily accommodate the series resistor so direct connection to the processor and no PCB needed.</p>
<p>- Not meant as a criticism but just my thoughts as I start to think about building something myself.</p>
<p>I&#39;m doing a training course next week to get Easy MCS accreditation for solar thermal installs. My thermal store will be on order soon with only 5% vat and I&#39;ll fit it in April. We will be without a boiler for a few months over the summer so ideal opportunity for PV dumping rather than the grid to heat DHW.</p>
<p>Your software seems so refined now that I&#39;m unlikely to be able to make an significant contribution to it. I&#39;ll most likely shamelessly&nbsp; use it as is and try and &#39;pay back&#39; with ideas in related fields if possible.</p>
</div>
<p>Bob</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10244"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sat, 02/03/2013 - 18:27.</div>
    <div class="content">
     <p><em>Yes exactly that, most SSRs come with two hefty screw terminals for the power and 2 smaller screws for the drive which can easily accommodate the series resistor so direct connection to the processor and no PCB needed.</em></p>
<p>And the price tag?&nbsp; My triac and trigger come to around a fiver.</p>
<p><em>Your software seems so refined now that I&#39;m unlikely to be able to make an significant contribution to it. </em></p>
<p>There&#39;s always room more more refinements!&nbsp; When re-connecting my rig for today&#39;s sun, I moved my selector switch for the Immersion to &quot;constant&quot; several times.&nbsp; On each occasion, consumption started to register at our meter.&nbsp; After turning the selector back to &quot;PV only&quot;, power distribution (in anti-flicker mode) started up again shortly after.&nbsp; All just as expected.</p>
<p>On each occasion, while the router&#39;s energy bucket was charging up, the meter&#39;s LED went on thereby showing that some surplus power has been lost.&nbsp; This is an unfortunate consequence of the router not knowing the state of the meter&#39;s own &quot;bucket&quot;, or equivalent.</p>
<p>If the router were to monitor the meter&#39;s LED events, and update the level in its own energy bucket accordingly, alignment between the two systems could be maintained at all times.&nbsp; No more energy need ever be lost whenever the system starts up after a period of export.</p>
<p>This is a limitation which I hope to fix before too long.&nbsp; But it&#39;s also an open challenge to anyone else who may be interested ...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10246"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Sat, 02/03/2013 - 18:44.</div>
    <div class="content">
     <p><em>If the router were to monitor the meter&#39;s LED events, and update the level in its own energy bucket accordingly, alignment between the two systems could be maintained at all times</em>.</p>
<p>That doesn&#39;t sound very difficult. Isn&#39;t it just a matter of setting the energy bucket to full when you get an interrupt from light sensor? I had a play with detecting the meter LED for my <a href="http://openenergymonitor.org/emon/node/2059">ICAL calibration tool </a>and it&#39;s pretty simple to do.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10247"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Markus&#039;s picture" title="Markus&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by Markus (not verified) on Sat, 02/03/2013 - 19:30.</div>
    <div class="content">
     <p>Hi Robin</p>
<p>I just &nbsp;glued the heat sink with heatproof&nbsp;silicone.</p>
<p>Today I&#39;ve tried about 10 hours with a 4,5Kw&nbsp;load and heat is around 50-55&ordm;C on heat sink. Traces on print for load are &nbsp;traced on top and bottom of pcb, it is designed to hold 30A</p>
<p>About if PCB is available, yes it&#39;s possible will be around 20&euro;, I have made 5 PCB (absolute minim) by a 6 hour quick service and it have cost me 43&euro; each, to get discount I&#39;ve to order at least 50 pieces.</p>
<p>&nbsp;</p>
<p><img alt="" src="http://revosolar.com/solar-shop/375-thickbox_default/inhibidor-inyectar-a-la-red.jpg" style="width: 400px; height: 400px;" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10248"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2867" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="9fingers&#039;s picture" title="9fingers&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2867" title="View user profile.">9fingers</a> on Sat, 02/03/2013 - 19:37.</div>
    <div class="content">
     <p><em>And the price tag?&nbsp; My triac and trigger come to around a fiver.</em></p>
<p>And the PCB?</p>
<p>About half your price here <b>http://tinyurl.com/ac2stf7&nbsp; </b></p>
<p>&pound;2.55 including P&amp;P from Hong Hong</p>
<p>&nbsp;</p>
<p>I put one of this type into a kiln controller recently without drama. They take about 3 weeks to arrive but I just can&#39;t think how they can post them around the world to that price.</p>
<p>&nbsp;</p>
<p>Bob</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10252"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sat, 02/03/2013 - 22:15.</div>
    <div class="content">
     <p><em>That doesn&#39;t sound very difficult. Isn&#39;t it just a matter of setting the energy bucket to full when you get an interrupt from light sensor?&nbsp; </em></p>
<p>Indeed it is.&nbsp; But if you do nothing else, then the triac will come on straight away because the bucket is full. &nbsp; The algorithm for turning the triac on will need to be a bit smarter.&nbsp;</p>
<p>There will also be a delay before the meter pulse can be confirmed, so the bucket&#39;s level will ideally need to be adjusted by however much energy has flowed since the start of the pulse.&nbsp; Not every off-&gt; on transition is the start of a pulse.&nbsp; Periods of exporting and anti-creep both start in this way.&nbsp;</p>
<p>And although it doesn&#39;t look like one, an on-&gt;off transition means just the same as a pulse; you have just been charged.&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10261"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Sun, 03/03/2013 - 12:20.</div>
    <div class="content">
     <p>I prefer to use the SSR as no pcb is needed and mains connections are direct to it.&nbsp; I&#39;m using these:</p>
<p>&nbsp;http://uk.rs-online.com/web/p/solid-state-relays/7360867/</p>
<p>Not cheap but a quality item. The SSR is Zero crossing and has very little heat output. The input current is also very low so no resistor is needed.</p>
<p>One thing&nbsp;to note though is that the input is reversed- ie high is on. To me this is the way it should be and not high is off, especially as I have mine mounted remotely, about 75m away,&nbsp;and therefore any break in the control cable would not result in the loads being on.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10263"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Sun, 03/03/2013 - 12:36.</div>
    <div class="content">
     <p><em>I&#39;d like to modify Robins design to use frequency rather than current as the control input to activate an immersion heater....trouble is I have no idea what im doing!</em></p>
<p>I have Sunny 5000&nbsp;backups for my system. To use Robins system have you thought about using a frequency controlled relay to turn it on. As the frequency rises to limit the output of the inverter the relay could be set to turn on the supply to the Triac / SSR.</p>
<p>I bought this one on ebay</p>
<p>&nbsp; <a href="http://cgi.ebay.co.uk/ws/eBayISAPI.dll?ViewItem&amp;item=200839603252&amp;ssPageName=ADME:X:AAQ:GB:1123" title="http://cgi.ebay.co.uk/ws/eBayISAPI.dll?ViewItem&amp;item=200839603252&amp;ssPageName=ADME:X:AAQ:GB:1123">http://cgi.ebay.co.uk/ws/eBayISAPI.dll?ViewItem&amp;item=200839603252&amp;ssPage...</a></p>
<p>You would also need to put a delay timer in to stop the relay cutting out as the frequency dropped when the loads came on.</p>
<p>Another option is&nbsp;I think the SB2200&nbsp; has a relay within it that can be set&nbsp;using different parameters eg. battery state of charge&nbsp;so you could use that to control a large relay for the triac/ssr supply.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10270"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sun, 03/03/2013 - 19:02.</div>
    <div class="content">
     <p><a href="http://openenergymonitor.org/emon/user/3346" title="View user profile.">willatpenru</a></p>
<p>You could also look at <a href="http://openenergymonitor.org/emon/node/1535">Martin&#39;s PLL design</a>, which measures the frequency on-board. It uses the same basic algorithm for load control. There&#39;s not much point in buying an add-on relay if you can do it on the software.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10279"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Mon, 04/03/2013 - 08:34.</div>
    <div class="content">
     <p>Yes,thanks Robert.&nbsp;&nbsp;The PLL library I posted <a href="http://openenergymonitor.org/emon/sites/default/files/PLL50Hz.zip">here</a> will give you frequency too.</p>
<p>How will you know when to turn the load off once the frequency drops though?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10281"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Mon, 04/03/2013 - 08:56.</div>
    <div class="content">
     <p><em>How will you know when to turn the load off once the frequency drops though?</em></p>
<p>Its not just that- you also&nbsp;have to be careful that the sunny backup doesn&#39;t start using the batteries to power the controlled&nbsp;loads.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10312"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Wed, 06/03/2013 - 00:59.</div>
    <div class="content">
     <p>I&#39;m not sure if&nbsp;I am the only one to be using Robins&nbsp;sketch in anti flicker mode but&nbsp;I have noticed something that is very important.</p>
<p>Robin mentions, how with anti flicker, it is&nbsp;vital to get everything calibrated spot on. Despite doing all&nbsp;that&nbsp;I still couldn&#39;t get the&nbsp;led on my electricity meter to stop registering consumption. Eventually through trial and error&nbsp;I managed to find calibration values that worked pretty well but they weren&#39;t anywhere near where they should be.&nbsp;The conclusion&nbsp;I reached was that my meter didn&#39;t have an &#39;energy bucket&#39; of&nbsp;3600J.</p>
<p>I need to run the anti flicker mode as I use multiple battery chargers, switched in sequence, to charge my batteries up with the surplus PV.</p>
<p>Today was the first time&nbsp;I have had some time available to test that theory and to cut a long story short I&#39;ve found my meter has an energy bucket of only&nbsp;1250J.&nbsp;This meter is an ACE1000 which can be manufactured either by Itron or Landis &amp; GYR.</p>
<p>Is anyone else using anti flicker?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10314"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Wed, 06/03/2013 - 07:41.</div>
    <div class="content">
     <p>The brochure for the meter says both&nbsp;the meter constant&nbsp;and the auxiliary contacts are&nbsp;&nbsp;800 pulses per kWh. I would have expected the &#39;energy bucket&#39; to be 1.25Wh or 4500 Joules from that so 1250 Joules is surprising.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10315"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Wed, 06/03/2013 - 08:13.</div>
    <div class="content">
     <p>Yes that was my thought as well but it certainly isn&#39;t. You can run a 500w load for 2.5 seconds without it registering but try it for 2.6 seconds and in this case the green led on the meter goes off and the red led will pulse.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10316"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Wed, 06/03/2013 - 08:44.</div>
    <div class="content">
     <p>It might be worth getting another meter and checking it on the bench just to make sure that yours isn&#39;t faulty. They&#39;re only &pound;11 from <a href="http://www.universalmeterservices.co.uk/store/index.php?main_page=product_info&amp;products_id=60">UMS here</a>.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10318"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Wed, 06/03/2013 - 12:52.</div>
    <div class="content">
     <p>I had my system connected to the DNO meter and that&#39;s when&nbsp;I noticed&nbsp;the calibrated values didn&#39;t work with it&nbsp;so&nbsp;I purchased a meter to bench test from the company you mention.</p>
<p>The values&nbsp;I had found worked&nbsp;using trial and error on the DNO meter were a powercal of 0.15 using an energy bucket of 2800J (I had assumed worst case and reduced the 3600J to 2800J as my meter is only 800 pulses, wrong way round&nbsp;I know,&nbsp;but&nbsp;I was frustrated and wanted to use the worst case&nbsp;I could possibly think of).</p>
<p>My tallymode my powercal should be 0.067</p>
<p>interpolating;</p>
<p>(2800/1250) = 2.24 multiply that by&nbsp; 0.067 gives the 0.15 that I&rsquo;d got by trial and error.</p>
<p>So both meters give the same result.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10324"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1163" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1163.gif" alt="markcarter10&#039;s picture" title="markcarter10&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1163" title="View user profile.">markcarter10</a> on Wed, 06/03/2013 - 12:24.</div>
    <div class="content">
     <p>Tinbum</p>
<p>I have the same meter. I tried the AF MK2i rev 4 and found that I could not get it to work as intended without getting a charge pulse. So I&#39;m back in the normal mode. I don&#39;t have an issue with flickering lights but wanted to have a play with the AF mode.</p>
<p>I&#39;m also fairly confident that my MK2 is calibrated well and works just fine in normal mode!</p>
<p>&nbsp;</p>
<p>Mark</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10325"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Wed, 06/03/2013 - 12:24.</div>
    <div class="content">
     <p>Digital meters appear to have different ways of accommodating reverse flow.&nbsp; In the standard case, the whole of each 1 Wh window is available for reverse flow.&nbsp; Providing that your A/F measures remain&nbsp; within this range, and the router&#39;s energy bucket never under- or over-flows, you should be OK.&nbsp;</p>
<p>During periods of consumption, some meters pulse less frequently than once per Wh.&nbsp; One might be tempted that this larger window is therefore available for retrievable reverse flow, but that does not seem to be the case. &nbsp; I think what&#39;s happening here is that every time the green LED goes off, some charge is being registered.&nbsp; After N iterations, a red pulse appears.&nbsp; But if the oscillations are kept sufficiently small that the LED never goes off, then no charge is levied, hence no pulses.&nbsp;</p>
<p>It would be very interesting to know whether N is constant.&nbsp; In other words, does the red pulse always occur after the same number of consumption cycles, regardless of whether the timer is set to 2.6 seconds or 2.8 or 3.0?&nbsp;&nbsp; My hunch is that it will not make any difference.</p>
<p>While surplus power is being actively diverted, I think it&#39;s OK for the led to be either constantly &#39;on&#39; or &#39;off&#39;, but it should definitely not be cycling on/off in time with the load operation.&nbsp; If this is happening, then I feel sure that you will be wasting power and also being charged for the privilege!&nbsp; Definitely something to watch out for.&nbsp;</p>
<p>Operation outside the sweet zone can be easily checked by adjusting the cal factor so that the router under-reads.&nbsp;&nbsp; If using twin energy thresholds that are 0.8 Wh apart, I would expect normal service to be maintained until the calibration is out by around 20% (or 25% for the purists).&nbsp; After this point, the LED&#39;s behaviour will noticeably change.&nbsp; This kind of experimentation allows the margin of safety to be determined directly, but the results do need to be viewed in the light of the prevailing conditions, both weather and base-load.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10326"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Wed, 06/03/2013 - 12:26.</div>
    <div class="content">
     <p>An interesting observation. I&#39;m trying to figure out the significance of 4500 / 1250 = 3.6. Moreover, what I don&#39;t understand is how you get an indication after 1250 J when the meter constant equates to 4500 J? Are you saying that the first pulse after export comes after 1250 J, then the next (continuously importing) after a further 4500 J, or is your meter constant 2880 pulses per kWh and not 800 as specified?</p>
<p>One thing is certain: your &#39;anti-flicker&#39; won&#39;t be as effective as it would otherwise be.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10328"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Wed, 06/03/2013 - 12:55.</div>
    <div class="content">
     <p>Hi Mark,</p>
<p>I&#39;d be interested if you could &nbsp;try it in antiflicker with the energy bucket at 1250J instead of the 3600J and see if it works then. I&#39;m certain it will.</p>
<p>Nick</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10329"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1163" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1163.gif" alt="markcarter10&#039;s picture" title="markcarter10&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1163" title="View user profile.">markcarter10</a> on Wed, 06/03/2013 - 12:59.</div>
    <div class="content">
     <p>Will do but my free time when the sun is out is at weekends only. So let's hope we have enough excess at the weekend to give it a try.</p>
<p>Mark</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10330"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Wed, 06/03/2013 - 13:08.</div>
    <div class="content">
     <p><em>Are you saying that the first pulse after export comes after 1250 J, then the next (continuously importing) after a further 4500 J,&nbsp; </em></p>
<p>If I may venture an opinion, I think the answer is yes, but they are two different types of pulse/event.</p>
<p>With most meters, the LED going off is essentially the same as a 1 Wh pulse, although it doesn&#39;t look like one.&nbsp; In the case of this alternative type of meter, it is only the &#39;big&#39; consumption pulses that are normally seen (red led).&nbsp;&nbsp; Its &#39;mini&#39; consumption events are not normally seen because the green LED is normally not on during periods of consumption.&nbsp; They can only be seen when repeating periods of reverse flow exceed the capacity of the mini window, which appears to be around 1250 J.</p>
<p>My hunch is that there will always be the same number of mini charge events (green led, on-&gt;off) before each red pulse is seen.&nbsp; It will be interesting to see whether the number of cycles per red pulse is affected by the duration of each period of consumption.</p>
<p>But that&#39;s only my prediction ...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10334"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Wed, 06/03/2013 - 14:00.</div>
    <div class="content">
     <p>I will try and find time to do a bit more testing on this meter and count the green pulses before a red and also&nbsp;try with different loads, but I&#39;m really busy at the moment.</p>
<p>Re. antiflicker not working so well with such a small energy bucket, very true, which is disappointing, but thankfully my loads that have to run antiflicker are only 1Kw each.</p>
<p>Robin very kindly wrote me a multiload sketch so&nbsp;I have 5 triacs controlled by the Arduino.&nbsp;</p>
<p>4 1Kw loads (battery chargers) are turned on in sequence depending on the available PV using antiflicker mode. The 5th Triac is to the 3Kw immersion element&nbsp;which won&#39;t run well on antiflicker with this meter. I have now adapted the sketch so that when the 5th triac turns on the mode automatically changes from antiflicker to normal. This will have no effect on the first 4 loads as they are already all&nbsp;on constantly. Should the PV then drop the mode will change back to antiflicker. Just waiting for the sun!!&nbsp;</p>
<p>.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10348"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Thu, 07/03/2013 - 00:35.</div>
    <div class="content">
     <p>If you only have 1 kW loads, it might be worth recording the voltage dip when you switch the load. If it&#39;s less than 0.3%, you don&#39;t need to worry about it.</p>
<p><a href="http://www.compliance-club.com/archive/old_archive/990619.html">Harmonics and Flicker - the low frequency end of the EMC spectrum<br />
	By Dr. Philip D Slade, Exeter University<br />
	http://www.compliance-club.com/archive/old_archive/990619.html</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10349"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Thu, 07/03/2013 - 09:47.</div>
    <div class="content">
     <p><em>1Kw loads (battery chargers) are turned on in sequence depending on the available PV using antiflicker mode. The 5th Triac is to the 3Kw immersion element&nbsp;which won&#39;t run well on antiflicker with this meter. I have now adapted the sketch so that when the 5th triac turns on the mode automatically changes from antiflicker to normal.</em></p>
<p>The extent to which anti-flicker measures can be usefully applied is dependent on the meter, not the load.&nbsp; If a simple 2-threshold A/F scheme works with your meter when running a 1 kW dump load, then it should also work for a 3 kW load, or any other rating for that matter.&nbsp;&nbsp; The &quot;sweet zone&quot; of the meter is the same regardless of the load.&nbsp;</p>
<p>For most meters, this value of this usable zone is 3600 J.&nbsp; Because yours is less than this, around 1250 J, your upper and lower thresholds will need to be closer together, maybe 1000 J apart.&nbsp;</p>
<p>Make sure that you don&#39;t have any timing criteria in there.&nbsp; My A/F schemes to date have generally had a feature that prevents the triac from switching on or off within a certain period after the previous transition.&nbsp; You could either remove this logic, or set the value of this period to zero.</p>
<p>The benefit of A/F becomes progressively greater as the rating of the load is increased.&nbsp; It makes little sense to me for A/F measures to be in place for small loads, but absent for larger ones.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10353"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Thu, 07/03/2013 - 11:29.</div>
    <div class="content">
     <p><em>If you only have 1 kW loads, it might be worth recording the voltage dip when you switch the load. If it&#39;s less than 0.3%, you don&#39;t need to worry about it.</em></p>
<p>Hi, yes&nbsp;I see the reasoning but&nbsp;I&#39;m not running it in the A/F mode because of flicker its actually because of the type of load.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10358"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Thu, 07/03/2013 - 12:45.</div>
    <div class="content">
     <p>Anti-flicker mode affects the rate at which flicker occurs. It has absolutely no effect on the voltage dip - none whatsoever. Your logic seems more than a little topsy-turvey to me and I think you need to stand back and think through how the algorithm actually works, and how the controller interacts with the meter, and how your loads interact with the electricity supply. You&#39;ll find the complete write-up by Robin <a href="http://openenergymonitor.org/emon/mk2">here</a> and something about meters <a href="http://openenergymonitor.org/emon/buildingblocks/meters">here</a>.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10366"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Fri, 08/03/2013 - 08:46.</div>
    <div class="content">
     <p><em>Anti-flicker mode affects the rate at which flicker occurs. It has absolutely no effect on the voltage dip - none whatsoever. Your logic seems more than a little topsy-turvey to me and I think you need to stand back and think through how the algorithm actually works, and how the controller interacts with the meter, and how your loads interact with the electricity supply. You&#39;ll find the complete write-up by Robin here and something about meters here.</em></p>
<p>Sorry but my logic is totally sane and i know exactly what i am doing. What is it with this forum, new members come along and they just get slated.</p>
<p>You mentioned voltage dip not me. The normal mode is good for resistive loads, my battery chargers are not resistive loads.</p>
<p>To be perfectly honest&nbsp;I think Im just going to leave the forum.To be blunt&nbsp;I now have a system that works perfectly and you can just go on and work out the rest for yourselves.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10367"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Thu, 07/03/2013 - 17:32.</div>
    <div class="content">
     <p>Voltage dip, more specifically the perception of the effect of dip - flicker - is the reason for the regulations concerning the rate at which you can automatically switch a load. Any load. That&#39;s why I mentioned that if your dip was less than 0.3%, you had no need to concern yourself with flicker. Otherwise, if the combination of dip and switching frequency falls inside the area where it has been shown to cause annoyance, the electricity supplier can force you to stop using the system until you comply.</p>
<p>It seems highly probable to me that unless your 3 kW load also has in parallel a very large capacitor, it will cause roughly 3 times the dip of the 1 kW loads, hence it will be that much more likely to create annoyance and attract the attention of the authorities.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10368"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Thu, 07/03/2013 - 19:10.</div>
    <div class="content">
     <p>I will say again- I&#39;m not running it in the A/F mode because of flicker its actually because of the type of load.</p>
<p>I want the 1Kw loads either&nbsp;OFF or&nbsp;ON at full power and nothing in between. The 3Kw load is pure resistance and doesn&#39;t require any&nbsp;similar requirement. but a 3kw load in A/F would be on for 0.4166 seconds with very slightly more PV generated than base load and that&#39;s not allowing for any margin. And at the other end when the surplus PV available is just below the 3Kw load the triac would need to be off for only slightly more than the&nbsp;0.4166 seconds before the energy bucket was full again so A/F would waste loads of energy to the grid unless the timings are removed.</p>
<p>I know exactly what flicker is and was on the receiving end of it many years ago in a small village that&nbsp;I lived&nbsp;In. It took the DNO months to find the faulty item and only then&nbsp;because they saw the same equipment in another village with the same problem, but that&#39;s another story.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10376"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Thu, 07/03/2013 - 21:22.</div>
    <div class="content">
     <p><em>To be perfectly honest&nbsp;I think Im just going to leave the forum.</em><em> To be blunt&nbsp;I now have a system that works perfectly and you can just go on any work out the rest for yourselves.</em></p>
<p>That&#39;s a pity.&nbsp;&nbsp; Thanks for acknowledging the help that I&#39;ve given you.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10394"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1163" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1163.gif" alt="markcarter10&#039;s picture" title="markcarter10&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1163" title="View user profile.">markcarter10</a> on Sat, 09/03/2013 - 10:58.</div>
    <div class="content">
     <p>Robin / Tinbum</p>
<p>&nbsp;</p>
<p><em>Re. antiflicker not working so well with such a small energy bucket, very true, which is disappointing, but thankfully my loads that have to run antiflicker are only 1Kw each</em></p>
<p>I can confirm that changing the Energy Bucket size to 1250 joules ( I have an&nbsp;Actaris Ace1000 Consumption&nbsp;Electricity Meter) will now let me use the Anti Flicker Mode in the MK2i sketch</p>
<p>So i concur with Tinbum that the Actaris Ace1000 meter has a much smaller energy bucket than most other meters</p>
<p>the settings that I used in the sketch are:</p>
<p>#define JOULES_PER_WATT_HOUR 1250</p>
<p>float minTimeBetweenActivationsinAFmode = 1;&nbsp;&nbsp; // &lt;-- anti-flicker requirement (seconds)</p>
<p>float offsetOfEnergyThresholdsInAFmode = 0.22; //<strong><u> any value higher than 0.22 would cause the green LED (on the meter) to go o</u></strong>ut</p>
<p>&nbsp;</p>
<p>regards</p>
<p>&nbsp;</p>
<p>Mark</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10395"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1775" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1775.jpg" alt="Brian D&#039;s picture" title="Brian D&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1775" title="View user profile.">Brian D</a> on Sat, 09/03/2013 - 11:31.</div>
    <div class="content">
     <p>I have an Ampy Automation (now Landis &amp; Gyr) Type 5196A consumption meter.</p>
<p>	During periods when say &gt; 1kW of surplus PV is available and my energy diverter is operating in low frequency anti flicker mode the red LED on my meter is permanantly lit.</p>
<p>	If my meter is disconnected from all loads the LED is permanantly lit.</p>
<p>	If the surplus PV is only ~ 100W and anti flicker diverting is operating the LED is lit most of the time but occasionally goes out but does not produce the familiar brief pulse that is normally identified as a charge pulse.</p>
<p>	When the LED is off and a small reverse flow is occuring the LED remains OFF for several seconds before returning to the steady on state.</p>
<p>	So, a few questions.</p>
<p>	1. Is there a power threshold that must be exceeded before the meters internal counter begins to decrement?<br />
	2. If so, does this mean that when diverting small amounts of power we should take account of the threshold?<br />
	3. Could the previous posts regarding the Actaris have more to do with the level of power being diverted than the flicker rate?<br />
	4. Does the Ampy 5196A charge when the LED goes from ON to OFF or does it only charge on a pulse?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10420"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Mon, 11/03/2013 - 10:03.</div>
    <div class="content">
     <p><em>Brian D: During periods when say &gt; 1kW of surplus PV is available and my energy diverter is operating in low frequency anti flicker mode the red LED on my meter is permanantly lit.</em></p>
<p>The reason that your meter&#39;s LED is lit is that surplus power is generally lost (i.e. donated to the grid) at startup.&nbsp; This occurs at the start of each period when surplus power becomes available.&nbsp; As the router&#39;s energy bucket climbs from 0% to 90%, so the meter&#39;s equivalent mechanism falls by a similar amount.&nbsp; Unless the meter was on the verge of issuing its next consumption pulse, it will hit its lower endpoint and the familiar red LED will appear as some energy is irretrievably lost.</p>
<p>If we were to monitor and react to the meter&#39;s pulses, then the two systems could be maintained in a state of alignment while consumption occurs.&nbsp; The start of each episode of surplus power would then be &#39;clean&#39;, with no loss of energy and no LED going on.&nbsp; While diverting power, we would then have a positive indication of the meter&#39;s &quot;sweet zone&quot; being exceeded at either end of the usable range:&nbsp; if the LED goes on, we&#39;ve hit the lower limit; if there&#39;s a pulse, we&#39;ve exceeded the upper limit.&nbsp;</p>
<p>When using an A/F range of maybe 80% of the 1 Wh sweet zone that most meters provide, there&#39;s not much spare room to play with, hence the need for accurate calibration and good linearity.</p>
<p><em>If the surplus PV is only ~ 100W and anti flicker diverting is operating the LED is lit most of the time but occasionally goes out but does not produce the familiar brief pulse that is normally identified as a charge pulse.</em></p>
<p>&nbsp;</p>
<p>If the LED ever goes from on-&gt;off, I am confident that you have been charged.&nbsp; It may not look like a pulse, but it has the same effect as one.&nbsp; I ran tests to demonstrate this back in October, as documented with my DigitalMeterEmulator tool.&nbsp; There&#39;s a link to this at <a href="http://openenergymonitor.org/emon/node/1757" title="http://openenergymonitor.org/emon/node/1757">http://openenergymonitor.org/emon/node/1757</a> .</p>
<p><em>When the LED is off and a small reverse flow is occuring the LED remains OFF for several seconds before returning to the steady on state.</em></p>
<p>That&#39;s because the LED only goes on when the meter&#39;s internal 1 Wh monitor hits its lower limit.&nbsp; Some nice diagrams about this have recently appeared at <a href="http://openenergymonitor.org/emon/buildingblocks/meters" title="http://openenergymonitor.org/emon/buildingblocks/meters">http://openenergymonitor.org/emon/buildingblocks/meters</a> .</p>
<p>So, a few questions.</p>
<p><em>1. Is there a power threshold that must be exceeded before the meters internal counter begins to decrement?</em></p>
<p>No, it will decrement immediately.</p>
<p>
	<em>2. If so, does this mean that when diverting small amounts of power we should take account of the threshold?</em></p>
<p>N/A</p>
<p>
	<em>3. Could the previous posts regarding the Actaris have more to do with the level of power being diverted than the flicker rate?</em></p>
<p>No, it&#39;s just that some meters have less range that can be usefully exploited.&nbsp;</p>
<p>
	<em>4. Does the Ampy 5196A charge when the LED goes from ON to OFF or does it only charge on a pulse?</em></p>
<p>Yes, it does.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10424"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1775" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1775.jpg" alt="Brian D&#039;s picture" title="Brian D&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1775" title="View user profile.">Brian D</a> on Mon, 11/03/2013 - 20:52.</div>
    <div class="content">
     <p>Thanks Robin that&#39;s an excellent reply.</p>
<p>	I have more questions so if you will bear with me.</p>
<p>	My problem is that although I can look at my energy diverter in action and convince myself that it works as intended when I try to prove the method of operation on paper I run into difficulty. The second link you provided has a nice image which I have modified slightly to help explain my problem and have attached to this post. I have added the blue line and the green line.</p>
<p>	The original drawing shows the ideal situation where the energy fluctuations are oscillated through the meter at roughly the half way point of the 1Wh &#39;energy packet&#39;. In his ideal situation I have no problem.</p>
<p>	My diagram shows what I think will happen in the real world given that our energy controllers are not synchronised to the internal counter in the meter. Presumably the first time we cross the upper energy packet point and produce a charge pulse this will reset the internal counter and set the empty point. We now pour some energy into the meter but its counter is already zero and does not go negative so the energy is lost but the base line is now re-defined and when we consume energy &lt; 1Wh there is no problem but when we replace it we are going right to the wire which means there is a good chance that we could cross the base line and therefore effectively store insufficient energy to cover our next extraction pulse.</p>
<p>So far?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10425"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2867" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="9fingers&#039;s picture" title="9fingers&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2867" title="View user profile.">9fingers</a> on Mon, 11/03/2013 - 21:56.</div>
    <div class="content">
     <p>I&#39;ve yet to build a PV&nbsp; router but just spotted this issue with an AMPY meter. My meter is an Ampy 5193A. Does anyone know if this model behaves like the similarly numbered model 5196A that Brian has?</p>
<p>Bob</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10427"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Mon, 11/03/2013 - 22:42.</div>
    <div class="content">
     <p>When energy flows backwards through the meter beyond the point where it can be recovered without penalty, the meter and router are likely to slip relative to each other.&nbsp;</p>
<p>Robert and I have had various discussions about the best way to show by means of a diagram what&#39;s going on.&nbsp; One way of explaining the meter&#39;s behaviour is that the point where the next charge pulse will appear slips closer (it&#39;s always 3600 J above the point where non-recoverable export ceases, i.e. less than 3600 J after the previous one).&nbsp; Another way is to regard the meter as simply &#39;losing&#39; this non-recoverable energy so that the meter sits precisely at its 0 J point until consumption re-starts.&nbsp; This latter approach is as depicted in the Building Blocks piece.</p>
<p>The lines you&#39;ve drawn suggest that you&#39;re thinking along to similar lines to the first explanation.&nbsp; Both are equivalent.&nbsp; Until both systems are synchronised by using meter pulses (and on-off transitions), some energy is bound to be lost at the start of most periods of surplus power.&nbsp; Especially when in A/F mode.&nbsp;</p>
<p>But we&#39;re no doubt only talking pico pence!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10428"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Mon, 11/03/2013 - 23:58.</div>
    <div class="content">
     <p><a href="http://openenergymonitor.org/emon/user/2867" title="View user profile.">9fingers</a></p>
<p>Let me know when you find out and if it is, I&#39;ll add that meter to the list of exceptions. Even though the meter constant is 1000 pulses per kWh, as we&#39;ve seen the meter constant is not a reliable indication. The 5196 &#39;packet&#39; was 1 pulse/3.6, so maybe yours is 1000 J ?&nbsp; I think we won&#39;t know until somebody checks one.</p>
<p>This is all I can find about it:</p>
<p class="rteindent1">Operational Requirements<br />
	Measurement<br />
	The Meter is a 220 Vac - 240 Vac 50Hz 15/20 - 100 Amp Single Phase Credit Meter. It contains an independent measuring element allowing consumed energy to be measured. The meter measures and registers kWh to class 1.0. There is a red LED mounted on the front panel of the meter pulsing at a rate of 1 000 pulses per kWh for energy registration.<br />
	Total kWh Register<br />
	The total kWhs measured are stored internally to 3 decimal places. The total kWhs are displayed on the meter to a maximum of 2 decimal places unless programmed via the Flag Port (see User Interfaces) to 3 decimal places for testing purposes. The Total kWh register range is 00000.000 - 99999.999 kWh<br />
	Reverse Energy<br />
	Reverse Energy is detected if export energy greater than the meters starting threshold is measured. If reverse energy is detected the display alternates between a Reverse Energy Detected message and the default display.<br />
	Reverse Energy Register<br />
	The reverse kWhs consumed by the meter are stored internally to 3 decimal places but only displayed to a maximum of 2 decimal places. The Reverse kWh register range is 00000.000 - 99999.999 kWh<br />
	Meter Memory<br />
	All the meter&#39;s data is recorded in a Ferroelectric Random Access Memory (FRAM) under the control of the microprocessor. All the kWh registers are stored in the FRAM and are updated every 1/100 th of a kWh. The FRAM is guaranteed for a minimum of 10 000 000 000 write cycles.<br />
	Anticreep<br />
	Below starting current the meter enters into an anticreep mode. In this state the meter registration LED is permanently lit and the registers do not increment. The Led remains lit until the meter current is increased in either the forward or reverse direction beyond the starting current.<br />
	Temperature Range Limit<br />
	range of operation : -20 C to 55 C<br />
	Storage range* : -25 C to 70 C This complies with IEC 1036 : section 4.3.1.<br />
	* Maximum period of 6 hours at the extremes of this temperature range.<br />
	Power Supply Rated Voltage : 220 - 240 Vac (230 Vac Nominal)<br />
	Operating Voltage Range : +15% to -20%<br />
	Influence of Supply Voltage<br />
	The meter complies with IEC1036: Section 4.4.2.<br />
	Operation over the voltage range complies with IEC 1036: Section 4.4.2.1. with permissible error as given in IEC 1036 Table 14. For voltage dips and short interruptions the meter complies with IEC 1036: section 4.4.2.2 and is tested according to IEC 1036: Section 5.4.2.1.<br />
	Current Range: 15/20 to 100 Amps<br />
	Frequency: 50Hz<br />
	Power Burden: Less than 2<br />
	&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10430"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Tue, 12/03/2013 - 07:59.</div>
    <div class="content">
     <p><em>markcarter10:</em></p>
<p><em>So i concur with Tinbum that the Actaris Ace1000 meter has a much smaller energy bucket than most other meters<br />
	the settings that I used in the sketch are:<br />
	#define JOULES_PER_WATT_HOUR 1250</em></p>
<p><em>...</em></p>
<p>In my Mk2i_rev4 code, this definition is only used in one place, to define the energy bucket&#39;s capacity.&nbsp; It may be helpful to change the name too, so as to avoid any confusion later.&nbsp; How about:</p>
<p><em>#define ENERGY_BUCKET_SIZE_JOULES 1250</em></p>
<p>
	&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10431"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Tue, 12/03/2013 - 08:06.</div>
    <div class="content">
     <p><em>Brian D: So, a few questions.</em></p>
<p><em>1. Is there a power threshold that must be exceeded before the meters internal counter begins to decrement?</em></p>
<p><em>calypso_rae: No, it will decrement immediately.</em></p>
<p>Sorry, Brian, seems I was wrong on that one.&nbsp; From the spec that Robert has just posted, it appears that meters don&#39;t register reverse current until the starting threshold has been exceeded.&nbsp; However, while a router is actively diverting surplus power, energy flow is likely to be considerably above any starting threshold as the dump load cycles on and off.</p>
<p>Robin</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10432"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1163" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1163.gif" alt="markcarter10&#039;s picture" title="markcarter10&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1163" title="View user profile.">markcarter10</a> on Tue, 12/03/2013 - 08:57.</div>
    <div class="content">
     <p><em>In my Mk2i_rev4 code, this definition is only used in one place, to define the energy bucket&#39;s capacity.&nbsp; It may be helpful to change the name too, so as to avoid any confusion later.&nbsp; How about:</p>
<p>	#define ENERGY_BUCKET_SIZE_JOULES 1250</em></p>
<p>&nbsp;</p>
<p>Sounds reasonable and yes clearer</p>
<p>&nbsp;</p>
<p>Mark</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10434"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1775" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1775.jpg" alt="Brian D&#039;s picture" title="Brian D&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1775" title="View user profile.">Brian D</a> on Tue, 12/03/2013 - 09:36.</div>
    <div class="content">
     <p>If the diagram that I posted above is correct then in that example energy diverting is not occurring in the middle of the meters &#39;sweet zone&#39; but is running very close to the lower limit.</p>
<p>	This could be improved by introducing a sensor to monitor the meter LED and synchronise on charge pulses.</p>
<p>Alternatively, when the software recognises that exporting has started again it should allow the first burst to exceed the energy packet capacity of the meter thereby ensuring the internal counters are zero and then extract slightly more than the standard amount to ensure that operation is once more in the middle of the &#39;sweet zone&#39;.</p>
<p>	A second diagram is attached showing the effect of what I am proposing.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10436"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Tue, 12/03/2013 - 10:23.</div>
    <div class="content">
     <p>Power diversion doesn&#39;t have to happen right in the centre of the meter&#39;s &#39;sweet zone&#39;.&nbsp;</p>
<p>One end of the zone is friendlier that the other.&nbsp; The further away from the scorpion&#39;s end the better, IMHO!</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10442"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 12/03/2013 - 13:12.</div>
    <div class="content">
     <p><em>it appears that meters don&#39;t register reverse current until the starting threshold has been exceeded.&nbsp;</em></p>
<p>should read:</p>
<p><em>meters don&#39;t register ANY current until the starting threshold has been exceeded.</em></p>
<p>Though when you equate the starting current to power, they don&#39;t give much away! - maybe 1 CFL, and a little one at that.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10443"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2867" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="9fingers&#039;s picture" title="9fingers&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2867" title="View user profile.">9fingers</a> on Tue, 12/03/2013 - 13:20.</div>
    <div class="content">
     <p>Thanks for the spec details Robert.</p>
<p>I think some of the features are dependent on the programming by the installer.</p>
<p>For example my meter alternates between Red (reverse energy detected) and the imported total power. It never displays the exported power. Also the led stays on continuously during export.</p>
<p>I suspect that their statement &quot;Below starting current the meter enters into an anticreep mode. In this state the meter registration LED is permanently lit and the registers do not increment. The Led remains lit until the meter current is increased in either the forward or reverse direction beyond the starting current.&quot;</p>
<p>will hold true if the meter were programmed to display export.</p>
<p>I&#39;ve got a few other jobs on the go at the moment - specifying, ordering and starting the install of my Solar Thermal system - but the PV router is lurking in the background and I must assemble the hardware when I get an idle moment.</p>
<p>I&#39;m guessing this will be the only way I can investigate the energy bucket size or is there another way given that I can&#39;t interfere with this meter.</p>
<p>&nbsp;</p>
<p>Bob</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10447"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Tue, 12/03/2013 - 16:31.</div>
    <div class="content">
     <p><em>I&#39;m guessing this will be the only way I can investigate the energy bucket size or is there another way given that I can&#39;t interfere with this meter.</em></p>
<p>The way to quantify the &quot;sweet zone&quot; of a meter is to determine the maximum amount of energy that can flow in the reverse direction before the LED comes on.&nbsp; This will occur when reverse flow starts just before the next consumption pulse is due.</p>
<p>The fact that the meter is permanently connected to the incoming supply mains does present a bit of a challenge, but it&#39;s not unsurmountable.&nbsp; Here&#39;s how I would go about it:</p>
<p>1)&nbsp; Construct some kind of measurement system with which can measure the flow of energy, and then calibrate this system using something that you can trust.&nbsp; A 3kW kettle maybe.&nbsp;&nbsp; With its built-in calibration routine, my Mk2i_rev4 PV Router sketch would be fine for this.&nbsp; It can run on an Arduino on an emonTx, and just needs a pair of input sensors.&nbsp;</p>
<p>1a)&nbsp; Even better would be to rig up a sensor which can record each meter pulse.&nbsp; The schematic and supporting code is already included in the above sketch.&nbsp; You could then calibrate your system with ease by adjusting it to it record exactly 3600 Joules per meter pulse.</p>
<p>2)&nbsp; Fit your calibrated system to your supply point, adjacent to the meter, and get it to display the energy level in your bucket repeatedly.&nbsp; For this purpose, you could usefully use the variable&nbsp; <strong>energyInBucket_4led_long</strong>&nbsp; which has no upper or lower limits.</p>
<p>3) While surplus power is available, find a combination of loads such that there is only a small amount of residual export.&nbsp; Then turn on a Big Load so that consumption resumes.</p>
<p>4) Just before the next consumption pulse is due, turn off the Big Load and note the bucket&#39;s level.&nbsp; Then record the level when the meter&#39;s LED goes on.&nbsp; The difference between these two readings is the &quot;sweet zone&quot; of your meter.</p>
<p>An approximate result could be obtained using a proprietary clip-on meter.&nbsp; Just measure the amount of reverse current and the maximum time for which it can flow before the LED comes on.<br />
	&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10451"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2867" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="9fingers&#039;s picture" title="9fingers&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2867" title="View user profile.">9fingers</a> on Tue, 12/03/2013 - 21:45.</div>
    <div class="content">
     <p>Thanks Robin.</p>
<p>I saw a pretty similar meter on ebay today but the model number was different so I did not think it would help.</p>
<p>I&#39;ll try and get some hardware up &amp; running asap and give your suggestions a try.</p>
<p>Bob</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10467"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3410" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-3410.jpg" alt="DickieW&#039;s picture" title="DickieW&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3410" title="View user profile.">DickieW</a> on Thu, 14/03/2013 - 13:31.</div>
    <div class="content">
     <p>Hi All, built the MK2 october-ish last year, all I can say is thank you very much Robin for the diagrams and program data, and to all&nbsp; the rest of you educated guys with your contributions in making this such a success. Anyhow&nbsp; enough praise, I have just joined so yet another that&#39;s no longer &quot;Lurking&quot;.<br />
	Up until a few days ago my unit was switching surplus energy to the cheap Argos convector. I have just finished installing a 175ltr presurised direct tank in the&nbsp; loft. The challenge was to feed cold water mains to the presurised tank, this (weather dependent) being the primary hot water supply for the house. When the solar heated water has depleted the top thermostat closes and operates a 3 port valve that will then divert the mains pressure cold water to my combi boiler also in the loft. Once sufficient solar hot water is acheived in the pressurised vessel the top thermostat will open thereby causing the 3 port valve to divert cold water pressure back to the vessel.&nbsp; The hot water output from the combi boiler and vessel are common. Just fine tuning the stats over the next couple of days, but early experience&nbsp; shows it working as designed. Had a lovely shower this morning on yesterdays sunshine. Nice having free hot water. Thanks again Robin and team.&nbsp; I have posted a couple of pics and video of the install if any one is interested at dickiewelham.dyndns.org:80/public/ .</p>
<p>I&#39;m really interested in a&nbsp; secondary output that I believe was mentioned earlier in the forum, the Idea being that when the bucket still indicates surplus with the first output&nbsp; full on then the secondary would start switching the surplus i.e. 3kw PV generated energy could supply a 2kw load on the first full on output whilst switching the remaining 1kw to another load. Also when the Emersion stat opens all the suplus would be available on the Second output, hope this makes sense.&nbsp; I have not got a clue on programming (Bob Hope/No Hope) so wondered what config I would need to add to the original sketch to fire a second output to a second MOC/Triac, Can anyone help?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10468"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Thu, 14/03/2013 - 14:14.</div>
    <div class="content">
     <p>Hi Dickie,&nbsp; I&#39;m delighted to hear that another Mk2 build is providing good service.&nbsp; Wow, that&#39;s some heatsink!</p>
<p>Within the next few days, I&#39;m intending to post a revised version of my Mk2i sketch which will support a remote load via an RF link.&nbsp; If everything goes to plan, the priority of the remote load will be switchable.&nbsp; When selected as the higher priority, a surplusPV-powered kettle would then temporarily divert power away from heating the DWH.&nbsp;&nbsp; In my case, I&#39;m intending that the DHW will generally be top priority, with the remote dump only becoming live when the tank is fully up to temperature.&nbsp; Not sure yet what the remote capability will be used for, a small storage heater maybe, or just a simple heater for drying clothes over (if I can&#39;t be bothered to peg them outside!).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10473"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3410" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-3410.jpg" alt="DickieW&#039;s picture" title="DickieW&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3410" title="View user profile.">DickieW</a> on Fri, 15/03/2013 - 08:39.</div>
    <div class="content">
     <p>Thanks Robin, Looking forward to seeing how this will work, I&#39;m doing extension work at the moment so I have run in a 2.5 mm cable for a Kitchen and Hall&nbsp; PV Socket back to the Mk2 Box in my harry potter cupboard. This&nbsp;also houses the Meter and Consumer unit, so&nbsp;I will&nbsp; able to mount&nbsp;the second Triac on the monster Heat Sink without the need for RF LOL! However really&nbsp;Interested to see the&nbsp;RF setup, great idea.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10476"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Fri, 15/03/2013 - 10:48.</div>
    <div class="content">
     <p>While developing the code to support a remote load via an RF link, I&#39;ve stumbled across an anomaly which has been present right from Day 1 of the Mk2 code.&nbsp;</p>
<p>There has always been a start-up period to allow the LP filter to settle.&nbsp; This is the filter which allows voltage samples to be grouped into separate mains cycles.&nbsp; Until this start-up period has expired, the energy bucket is not updated.&nbsp; The power-routing logic, however, has always been operational right from the start.&nbsp; With the benefit of hindsight, this makes little sense.&nbsp; It would be far better for everything to be disabled until after the LPF has settled.</p>
<p>An easy way to fix this bug is to move the LPF logic into the negative half of the cycle which previously had nothing to do.&nbsp; All of the processing which is specific to positive samples can then be disabled until the start-up period has expired.&nbsp; The start-up period now needs to be defined using millis(), rather than cycleCount.</p>
<p>This fix will appear in Mk2i_rev5 in due course.&nbsp; I&#39;ve also updated Mk2_PV_Router_mini in the same way, as attached.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10531"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2867" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="9fingers&#039;s picture" title="9fingers&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2867" title="View user profile.">9fingers</a> on Mon, 18/03/2013 - 20:10.</div>
    <div class="content">
     <p>I&#39;ve just started building the hardware for the PV router, mainly at this stage to investigate the energy bucket on my Ampy meter.</p>
<p>&nbsp;</p>
<p>All going well so far and I&#39;ve been testing the CT ratio- burden resistor and adjusting the voltage input to get the recommended 800 ish ADC steps using Robin&#39;s <strong>MinAndMaxValues </strong>sketch.<strong> </strong></p>
<p>I&#39;ve noticed that with no AC input for either current or voltage, the ADC uncertainty is about 6 to 8 counts.</p>
<p>I immediately suspected my half rail bias supply. I&#39;d already decoupled the +ve input to the op amp buffer so tried some filtering on the output bias line which made no difference.</p>
<p>I have completely removed the problem (if indeed there was a problem) by fitting&nbsp; 2200pf capacitors from Ain1 and Ain2 to 0v</p>
<p>With no ac input, the ADC values equal the min and max values at 509 (ideal 512) for minutes at a time and the total excursion of values is unaffected as far as I can see.</p>
<p>The impedance of the 2200pF is quite high at 50Hz (1.5Mohms) but is clearly removing higher frequency components.</p>
<p>I don&#39;t know if others have noticed this ADC noise?</p>
<p>Bob</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10533"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Mon, 18/03/2013 - 21:49.</div>
    <div class="content">
     <p>When you&#39;ve got a working pair of voltage &amp; current sensors, you could try running my Mk2i PV Router code, I suggest revision 4.&nbsp; A 10-second &quot;Tallymode&quot; run will show you a signature of the energy content of individual mains cycles so you&#39;ll be able to see how much spread you&#39;re getting.&nbsp; By monitoring a known rate of energy flow (aka power), you should immediately able to assess the calibration state of your system.&nbsp; If it&#39;s reading 50% low, then just double your value of powerCal.&nbsp;</p>
<p>The same sketch supports a &#39;surplus PV&#39; LED, as does the rev_5 version that I posted today.&nbsp; When there&#39;s no current flowing, that LED rattles merrily on and off because each cycle&#39;s energy content is either slightly above zero or slightly below.&nbsp; But when I fire up a 60W bulb, the LED goes firmly on.&nbsp; This tells me that the amount of dither/noise is not great.</p>
<p>My Mk2a PV Router code also supports Tallymode, but the results are not displayed in Watts so it&#39;s less user-friendly.</p>
<p>PS.&nbsp; If anyone&#39;s not found the <a href="http://openenergymonitor.org/emon/node/1912">Mk2i</a> thread, it&#39;s probably worth a look.&nbsp; That version now supports multiple loads including a remote load via an RF link, and switchable priorities with anti-flicker.&nbsp; And all running super fast on J&ouml;rg&#39;s interrupt-based core.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10541"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2867" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="9fingers&#039;s picture" title="9fingers&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2867" title="View user profile.">9fingers</a> on Tue, 19/03/2013 - 19:09.</div>
    <div class="content">
     <p>Should I be checking phasecal before taking the TALLYMODE checks?</p>
<p>&nbsp;</p>
<p>TIA</p>
<p>&nbsp;</p>
<p>Bob</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10560"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Wed, 20/03/2013 - 21:17.</div>
    <div class="content">
     <p>When measuring real power, phasecal makes so little difference I just leave it at 1.0 and forget about it. &nbsp;</p>
<p>There&#39;s a video showing how insensitive this setting is at&nbsp;&nbsp; <a href="http://www.youtube.com/watch?v=v8ifoUJvcXY%C2%A0" title="http://www.youtube.com/watch?v=v8ifoUJvcXY&nbsp;">http://www.youtube.com/watch?v=v8ifoUJvcXY&nbsp;</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10563"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2867" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="9fingers&#039;s picture" title="9fingers&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2867" title="View user profile.">9fingers</a> on Wed, 20/03/2013 - 22:16.</div>
    <div class="content">
     <p>Thanks Robin.</p>
<p>&nbsp;</p>
<p>Good progress today. I progressed through Phasecal, (where i agree it makes little difference) to Tallymode and then onto my test rig with a variac to represent the Solar input and dumping into a 2kW convector. I had the workshop floo-tubes flickering nicely and then flipped into Antiflicker mode and they stopped flicking. Brilliant</p>
<p>Superb documentation made everything very easy - excellent job!</p>
<p>I now need to tidy up my hardware before moving into the garage and to try and characterise my import meter over the next few days.</p>
<p>&nbsp;</p>
<p>Bob</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10608"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2867" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="9fingers&#039;s picture" title="9fingers&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2867" title="View user profile.">9fingers</a> on Sun, 24/03/2013 - 15:14.</div>
    <div class="content">
     <p>I think I now have some reliable results of the size of the energy bucket in the AMPY 5193A (year 2000 vintage)</p>
<p>&nbsp;</p>
<p>I used the method suggested by Robin earlier which i&#39;ve repeated below in italics</p>
<p>&nbsp;</p>
<p><em>The way to quantify the &quot;sweet zone&quot; of a meter is to determine the maximum amount of energy that can flow in the reverse direction before the LED comes on.&nbsp; This will occur when reverse flow starts just before the next consumption pulse is due.</em></p>
<p><em>The fact that the meter is permanently connected to the incoming supply mains does present a bit of a challenge, but it&#39;s not unsurmountable.&nbsp; Here&#39;s how I would go about it:</em></p>
<p><em>1)&nbsp; Construct some kind of measurement system with which can measure the flow of energy, and then calibrate this system using something that you can trust.&nbsp; A 3kW kettle maybe.&nbsp;&nbsp; With its built-in calibration routine, my Mk2i_rev4 PV Router sketch would be fine for this.&nbsp; It can run on an Arduino on an emonTx, and just needs a pair of input sensors.&nbsp;</em></p>
<p><em>1a)&nbsp; Even better would be to rig up a sensor which can record each meter pulse.&nbsp; The schematic and supporting code is already included in the above sketch.&nbsp; You could then calibrate your system with ease by adjusting it to it record exactly 3600 Joules per meter pulse.</em></p>
<p><em>2)&nbsp; Fit your calibrated system to your supply point, adjacent to the meter, and get it to display the energy level in your bucket repeatedly.&nbsp; For this purpose, you could usefully use the variable&nbsp; <strong>energyInBucket_4led_long</strong>&nbsp; which has no upper or lower limits.</em></p>
<p><em>3) While surplus power is available, find a combination of loads such that there is only a small amount of residual export.&nbsp; Then turn on a Big Load so that consumption resumes.</em></p>
<p><em>4) Just before the next consumption pulse is due, turn off the Big Load and note the bucket&#39;s level.&nbsp; Then record the level when the meter&#39;s LED goes on.&nbsp; The difference between these two readings is the &quot;sweet zone&quot; of your meter.</em></p>
<p>&nbsp;</p>
<p>I&#39;ve a test rig that incorporates a Landis &amp; Gyr E110 type 5235B year 2011 .</p>
<p>I have a variable transformer injecting current as the &#39;solar PV&#39; source and a 2kW convector as the load.</p>
<p>I&#39;ve added a little code to ver4 that prints out every 10th value of energyInBucket_4led_long - simply to make it easier to read.</p>
<p>My calibration factor is 0.044 which makes a 3600J bucket equal to 4090909 internally.</p>
<p>Running Robin&#39;s method on my 5235B meter I got an average bucket size of 4000000 which is very close to 4090909 suggesting that my test meter does indeed have a 3600J bucket.</p>
<p>&nbsp;</p>
<p>Switching to my house meter Ampy 5193A , I took about 20 readings. These proved more difficult to do with domestic loads switching on and off. I turned off everything I could think of.</p>
<p>Having rejected the less credible results, I was left with 10 reasonable ones which averaged to 3.36 x10^6</p>
<p>Calculation suggests&nbsp; the Ampy meter has a bucket of 2956J&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (3600 x 3.36 x10^6/4.090909 x10^6)</p>
<p>This is probably 3000J in practise</p>
<p>This is not much difference to the common bucket size of 3600J and looking at the internal thresholds in Robin&#39;s code,</p>
<p>the upper and lower bucket&nbsp; thresholds are set to 60% and 30% of the bucket volume.</p>
<p>My conclusion is that I will proceed with my installation using the standard bucket size for now but will keep an eye on performance and if needed try modifying the bucket to 3000J.</p>
<p>&nbsp;</p>
<p>Thanks to Robin for suggesting the method.</p>
<p>&nbsp;</p>
<p>Bob</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10614"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sun, 24/03/2013 - 18:39.</div>
    <div class="content">
     <p>Having calibrated your system using Mk2i_rev4, it may be easier to work with a version of the code where everything is done using FP maths.&nbsp; Mk2_PV_Router_mini_2, which conveniently displays the results of its &#39;no-limits&#39; bucket every second, might be a good choice.&nbsp;</p>
<p>Regardless of the underlying maths format, all Mk2 versions should give similar results.&nbsp; If they don&#39;t, please send me a PM!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10941"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="GTEC&#039;s picture" title="GTEC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by GTEC (not verified) on Fri, 05/04/2013 - 23:10.</div>
    <div class="content">
     <p>Teething Problems</p>
<p>Hi all, brand new to this so please treat me gently :)</p>
<p>I have built a router with Rich&#39;s PCB&#39;s and an Ardunio&nbsp;Leaonardo.</p>
<p>All wired up and tested out (continuity) across all soldered joints but i just cant get the router to function properly!</p>
<p>I should add that i know nothing about sketches but i am keen to learn but i think that it may be something hardware related that is stopping the router from working</p>
<p>all of the following completed in the hours of darkness!</p>
<p>I originally uploaded Rev 4 but with no avail (no output at all) - so i decided to revert to Rev 2 and bingo, output at full whack (i have a low res clamp-meter so could monitor the output on the immersion conductor) thinking that all i need to&nbsp;do now is swap the CT clamp orientation that is what i did, sadly at that point the output was still running at full whack when i would have expected it to drop off?</p>
<p>I am using the SCT 013 000 CT and when clamped around a conductor using 9A i get 3V straight from the CT &quot;tails&quot; - this translates into 0.275v after the 150 ohm burden resistor on the board</p>
<p>I was recommended to try the &quot;Min and maxvalues&quot; sketch, which i did but got the following&nbsp;</p>
<p>1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	629&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	0&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023<br />
	1023&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp; 1023</p>
<p>&nbsp;</p>
<p>However hard i try i don&#39;t really understand what these figures represent so don&#39;t know if they are good or bad (but i suspect bad)</p>
<p>Any assistance greatly received and thank you in advance :)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10942"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sat, 06/04/2013 - 00:06.</div>
    <div class="content">
     <p>Those values are indeed bad - big time!</p>
<p>If you look at the sketch, around line 16, the output you see is a result of the &quot;Serial.print(.....)&quot; statements.</p>
<p>&nbsp; Serial.print(val);&nbsp; Serial.print(&quot;&nbsp;&nbsp;&nbsp;&nbsp; &quot;);<br />
	&nbsp; Serial.print(minVal); Serial.print(&quot;&nbsp; &quot;);<br />
	&nbsp; Serial.println(maxVal);</p>
<p>Making a few intelligent guesses (often necessary with programming!) you can deduce that the first number is the <strong>val</strong>ue read on that excursion around the loop, the next is the <strong>min</strong>imum <strong>val</strong>ue and the last the <strong>max</strong>imum <strong>val</strong>ue since the sketch started.</p>
<p>You have a serious problem with your analogue input. It is flipping between 0 and 1023 (full scale) with only one value somewhere in between. The input voltage is swinging far too much.&nbsp;</p>
<p>Which input are you looking at? At line 9 in the sketch, it says (as downloaded) you are reading the voltage input - if you&#39;ve built it according to Robin&#39;s diagram. That means you have some wrong resistors between your ac-ac adapter or transformer and the analogue input. Are the 150 k and 15 k in the correct positions? - my best guess is they are swapped around. The voltage at the analogue input should be not more than about 1.5 v a.c. and it should &#39;sit&#39; at 2.5 V d.c - half way between ground and the 5 V supply.</p>
<p>So the minmax sketch should report the min around 100 and the max around 900 - give or take depending on your mains voltage for the voltage input.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10945"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sat, 06/04/2013 - 07:35.</div>
    <div class="content">
     <p>Yes, as Robert says, there appears to be a serious problem with your input sensors. They need to be generating suitably sized sine waves, otherwise nothing else will be work as intended.</p>
<p>Sample output files were posted along with my minAndMaxValues and RawSamplesTool sketches.&nbsp; You need to get your rig to do likewise.</p>
<p>If you spend a bit of time looking at these sketches, I&#39;m sure you should be able to see what&#39;s going on.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10955"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="GTEC&#039;s picture" title="GTEC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by GTEC (not verified) on Sat, 06/04/2013 - 13:59.</div>
    <div class="content">
     <p>Hi Both, thank you for your time and assistance</p>
<p>Ok, so i cant read - or at least tell the difference between a 150K and a 150 ohm resistor (Doh)</p>
<p>These are now swapped around and i have an output of around 1v on AN2 input and 2.5v on AN1&nbsp;as you have said that I should - so I&#39;m making progress (debatable I know)</p>
<p>Robin, I&#39;ve looked for the sample outputs but cant find them i am afraid would you be so kind as to post the link?</p>
<p>Currently (no pun intented) I am seeing</p>
<p>AN1 - CT - min = 385 and max = 641</p>
<p>AN2 - V - min 211 and max 803</p>
<p>Look at that I managed to change the monitored pin (ok but i think that is making progress&nbsp;:))</p>
<p>So following that i confidentially uploaded Rev2 of the router sketch and the Triac doesn&#39;t come on permanently as it did before, but now it isn&#39;t coming on at all, even if I swap the CT orientation around</p>
<p>Any ideas what i should&nbsp;look at next please?</p>
<p>cheers</p>
<p>Griff</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10960"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sat, 06/04/2013 - 15:23.</div>
    <div class="content">
     <p>The index to all of Robin&#39;s work is <a href="http://openenergymonitor.org/emon/node/1757" title="http://openenergymonitor.org/emon/node/1757">http://openenergymonitor.org/emon/node/1757</a> There&#39;s a picture in the RawSamplesTool post.</p>
<p>The current you read (385 - 641) was with 9 A load? That&#39;s exactly a quarter of full scale (coincidentally).</p>
<p>OK, it looks as if you have workable values for the inputs, you&#39;ve proved the triac can come on so the output is OK, so it looks as if the hardware side is probably working.</p>
<p>Just to be clear, you are using Mk2a_PV_Router_rev2.ino? Have you read all the comments at the beginning of the sketch and set powerCal and voltageCal?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10963"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="GTEC&#039;s picture" title="GTEC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by GTEC (not verified) on Sat, 13/04/2013 - 12:33.</div>
    <div class="content">
     <p>Hi Robert</p>
<p>Yes I&#39;ve read the introduction and calibration section and deduced that as my range is around 600 + 100 either way = 800 so the default looks OK for Voltage Cal and I&#39;ve left the other two at default</p>
<p>The result is listed below and is the result of the sample from &quot;raw samples&quot; - so I think all should be OK, although theres room for improvement&nbsp;</p>
<p>I&#39;m&nbsp;attempting (on Robins suggestion) to use Mk2i - Rev 2 to start with but im not precious if you think there is a different&nbsp;version&nbsp;that may be more suitable to start with?</p>
<p>Many thanks</p>
<p>Griff</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10964"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="GTEC&#039;s picture" title="GTEC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by GTEC (not verified) on Sat, 13/04/2013 - 12:38.</div>
    <div class="content">
     <p>with CT in different orientation and a load of 3.4A</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10966"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="GTEC&#039;s picture" title="GTEC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by GTEC (not verified) on Sat, 13/04/2013 - 12:36.</div>
    <div class="content">
     <p>And with a 16.4A load the data in the attached PDF is shown</p>
<p>Does this mean i need to recal my CT for lower Current measurements?</p>
<p>cheers</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10969"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sat, 06/04/2013 - 20:57.</div>
    <div class="content">
     <p>I&#39;ve got a pretty good idea how Robin&#39;s software and hardware works, but clearly my knowledge is not as detailed as his. Those waveforms look OK to me, but is it still not working? I presume you have carefully checked the mains wiring.</p>
<p>Have you got a LED and a series resistor on pin 13 of the Arduino output - and does the LED flash?&nbsp; That pin is driven at the same time as the triac trigger.</p>
<p>I don&#39;t know off the top of my head the phase relationship the controller expects, so unless that is the problem (simply cured by reversing the c.t.), then we&#39;ll have to wait for Robin to help.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10971"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sat, 06/04/2013 - 22:35.</div>
    <div class="content">
     <p>Hi, what exactly is the problem?&nbsp; Those waveforms look reasonable to me.&nbsp;</p>
<p>I&#39;m intrigued by the peak in the current waveform at the mid-point of each mains half-cycle, when the voltage tends to droop.&nbsp; This seems to be the behaviour of most PV inverters, but I presume you weren&#39;t measuring your inverter&#39;s output at the time.</p>
<p>I you think everything&#39;s set up OK, why not try a Tallymode run with, say, Mk2i_rev4.&nbsp; This should show you exactly what&#39;s going on.&nbsp; Start with no currents anywhere, and you should get a small distribution of energy values around the 0W point.&nbsp;</p>
<p>Then measure a small load around 100W, and your tally values should reflect this.&nbsp; Simulated PV needs to return +ve power values which will make the levcel in the energy bucket increase.&nbsp; Then, when it reaches 1800J (in normal mode), the triac should turn on and cause your dump load to draw power.&nbsp; This will be seen as a small peak in the -ve part of your tallies, assuming that you&#39;ve set the end values appropriately.</p>
<p>Rather than take up lots of thread space, results files can be attached to forum postings very easily.&nbsp; Paste the contents of the Serial Monitor window to a .txt file (using Notepad or similar), then attach it to your post using the &quot;File Attachments&quot; link just below the window that you type in.&nbsp; Having attached the file, you then need to &#39;tick&#39; the &quot;List&quot; box.&nbsp; If you forget to do this, the file won&#39;t be visible to others.&nbsp; No problem we&#39;ve all done it.&nbsp; Just &quot;edit&quot; the message, and tick the box.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10979"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sun, 07/04/2013 - 16:51.</div>
    <div class="content">
     <p><a href="http://openenergymonitor.org/emon/user/1165" title="View user profile.">richmc</a> has pointed out that you appear to be using the Arduino Leonardo rather than the Uno. I have no knowledge of those units, but if that is indeed the case, have you checked that you are using the correct output pin to drive the opto-trigger? (If you change the hardware to something different, you always need to check compatibility - and adapt the design, hardware or software or both, accordingly).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-11197"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="GTEC&#039;s picture" title="GTEC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by GTEC (not verified) on Sat, 13/04/2013 - 12:51.</div>
    <div class="content">
     <p>Hi Robert et all</p>
<p>FYI - i have tidied up my posts, apologies for getting carried away with those!</p>
<p>I have checked in so far as i can that leonardo pins are the same via the Ardunio site&nbsp;</p>
<p>I have now loaded up Mk2i_rev4 and still no success, but now strugling to run the&nbsp;Tallymode - i think due to the difference in the way in which it handles serial&nbsp;statements -&nbsp;</p>
<p>im going to now post on the relevant string and thank you in advance for any further assistance that you can give me</p>
<p>cheers</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-11220"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sat, 13/04/2013 - 17:05.</div>
    <div class="content">
     <p>The thing that&#39;s different about Tallymode is that the user is required to supply some informatiuon during the setup phase.&nbsp;&nbsp; If the serial display doesn&#39;t work right from the word go, that can be a problem.</p>
<p>The first question is &quot;For how many seconds should the test run?&quot;&nbsp; So if you just type in, say, &#39;3&#39; &#39;0&#39; &#39;c/r&#39; (for 30 seconds), you can then continue with the rest of the sequence.&nbsp; This problem does not occur with an Arduino Uno, but does seem to do so when programming an emonTx via the necessary USB-to-UART adapter + cable.</p>
<p>This topic has now moved to the <a href="http://openenergymonitor.org/emon/node/1912?page=1">Mk2i PV Router thread</a> ...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-11648"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="willatpenru&#039;s picture" title="willatpenru&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by willatpenru (not verified) on Sat, 27/04/2013 - 11:41.</div>
    <div class="content">
     <p>The Sunnyboy regulates PV out put to prevent overcharging when the minigrid frequency is at 51hz. Between 50 and 51 is safe in terms of battery over charging. Its just an indicator that the energy in the system is close to being too much to match active loads or battery charging&nbsp;operations. This gives a margin within which a set point could be specified.</p>
<p>I imagine it working something like this. If a frequency greater than 50.5hz is detected , load is added via the triac&nbsp;until the frequency drops to 50.5. &nbsp;If the frequency drops below 50.5 triac load is reduced until the target frequency is reached. &nbsp;That logic seems simple to me. &nbsp;The Sunny Island has done all the hardwork, just need something that can respond to the frequency shift to add or reduce loads to reach the set point of 50.5hz..... Does anyone know of any workshops or events where this stuff could be covered?</p>
<p>I apperciate the suggestions from others about relays controlled by the Sunnyboy&nbsp;or Sunny Island but they are too simplistic for this setup where the amount of power consumed by battery charging is dynamic due to IUoU charge pattern. The SB has a self consumption relay which can be triggered above specified power output, but that output is only reached if there is enough load to allow high production, which wont occour when the the system is throttling down...which is when I want to use the excess!</p>
<p>Robins triac controlled load, balanced by PID seems ideal.</p>
<p>For example: If there was constant 2kw of PV available for 5 hours. No load on the house and the SI had just started a bulk charge phase, all 2kw&nbsp;would be utilised in charging&nbsp;initially, but as the batteries filled, the amount of current required drops off. The SI will increase the grid fequency incrementally to reduce the SB output until the battery is full at which point the minigrid fequency&nbsp;will be 52hz and the PV output 0. &nbsp;With a triac, load can be added incrementally thoughout the charge process to make use of the excess without interfering with the charge cycle. this is a simplified scenario, obviouly it could handle any situation. &nbsp;All it has to do is maintain 50.5hz</p>
<p>I think I must stop obsessing about this as its beyond my capability. &nbsp;But again if anyone comes across any resources or mature projects that are trying to accomplish the same thing let me know. &nbsp;Thanks</p>
<p>Will</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-11650"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sat, 27/04/2013 - 12:01.</div>
    <div class="content">
     <p>Are you off-grid? I assume so as the UK grid tolerance is &plusmn;1%. You might want to look at MartinR&#39;s PLL controller (derived from the Mk2). This locks to, and consequently measures, the frequency so that information would be available to your control algorithm.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-11676"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="willatpenru&#039;s picture" title="willatpenru&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by willatpenru (not verified) on Sun, 28/04/2013 - 13:25.</div>
    <div class="content">
     <p>Yeah, Its an offgrid setup which is why the the Sunny Island is allowed to use Frequency Shift Power Control to regulate SunnBoys&nbsp;on the minigrid.&nbsp;Its pretty smart, if its a sunny day and the system spends hours fully regulating by holding the frequency at 52 hz it will drop the frequency to 48 hz for the same period over night to correct any mains frequency dependent devices such as clocks. &nbsp;Although we dont have anything like that, &nbsp;I like the fact that SMA thought of it! Im chuffed to bits with it.&nbsp;Ive&nbsp;already saved about &pound;1700 in diesel costs and made &pound;1000 in generation payments. (Its the MCS scheme but technically not a Feed In Tarrif payment as Im not on the grid.) Thanks for the link to the PLL&nbsp;library. &nbsp;Honestly, at present, its beyond me. &nbsp;Im hoping I can spark the interest of someone with more brains than me :o)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-11808"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Thu, 02/05/2013 - 18:05.</div>
    <div class="content">
     <p>To check that the output stage of a PV Router is working correctly, there&#39;s no need for the rest of the system to be present.&nbsp; With a series resistor to limit the current to around 15 mA, the opto-isolator can be activated using nothing more than a 9V battery.</p>
<p>A video showing this technique will soon be available <span class="watch-page-link">at: <a href="http://youtu.be/hpClB_5mjRc" target="_blank">http://youtu.be/hpClB_5mjRc</a></span></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12036"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1372" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="noah&#039;s picture" title="noah&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1372" title="View user profile.">noah</a> on Sat, 11/05/2013 - 15:14.</div>
    <div class="content">
     <p>At last after several months out doing unimportant things like earning a crust and falling down stairs I`ve got my 3 phase Mk2 working. Nothing fancy (none of these interrupt based thingies or anti flicker- just the old fashioned steam power Mk2). Using Rich`s boards I`m now diverting about 9kw using one Mk2&nbsp;per phase. Glad to say it worked first time. I put in 3 disc meters (at just a few quid each, cheapest way of monitoring size and direction of current) and its good to see them judder to a halt as soon as you flip the switch.</p>
<p>Just in time for summer!</p>
<p>(mind you my workshop doesnt&nbsp;heat up until about August, and last year not even then)</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12037"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Sat, 11/05/2013 - 15:29.</div>
    <div class="content">
     <p>Depending on your exact setup noah, 3 separate systems might not be the best solution. 3-phase meters have a single &quot;energy bucket&quot; so ideally you want to implement the same thing for diversion. That way you can you can pass PV energy between phases if necessary.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12058"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1372" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="noah&#039;s picture" title="noah&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1372" title="View user profile.">noah</a> on Sun, 12/05/2013 - 09:09.</div>
    <div class="content">
     <p>Martin</p>
<p>I havnt followed (or been able to follow) all the possibilities associated with this topic but certainly being able to somehow offset overuse on one phase with underuse on another would be handy. Is this in fact possible and if so how complex is it to achieve ?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12062"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sun, 12/05/2013 - 11:24.</div>
    <div class="content">
     <p>With a Mk2-type router, the input and output sides are functionally separate.&nbsp; They are only linked by the energy bucket.&nbsp; You have three such  systems at present, one on each phase, all acting independently.</p>
<p>One approach might be to leave the measurement parts of your three existing systems just as they are, but to add an extra control system which would deal with the distribution of surplus power.&nbsp; Each of the three monitor systems would routinely convey the state of its energy bucket to the controller.&nbsp;&nbsp; The controller could then turn on each of the dump-loads as necessary in order to balance the entire system.</p>
<p>A simple way to communicate between these systems could be for each of the monitor systems to continuously output the state of its energy bucket by means of a pseudo-analog signal via (smoothed) PWM.&nbsp; The controller could then routinely poll these signals.&nbsp; By this means there would be no complex comms protocols to worry about.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12063"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Sun, 12/05/2013 - 11:58.</div>
    <div class="content">
     <p>I have it working on <a href="http://openenergymonitor.org/emon/node/1170">my 3-phase system</a> noah, so it&#39;s certainly possible. Since the stacked emonTxs are linked via the I2C bus I can pass the PV&nbsp;energy accumulated during each cycle from the slaves to the master. There is a single energy bucket on the master which sums the energy from all 3 sources. Each emonTx has 2 dump loads controlled via signals from the master.</p>
<p>It should be possible to link Uno boards in the same way using wires.</p>
<p>One complication of having 3 phases is that you have to scale the energy for each phase before adding it to the total as the calibration will be different for each phase.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12071"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1372" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="noah&#039;s picture" title="noah&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1372" title="View user profile.">noah</a> on Sun, 12/05/2013 - 15:25.</div>
    <div class="content">
     <p>If any of you clever gents wants to design something then I`m all for it. I wouldnt know even where to start. I`d certainly be eternally grateful.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12073"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Sun, 12/05/2013 - 18:05.</div>
    <div class="content">
     <p>If you were starting from scratch I&#39;d suggest using emonTxs and cloning my system, but if you are not comfortable with coding then adapting it to work with your hardware will probably be a step too far. It would be difficult for Robin to develop anything either without access to a 3-phase supply.</p>
<p>One problem with the arrangement you have is that you could be charged for power that you think is coming from your generation system (water wheel in your case?) if you are not careful. Imagine a&nbsp;situation where you have 1kW of generation on each of the 3 phases and a 3kW load on phase 1. Your meter will see this as no overall generation or consumption. However, your Mk2s on phases 2 and 3 will each see 1kW of surplus energy and divert this to your dump loads and the meter will see 2kW of import, for which you will be charged.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12075"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sun, 12/05/2013 - 19:24.</div>
    <div class="content">
     <p>I&#39;ve been having the odd thought about this problem and that possible situation had occurred to me too. I don&#39;t see any problem with having a single energy bucket which accepts the combined contributions of the three phases and I think that&#39;s a prerequisite, where I have the problem is deciding how best to share out the dump load when it&#39;s needed. From Noah&#39;s point of view, I think it would be preferable for his generator(s) to loaded as evenly as possible across the 3 phases, and to allow the grid to take up any unbalance. I think that implies that the algorithm needs share the dump load so that that is achieved. What I&#39;ve no idea about is whether firing the three triacs the same amount of time (either in parallel or maybe in sequence) would be enough to be reasonably certain that this would happen - it depends on the generator fault level in relation to the supply fault level amongst many other things. And it gets even more interesting when one phase (or two) of dump load becomes unavailable.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12081"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1165" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="richmc&#039;s picture" title="richmc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1165" title="View user profile.">richmc</a> on Sun, 12/05/2013 - 19:58.</div>
    <div class="content">
     <p>Contrary to my post saying I wouldn&#39;t be able to supply the triac boards on their own I will now be able to supply kits for the O/P board with all components for &pound;15 plus &pound;1 P&amp;P, please PM me if interested.</p>
<p>Rich.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12083"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sun, 12/05/2013 - 22:32.</div>
    <div class="content">
     <p>Two closing points for today:</p>
<p>1.&nbsp; I agree with Robert and Martin that there should only be one energy bucket.&nbsp; As the level in this bucket rises, the state of your dump load(s) should be varied so as to maintain the level within the zone that is permitted by your meter.&nbsp;&nbsp; From a financial point of view I don&#39;t think it matters which phases your loads are connected to.&nbsp; If you wanted to balance your overall loads across the three phases, which would seem a nice idea, the power distribution algorithm would become a whole lot more complicated.</p>
<p>2.&nbsp; My previous idea about using PWM to indicate the state of three separate energy buckets is rubbish.&nbsp; Sorry about that!</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12086"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sun, 12/05/2013 - 23:23.</div>
    <div class="content">
     <p>I was thinking about heating and the effects of unbalanced torques on the generators, and side effects on the generator&#39;s AVR, when I said I thought the generator would prefer to see a balanced load. Another thought has occurred to me: with a pulsating load, it would be wise to check for mechanical resonances particularly in the shaft (and coupling?) between the generator and the turbine, and it might be necessary to tweak the algorithm to avoid that. It might not happen, but if it did and was serious enough to provoke a failure it would be expensive.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12088"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Mon, 13/05/2013 - 06:45.</div>
    <div class="content">
     <p>I&#39;m assuming noah&#39;s turbine is connected to the Grid&nbsp;so the only pulsating will be at the level of the flicker we see with PV systems - ie small. The impedance of the dump load will presumably be much greater than the impedance of the Grid.</p>
<p>For my floor heating I cycle through the loads on each phase in turn which reduces the flicker frequency on each phase by a factor of 3 - I hope!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12095"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Mon, 13/05/2013 - 13:25.</div>
    <div class="content">
     <p>When you posted you original &#39;stacked&#39; design, Martin, I didn&#39;t understand how the three emonTx layers communicated between each other.&nbsp; Looking at the Atmel datasheet, I see there is a serial comms mechanism that allows data interchance between connected processors.&nbsp; The relevant pins on the 386 chip appear to be 27 and 28, also used for Analog inputs 4 and 5.</p>
<p>If Noah were to link these pins of his three Arduinos together, then the energy states of each monitor could be combined, much as your software does.&nbsp; This hardware would then be functionally identical to your triple emonTx unit, albeit not as compact.&nbsp;</p>
<p>One of the existing Arduinos could be designated as the master, and look after the top-level decisions.&nbsp;&nbsp; Or a fourth processor could presumably be added which would means that the three monitor boards would remain identical.</p>
<p>With your existing system, how often do the slaves send energy data to the master?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12096"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Mon, 13/05/2013 - 14:34.</div>
    <div class="content">
     <p>Is there any reason why a mega 2560 couldn&#39;t be used as that has many more imputs, would be simpler and cost less than 3 separate boards?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12098"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Mon, 13/05/2013 - 14:44.</div>
    <div class="content">
     <p>You still have to do all the readings and all the processing, so the fidelity of the waveform capture would be compromised.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12099"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1372" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="noah&#039;s picture" title="noah&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1372" title="View user profile.">noah</a> on Mon, 13/05/2013 - 15:07.</div>
    <div class="content">
     <p>Yes the scenario with 3*1kw generated and 1*3 kw utilised&nbsp;is actually common as loads are not balanced. This is what I was expecting.</p>
<p>&nbsp;System is grid connected so generator will always run pretty smoothly. So extra loading or subtracting from any phase should not lead to &nbsp;mechanical problems.</p>
<p>I cant quite get my head around whether the energy bucket/s actually exist or are they almost purely conceptual?</p>
<p>The system as set up seems to do what it says on the tin: ie as if there are 3 energy buckets, all independent of each other. I can see that it will still work if there is only 1 but wouldn`t there be a lot of `overfilling` with each phase thinking it has a certain number of joules to play with and in fact only having a third of that amount?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12100"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Mon, 13/05/2013 - 15:48.</div>
    <div class="content">
     <p>What does it say on the tin: &quot;donations to the electricity company&quot;? :)</p>
<p>Do you not see that in the 3*1kW generated and 1*3 kW utilised situation the 2 unloaded phases will each divert 1kW to your dump loads so the total utilised will be 5kW when you are only generating 3kW?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12101"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Mon, 13/05/2013 - 16:37.</div>
    <div class="content">
     <p>So what exactly is an &quot;energy bucket&quot;?&nbsp; Deep breath ...</p>
<p>The Mk2&#39;s energy bucket is simply a means of recording the net flow of real energy at the supply point.&nbsp; A single-phase utility meter works in exactly the same way.&nbsp; It monitors the flow of real energy, and updates its accumulator accordingly.&nbsp; When a certain amount of energy has been imported, a charge-pulse is applied.&nbsp; This causes a register within the meter to be incremented, and the accumulator is reset.&nbsp; Between each charge-pulse, the accumulator winds its way up (or down) within a window which has a fixed range.&nbsp; This window is the meter&#39;s &quot;sweet zone&quot; which typically spans 1 WattHour&#39;s worth of energy flow.</p>
<p>Because the router&#39;s window (aka energy bucket) is of the same range as the meter&#39;s window (aka sweet zone), the router can constrain the net flow of energy to remain within the meter&#39;s sweet zone thereby preventing any charge pulses.</p>
<p>As I understand it, a 3-phase system works in a very similar way.&nbsp; Although the energy flow on each phase is measured separately, it is only the net flow which is monitored by the meter.&nbsp; The Router should therefore aim to do likewise, which means that there should only be one energy bucket, as such.&nbsp; This will be used to determine when the overall dumpload need to be increased or decreased.</p>
<p>Via the 2-wire interface by which adjacent processors can be linked, each of the three per-phase monitors can routinely send&nbsp; energy flow contributions to the controller.&nbsp; To keep track of this data in between such transmissions, each monitor would need to have its own accumulator.&nbsp; This would not be a &quot;bucket&quot; as such, with min and max limits, but simply an endless (signed) accumulator which can be reset to zero after its content has been disclosed.</p>
<p>Every so often, the controller would request energy flow data for each of the individual phases.&nbsp; Having updated the single energy bucket which records the overall flow, a decision would be taken as to whether the total amount of dumpload needs to be increased of decreased.&nbsp;</p>
<p>For a fully balanced system, I think each dump-load should be capable of being driven by each phase.&nbsp; Whenever a given load needs to be brought on, a decision would be taken as to which phase it should be driven by.&nbsp; While that load needs to remains on, no other triac must attempt to drive it.&nbsp; Having eventually been turned off, when that same load next needs to come again , a new decision would be taken as to which phase it should be driven by.&nbsp; That decision would be based on recent energy contribution data from each of the individual per-phase monitors.</p>
<p>Hot-switching loads between phases, purely to maintain the per-phase balance, would surely be a non-starter.&nbsp; If nothing else, there would need to be some guard zone when both triacs were off, which would result in &quot;flicker&quot;.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12102"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1372" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="noah&#039;s picture" title="noah&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1372" title="View user profile.">noah</a> on Mon, 13/05/2013 - 17:53.</div>
    <div class="content">
     <p>Yes Martin, I thought that was exactly what I said. Its also what I expected from the setup so I`m not disappointed&nbsp;but obviously I`d like a setup which uses as little import as possible, however this is achieved.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12464"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="KOUROS&#039;s picture" title="KOUROS&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by KOUROS (not verified) on Thu, 30/05/2013 - 12:04.</div>
    <div class="content">
     <p>Hi, i am from Spain and i have a Zerbox (same like MK2)</p>
<p>&nbsp;</p>
<p>I need to <strong>avoid</strong> to export current because it is forvidden in Spain.</p>
<p>&nbsp;</p>
<p>I have changed&nbsp; safetyMargin_watts&nbsp; with negatives values like -15, -35- -50- 70, but i always export current.</p>
<p>I have 400w of Solarpanels and 250w of <span class="short_text" id="result_box" lang="en"><span class="hps">minimum</span> <span class="hps">consumption. Actually i have a 2000w radiator heater, and i&#39;l put a 1500w of water heater in a few days.</span></span></p>
<p>In afew months <span class="short_text" id="result_box" lang="en"><span class="hps">I would like to</span> <span class="hps">expand</span> <span class="hps">the solarpanels up&nbsp; to</span> <span class="hps">1500w</span></span>.</p>
<p><span class="short_text" lang="en"><span class="hps">In Spain the current is 230v, and i have 232-236v.</span></span></p>
<p>&nbsp;</p>
<p><span id="result_box" lang="en"><span class="hps">Someone</span> <span class="hps">would be</span> <span class="hps">kind enough to help</span> <span class="hps">to adjust</span> <span class="hps">the parameters</span> <span class="hps">of the program ?</span></span></p>
<p>&nbsp;</p>
<p>a lot of thanks !!! and Congratulations for this Forum !</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12469"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Thu, 30/05/2013 - 13:55.</div>
    <div class="content">
     <p>If you must never export energy, you must always be able to consume more than you generate. The Mk 2 controller will always try to balance consumption against generation so that zero energy is exported or imported. It will only be possible to do this when the load - lights, refrigerator, computer <strong>plus</strong> the controlled load of water heater and radiator heater - is equal to or greater than the power your Solar panels generate.</p>
<p>Have you read <a href="http://openenergymonitor.org/emon/mk2" title="Diverting surplus PV Power, by Robin Emley">Diverting surplus PV Power?</a>&nbsp; Is your controller working at all - does the water heater switch on when there is generation? Are you measuring current at the correct place?&nbsp; <a href="http://openenergymonitor.org/emon/sites/default/files/mk2typical.png " title="http://openenergymonitor.org/emon/sites/default/files/mk2typical.png ">http://openenergymonitor.org/emon/sites/default/files/mk2typical.png </a> Is your c.t. the correct way round?&nbsp; Which version of the software sketch are you using?&nbsp; Have you tried to calibrate Voltage and Power - these are the main things you need to adjust.</p>
<p>Have you tried the tools here: <a href="http://openenergymonitor.org/emon/node/1757" title="http://openenergymonitor.org/emon/node/1757">http://openenergymonitor.org/emon/node/1757</a> and do you get reasonable numbers for example from <a href="http://openenergymonitor.org/emon/sites/default/files/rawSamplesTool.ino_.zip" title="http://openenergymonitor.org/emon/sites/default/files/rawSamplesTool.ino_.zip">http://openenergymonitor.org/emon/sites/default/files/rawSamplesTool.ino...</a></p>
<p>I need to check, but I think safetyMargin was found to be unnecessary - for the UK - and has been removed.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13007"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sun, 16/06/2013 - 15:55.</div>
    <div class="content">
     <p>After nearly 12 months of fault-free operation, my original Mk2 breadboard rig has been officially retired in favour of a more respectable looking boxed up version.&nbsp; This uses a pair of Rich&#39;s PCBs with a pcb-mounting transformer for the AC voltage source.&nbsp; The original BTA41 triac and home-made heat-sink have been retained, mainly to see how long they keep going for.</p>
<p>I&#39;m using a Magnelab CT rather than the standard YHDC one.&nbsp; With its larger aperture, this CT allows a couple of extra coils to be tucked alongside the incoming Neutral line.&nbsp; By this means, the rig&#39;s operation can be checked at any time, even when the PV system is not active.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13009"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1165" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="richmc&#039;s picture" title="richmc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1165" title="View user profile.">richmc</a> on Sun, 16/06/2013 - 18:40.</div>
    <div class="content">
     <p>Not bad for a beginner ;-)</p>
<p>You forgot to put an LED on the front!</p>
<p>Looks tidy Robin.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13014"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2867" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="9fingers&#039;s picture" title="9fingers&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2867" title="View user profile.">9fingers</a> on Sun, 16/06/2013 - 19:40.</div>
    <div class="content">
     <p>Robin,</p>
<p>Where do you get your plastic boxes from please? I&#39;m using something externally similar but the internal mounting strips are in a diagonal X format. Yours at right angles look much easier to use.</p>
<p>You can just see the X here <a href="http://www.ebay.co.uk/itm/Sealed-Plastic-Enclosure-194-5x145x78mm-Electronic-Terminal-Box-Project-Case-/230954059201?pt=UK_BOI_Electrical_Components_Supplies_ET&amp;hash=item35c5ef45c1" title="http://www.ebay.co.uk/itm/Sealed-Plastic-Enclosure-194-5x145x78mm-Electronic-Terminal-Box-Project-Case-/230954059201?pt=UK_BOI_Electrical_Components_Supplies_ET&amp;hash=item35c5ef45c1">http://www.ebay.co.uk/itm/Sealed-Plastic-Enclosure-194-5x145x78mm-Electr...</a></p>
<p>They are well priced, reasonably sealed and machine well just difficult to use the internal mounts.</p>
<p>&nbsp;</p>
<p>TIA</p>
<p>Bob</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13019"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sun, 16/06/2013 - 20:22.</div>
    <div class="content">
     <p>On the grounds that there&#39;s a prominent neon indicator just above, Rich, I decided to economise on the LED :D</p>
<p>Yes, Bob, that box was a dream to mount components in when I first assembled the rig before Easter.&nbsp; The box itself has been kicking around here unused for maybe 20 years, but I&#39;ve no idea where it came from.&nbsp; The plastic is quite supple, and it takes mounting screws very easily.&nbsp; Modern boxes seem to be more brittle.</p>
<p>The triac has finally got its mica washer and insulated mounting.&nbsp; I&#39;ve not fitted an RF unit because our secondary dump-load (a storage heater) did not appear to be effective.&nbsp; It takes more power to cook up a storage heater than we are ever likely to have available.&nbsp; A longer immersion heater element is the next obvious upgrade for our system.</p>
<p>I replaced the &quot;normal/AF&quot; metal switch by a plastic one so that the only exposed metal part is the heat-sink which is earthed.&nbsp; The USB connector of the Uno unfortunately sticks out a little.&nbsp; If mounting the same components again, I would fit the Uno slightly further inside the box so as to avoid this unnecessary protrusion.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13021"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1165" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="richmc&#039;s picture" title="richmc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1165" title="View user profile.">richmc</a> on Sun, 16/06/2013 - 20:57.</div>
    <div class="content">
     <p>Bob, the box you have is the one I use, I&#39;ve found short self tappers are the best way of mounting stuff internally, but I do have to &quot;dremel&quot; away some of the plastic under the Arduino for it to sit flat. I find this box reasonably easy to work, not at all brittle as Robin says many are.</p>
<p>Robin you don&#39;t need the mica washer just a smear of conductive paste, belt and braces seems to apply.</p>
<p>Through the winter I used a cheap 2KW convection heater (&pound;20 from Argos) that has 3 switched levels and sits in my hallway so helps supplement the heating in the hallway and up the stairs to the bedrooms.</p>
<p>I set the USB socket 5 or 6 mm back into the case, ideally there should be some type of grommet or cover for it.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13030"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Mon, 17/06/2013 - 10:06.</div>
    <div class="content">
     <p>Given the flexibility of the mounting channels, I could no doubt move the Uno a bit further into the box to prevent its USB socket from overhanging.&nbsp;</p>
<p>I&#39;ve always used conductive paste to get a good thermal contact, but as Robert has often pointed out, this doesn&#39;t isolate the triac electrically from the heatsink,&nbsp;&nbsp; Hence my use of an <a href="http://spiratronics.com/mica-to3-mounting-kit-en.html">insulated mounting kit</a> from Spiratronics, or eqivalent, with some thermal paste for good measure.</p>
<p>With the heatsink also being earthed, this precaution is indeed belt &amp; braces, but this is surely no bad thing when mains power is involved.&nbsp; There is no fuse as such in the system, so if the immersion element were to fail, the triac could start to break down and who knows what may happen during its final moments.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13032"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Mon, 17/06/2013 - 10:50.</div>
    <div class="content">
     <p>For what it&#39;s worth, I prefer the <a class="underlined-bold" href="http://spiratronics.com/pcb-hardware-and-enclosures/semiconductor-hardware/transistor-mounting/silicone-rubber-mounting-kits.html">Silicone Rubber Mounting Kits</a>. These are allegedly better, at approx. 0.45&deg;/W, and a lot less messy than conductive paste. And as Robin infers, you then need 2 faults to trip the breaker and 3 faults before it gets dangerous (insulation failure in the triac, in the mounting and finally a broken earth to the metalwork).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13033"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Mon, 17/06/2013 - 14:24.</div>
    <div class="content">
     <p>It would be interesting to try out various ways of mounting a triac: with silcone or mica washers, and dry or with thermal compound, to see how they behave.&nbsp;&nbsp; If they&#39;re all passing the same current, the power that each one dissipates should be pretty much the same.&nbsp;</p>
<p>Any takers? ...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13036"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1165" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="richmc&#039;s picture" title="richmc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1165" title="View user profile.">richmc</a> on Mon, 17/06/2013 - 14:54.</div>
    <div class="content">
     <p>If you earth the heatsink properly then no fault will be dangerous if the trip is working properly, and the only problem with paste is people use too much of it, if you use a mica washer you also have two lots of paste hence twice the opportunity to use too much . Silicon pads are initially better but as the heat dries thermal paste (if used properly) it becomes more effective. Never mount a device dry as it will seriously inhibit the ability to conduct heat. It&#39;s not so much what the device dissipates but the transfer to the heat sink that is impaired or improved.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13040"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1775" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1775.jpg" alt="Brian D&#039;s picture" title="Brian D&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1775" title="View user profile.">Brian D</a> on Mon, 17/06/2013 - 18:13.</div>
    <div class="content">
     <p>A bigger potential problem is the wiring and connectors. I was sure that I fully tightened the connectors in my unit but the attached photos suggest differently.</p>
<p>The result was a Live to case short which tripped the house RCD</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13043"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Mon, 17/06/2013 - 18:40.</div>
    <div class="content">
     <p>You didn&#39;t tin those wires first, did you? I was taught never to tin a stranded conductor. I was told that copper on its own has enough spring and maintains contact pressure; but solder, being soft, flows under pressure and eventually there is not enough pressure to assure a low resistance, resulting in heating.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13045"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1775" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1775.jpg" alt="Brian D&#039;s picture" title="Brian D&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1775" title="View user profile.">Brian D</a> on Mon, 17/06/2013 - 19:19.</div>
    <div class="content">
     <p>Robert said:</p>
<p class="rteindent1"><em>You didn&#39;t tin those wires first, did you?</em></p>
<p>I did indeed tin them first! Your advice is appreciated and I shall not do that again.</p>
<p>On the diverter I changed the connector block for a larger size and beefed up the wiring plus I used longer tails to ensure that each is engaged by two screws. Finally I made sure the screws are damn tight but yes I tinned the wires again.</p>
<p>I will have another look soon.</p>
<p>Thanks</p>
<p>Brian</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13050"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Mon, 17/06/2013 - 21:02.</div>
    <div class="content">
     <p>FWIW, I often &#39;tin&#39; stranded wires too.&nbsp; I&#39;ve been told that this operation is not recommended because it reduces the ability of the wire to flex (which is fairly obvious) but that it&#39;s probably not a problem if no movement of the wiring is likely.&nbsp;</p>
<p>I also like to double-back the ends of single wires that go into connector blocks; this seems to prevent the wire escaping around the side of the screw.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13051"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1165" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="richmc&#039;s picture" title="richmc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1165" title="View user profile.">richmc</a> on Mon, 17/06/2013 - 21:21.</div>
    <div class="content">
     <p>When using screw terminals, twist the wire then double it back, the main object is to stop single strand whiskers escaping. A better plan is to crimp on a thin brass ferrule, you may have seen them in pre wired plugs.</p>
<p>You should only tin a wire that&#39;s going to be soldered to something else.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13054"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Mon, 17/06/2013 - 22:51.</div>
    <div class="content">
     <p>Some information, some possibly useful and some not quite so:</p>
<p>Those ferrules are often called &quot;bootlace ferrules&quot; at least by <a href="http://uk.rs-online.com/web/c/connectors/terminals-splices/crimp-bootlace-ferrules/">RS</a> and <a href="http://spiratronics.com/product-39941.html">Spiratronics</a> but not by<a href="http://www.maplin.co.uk/insulated-crimp-ferrules-455091"> Maplin </a>(and they&#39;re tin plated copper, not brass, that&#39;s much too hard), and I must add the obligatory other suppliers for these exist!</p>
<p>In the good old days when appliances didn&#39;t come with fitted plugs, they often came with tinned ends to the flex - so loose connections in the plug were common. And the reason for tinning the wires? - solely to make it easier to handle during assembly and test. The little known advice then was cut the tinned ends off when fitting the plug.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13058"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1165" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="richmc&#039;s picture" title="richmc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1165" title="View user profile.">richmc</a> on Tue, 18/06/2013 - 07:53.</div>
    <div class="content">
     <p>Thin brass in my day Robert, that was MOD spec! &nbsp;With real men doing the crimping (and some very tough women).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16365"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2116" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="pedben&#039;s picture" title="pedben&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2116" title="View user profile.">pedben</a> on Tue, 19/11/2013 - 09:37.</div>
    <div class="content">
     <p>
	Second load on Robins MK2 diverter.</p>
<p>
	Using Honeywell strap on cylinder stat,I have been able to add a second load to Robins MK2 diverter.<br />
	With the cold weather we are having now,the boiler system gives us all the hot water we need.So when the sun shines,our solar system has no where to go.</p>
<p>With this in mind I came up with the idea of using the Honeywell strap on cylinder stat.to switch over to a convection heater.<br />
	The thermostat is just a temperature controlled single pole double throw switch.</p>
<p>Connecting pin 9 of arduino to the common contact marked C on the Stat,one can switch between the existing circuit ie Robins circuit and another external SSR based system.<br />
	The 5v supply in this case is common to all .</p>
<p>One can also use a rotary switch to select more devices.This is a manual system and one must remember to switch back to solar when the sun shines.</p>
<p>With the stat serving as auto switch,when the immersion heater stat switches off, the strap on stat which is strapped between the hot part of the cylinder and the cold part<br />
	would have reached the set temperature and switch over to contact 2.</p>
<p></p>
<p>In this state arduino pin 9 is now connected to contact 2. This in turn fires up the second ssr to drive a convection heater or another water tank.</p>
<p>(Please note that FAN HEATERS are not suitable due to inductive part of the fan.If the fan can be switched off it will be ok)</p>
<p>The good thing about this system is that if the temperature drops in the first cylinder,the strap on stat will switch over to contact 1.allowing immersion heater to start heating again.</p>
<p>I have been trying it out for over a week heating my living room when the sun shines.</p>
<p>Please see attached pics and diagram.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16560"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1372" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="noah&#039;s picture" title="noah&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1372" title="View user profile.">noah</a> on Thu, 05/12/2013 - 09:50.</div>
    <div class="content">
     <p>BTA41 blows!</p>
<p>Came down to workshop this morning and no heating.</p>
<p>I have 4 of R Mk2 and on one (on one 3.5kw leg of 3 phase turbine) had no output. MCB off- switched back on, plugged in resistance load and got an actual flame from&nbsp;BTA41.</p>
<p>I blew one of these before (by shorting out lead) and replaced it, has been working fine since.</p>
<p>This is the first to blow under its own steam so to speak. Perhaps the heating load (2 oil filled rads) are a bit close to the unit ( afew feet away and on most of the time) whereas the others are all in cold places.</p>
<p>Anyone else had a problem with these?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16563"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Thu, 05/12/2013 - 11:49.</div>
    <div class="content">
     <p>Hi Noah, you most be one of the very few UK users whose Mk2 systems are actually doing anything useful at present.&nbsp; Yesterday there was a bit of sun, but recent days have been grim indeed on the generation front.&nbsp; My total for Monday was 0.07 kWh, and the surplus power for that day was nil.&nbsp;</p>
<p>No, I&#39;ve never managed to blow up a triac.&nbsp; Shivvering here in a chilly house (unless I fire up the gas boiler), I could really do with some turbines like yours in the back garden!</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16567"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Thu, 05/12/2013 - 13:53.</div>
    <div class="content">
     <p>And there have been people berating me for recommending a 40 A device!</p>
<p>You seem to indicate that you think it may have overheated. What is the maximum current it was handling?&nbsp; Other things to look at would be the efficiency of the heat sink - have you deburred the mounting face and is the triac making good contact, have you used heat sink compound or anything else to assure good thermal contact?&nbsp;</p>
<p>Do you have a snubber fitted?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16574"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1372" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="noah&#039;s picture" title="noah&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1372" title="View user profile.">noah</a> on Thu, 05/12/2013 - 21:46.</div>
    <div class="content">
     <p>Robert</p>
<p>I think its probably the ambient temp being too high-someone could easily have pushed one of the heaters right next to the MK2 box and whacked up ambient to over 40. The other two on the turbine have same heatsinks&nbsp; but are in cooler places. These three handle a max of 3.6kw each. There is good contact with heatsink.</p>
<p>My first MK2&nbsp;is a fair bit older than these 3 and has been handling 3kw pretty consistently without a problem- mind you this is in a bigger housing and in an unheated area.</p>
<p>I`ll replace the triac and make sure the heaters are kept well away.</p>
<p>Turbine and waterwheel putting out just under 15kw. Dontcha love the rain?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16576"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Fri, 06/12/2013 - 00:06.</div>
    <div class="content">
     <p>You&#39;re talking then about 15 A (assuming 240 V). Let&#39;s say 16 A worst case. From the graph in the data sheet that means that the triac is dissipating fractionally less than 15W.&nbsp; The maximum junction temperature is 125 &deg;C and the resistance junction to case is 0.9 &deg;C/W. That means the maximum case temperature is 125 - 15 * 0.9 = 111.5 &deg;C.</p>
<p>I use silicone rubber mounting kits and their thermal resistance is 0.45 &deg;C/W, that makes the heatsink temperature directly under the triac 111.5 - 15 * 0.45 = 104.75 &deg;C.</p>
<p>If you have a 40 &deg;C ambient, that means your heatsink needs to be at least (104.75 - 40) / 15 = 4.32 &deg;C/W</p>
<p>If you have a temperature range and a thermocouple with your multimeter, you could try a drop of oil on the triac tab, put the thermocouple in the oil to give you good thermal contact and measure the temperature. Also, knowing the dissipation, if you know the thermal resistance of your heatsink and the mounting method, you can redo the sum above with your numbers and work out the maximum ambient temperature. If that&#39;s above the actual ambient, you&#39;re OK. If not, you need a better heatsink.</p>
<p>Robin claims <a href="http://openenergymonitor.org/emon/node/2857">his heatsinks</a> are 1.5 &deg;C/W, so they should be good to a ridiculous temperature - over 80 &deg;C.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16702"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="ecoreuil&#039;s picture" title="ecoreuil&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by ecoreuil (not verified) on Tue, 10/12/2013 - 14:31.</div>
    <div class="content">
     <p>I am a &quot;newbee&quot; and I want to thank you, Robin,&nbsp;and your fellow enthusiasts for all the work on the Solar diverter.&nbsp; I basically had zero knowledge of&nbsp; electronics, soldering etc. and my programming goes back to FORTRAN IV in the early 70&#39;s. In spite of this, I was thrilled when I managed to build and install a working Mk 2 system using Robin&#39;s July 2012 circuit diagram and the August 2012 Arduino sketch.&nbsp; On Sunday 8 December 2012&nbsp; I harvested 17 kWhr of heat from 42 kWhr generated (only &quot;losing&quot; 2 units to the grid measured by an Iskra import/export meter - I can generate up to 6.4 kw (from a Proven Windturbine) but I am only diverting to a 3 kW immersion at present).&nbsp; I can use all the surplus power in the house at this time of year as my primary heating is Economy 7 heating a 3000 l Akvaterm thermal store. Now, I have to reduce the flicker (which in a way I quite like as it is an indication that the system is working!) &nbsp;so I will try Robin&#39;s Mk2a_PV_router_rev3a sketch if I can get my head around calibration!&nbsp; Many thanks to you all who have contributed so much to this project.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16703"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Tue, 10/12/2013 - 16:06.</div>
    <div class="content">
     <p>It&#39;s always good to hear of another Mk2 Router that&#39;s working well.&nbsp; Thanks for the kind words.&nbsp; At this time of year, wind and hydro seem the only way to go!</p>
<p>Although the anti-flicker feature first appeared in Mk2a rev3, the Mk2a line has seen little use and is less refined than the Mk2i interrupt-based one.&nbsp; The most refined sketch with standard 2-level AF logic is rev4b of Mk2i.&nbsp; Rev5b of Mk2i has an alternative type of AF algorithm that needs no calibration but doesn&#39;t reduce the flicker speed by as much as a properly calibrated system running rev4b.&nbsp; Unlike the standard AF algorithm, the one in Rev5b is ideal for a system with multiple dump-loads.</p>
<p>Mk2_PV_Router_mini_3 is a simple floating-point sketch that does not have anti-flicker.&nbsp; However, it should not take much effort to add some simple AF logic to this code if required.&nbsp; Floating point maths is fine if there&#39;s nothing else for the processor to do.</p>
<p>Links to all sketches are <a href="http://openenergymonitor.org/emon/node/1757">here</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16726"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="ecoreuil&#039;s picture" title="ecoreuil&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by ecoreuil (not verified) on Thu, 12/12/2013 - 11:14.</div>
    <div class="content">
     <p>Thanks, Robin.&nbsp; I have just ordered the components to build another Mk2 router so that I can try out various versions of your software and experiment with calibration.&nbsp; I am reluctant to disconnect my first router as it is working so well!&nbsp;&nbsp;My son will be home for a couple of weeks at Christmas and he is an enthusiastic C programmer so I will see if I can get him interested.&nbsp; My son-in-law will also be with us for Christmas and his day job is installing and maintaining systems using huge capacitors to regulate power factor in industrial installations - I hope that I can get him involved as well.&nbsp; I&#39;ll let you know how I get on!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-18370"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/4344" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Catty&#039;s picture" title="Catty&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/4344" title="View user profile.">Catty</a> on Wed, 12/02/2014 - 16:01.</div>
    <div class="content">
     <p>Hi RichMc, I am after 3 sets of your PCB&#39;s, Have you any ?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-18371"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Wed, 12/02/2014 - 16:32.</div>
    <div class="content">
     <p>Catty: Rich hasn&#39;t been active around here for some time, the last we heard he was poorly. Robin Emley <a href="http://openenergymonitor.org/emon/user/956">(calypso_rae)</a> has his own design and may be able to help you.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-18461"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="wysiwyg&#039;s picture" title="wysiwyg&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by wysiwyg (not verified) on Sat, 15/02/2014 - 16:38.</div>
    <div class="content">
     <p>I built one of robins solar controlers over a year ago and has been working perfectly eversince. but yesterday my boiler went on the blink so i have no heating and now no hot water, as my immersion is controlled through the solar controler.</p>
<p>my question is could somebody add some code to robins scetch to allow a pushbutton that will switch on the triac for 1 hour, this will allow me to overide my solar controler in case of emergencies.</p>
<p>I am not very good at coding thats why i need someones help, this would also help other people in the same situation as me.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-18464"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sat, 15/02/2014 - 17:25.</div>
    <div class="content">
     <p>By far the easiest quick fix is to wire a switch rated at 10A or 15 A &amp; 250 V in parallel with the triac, to switch the immersion heater manually. That will give you hot water even if the electronics of the diverter fail.</p>
<p>The units that Robin is now building have such an override switch.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-18843"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/4344" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Catty&#039;s picture" title="Catty&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/4344" title="View user profile.">Catty</a> on Thu, 27/02/2014 - 18:34.</div>
    <div class="content">
     <p>Thanks Robert for the reply,&nbsp;I am making a set of PCbs tomorrow, the hard work has been done so thanks to all, Fantastic project with huge input. I am going for the original hand drawn sketch from July 2012 to start off and play with that, the anti flicker part .... well I&#39;ll see how that goes. Hope Rich makes a full recovery !</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-18844"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Thu, 27/02/2014 - 19:46.</div>
    <div class="content">
     <p>Catty, the original hand-drawn schematic is still perfectly valid, and has not changed at all.&nbsp; It forms the basis of the PCBs that I have recently commissioned and which I will very soon be able to offer to constructors.&nbsp;&nbsp;</p>
<p>All versions of the Mk2 sketch can be run on the same hardware.&nbsp; One of the simplest sketches is described in detail at the very end of my online article about diverting surplus power.&nbsp; The link to that article is on the OEM Home Page, just below the &#39;Welcome&#39; paragraph and picture.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19092"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1550" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="DebbieL&#039;s picture" title="DebbieL&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1550" title="View user profile.">DebbieL</a> on Fri, 07/03/2014 - 19:17.</div>
    <div class="content">
     <p>My&nbsp;MK2&nbsp;has been working for over a year now and apart from a few weeks this winter has supplied all my hot water requirements. Thank you Robin and the other contributors for coming up with a&nbsp;circuit that was simple to construct, required no trouble shooting and just gets on with the job!</p>
<p>I recently added an LCD display to indicate the kWh diverted to the tank and this&nbsp;revealed that&nbsp;on sunny days with chilly evenings there is still a lot of power exported during the day when I&#39;m at work after the immersion has cut off.</p>
<p>I&#39;ve acquired a small storage heater, a Dimplex 0.85kW XL6N, with plans to divert power into this after the immersion has cut out. While it clearly has resistive heating elements I still need to investigate what other circuitry is inside since it may not like the waveform from the triac. Also there may be circuitry that somehow turns the heating elements on only during the economy 7 period which would need to be overridden. Has anyone tried supplying a storage heater with an MK2?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19095"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Fri, 07/03/2014 - 20:41.</div>
    <div class="content">
     <p><em>Has anyone tried supplying a storage heater with an MK2?</em></p>
<p>Yes, I tried using the 3.4 kW version in the Dimplex range and found it needed far more energy that my PV system could supply. Going for the smaller one sounds a much better idea.&nbsp;</p>
<p>The Dimplex worked fine with the burst-mode feed from the triac.&nbsp; I just turned the thermostat full on and it absorbed whatever power came its way - but there simply wasn&#39;t enough oomph to get the whole unit warm. &nbsp;</p>
<p>I think the Dimplex would normally be fed from a circuit which is only live during the Economy 7 night-time, so there&#39;s no need to override anything.&nbsp;</p>
<p>I posted a video about this on the day I got it going, it&#39;s at <a href="http://www.youtube.com/watch?v=TTgZxkW1sB8">http://www.youtube.com/watch?v=TTgZxkW1sB8</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19716"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/5882" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-5882.jpg" alt="Chassyh&#039;s picture" title="Chassyh&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/5882" title="View user profile.">Chassyh</a> on Mon, 24/03/2014 - 01:49.</div>
    <div class="content">
     <p>Robin</p>
<p>I posted a question on the &#39;Talking Solar&#39; website as to whether your MK2 would work with all types of utility meter, analogue, digital or smart.&nbsp; As I haven&#39;t had a definitive answer, I thought I would ask the master himself ??</p>
<p>Thanks</p>
<p>&nbsp;</p>
<p>Chas</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19726"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Mon, 24/03/2014 - 09:21.</div>
    <div class="content">
     <p>Hi Chas,</p>
<p>The Mk2 Router simply balances the amounts of imported and exported energy as measured at the supply point, which is where the supply meter is located.&nbsp; As many constructors have satisfactory demonstrated, this arrangement works fine with conventional meters, both digital and analogue.&nbsp;</p>
<p>All known types of meter have a &quot;sweet zone&quot; within which energy can be moved to and fro without loss or charge to the user.&nbsp; With non-reversing analogue meters, this zone may be quite large, around 2.5 Wh.&nbsp; With most digital meters, it is 1 Wh, or 3600 Joules.&nbsp; With some digital meters, notably those with 2-colour LEDs, the sweet zone can be considerably smaller, around 1250 Joules.</p>
<p>In its &quot;normal&quot; mode, the Mk2 Router requires just a couple of hundred Joules of headroom within which to work.&nbsp; So it will clearly work OK alongside any of these kinds of meter.&nbsp; In AF mode, the cycle rate&nbsp; (aka &quot;flicker&quot; rate) is reduced by turning the output stage on in longer bursts.&nbsp; When using this mode, it is important for the twin threshold levels to be appropriately set for the type of meter that is in use.&nbsp;&nbsp; Calibration of the system is also a good idea, this being unnecessary when running in &quot;normal&quot; mode.</p>
<p>I have no idea how a &quot;smart meter&quot; works.&nbsp; Providing that it allows some leeway within which the Router can operate, I can&#39;t foresee any problems.</p>
<p>Maybe you would like to mention the existence on my new website <a href="http://www.mk2pvrouter.co.uk/">http://www.mk2pvrouter.co.uk/</a>&nbsp; in the other place.&nbsp;</p>
<p>Thanks, Robin</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19761"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/5882" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-5882.jpg" alt="Chassyh&#039;s picture" title="Chassyh&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/5882" title="View user profile.">Chassyh</a> on Mon, 24/03/2014 - 17:56.</div>
    <div class="content">
     <p>Hi</p>
<p>In reply to the post&nbsp;&nbsp; -&nbsp; <strong><em>Submitted by pedben on Tue, 19/11/2013 - 09:37.&nbsp; Second load on Robins MK2 diverter.</em></strong></p>
<p>I have been considering using the solar electric when the cylinder is hot for another purpose, sorry if&nbsp; I appear to be dim, please excuse me!!&nbsp; You wrote :-</p>
<p><strong><em>Connecting pin 9 of arduino to the common contact marked C on the Stat,one can switch between the existing circuit ie Robins circuit and another external SSR based system.<br />
	The 5v supply in this case is common to all .</em></strong></p>
<p>Is that the normal situation, or do you mean connecting <em>another</em> cable to the arduino?? I had assumed that I could let the cylinder stat do the switching, is that what you are saying here?</p>
<p>So the output from the diverter, instead of going directly to the immersion, goes to the cylinder stat instead, which causes it to heat the immersion if the cylinder is cold, then switches to another load if the cylinder is hot, or is that too simplistic?</p>
<p>I get the idea that a Dimplex storage radiator would work OK, if it is small enough - about 1kW.</p>
<p>Thanks in advance</p>
<p>&nbsp;</p>
<p>Chas</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19778"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 25/03/2014 - 00:19.</div>
    <div class="content">
     <p>What pedben is saying is he is using the cylinder stat to switch the<em><strong> firing signal,</strong></em> that goes to the immersion triac when the cylinder is cold, away to another SSR when the cylinder is hot. Obviously, the second SSR will be connected to the normally open contact of the stat and to the Arduino common.</p>
<p>The problem I see with that is the cylinder stat contacts are designed for high current and might not switch the low current (15 - 20 mA) firing signal reliably after a period of time, unless there is a good wiping action as the contacts make.</p>
<p>I suspect he did it that way as it would be easier to run the low voltage low current firing signal to the second load than it would be to run high power wiring, even though it does mean that there are two SSRs / Triacs.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19780"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/5882" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-5882.jpg" alt="Chassyh&#039;s picture" title="Chassyh&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/5882" title="View user profile.">Chassyh</a> on Tue, 25/03/2014 - 00:45.</div>
    <div class="content">
     <p>Thanks for your comments, I should have known better than to try to understand, as a non-electronica most of what you are saying is incomprehensible to me, but I do appreciate you trying.</p>
<p>My diverter set up is quite some distance from the immersion and would require quite some work to run an extra (even low voltage) cable to the immersion/cylinder area.</p>
<p>Best leave well alone I reckon,</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19801"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Tue, 25/03/2014 - 14:54.</div>
    <div class="content">
     <p><em>My diverter set up is quite some distance from the immersion and would require quite some work to run an extra (even low voltage) cable to the immersion/cylinder area.</em></p>
<p>Can&#39;t you intercept the cable somewhere near to the consumer unit?&nbsp; That&#39;s presumably where your immersion heater gets its power from.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19810"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 25/03/2014 - 17:40.</div>
    <div class="content">
     <p>Chas, what exactly do you want to do? You are already diverting PV power to your immersion heater, but I&#39;m guessing at what else? Tell us a bit more detail and we might be able to help.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19813"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/5882" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-5882.jpg" alt="Chassyh&#039;s picture" title="Chassyh&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/5882" title="View user profile.">Chassyh</a> on Tue, 25/03/2014 - 21:16.</div>
    <div class="content">
     <p>Thanks all for your patience!</p>
<p>I was thinking of what to do with the solar when it had heated my water to capacity.&nbsp; Some comments have been made to use the excess to &#39;charge up&#39; a storage radiator.</p>
<p>Robin&#39;s diverter switches the mains power to the immersion when there is enough solar to do so, it resides next to the consumer unit, which is about 30 ft from the immersion.</p>
<p>So at the immersion socket in my airing cupboard, there is power when the sun shines enough to power the immersion until the thermostat in the immersion says &#39;enough&#39;. When the thermostat stops the power to the immersion, the power is still at the socket, ready to be used by another appliance.</p>
<p>I thought I could switch that power to a storage radiator by simply asking a cylinder thermostat to do the switching for me, so that the immersion heats up when the water is cold, and the storage radiator heats up when the water is hot.</p>
<p>This seems logical to me, how about everyone else?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19821"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 25/03/2014 - 22:24.</div>
    <div class="content">
     <p>It&#39;s logical enough, but I&#39;m guessing (again) that the storage radiator you want to use is not close by the immersion heater.</p>
<p>Fortunately, Robin can come to your rescue. If you read his write-up, you&#39;ll see that he uses the concept of an &quot;energy bucket&quot; that is filled by the PV and emptied by the immersion. What happens to this when the cylinder stat opens? No prizes for saying it overflows. We can detect and use that to switch a second load, and Robin has done exactly that using the RFM12B radio. So what you could do is modify the diverter by adding a radio module, build a second electronic switch based on an emonTx with the triac output board added and locate this next to and switching your storage radiator.</p>
<p>He&#39;s published the sketches and links here: <a href="http://openenergymonitor.org/emon/node/1757" title="http://openenergymonitor.org/emon/node/1757">http://openenergymonitor.org/emon/node/1757</a><br />
	The &quot;Mk2i_PV_Router_rev5.ino&quot; is the main controller and the receiver sketch is &quot;RF_for Mk2_rx.ino&quot;</p>
<p>You probably want to read the supporting posts to make your own decision, but I think this is probably what you are looking for. Unfortunately, it is a bit more expensive than adding another connection to the thermostat (but probably a lot cheaper in terms of domestic upheaval).<br />
	&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19842"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/5882" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-5882.jpg" alt="Chassyh&#039;s picture" title="Chassyh&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/5882" title="View user profile.">Chassyh</a> on Wed, 26/03/2014 - 12:53.</div>
    <div class="content">
     <p>Thankyou Robert for your input.</p>
<p>I am really on this forum as an imposter!! My Robin&#39;s MkII was built by a third party, but I did wire in it myself.</p>
<p>I pride myself as a reasonably competent amateur electrician (although as a species we are becoming forcibly extinct) assisting on at least two complete re-wires.</p>
<p>So I tend to be OK on the macro-electrics, whereas the micro-electrics seem to me to be a little like witchcraft!</p>
<p>In your post I was OK up to the term RFM12B radio, then you lost me.</p>
<p>This is why I tend to look for a mains solution, rather than the way I am being encouraged to follow.</p>
<p>From what I have read so far, I can find no reason why my solution, all be it clumsy and maybe untidy, would not do the job, AND not take me out of my comfort zone (I know I&#39;m a scaredy cat).</p>
<p>Thanks again for everyone&#39;s time and help.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19847"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Wed, 26/03/2014 - 14:46.</div>
    <div class="content">
     <p>Chas, diverting surplus power to more than one load is an obvious way to refine a PV Router system.&nbsp; As I type this, our DWH is already up to temp, and any remaining surplus is spilling over into the grid.&nbsp; At some stage, I need to build a tidy unit which will allow this excess power to be used for a mobile appliance, controlled by RF.&nbsp; As Robert has pointed out, my Mk2i Router code already supports this functionality.</p>
<p>Rather than using the cylinder stat to do something it was never intended to do, my preferred approach is for the Router to have two output stages, each with its own triac.&nbsp; As only one triac will be on at a time, they can share a heatsink.&nbsp; The Mk2i code can support any number of logical loads.&nbsp; Each of these can be mapped to a physical load for which a dedicated pin is required on the processor, or the control signal could be transmitted by RF.</p>
<p>The RFM12B is a standard module which allows data to be transmitted and received by RF.&nbsp; There&#39;s plenty of information about it in the Building Blocks <a href="http://openenergymonitor.org/emon/buildingblocks/rfm12b-wireless">Networking</a> pages.</p>
<p>While working on the Mk2i line, I posted a simulation to show how multiple loads are dealt with.&nbsp; At the time, it was more concerned with Anti-flicker regimes, but it demonstates how each load becomes activated when its stage in the heirarchy is reached.&nbsp; When the stat for load 1 opens, that load effectively disappears, so load 2 takes over, and so on.&nbsp; The paragraph for this sketch on my<a href="http://openenergymonitor.org/emon/node/1757"> Summary Page</a> reads:</p>
<p><em><strong>FlickerDemo_multiLoad_2</strong>.&nbsp; A max rate of change of surplus power has been added for realism.&nbsp; Overflow and underflow of the 3600J energy bucket are now properly detected and displayed.&nbsp; An ideal vehicle for playing around with different anti-flicker schemes.&nbsp; Posted on 27/1/13 at <a href="1637" title="http://openenergymonitor.org/emon/node/1637">http://openenergymonitor.org/emon/node/1637</a>, this tool is available at<br />
	<a href="../sites/default/files/FlickerDemo_multiLoad_2.ino_.zip" title="http://openenergymonitor.org/emon/sites/default/files/FlickerDemo_multiLoad_2.ino_.zip">http://openenergymonitor.org/emon/sites/default/files/FlickerDemo_multiL...</a></em></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19848"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Wed, 26/03/2014 - 15:32.</div>
    <div class="content">
     <p>If Robin&#39;s proposal frightens you, then provided you have a thermostat with a changeover switch, you could wire the feed from the diverter to the pole (common) of the stat, the n/c contact to the immersion (these two might need swapping over, but should otherwise be as you have it now), then you add the feed to the storage radiator from the n/o contact of the stat, with the neutral connected to the immersion neutral. Even though the storage radiator is only 1 kW, you must extend the wiring in cable that is fully rated to the level of protection provided for the immersion heater.</p>
<p>Can I remind you of a quote from Arthur C Clarke: Any sufficiently advanced technology is indistinguishable from magic.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20500"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3885" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="PeterC&#039;s picture" title="PeterC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3885" title="View user profile.">PeterC</a> on Sat, 05/04/2014 - 19:08.</div>
    <div class="content">
     <p><strong><u>Failed connection on Arduino analog pin 1 - current coil input</u></strong></p>
<p>Dear all,</p>
<p>I have just had an infuriating problem on my installation. I noticed that when diverting power to the immersion I was drawing power from the grid. The degree of draw from the grid was proportional to the PV being diverted. The more I generated and dumped to the HW tank, the more I drew from the grid, up to a maximum of 500W. This was getting expensive.</p>
<p>I entertained all sorts of deep thoughts about software problems, triac failing, opto isolator not detecting zero etc etc .</p>
<p>Eventually the system failed all together and I had to take the lid off and poke around.&nbsp;</p>
<p>i transpired that the CT connection to Arduino analog pin 1 had come loose. I had twisted the wires, tinned them then shoved them in the hole. This was a very snug fit 9 months ago, but not now. I have now used gold pins and soldered connections which should last longer. (Note earlier postings about tinning twisted wires, brass ferrules etc etc.)</p>
<p>Some code to detect failure modes would be useful though to protect us from instances like this. All connections are likely to fail eventually and those on the Arduino are delicate. When they do it would be useful to shut the system down</p>
<p>PeterC</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20502"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sat, 05/04/2014 - 19:36.</div>
    <div class="content">
     <p>I&#39;d humbly suggest that the initial fault was a poor standard of construction. You state that all connections are likely to fail eventually. My experience after nearly 50 years in the industry - I started as a student apprentice in 1967 - is that improperly made connections fail quite soon, and properly made ones don&#39;t. It is very difficult to predict every possible type of failure mode, and to devise the appropriate automatic action. I suspect that if it had shut down, you would be complaining about all the energy you&#39;d exported and having had to override the system to get some hot water.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20595"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3885" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="PeterC&#039;s picture" title="PeterC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3885" title="View user profile.">PeterC</a> on Mon, 07/04/2014 - 20:36.</div>
    <div class="content">
     <p>Robert,</p>
<p>My initial construction was poor, which is why I mentioned it. There is a posting some way back that talked of soldering flexible cabling and I was hoping that my experience endorsed and reinforced that view for the benefit of others entering this forum who may be tempted to poke soldered wires into the Arduino&nbsp;sockets.&nbsp;</p>
<p>My poorly made connection did last for 9 months or so and only became apparent when I took the unit off the wall to relocate it, presumably dislodging the connection.&nbsp;</p>
<p>I still maintain that the original Arduino pins are not in the &#39;fit-and-forget&#39; category. Anyone using them needs to take care and perhaps make them an early point of investigation in fault tracking. If my fault was repeated then they could unintentionally draw power from the grid as a result of a faulty input on the CT input.&nbsp;</p>
<p>I hope these diverters are a success. A lot of work has been put into the development by many on this Forum, including you Robert. However as they become adopted more widely it is going to become more difficult to control the quality of the installations. If others make the mistake I made then that would be a shame. The dedicated board system reduces the possibility as screwed terminations rather than push-ins are used. However they are still a point of potential failure.</p>
<p>If it is possible to have a limited suite of codes for the most common faults such as out of tolerance signals on the analog input pins then that would help. If that is not possible then have some code to alert to the fact that significant power was being imported whilst the triac was firing. I was fortunate in that my Landis &amp; Gyr&nbsp;E470 meter came with a remote display that I have next to the immersion neon in the kitchen so a routine visual check found it for me. If the meter is older and &nbsp;in a cupboard with no remote display then this would not be so easily apparent. &nbsp;&nbsp;</p>
<p>I would not have complained about exporting the energy, nor overriding the system to get hot water as the root cause was my poor connection.</p>
<p>Peter</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20628"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1164" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1164.jpg" alt="Simon&#039;s picture" title="Simon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1164" title="View user profile.">Simon</a> on Wed, 09/04/2014 - 08:13.</div>
    <div class="content">
     <p>Good morning Peter, for what it&#39;s worth. &nbsp;</p>
<p>I&#39;ve just taken some time off my Heliostat design, whilst I try and source two large worm wheels, unfortunately it looks like I&#39;m going to have make them myself, my Meccano&nbsp;prototype&nbsp;works well, but not man enough for the job, and commercial ones are just too expensive, but that&#39;s an aside. &nbsp;I wish I still had a metal lathe :-(</p>
<p>I too used one of Robin&#39;s MK2i sketches, and took I slightly different approach to ensuring that a fault didn&#39;t cost me money. &nbsp;I added a hardware buffer between the Arduino output and the triac triggers, the buffer is enabled by the red light on the import meter.</p>
<p>The buffer I used was a 74HC365 (because I had one), it has two enable inputs, but I&#39;m wasting one which is just tied to ground, but that could be connected to a &#39;watchdog&#39; timer driven by a pulse from the processor for even more protection, at the moment the other input is driven low when the red light on the meter comes on, thus enabling the triac&nbsp;drive.</p>
<p>It may cause me to lose a little generated energy before the light comes on, and I haven&#39;t filtered out the normal 1Wh/Pulse, so there is potential for false enabling of the buffer for that short time, but it does give me a level of additional confidence, that I&#39;m not inadvertently firing the triacs when I shouldn&#39;t.</p>
<p>I rather like this approach, and it does increase the chance&nbsp;that a fault in the system, won&#39;t cost you lots of money and it works for me.</p>
<p>It&#39;s worth a thought, it is an additional LDR, small general purpose transistor and some resistors, and additional opportunity for poor soldering!! Which with age and my eyes get worse, is becoming increasingly likely.</p>
<p>Hope this helps.</p>
<p>Just for fun, I&#39;ve attached two pictures, showing the Heliostat&nbsp;prototype.</p>
<p>No comments about the quality of wiring, and soldering. &nbsp;The stepper motor drive is from an old ICL printer.</p>
<p>Simon</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20638"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Wed, 09/04/2014 - 12:59.</div>
    <div class="content">
     <p>Simon, your fail-safe method of driving the triac looks pretty sound to me.</p>
<p>The triac remains disabled until sufficient energy has been exported for the meter&#39;s LED to come on.&nbsp; When this occurs, it effectively means that 3600J can be drawn without charge.&nbsp; The Mk2 should never supply more than this amount to the load in one burst, so a safe start-up is assured.</p>
<p>Charge pulses only appear during periods of import.&nbsp; During import, the Router&#39;s energy bucket will most likely be at zero, so the control signal for the triac will be firmly &#39;off&#39;.&nbsp; Briefly enabling the path between the processor and the trigger during a charge pulse will have no effect.</p>
<p>I have always felt it would be a good idea to monitor the meter&#39;s LED because the logic within the Router could then be synchronised to that of the meter.&nbsp; By this means, no &#39;free&#39; energy would be wasted at the start of each new period of surplus power becoming available.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20643"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1164" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1164.jpg" alt="Simon&#039;s picture" title="Simon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1164" title="View user profile.">Simon</a> on Wed, 09/04/2014 - 14:58.</div>
    <div class="content">
     <p>Hi Robin, it certainly works for me and I must take the opportunity to thank you again for sharing your solutions, it has been fun getting back into &#39;hands on&#39; electronics. &nbsp; &nbsp;</p>
<p>If I were to take the watchdog solution further, and there are probably dedicated watchdog timers available now, I would set something like 555 timer up as a Monostable&nbsp;Multivibrator, with the sketch putting it into the quasi-stable mode which would enable the output buffer, and as long as the sketch hits the timer with a pulse before the RC time constant is exhausted it would keep the output, enabled assuming the red light is on as well. &nbsp;This way if the the processor locked up, or another fault as in Peter&#39;s case the output would be disabled.</p>
<p>I haven&#39;t done the watchdog circuit (I got diverted) and I think Robert&#39;s comments resonate with me, that there is only so much you can do to capture every failure condition, but with the Triac firing gated with a watchdog and the red light inputs, I think you could be very confident of staying in a safe firing mode at all times.</p>
<p>By the way Robert, I remember after University doing my EP1&nbsp;training with Mullard Electronics and spending ages having my soldering tested and checked. &nbsp;At the time it was really boring, but I have to say the techniques stuck with me, and when I fail to follow the physically strong connection before soldering, I nearly always regret it!!!!!</p>
<p>Regards and all the best</p>
<p>Simon</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20650"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Wed, 09/04/2014 - 19:29.</div>
    <div class="content">
     <p><em>This way if the the processor locked up, or another fault as in Peter&#39;s case the output would be disabled.</em></p>
<p>The protection that a watchdog circuit can offer will depend on the nature of the failure.&nbsp; If a CT were to go open-circuit for any reason, the processor would have no way of knowing that anything is wrong, so would keep on refreshing the watchdog circuit as normal.&nbsp; If the energy bucket&#39;s level happened to be above the &#39;on&#39; threshold, the triac would come on and stay on indefinitely, just as if a manually operated system had been inadvertantly left on.</p>
<p>Because the fail-safe mechanism that you have already implemented links directly to the LED of your supply meter, that arrangement seems pretty foolproof to me - better than any watchdog.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20654"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3885" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="PeterC&#039;s picture" title="PeterC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3885" title="View user profile.">PeterC</a> on Wed, 09/04/2014 - 20:04.</div>
    <div class="content">
     <p>Simon,</p>
<p>Thanks for this. You have though ahead here and predicted a failure mode. &nbsp;I agree that having a failsafe that is nothing to do with Robin&#39;s router makes sense. Especially as the meter is the beast that drives the bills.</p>
<p>Thinking this through a bit more it isn&#39;t just the terminations on the Arduino&nbsp;but the whole current coil(s) circuitry that could fail and cause intermittent faults. Robin has reduced the propensity for faults on his board very well but its the bits outside his box that are outside his control. &nbsp;</p>
<p>In my case I used a solid toroid&nbsp;CT, not the split type as i wanted to reduce the chances of failure. I was comfortable disconnecting the circuit&nbsp;inside my consumer unit and threading this through the CT. I then soldered my burden resistor onto the CT and sealed it all up to minimise the chance of mechanical damage. However I can imagine the split type being knocked about depending on where it is attached.&nbsp;</p>
<p>Could you sketch out the circuit for your design please? I am a mechanical not an electronics engineer. I know enough to be dangerous but would appreciate a design to follow. My system is back working OK now though but one broken wire and the meter spins again!</p>
<p>=====</p>
<p>(I am continuing my destratification tests and will issue the results soon. I have got a system working with an external pump. I want to offer a version with submerged pump inside the hot water tank for the more adventurous as this is more efficient ... provided the pump lives up to its speciafication when submerged at 70C. i need a few more sunny days)</p>
<p>Peter</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20684"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3885" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="PeterC&#039;s picture" title="PeterC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3885" title="View user profile.">PeterC</a> on Thu, 10/04/2014 - 21:15.</div>
    <div class="content">
     <p>Simon</p>
<p>I do not need your design after all, but others may and I think it would still be useful</p>
<p>I am fortunate enough that my relatively new Landis &amp;&nbsp;Gyr E470 meter supplied by EoN has a remote display driven by a wireless link back to the E470. I have this remote display screwed to the wall in my kitchen next to the immersion heater switch.</p>
<p>It displays all the usual Smart Meter stuff. It usefully has a running total of exported energy, so a metric specific to us that will no doubt be used in evidence against us at tariff contract renewal.</p>
<p>There are 3 (Red Amber Green)&nbsp;LEDs on the front panel representing 3 different consumption thresholds.</p>
<p>I took the back off today and it was easy for me to solder a wire onto each of these 3 signals to these LEDs. I can now make triac firing contingent upon a HIGH signal on the green LED. This makes the cross-check simple and independent of Robin&#39;s code. A solder free solution would be a photoresistor. The display&#39;s&nbsp;LEDS are very bright.</p>
<p>I believe these Smart Meters are free upon request, mine was.T</p>
<p>Peter</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20687"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Thu, 10/04/2014 - 22:09.</div>
    <div class="content">
     <p>It&#39;s good to know that my Router design works with a Smart meter.&nbsp;</p>
<p>I&#39;ve never been able to answer that question before.&nbsp; I presume that a &quot;Smart meter&quot; is nothing more than a standard digital meter with an extra remote interface for the user to look at.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20742"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3885" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="PeterC&#039;s picture" title="PeterC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3885" title="View user profile.">PeterC</a> on Sun, 13/04/2014 - 19:51.</div>
    <div class="content">
     <p>Robin,</p>
<p>Correct. It is a remote display with RF link back to the base meter in the meter box on the external wall</p>
<p>However the remote display has a push button interface and allows access to information that you cannot get from the meter itself</p>
<p>Here is a picture ... <a href="http://i.ytimg.com/vi/Dn5RQDb0r50/0.jpg" title="http://i.ytimg.com/vi/Dn5RQDb0r50/0.jpg">http://i.ytimg.com/vi/Dn5RQDb0r50/0.jpg</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20751"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3885" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="PeterC&#039;s picture" title="PeterC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3885" title="View user profile.">PeterC</a> on Mon, 14/04/2014 - 07:04.</div>
    <div class="content">
     <p>Robin,</p>
<p>(My last post does not appear to have arrived)</p>
<p>Yes it is a remote display, but it does have functionality that you cannot get at the meter itself. Display options for both gas and electricity (I have a smart gas meter too) I can enter tariff values so get cost and energy calculations and historical info as well as instantaneous. Traffic lights and a high usage buzzer all help &quot;Household Paranoia&quot; &nbsp;</p>
<p>I cannot seem to enter the URL into this site. If you Google Landis &amp; Gyr Smart Meter you will find it</p>
<p>Peter</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22208"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1704" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Keith Walker&#039;s picture" title="Keith Walker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1704" title="View user profile.">Keith Walker</a> on Fri, 27/06/2014 - 11:54.</div>
    <div class="content">
     <p>Hi Dom,</p>
<p>The sketches can look scary but they are well written and easy to change.</p>
<p>I use two loads and the changes I made to Mk2i_PV_Router_rev5a can be found on the Talking Solar website.</p>
<p><a href="http://www.talkingsolar.co.uk/index.php/forum/7-arduino-circuit-discussions/1784-multiple-loads" title="http://www.talkingsolar.co.uk/index.php/forum/7-arduino-circuit-discussions/1784-multiple-loads">http://www.talkingsolar.co.uk/index.php/forum/7-arduino-circuit-discussi...</a></p>
<p>It might help in seeing which parts of the well structured sketch need to be changed.</p>
<p>Regards, Keith</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22216"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Fri, 27/06/2014 - 14:45.</div>
    <div class="content">
     <p>Keith,</p>
<p>I really can&#39;t recommend that anyone should go looking elsewhere in search of useful refinements for any Mk2 PV Router code of mine.&nbsp; If useful new versions have been created, they should be posted here on the OEM forum where they can be peer-reviewed and checked by the author; not elsewhere in secret.&nbsp; If your group wishes to modifiy my code in private, well that&#39;s your business, but please don&#39;t interfere with the well-established processes here.</p>
<p>I have visited the Talking Solar website on a few occasions, but have seen little to recommend it.&nbsp; As I&#39;ve mentioned on another forum thread recently, my latest Mk2 software is now to be found on my own website.&nbsp; This code can be easily modified to run on any other Atmega 328 platform.</p>
<p>Robin</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22232"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sat, 28/06/2014 - 10:47.</div>
    <div class="content">
     <p>Keith,</p>
<p>Having just visited the Talking Solar website, I am disappointed to find there are various errors pertaining to my work.&nbsp; For a start, it is stated that:</p>
<p><em>For those wishing to see all the versions of the Mk2 programs and development tools he has used they are listed here -</em></p>
<p><em>openenergymonitor.org/emon/node/1757</em></p>
<p><strong><em>Some of these are Robins own work whilst others are gleaned from other OEM members.</em></strong></p>
<p>That statement is incorrect.&nbsp; <strong><u>All </u></strong>of the content of that thread has been supplied by me, that&#39;s what it&#39;s for.&nbsp; That thread is a summary of my work, which is why Trystan has kindly allocated it &#39;sticky&#39; status.</p>
<p>Rich McD has not been able to supply PCBs for some months.&nbsp; However, a full range of Mk2-related items are available via my own website, at <a href="http://www.mk2pvrouter.co.uk">www.mk2pvrouter.co.uk</a>.&nbsp; Maybe you would like to include this link at some prominent place on your website.</p>
<p>If changes are being made to my Mk2 code, and posted online, I would very much appreciate it if those changes could be posted on the Open Energy Monitor forum where they can be peer-reviewed, and where I get the chance to see them.</p>
<p>Thanks, Robin</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22395"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1704" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Keith Walker&#039;s picture" title="Keith Walker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1704" title="View user profile.">Keith Walker</a> on Tue, 08/07/2014 - 18:35.</div>
    <div class="content">
     <p>Hi Robin,</p>
<p>I&#39;m sorry that I seem to have wound you up, it&#39;s certainly not my aim.</p>
<p>But I would like to correct a few things that I&#39;m not convinced that you&#39;re not been fair about.</p>
<p>1)&nbsp; Some of these are Robins own work whilst others are gleaned from other OEM members.</p>
<p>That statement is incorrect.&nbsp; All of the content of that thread has been supplied by me, that&#39;s what it&#39;s for.&nbsp; That thread is a summary of my work, which is why Trystan has kindly allocated it &#39;sticky&#39; status.</p>
<p>------------</p>
<p>You asked me to add this in January 2013 because it was a team effort.</p>
<p>&quot;Re: Mk2a PV Router (lean, mean and fast!!)<br />
	Submitted by calypso_rae on Thu, 31/01/2013 - 20:42.</p>
<p>Thanks Keith,</p>
<p>Rich has reminded me of my user details, and will PM you about what else I would like to be changed.&nbsp; One point that I wanted to be corrected is that the phasecal algorithm was not my invention, it&#39;s been part of the standard OEM library code for as long as I&#39;ve been around.&nbsp; That one has already sorted.&quot;</p>
<p>I haven&#39;t got the PM now.</p>
<p>But you were happy with the changes that I&#39;d made.</p>
<p>&quot;Re: Mk2a PV Router (lean, mean and fast!!)<br />
	Submitted by Keith Walker on Thu, 31/01/2013 - 21:01.</p>
<p>Hi Robin,</p>
<p>I&#39;ve made the changes to <a href="http://www.talkingsolar.co.uk/index.php/robin-s-mk-2-energy-bucket" title="http://www.talkingsolar.co.uk/index.php/robin-s-mk-2-energy-bucket">http://www.talkingsolar.co.uk/index.php/robin-s-mk-2-energy-bucket</a>.</p>
<p>Can you have a look and see if it&#39;s what you&#39;re after?&quot;</p>
<p>&quot;Re: Mk2a PV Router (lean, mean and fast!!)<br />
	Submitted by calypso_rae on Thu, 31/01/2013 - 22:04.</p>
<p>Thanks Keith, that looks fine now.&quot;</p>
<p>I also seem to remember that the interrupt code was supplied by another member. So it was a team effort but with you as the leader and supplier of the idea. Which is what I had written and you had agreed. I&#39;m puzzled.</p>
<p>----------------------------</p>
<p>2) &quot;Rich McD has not been able to supply PCBs for some months.&nbsp; However, a full range of Mk2-related items are available via my own website, at <a href="http://www.mk2pvrouter.co.uk. " title="www.mk2pvrouter.co.uk. ">www.mk2pvrouter.co.uk. </a> Maybe you would like to include this link at some prominent place on your website.&quot;</p>
<p>I&#39;ll remove the link to Richard&#39;s board and replace it with your website.</p>
<p>But I&#39;ve been promoting your venture for a while.</p>
<p>Nearly 5 months ago I posted ...</p>
<p>&quot;Hi All,</p>
<p>Robin is going commercial. He&#39;s designing new hardware and will be selling kits or fully built systems. See his site below for details.</p>
<p><a href="http://www.mk2pvrouter.co.uk" title="www.mk2pvrouter.co.uk">www.mk2pvrouter.co.uk</a></p>
<p>Regards, Keith&quot;</p>
<p>I also posted this just over 2 month ago ...</p>
<p>&quot;Hi All,</p>
<p>Robin has started a commercial venture.</p>
<p><a href="http://www.mk2pvrouter.co.uk/" title="www.mk2pvrouter.co.uk/">www.mk2pvrouter.co.uk/</a></p>
<p>Good luck Robin :-)</p>
<p>Regards from us all at Talking Solar.&quot;</p>
<p>&nbsp;</p>
<p>3) As regards to making secret changes to your code.</p>
<p>The changes that I&#39;ve made for a small sweet zone for my meter were suggested by you on this site. So no modifying of your code in secret there.</p>
<p>The additions that I&#39;ve made for the multiple loads are just an minor extention to your code which I&#39;m sure I&#39;ve posted to the openenergy forum. If not I apologise. But again no secret changes.</p>
<p>I tried to post the changes on her but your forum seems to dislike Windows 7 and the latest version of IE.&nbsp; And I couldn&#39;t cut and paste. That is why I posted the link. Tonight I couldn&#39;t even log on so I typing this on a four year old Linux netbook.</p>
<p>---------------------</p>
<p>Anyway I don&#39;t wont to get in a slanging match with you but I just wanted to but my side forward.</p>
<p>I&#39;ll remove Rich&#39;s board details and replace it with another link to your site. That will be three :-) I hope they generate some sales for you :-)</p>
<p>My site was set up to share ideas on maximizing solar power usage. I used google to search for &quot;solar power excess power&quot; etc and found nothing. Goggle knows best. I now know that I should have searched for &quot;solar power immersion heater&quot;. It&#39;s paid for three years. After that it will quietly disappear but may turn into a facebook group to chat about the lighter side of solar power.</p>
<p>Stay Chilled, Keith</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22438"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Thu, 10/07/2014 - 16:55.</div>
    <div class="content">
     <p>Hi Keith,</p>
<p>I am not able to moderate any messages myself, but I&#39;m sure that those who can will be able to remove any multiple copies.&nbsp;</p>
<p>My preference is simply that anyone who wishes to contribute to the Mk2 debate should do so via the OEM forum.&nbsp; By that means, all new contributions are kept within one place and any misunderstandings can be nipped in the bud.&nbsp;</p>
<p>If anyone is following my postings via this forum, they will already be aware of the website that I have recently set up.&nbsp; Having a whole section on your own website that is dedicated to my work, but without my knowledge, agreement or consultation seems a surprising way to go.&nbsp; I don&#39;t see how it can be helping anyone.</p>
<p>Robin</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22952"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Fri, 08/08/2014 - 20:42.</div>
    <div class="content">
     <p>My original Mk2 design was intended to run on a 5V Arduino, hence the input range of the ADC was 5V.&nbsp; For the emonTx V3, the supply voltage is 3.3V hence the ADC range is correspondingly less.&nbsp; In each case, the ADC reference has always been set to its default value of Vcc.</p>
<p>The Atmega processor can also use an internally generated 1.1V reference for its ADC.&nbsp; This reduced voltage range would be a better match for many CTs which are only intended to operate up to around 0.3V rms max.</p>
<p>Running the processor in this alternative manner is very straightforward and appears to give excellent results.&nbsp; I recall trying to do this a couple of years ago but without success.&nbsp; Maybe the breadboard was causing poor connections.&nbsp; Or maybe I was in too much of a hurry ...</p>
<p>Anyway, with a more robust setup, this alternative way of working seems to be giving good results now.&nbsp; A handful of&nbsp; component values need to be changed:</p>
<p>The Vref needs to be 0.55V rather than 2.5V.&nbsp; With a 5V rail, this can be achieved using 27K and 220K in the op amp circuit, rather than both values being equal.</p>
<p>The voltage source will need to be dropped to a smaller signal, the actual values being dependent on the transformer that is being used.&nbsp; With a 6V AC transformer, I&#39;m using 2k7 and 100R.</p>
<p>With the reduced ADC range, the burden resistor needs to be smaller.&nbsp; Rather than 150R for measuring up to around 4 kW, I&#39;m now using 47R. &nbsp;</p>
<p>When using <em>analogRead()</em>, the only change that&#39;s needed for the sketch is to include <strong>analogReference(INTERNAL);</strong> within setup().&nbsp; When using the interrupt-based code, the value <strong>0x40</strong> needs to be changed to <strong>0xC0</strong> within the ISR.</p>
<p>The results below show a pair of voltage and current waveforms using this alternative arrangement when the CT is clipped around a cable through which 2 kW is flowing.&nbsp; They don&#39;t look much different than before, but the CT is now being used in a much better way.</p>
<pre>
No of cycles recorded = 1
cycleCount 2352,  samplesRecorded 53
|                                      21                                       |
|                                 2     1    v                                  |
|                            2          1         v                             |
|                         2             1             v                         |
|                      2                1                 v                     |
|                   2                   1                    v                  |
|                   2                   1                      v                |
|                   2                   1                      v                |
|                    2                  1                       v               |
|                      2                1                      v                |
|                          2            1                 v                     |
|                              2        1            v                          |
|                                   2   1      v                                |
|                                       12v                                     |
|                                   v   .1    2                                 |
|                               v       1         2                             |
|                          v            1             2                         |
|                       v               1                2                      |
|                   v                   1                   2                   |
|                 v                     1                   2                   |
|                v                      1                   2                   |
|                v                      1                  2                    |
|                v                      1                 2                     |
|                    v                  1             2                         |
|                         v             1         2                             |
|                               v       1     2                                 |
|                                    v  12                                      |
min_V 223,  max_V 819
min_I1 519,  max_I1 525
min_I2 263,  max_I2 782</pre>         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22958"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sat, 09/08/2014 - 10:23.</div>
    <div class="content">
     <p>In my original Mk2 design, the Vref output from the op amp was mid-way between its power rails, and this arrangement has always worked well.&nbsp;</p>
<p>With the alternative scheme that I posted yesterday, the Vref output is very close to the ground rail, and the LM358 device may not work well in that configuration.&nbsp;&nbsp; So although the new version appears to give similar performance when a large current is flowing, it may be that this is not a viable way for the input stages to be operated.</p>
<p>I recall the output-range limitations of the LM358 op amp being raised years ago.&nbsp; To get around this difficulty, an alternative (non-DIL) device has been used by some constructors.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22976"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sun, 10/08/2014 - 19:22.</div>
    <div class="content">
     <p>Having checked the TM358 datasheet, it seems that this device can drive its output close to the ground rail, so it should be able to generate a 0.55V rail without any problem.&nbsp; With this system in place, the level of background drift&nbsp; appears to be worse that I have previously seen, so something is not behaving as expected.</p>
<p>In all measurement circuits that I&#39;ve seen to date, the reference voltage for the sensor circuits is referenced to Vcc, and so is the ADC.&nbsp;&nbsp; With the scheme that I was suggesting, the ADC uses the internally generated bandgap reference, but the sensors continue to use a stepped-down version of the supply voltage.&nbsp; Maybe this is not a good idea.</p>
<p>By re-configuring the op-amp connections, it may be possible to use a buffered version of the internally generated 1.1V reference for the input sensors. Has anyone has tried this?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23056"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Thu, 14/08/2014 - 09:50.</div>
    <div class="content">
     <p>My recent interest in using the Atmega&#39;s internal 1.1 V reference for the ADC is in connection with a new PCB that I&#39;ve commissioned for a 3-phase version of my PV Router.&nbsp; Details of this board, and initial performance results, are on the &quot;3-phase&quot; page at <a href="http://www.mk2pvrouter.co.uk">www.mk2pvrouter.co.uk</a></p>
<p>To allow one or more SSRs to be used for controlling the loads, the new PCB can be run at 5 V.&nbsp; As this voltage level is outside the specified working range for many CTs, it would seem better to operate the ADC (and hence the CTs) using the processor&#39;s internal reference voltage of 1.1 V if possible.</p>
<p>Using a modified version of this PCB, I&#39;ve been able to buffer the internally-generated 1.1 V reference and use this to supply the reference rail for the three pairs of voltage and current-sensors.&nbsp; Although this scheme does work (some results are attached), the amount of background noise that I&#39;m seeing is considerably more than when the ADC is referenced to Vcc in the conventional manner (results on website).&nbsp;</p>
<p>On the next version of this board, I intend to include a jumper so that the Vref rail for the input sensors can be derived either from Vcc or from a buffered version of the processor&#39;s VREF pin.&nbsp; Users will then be able to choose whichever version of the hardware is best for their needs.&nbsp; For an accurate representation of the current that is being measured by the CTs, the INTERNAL (1.1 V) reference may be best.&nbsp; But for a better signal-to-noise ratio, the DEFAULT (Vcc) setting of analogReference() would probably be a better choice.</p>
<p>Although the LM358 op amp is able to work close to ground, it cannot drive its output near to the Vcc rail.&nbsp; This means that it can only be used to buffer the VREF pin when analogReference() is set to INTERNAL.&nbsp; Unfortunately, the pin-compatible rail-to-rail TS912IN device from ST is no&nbsp; longer available in DIL form.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23417"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1164" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1164.jpg" alt="Simon&#039;s picture" title="Simon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1164" title="View user profile.">Simon</a> on Fri, 29/08/2014 - 10:48.</div>
    <div class="content">
     <p>I have copied and pasted a brief PM conversation I had with Robin and his reply. &nbsp;I definitely have an issue where with three loads, and a &#39;cloud over&#39; scenario and where third load is only just on, that I can have the loads on and seemingly under control (i.e, being pulsed) and the supply meter LED is also pulsing.</p>
<p>I am playing with the&nbsp;interLoadSeparationDelay_cycles, but I&#39;ve also brought a routine in, to monitor the supply LED and make sure I don&#39;t turn on the loads if the supply meter LED is not on.&nbsp;</p>
<p>Has anybody else experienced this?</p>
<p>Having upgraded to the MK2i- 5e that&#39;s the one I&#39;ve stayed with, but as you&#39;ll see in my rather long PM, i first noticed it with MK2i-5b</p>
<p>regards &nbsp;Simon</p>
<p>New<br />
	calypso_rae 28/08/2014 - 23:37<br />
	Hi Simon,<br />
	Yes, I agree entirely with your thinking.&nbsp; If multiple loads need to be turned off, then this should happen as quickly as possible.&nbsp; A 0.5 second delay is a somewhat crude way to do this, but this mechanism does seem to do a reasonable job for most of the time.<br />
	Reducing this &quot;hold-off&quot; value from 25 to say 10 mains cycles would probably be a good idea.&nbsp; I&#39;ve never experimented with this setting.&nbsp; There has to be some delay in there so as to allow the removal of the first load to take effect.&nbsp; If two loads were to be removed when only one would suffice, that would be unhelpful.<br />
	Feel free to raise this concern on the forum.&nbsp; Maybe other people have already made changes in this area.<br />
	Regards, Robin</p>
<p>My original PM&hellip;&hellip;.</p>
<p>
	Good morning Robin, sorry for the PM, but I thought initially I&rsquo;d talk directly to you, rather than the forum, but if ends up that there is value in this discussion we can move it there.&nbsp; My hypothesis is that interLoadSeparationDelay_cycles = 25 should not be used in the reduce load algorithm?</p>
<p>Be patient with me, I am finding it quite hard to articulate, but I&rsquo;m questioning the &lsquo;backing off of loads algorithm&rsquo; when there is a quick change in PV &ndash; cloud coming over and just enough PV to be switching on 2nd load fully, and 3rd load just on.</p>
<p>1. Firstly, I had been running the MK2i - 5B on Arduino uno, adapted to have 5 hard wired outputs, 4 of which are regularly active.&nbsp; For the purpose of this question, I upgraded to the MK2i &ndash; 5E, just in case you had made a change which rectified this perceived problem, and again adapted this for just three outputs, to keep the problem simple.&nbsp; I think 5, even if you are not using them, further exacerbates the problem.</p>
<p>
	2. Bottom line is that I seem to get to a situation where the meter LED is flashing i.e importing, and the loads are being activated.&nbsp; My understanding of the supply meter LED is<br />
	a. Fully on, either exporting, or has been in the &lsquo;sweetspot&rsquo; for circa 4.5 minutes &ndash;&ldquo; see saw effect&rdquo; i.e no nett energy movement seen stays in the range of 0 - 3600J .&nbsp; I think I may have noticed one flash before it goes fully on after the 4.5 minute see saw scenario.</p>
<p>
	b. Flashing, means importing which is an unfortunate reality costing money and wrong when the loads are also on.<br />
	3. I have an AMPY 5196A supply meter, and my sensing circuit though based on your original idea has slowly deviated, but I&rsquo;m confident it&rsquo;s working effectively.</p>
<p>
	4. I have a 4kW PV array, the primary load is the immersion heater (3kW), followed by two oil filled radiators at 2kw each, all of which have their own thermostats.</p>
<p>
	5. When the primary load is on, it is rare that there is enough PV to fire up the second load, the house currently takes about 600 watts of background energy.&nbsp; It has happened a few times, highest measured generation at 3.82kW, and I might have noticed this effect then, but too rare to be sure.</p>
<p>
	6. In the situation when the immersion is up to temperature, with only one additional load i.e bog standard MK2i with noOfDumploads = 2, the system&nbsp; seems to work correctly, however&hellip;.</p>
<p>
	7. In the situation where the immersion heater is up to temperature, and noOfDumploads = 3, and there is enough PV to switch on load 2 fully, and load three partially, when a big cloud comes over, I think that load 3 is turned off immediately, then with interLoadSeparationDelay_cycles = 25, then load 2 is turned off 0.5 second later, in which time at 2kw heater has consumed 1000 Joules.&nbsp;&nbsp; So, do you need interLoadSeparationDelay_cycles on switching off loads, I think I can see the benefit of it on bringing a new load in, but I&rsquo;m suggesting it might burn energy, which you might not have, taking you back to import which may not have been necessary.</p>
<p>
	8. When the cloud goes, the energy bucket fills up, the loads are turned back on and because the software&nbsp; takes control immediately the meter light is off waiting for that 4.5 minutes timeout&nbsp; &ldquo;see saw sweet spot zone&rdquo;.&nbsp; If in this period, the light levels drops slightly, again I think it turns off load 3 immediately, which may only just be being triggered, waits 0.5 seconds to turn off load 2, in which time 2kW is dumped in that half second which is another 1000 joules.&nbsp; If this happens 2 or three times, I think we fall out of the bottom of the real supply meter energy bucket and we have a pulse on the supply meter.</p>
<p>I&rsquo;m currently running in fixed timer mode, but prior to that free running, just to see whether I could change anything?&nbsp; I&rsquo;ve attached the opening dialogue from the serial monitor, weather is currently cold wet and raining PV generating about 300 Watts, which is offsetting house load of 600 Watts, result import of circa 300i&rsquo;sh Watts</p>
<p>I&rsquo;m sorry this is rather long, but hopefully readable have you got any thoughts with your intimate knowledge of your code? Or am I totally off kilter??</p>
<p>Regards Simon</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23419"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Fri, 29/08/2014 - 11:37.</div>
    <div class="content">
     <p>The trouble with monitoring the meter&#39;s LED is that the (albeit small) financial penalty has already been applied by the time that the LED changes state.&nbsp; The ideal scenario would be to monitor the meter&#39;s LED so that the Router&#39;s operation can be synchronized to it.&nbsp; Then there would be no need to pre-charge the energy bucket because the Router would always know the precise state of the equivalent accumulator within the supply meter.&nbsp;</p>
<p>When the amount of surplus power changes suddenly, it&#39;s difficult for any system to react quickly and accurately - and with minimal flicker.&nbsp; If you can come up with a better way of controlling multiple loads in such situations, I&#39;m sure that many correspondents will be interested in this.&nbsp;</p>
<p>The router can operate correctly when the meter&#39;s LED is either continuously on or continuously off.&nbsp; If you switch off a 3kW kettle just before the next consumption pulse is due, there&#39;s a good chance that the router&#39;s see-saw motion will start up without the LED coming on.&nbsp; But if a consumption pulse has just occurred, the meter&#39;s LED is likely to come on while the energy bucket is filling up to the pre-determined point where diversion starts to occur.&nbsp; During this phase, a small amount of surplus power is being lost to the grid, this being an unfortunate consequence of the two systems not being synchronized.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23421"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1164" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1164.jpg" alt="Simon&#039;s picture" title="Simon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1164" title="View user profile.">Simon</a> on Fri, 29/08/2014 - 11:56.</div>
    <div class="content">
     <p>Totally agree, and I&#39;m not being critical of the MK2 code at all, and if I do find a better solution, I&#39;d be very surprised - ecstatic actually.</p>
<p>No, my monitoring, which may end up as a flight of fancy was to stop what &nbsp;I&#39;m getting which is <strong>multiple</strong> pulses, whilst the loads are on. &nbsp;I still don&#39;t understand it, I&#39;m not sure it is the delay I mentioned, but it only happens with two loads being actively controlled at the &#39;same&#39; time. &nbsp;i.e when the PV is generating a little more than 1 loads worth, forcing the software to switch both loads, as clouds go over. &nbsp;The multiple pulses implied totally out of sync.......I&#39;m getting to understand your code a lot more now, so some good has come from it.</p>
<p>If you remember originally I had the meter light tied to a tri-state buffer, which blocked the firing signal if it wasn&#39;t on, but I took that off, maybe time to bring it back. &nbsp;No where is it????</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23444"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Fri, 29/08/2014 - 22:05.</div>
    <div class="content">
     <p>I found that you do need delays between the triacs as otherwise the loads turn on and off much too fast. I have about 13 loads and without the delay you get rapid switching on and off of nearly all the loads.</p>
<p>Note some meters will flash the led when exporting. (Constant on is when in anticreep mode)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23446"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sat, 30/08/2014 - 07:47.</div>
    <div class="content">
     <p><em>Note some meters will flash the led when exporting. (Constant on is when in anticreep mode)</em></p>
<p>With a meter that <strong>only</strong> charges for consumption, as in the UK, a short flash of the LED undoubtedly corresponds to a chargeable amount of consumption.&nbsp; If the diversion logic were to take too much energy before allowing the system to recover, then the meter would be right to charge the user and hence isolated pulses would be seen.&nbsp; I cannot believe that pulses would ever be seen during periods of genuine export.</p>
<p>If a meter is configured to charge for energy flow in <strong>both</strong> directions, as in many parts of the world, LED pulses would presumably be seen during continuous periods of export and import.&nbsp; Many overseas correspondents have installed Mk2-type diverters in order to prevent their surplus power from being exported.&nbsp; With such systems, it would be good to know how the meter responds to reciprocating energy flow when the energy state is maintained within the sweetzone of the meter, and charges are thereby avoided.&nbsp; I would expect the LED to be either &#39;on&#39; or &#39;off&#39;, but not flashing or pulsing.</p>
<p><em>Tinbum: </em>With so many loads in your system, it seems likely that any pulses at your meter are due to over-consumption, albeit for only short periods.&nbsp; It you could post your code here, correspondents would then be able to understand how your control mechanism is actually working.&nbsp; Your code may be based on &quot;Mk2i&quot;, but it has clearly been altered in significant ways.&nbsp;</p>
<p>If you are not willing to post your code here for inspection by interested parties, then any results that you obtain with it are meaningless to the rest of us.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23447"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Sat, 30/08/2014 - 08:58.</div>
    <div class="content">
     <p>Robin,</p>
<p>What on earth are you on about?</p>
<p>I have a meter that flashes when&nbsp;I am exporting but does not increase.- full stop!</p>
<p>&nbsp;</p>
<p>The code&nbsp;I was referring to was the code you did for me in the first place with no modification at all! Try it for yourself in practice-&nbsp;I had to add delays to stop rapid sequential switching of the triacs on and off.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23471"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sun, 31/08/2014 - 20:47.</div>
    <div class="content">
     <p><em>What on earth are you on about? ... The code I was referring to was the code you did for me in the first place with no modification at all! </em></p>
<p>Tinbum: the code that I supplied for you two years ago was a trial build for multiple loads before I formally released Mk2i Rev5.&nbsp; It was never intended for long-term use and should have been replaced with the proper Mk2 Rev5 version when that became available.&nbsp; Instead, you have continued to use that original trial version and have since modified it substantially to meet your particular needs.&nbsp;</p>
<p>That&#39;s OK for your own personal use.&nbsp; What is <u>not</u> OK is to suggest that any code which you have modified - or any results from it - have anything to do with me.&nbsp; That code can no longer be realistically described my &quot;Mk2i&quot;; it is now your own code for which you have sole responsibility.&nbsp; I don&#39;t understand why you are so reluctant to post it online for others to see and inspect.&nbsp; If your modifications have been properly implemented, you will get due credit for them.&nbsp; If not, then you will learn from the experience.</p>
<p>A couple of months ago, I upgraded some of your code for you by merging in the control logic from Mk2i Rev 5 and chopping out goodness knows how much extra stuff which I didn&#39;t think had any business to be in there.&nbsp; I would certainly not recommend using that build for any serious investigations</p>
<p><em>I had to add delays to stop rapid sequential switching of the triacs on and off</em></p>
<p>How can the code be &quot;unmodified&quot;, yet include extra delays which were not in the original version ???</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23473"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Sun, 31/08/2014 - 22:01.</div>
    <div class="content">
     <p>Robin,</p>
<p>I answered a general question about delays between triacs. This is not your forum.</p>
<p>This has absolutely nothing to do with any code&nbsp;I am running. As&nbsp;I have stated before my code is available and&nbsp;I have made it available.</p>
<p>I am absolutely fed up with your attitude, start listening to what people actually say and stop trying to shoot people down. Just because<strong> <u>you</u> </strong>haven&#39;t seen something it doesn&#39;t mean it doesn&#39;t exist. Examples being;</p>
<p>1 The energy bucket of a meter always isn&#39;t 3600J</p>
<p>2 Some meters will NOT work with your code.</p>
<p>3 LED&#39;s can flash when exporting.</p>
<p>Once again you are ranting over something that doesn&#39;t exist. Go back and read what has actually been said.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23476"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/6498" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-6498.jpg" alt="sumnerboy&#039;s picture" title="sumnerboy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/6498" title="View user profile.">sumnerboy</a> on Sun, 31/08/2014 - 22:42.</div>
    <div class="content">
     <p>Tinbum - I asked for your code a while ago but unless I missed a post, haven&#39;t seen it or any link to where it might be found. Are you able to post a link now? I am very interested to see how you are switching your loads, in particular your heat pumps.</p>
<p>Also, I think it is a bit harsh to be using that kind of tone with Robin. The work he has done on this forum and for all of us in terms of writing code and developing both software/hardware is quite phenomenal. And all but the hardware is provided completely free of charge.</p>
<p>I for one am extremely grateful to Robin, and Robert and all the other chaps on here who are extremely patient and helpful when dealing with beginners like me.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23478"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Mon, 01/09/2014 - 00:38.</div>
    <div class="content">
     <p>Ben,</p>
<p>I sent the code to you, at the e mail address in your pm, on 24th August at 12.37 our time.</p>
<p>Yes it may seem harsh but&nbsp;I am sick to the teeth of everything&nbsp;I have discovered being dismissed/disbelieved or blamed on my code.&nbsp;&nbsp;It has absolutely nothing to do with my code at all. I am not stupid enough to test a meter etc &nbsp;using a code that has timers in etc etc.</p>
<p>I know exactly how my code works and any limitations it has, after all, this code has been adapted over nearly 2 years of actual practical use with many loads, 13 at present, and many different types of load. As written it is a specific code for my use, for my specific loads and my specific load priorities and load sequence. The extra stuff&nbsp; that doesn&#39;t have any business in there is there for a reason, it all starts to get quite complicated.</p>
<p>As&nbsp;I have said in the past&nbsp;I am happy to give people the code but it can&#39;t be used just out of the box as every ones requirements are different. It can only be treated as a basis to start from and&nbsp;I don&#39;t have the time to adapt it to each persons individual needs though&nbsp;I am happy to give some help on a one to one basis.&nbsp;</p>
<p>I have never said that this code is Robins or his Mk2i, or that he is responsible for it and&nbsp;I have never used it for any investigations. It&#39;s use (not working) may have resulted in me starting investigating though.</p>
<p>Like&nbsp;I have,&nbsp;you are looking at adapting a code for your use but it doesn&#39;t mean that Robin has to write it, approve it or approve of it.</p>
<p>Like you, I admire Robin for his work, as&nbsp;I have previously stated on this forum and Robert for all the help he has given to me and everyone else.</p>
<p>I must be remembered, however that this is a forum where people should work together and take things forward. I could have simply kept quiet about the size of energy buckets or that&nbsp;I had found a meter that didn&#39;t work with Robins diverter but thats not the idea of a Forum. These are problems that we should be looking at a way round, not dismissing because they don&#39;t &#39;fit in&#39; or go against previous perceived knowledge. We are all here to learn.&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23479"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Mon, 01/09/2014 - 00:49.</div>
    <div class="content">
     <p><br type="_moz" /><br />
	Ben,</p>
<p>I see you&#39;ve just found it!!</p>
<p>Nick</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23480"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/6498" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-6498.jpg" alt="sumnerboy&#039;s picture" title="sumnerboy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/6498" title="View user profile.">sumnerboy</a> on Mon, 01/09/2014 - 00:50.</div>
    <div class="content">
     <p>Apologies! The email never arrived in my inbox but I just checked my spam folder and there it is - no idea why it was marked as spam, but as I said, apologies for not noticing it - and thank you very much for sending it through.&nbsp;</p>
<p>I understand what you are saying, and I agree that the forums are for learning. I am very new to all this so am struggling to keep up with the discussions but hopefully things can remain civil and you can both continue to offer help and advice to those who are new to all this!</p>
<p>I can&#39;t wait to get my diverter built and operational as we are heading into the summer months down-under...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23485"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1164" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1164.jpg" alt="Simon&#039;s picture" title="Simon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1164" title="View user profile.">Simon</a> on Mon, 01/09/2014 - 07:39.</div>
    <div class="content">
     <p>Hi Robin, Tinbum and Sumnerboy.</p>
<p>Without trying to be the opposite of a moderator&nbsp; ---&nbsp; &ldquo;provocateur&rdquo;??, &hellip;..</p>
<p>&hellip;..the question as to whether a meter can flash without it incurring cost is an important one, has anybody else seen, or can confirm, this to be the case.&nbsp; My understanding was that each pulse is chargeable.</p>
<p>I have an Ampy 5196A in which I think the &ldquo;sweetzone&rdquo; is 3600J, and with Robin&rsquo;s MK2i -5e code, I am seeing pulses in&nbsp; normal operation (that&rsquo;s what started this recent thread), but I have modified it to add one extra load for this test. &nbsp;It seems less about the number of loads per se, but the number which are active at one time, even though only one of those loads can operate at one time, the problem I think I&#39;m seeing is when two loads are being switched. i.e enough PV to support two loads</p>
<p>Modifications are :-</p>
<p>1. const byte noOfDumploads = 3<br />
	2. const byte physicalLoad_1_pin = 10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
	3. const byte physicalLoad_2_pin = 11;<br />
	4. const float powerCal = 0.0748;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
	5. const float voltageCal = 842 / (float)679;</p>
<p>Set the new load pins to be outputs<br />
	6. pinMode(physicalLoad_1_pin, OUTPUT);<br />
	7. pinMode(physicalLoad_2_pin, OUTPUT);</p>
<p>At start up added in the set force loads to be OFF section<br />
	8. digitalWrite(physicalLoad_1_pin, physicalLoadState[1]);<br />
	9. digitalWrite(physicalLoad_2_pin, physicalLoadState[2]);</p>
<p>Added new loads to Update all other physical loads section<br />
	10.&nbsp; digitalWrite(physicalLoad_1_pin, physicalLoadState[1]);<br />
	11.&nbsp; digitalWrite(physicalLoad_2_pin, physicalLoadState[2]);</p>
<p>
	I&rsquo;m not using RF, so that boolean is set to false, but that was how the original 5e code came set.</p>
<p>Absolutely no other changes and I&rsquo;m seeing pulses, and because it only happens in a boundary condition, very hard to observe.&nbsp; Condition being:-<br />
	1. 1st load at 3kW on but no longer drawing energy, up to temp.<br />
	2. 2nd load on, at 2kW and drawing energy.<br />
	3. 3rd load marginally on, being switched, at 2kW<br />
	4. PV on the cusp of supporting that load and varying considerably &ndash; clouds!!!</p>
<p>I have tried:-<br />
	1. Removing the&nbsp; interLoadSeparationDelay_cycles in the decreaseLoadIfPossible routine, it didn&rsquo;t remove the problem, as Robin thought.<br />
	2. I&rsquo;m in process of adding a Meter LED monitor, with a &ldquo;software crowbar&rdquo; which only fire triacs if meter light on, I think I&rsquo;m on the right track, but the LED is coming in on A3, so I&rsquo;m having to work within the interrupt routine, so slow, lot&rsquo;s of learning.<br />
	3. I&rsquo;m also thinking could it be my hardware, two of the loads are on the original triac drive, the third using a solid state switch which has an external snubber circuit, and I wonder whether that is too slow to switch?</p>
<p>Any thoughts would be welcomed.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23487"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2888" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2888" title="View user profile.">Tinbum</a> on Mon, 01/09/2014 - 10:31.</div>
    <div class="content">
     <p>I know I&#39;m not anyone else but to expand on what I&#39;ve seen;</p>
<p>The thing&nbsp;I have found is that meters&nbsp;can be&nbsp;different and many can be configured in lots of different ways.</p>
<p>I was very surprised to come across a meter that will pulse the LED on export without the display increasing. The meter is a Landis and Gyr E110. No code or diverter at all involved- just wired in reverse.</p>
<p>If you PM your e mail I&#39;ll send you a video of it doing it.</p>
<p>&nbsp;</p>
<p>EDIT</p>
<p>Apologies, file was to big to e mail- its at;</p>
<p><a href="http://youtu.be/NNfcfLhiG50" title="http://youtu.be/NNfcfLhiG50">http://youtu.be/NNfcfLhiG50</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23490"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1164" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1164.jpg" alt="Simon&#039;s picture" title="Simon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1164" title="View user profile.">Simon</a> on Mon, 01/09/2014 - 10:45.</div>
    <div class="content">
     <p>Thanks for that Tinbum,</p>
<p>It certainly does show the Landis and Gyr&nbsp;E110 behaving as you described. i.e pulsing whilst exporting, and with no increase in units. &nbsp;</p>
<p>Interesting.</p>
<p>Assuming that that is &#39;vanilla&#39; product, and the same for L&amp;G E110&#39;s&nbsp;then I can&#39;t take what I thought was standard for standard.</p>
<p>My Ampy doesn&#39;t behave like that, but it &#39;s good to know that the assumption that all meters show solid on export isn&#39;t true.</p>
<p>So I&#39;m still looking for my issue, but thank you for taking the time to show that to me.</p>
<p>Regards Simon</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23492"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Mon, 01/09/2014 - 11:55.</div>
    <div class="content">
     <p><em>&quot;Assuming that that is &#39;vanilla&#39; product, and the same for L&amp;G E110&#39;s then I can&#39;t take what I thought was standard for standard.</em>&quot;</p>
<p>I think you&#39;ve hit the nail on the head there. As I understand it, more or less any meter can be programmed to the customer&#39;s specification - the customer in this case being the energy supplier - and &quot;identical&quot; meters will no doubt be the same hardware, but the firmware and hence the operating modes can be very different.</p>
<p>What we&#39;ve seen is <em>most</em> meters flash when importing, <em>most</em> meters show a steady light in anti-creep, <em>most</em> meters show no LED when exporting and ignore exported energy, <em>most</em> meters have a 3600 J quantum inside which no energy transfer is registered. But not all. We&#39;ve heard of meters with very small energy quantum, we&#39;ve heard of meters that charge for export, and now we&#39;ve heard of a meter that flashes but doesn&#39;t charge for export.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23499"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Mon, 01/09/2014 - 14:25.</div>
    <div class="content">
     <p>Tinbum, that&#39;s an interesting demonstration of how a digital meter can pulse when current flows in the reverse direction, and a useful contribution to the debate about how meters can be configured.&nbsp;</p>
<p>The role of the Mk2 PV Router is to maintain the energy state of the premises within the penalty-free range that is permitted by the supply meter.&nbsp; While the energy state remains within this range, I would not expect to see any activity at the LED, however it has been configured.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23575"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1164" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1164.jpg" alt="Simon&#039;s picture" title="Simon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1164" title="View user profile.">Simon</a> on Fri, 05/09/2014 - 11:16.</div>
    <div class="content">
     <p>Those blinking lights..</p>
<p>I need some alternative views; I can&rsquo;t think what else to try.&nbsp;</p>
<p>I have been convinced that my MK2i code modified for multiple hard wired loads is allowing the supply meter LED to pulse whilst the loads are being controlled.&nbsp;</p>
<p>From a conversation with Tinbum, it was clear that not all meters behave in the same way, but I&rsquo;m pretty sure that my Ampy 5196A, follows the norm. i.e</p>
<p>&bull; LED pulse is 1Wh of energy.<br />
	&bull; LED on either for anti-creep, or exporting.<br />
	&bull; Before entering anti-creep, my meter gives one pulse.</p>
<p>Trying to watch the lights is nigh on impossible, so I felt obliged to write a monitor mainly using Robin&rsquo;s code.&nbsp; So now I can see:-</p>
<p>&bull; Unconstrained energy movement in bucket from last cycle<br />
	&bull; Which load is active<br />
	&bull; Status of Supply Meter LED whilst showing<br />
	&nbsp; &nbsp; o Energy in bucket at point of LED transition.<br />
	&nbsp; &nbsp; o Time in milliseconds of event</p>
<p>This has clearly left me somewhat perplexed; indeed I can prove that I have situations where when loads 2 and 3 are active that the supply meter is pulsing, but to be more scientific I came up a couple of levels in thinking to be sure I wasn&rsquo;t chasing ghosts.&nbsp;</p>
<p>&bull; I disabled all the outputs and ran the code &ndash; result was supply meter LED stayed on all the time and was logged as such.<br />
	&bull; I re-enabled the loads with only enough PV to partly satisfy load 0, so no switching, and periodically the LED turns off and back on again, the period ranged from a minute between Off-On cycles to about 3 minutes, but remains consistent with a given set up, i.e amount of PV, internal parameters of the code.&nbsp; The Off-On cycle last for 1.65 seconds, give or take +/- 0.05. I&rsquo;m assuming this is a chargeable event.</p>
<p>The code appears to be working impeccably, looking at the energy, it looks in the zone.&nbsp; As a test I reduced powerCal to 0.01 from the 0.0548 to make sure that the internal energy units were smaller than the real world that did slow the Off-On event down to the lowest repeat period, but it&rsquo;s still there.&nbsp; I have currently blocked firing of the loads if the supply meter LED is not on, to stop repeat pulses, but it still switches off and on.</p>
<p>Is it a feature of the meter? &nbsp;Am I being daft? &nbsp;Any thought would be welcomed.</p>
<p>
	Here is an example of 2 logs either side of the supply meter LEDOff event:-</p>
<p>Sketch ID:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Mk2i_PV_Router_rev5e_3Loads with_Monitor.ino<br />
	ADC mode:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 125uS fixed timer<br />
	Output mode:&nbsp;&nbsp;&nbsp; normal<br />
	Priority load:&nbsp; local<br />
	Auto-select?:&nbsp;&nbsp; yes<br />
	Extra Features: none<br />
	powerCal =&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0548<br />
	phaseCal =&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.50<br />
	&nbsp; capacityOfEnergyBucket_long = 3284671<br />
	&nbsp; midPointOfEnergyBucket_long&nbsp;&nbsp; = 1642335<br />
	&nbsp; postMidPointCrossingDelay_cycles = 0<br />
	&nbsp; interLoadSeparationDelay_cycles = 25<br />
	&gt;&gt;free RAM = 908</p>
<p>
	<strong>Example 1 - load 0 Only -&nbsp;</strong><br />
	-17.13,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 0,<br />
	-1.92,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 0,<br />
	-16.59,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 0,<br />
	-20.07,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 0,<br />
	2.94,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 0,<br />
	65.35,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 0,<br />
	-51.61,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 0,<br />
	************************** LED OFF **,&nbsp; energy in bucket = 1613356&nbsp; Time mS&nbsp;&nbsp;&nbsp; 976928<br />
	-25.72,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 0,<br />
	************************** LED ON **,&nbsp; energy in bucket = 1671245&nbsp; Time mS&nbsp;&nbsp;&nbsp; 978531<br />
	16.68,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 0,<br />
	-17.14,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 0,<br />
	2.67,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 0,<br />
	9.12,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 0,<br />
	68.04,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 0,<br />
	0.00,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 0,<br />
	-14.07,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 0,</p>
<p>&nbsp;</p>
<p>
	<strong>Example 2 &ndash; Load 0 off, loads 1 and 2 on and active.</strong><br />
	6.68,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	12.49,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	************************** LED OFF ** ,&nbsp; energy in bucket = 1610375&nbsp; Time mS&nbsp;&nbsp;&nbsp; 192461<br />
	527.83,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	1744.56,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	************************** LED ON **,&nbsp; energy in bucket = 3284671&nbsp; Time mS&nbsp;&nbsp;&nbsp; 194063<br />
	-247.18,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	-1005.83,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	-123.24,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	19.52,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	-20.14,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	63.10,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 1,<br />
	0.08,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 1,<br />
	-2.63,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 1,<br />
	-26.91,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 1,<br />
	0.84,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 1,<br />
	7.42,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 1,<br />
	-16.21,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 1,<br />
	21.29,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 1,<br />
	-5.82,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 1,<br />
	-8.29,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 1,<br />
	-60.18,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	100.26,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	-61.56,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	13.04,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	-36.12,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	35.52,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	-1.84,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	-6.59,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	-39.90,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	13.52,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	3.81,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	************************ LED OFF ** ,&nbsp; energy in bucket = 1609707&nbsp; Time mS&nbsp;&nbsp;&nbsp; 219882<br />
	1671.94,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	************************ LED ON **,&nbsp; energy in bucket = 3284671&nbsp; Time mS&nbsp;&nbsp;&nbsp; 221493<br />
	910.79,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,<br />
	-846.97,&nbsp;&nbsp;&nbsp;&nbsp; Active Load,&nbsp;&nbsp; 2,</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23581"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Fri, 05/09/2014 - 14:21.</div>
    <div class="content">
     <p>Simon, how often are you displaying the energy state?&nbsp; If it&#39;s only once per second, you may not be seeing the detailed picture.&nbsp;</p>
<p>Some of my Mk2 sketches have a second energy bucket that has LED in its name.&nbsp; Maybe you could print out that value whenever any LED activity happens.&nbsp; That second accumulator has no min or max limits.&nbsp; It would be helpful to print its value out in Joules rather than in integer energy units.</p>
<p>While checking the performance of a meter, I think it would be much better to be using only one load.&nbsp; When two loads are operating sequentially, there is some &#39;dead&#39; time before the &quot;active load&quot; can change during which there could be some LED activity.&nbsp; The Mk2 logic can only maintain the required the energy state while it has control. &nbsp; There may also be some part of the AF mechanism which prevents subsequent transitions occurring within a certain period.&nbsp; These should be set so as not to interfere with your testing.&nbsp; That mechanism was an attempt to prevent transitions from occurring too rapidly - but it is very likely to result in unwanted meter activity, as you are seeing</p>
<p>Have you looked at my Digital Meter Emulator sketch, which is on my Summary Page.&nbsp; I regularly use this one when calibrating any new hardware.&nbsp; When the pulse rate is the same as my spare Ampy meter, correct calibration has been achieved.&nbsp; The optimal powerCal value can then be transferred to the relevant Mk2 sketch.</p>
<p>My DME sketch appears to mimic the Ampy meter in both forward and reverse directions, but the anti-creep simulation was never completed.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23583"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1164" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1164.jpg" alt="Simon&#039;s picture" title="Simon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1164" title="View user profile.">Simon</a> on Fri, 05/09/2014 - 14:47.</div>
    <div class="content">
     <p>Hi Robin,</p>
<p>&nbsp;the &nbsp; &quot;power = energyInBucket_4led_long * IEU_to_Joules_conversion;&quot; is what I&#39;m printing first in the line, and it&#39;s printed in line with &quot;if ((cycleCount % CYCLES_PER_SECOND) == 7)&quot; &nbsp;It was in your words a useful place to print something :-)</p>
<p>The first example has only one load, and the PV levels were too low for any other loads to get a look in.</p>
<p>I&#39;ll try the Digital Meter Emulator again, I have used it the past, but Mmmm&nbsp; not convinced it will say anything but I will try. &nbsp;Sun going down now, will try it after it&#39;s stopped to get a simple answer with no PV.</p>
<p>I think your sketch is working fine, everything I&#39;ve looked at seems good, I do wonder whether a configuration&nbsp;of an Ampy meter is possible where it does do an inverse pulse during periods of export, or am I just dipping out of the sweetzone? &nbsp;How would I know</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23587"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Fri, 05/09/2014 - 17:54.</div>
    <div class="content">
     <p>OK, so that sketch is displaying the level in the energy bucket every second.&nbsp; For your purposes, I think it would be better to display this same value only when the LED changes state.&nbsp; You need to catch every on-&gt;off transition because they are chargeable events, IMHO.</p>
<p>During consumption, if your powerCal value is correct, LED pulses should occur approx. every 3600 Joules.&nbsp;</p>
<p>During operation in &#39;normal&#39; mode, when SP is available, no LED activity should occur because the Mk2&#39;s logic can keep the energy level well within the meter&#39;s sweet-zone..</p>
<p>When in AF mode, it&#39;s all to easy to stray outside this penalty-free zone.&nbsp; However, this behaviour can be used to your advantage.&nbsp; By slackening the AF criterion, the meter&#39;s LED should start to pulse in synch with the cycling of the load.&nbsp; Then, as the AF criterion is tightened, the LED should either stay permanently on or permanently off.&nbsp;&nbsp; The two AF regimes in Mk2 code have different criteria.&nbsp; For Mk2i Rev5, it&#39;s based on time (a certain number of mains cycles); for all other versions, it&#39;s based on the separation of two energy thresholds.</p>
<p>With tightly set AF limits, and not too much delay when activating your adjacent loads, I feel sure that your system can be encouraged to work as intended.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23625"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1164" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1164.jpg" alt="Simon&#039;s picture" title="Simon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1164" title="View user profile.">Simon</a> on Sun, 07/09/2014 - 14:13.</div>
    <div class="content">
     <p>Mystery solved!</p>
<p>Mia maxima Culpa, I committed the cardinal sin of assuming something and we all know what that means!</p>
<p>I even stated it in an earlier thread, where I said I&#39;m sure that my current and voltage sensors are working well, well the current coil which was off an E.on home meter is very very non linear. &nbsp;</p>
<p>This resulted in the filling of the bucket with smaller &#39;real&#39; energy packets, and emptying with larger &quot;real&quot; energy packets, based on the size of the current being measured. &nbsp;i.e low current from PV filling bucket (cloudy), higher current Immersion, radiators when emptying. &nbsp;So the software was happily switching around the 1700 Joules mark in software, but slowly sliding out of sync with the real electricity meter. &nbsp;</p>
<p>So sorry Robin for &nbsp;even challenging your software, now the linearity problem has been addressed &nbsp;it is working perfectly, as is the previous MK2i - 5b code.</p>
<p>So thanks to all who helped,</p>
<p>Simon</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23629"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sun, 07/09/2014 - 15:24.</div>
    <div class="content">
     <p>Did you have something like <a href="http://openenergymonitor.org/emon/node/476">this Efergy transducer</a> (I can&#39;t call it a CT due to the other components present)? That&#39;s clearly designed to be a non-linear rectifier, but (and I suspect this is what you meant) a proportionally larger output at low current to give increased sensitivity there. I would guess there&#39;s a lookup table in the Efergy software that linearises the numbers post ADC conversion. Maybe even, you have a badged Efergy unit?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23634"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sun, 07/09/2014 - 18:26.</div>
    <div class="content">
     <p>Interesting that the unhelpful effects of non-linearity have now actually been observed.&nbsp; I&#39;ve been harping on about this for ages without ever seeing the consequences myself.&nbsp; The standard CT seems remarkably able to maintain good linearity when operated at higher voltage levels than are intended.</p>
<p>I wonder how effective the magic sensor is for <a href="http://www.solariboost.co.uk/">this </a>new kid on the block?&nbsp; Maybe that&#39;s why they need a 200 Watt guardband!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23765"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1164" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1164.jpg" alt="Simon&#039;s picture" title="Simon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1164" title="View user profile.">Simon</a> on Fri, 12/09/2014 - 06:58.</div>
    <div class="content">
     <p>I don&#39;t think the guard band would safeguard the system. &nbsp;</p>
<p>The problem of the non-linearity in my current coil and circuit was that I repeatedly slipped out of sync with the meter &#39;bucket&#39;, when the PV was just on, so low current towards export and&nbsp;loads were high so high current towards import. &nbsp;It was that non-linearity which got me. i&#39;e&nbsp;proportionally larger output at low current. &nbsp;(Robert mine isn&#39;t a Efergy transducer, but I haven&#39;t played with it in anger yet to see what it is).</p>
<p>I think in the past you used to use the term biased toward either import or export, mine is now biased towards export, however your algorithm picks up the heat, perfectly after the midway point, I tend not to use anti-flicker, so it works well.</p>
<p>One thing I have done is to leave the supply meter LED monitor routine in, and only allow the triacs&nbsp;to fire when the Supply meter LED is on. &nbsp;I originally&nbsp;did this in hardware with a tri-state buffer, and may re-introduce that, but for now, I cannot fire any load unless meter light is on, which gives me a &#39;warm feeling&#39;, well actually not :-))))</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23768"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Fri, 12/09/2014 - 09:44.</div>
    <div class="content">
     <p>As I understand it, the <a href="http://www.eco-master.co.uk/fully-installed-solar-iboost.htm">Solar iBoost</a> system aims to divert all but 200W of the surplus power, which is the same as having an export bias of 200W.&nbsp; My Mk2 system, when equipped with a linear front-end, is sufficiently well balanced that no biassing is required.</p>
<p>The response time of a Mk2 system is around 30mS.&nbsp; If any alternative product says that a guard band is needed to avoid being charged when loads change unexpectedly, that just shows how slow their system is to react.&nbsp; From their FAQs:</p>
<p><strong>When does my Solar iBoost start putting energy into my hot water tank?</strong><br />
	<em>As your PV array starts to generate in excess of your household power requirement the Solar iBoost will begin to &quot;dump&quot; energy into your hot water tank. For example if you have 2.2kW of export energy then the Solar iBoost will dump 2kW into the immersion to heat your tank of water. There is a buffer of 200W to ensure that the Solar iBoost deals smoothly with the changing use of household energy and the PV array&#39;s generation thus avoiding any draw from the grid.</em></p>
<p>If there were to be a small amount of residual drift between the meter and a Mk2, it would most likely be below the anti-creep threshold of the meter and therefore ignored.</p>
<p>I rest my case :D</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23771"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Fri, 12/09/2014 - 12:44.</div>
    <div class="content">
     <p>From their advertising material, it looks as if their current transformer is attached to a transmitter - the &quot;sender&quot;. They must measure both the absolute value of power and its direction (even if they make assumptions about a unity power factor), so I&#39;m wondering whether the 200 W guard band is down to the way they are obliged to measure that. If they have a transmitter measuring current, it cannot be continuous measurement due to the regulatory requirements of the band in use (unless of course they have hijacked a band reserved for radio microphones or something like that). Nor can they transmit the rms value because they need phase information as well. So I&#39;m postulating that they transmit a short burst of the current wave at intervals, so that they remain within the channel occupancy limits, and it&#39;s that which limits their response time. It&#39;s just an idea that might be completely wrong.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24858"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/6993" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Ali72&#039;s picture" title="Ali72&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/6993" title="View user profile.">Ali72</a> on Wed, 29/10/2014 - 09:12.</div>
    <div class="content">
     <p>Hello,</p>
<p>I need some guidance with the PV diverter if someone could help me please, i have the basic schematics functional and now i need to know what soft to load on my Arduino Mega board, and how to make some fine tunings.</p>
<p>My PV power is 2.4kw, and a 2kw heater. I have an AC unit that is working all day, and the max&nbsp;divert amount of power is maximum 500-1000w.</p>
<p>​Thank you in advance!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24864"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Wed, 29/10/2014 - 11:38.</div>
    <div class="content">
     <p>I assume that you have read <a href="http://openenergymonitor.org/emon/mk2">the article</a> about Robin's diverter? There are links in there to the sketches, and there's a guide in <a href="http://openenergymonitor.org/emon/Choosing%20an%20Energy%20Diverter">the introductory article</a> about which sketch to use. Having chosen one, you'll need to make changes to the pin allocations to suit your hardware.<br />
There is a lot about tuning and calibration in the comments near the top of the sketch, but feel free to ask again if anything is unclear.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24865"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/6993" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Ali72&#039;s picture" title="Ali72&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/6993" title="View user profile.">Ali72</a> on Wed, 29/10/2014 - 11:41.</div>
    <div class="content">
     <p>Hi,</p>
<p>I&#39;m lost with so much versions and i don&#39;t know what&nbsp;to choose. I not need any improvement like wireless module, only to divert the surpluss&nbsp;PV production.&nbsp;</p>
<p>Thank you!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24866"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/6993" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Ali72&#039;s picture" title="Ali72&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/6993" title="View user profile.">Ali72</a> on Wed, 29/10/2014 - 12:12.</div>
    <div class="content">
     <p>hi, I read the article, but because i&#39;m not understanding some terms and operations right now i have doubts what to choose and how to fine tune the setup. I need basic functions of the diverter without&nbsp;Wifi module or other improvements (led status) that don&#39;t affect the basic functionality. The bad parts is i don&#39;t have any spare energy meter to see if the setup is working good.</p>
<p>Thank you!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24868"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Wed, 29/10/2014 - 14:01.</div>
    <div class="content">
     <p>I think rev3a is the version you want.<br />
You will need to change:<br />
Line 89: enum operatingModes operatingMode = ANTI_FLICKER; // <-- select the desired mode here<br />
&nbsp;&nbsp;if NORMAL makes your lights flicker, then ANTI_FLICKER should reduce the problem.<br />
Line 91: #define CYCLES_PER_SECOND 50<br />
&nbsp;&nbsp;to suit your supply<br />
Line 223: const float powerCal = 0.061;  // <---- powerCal value<br />
Line 238: const float voltageCal = 800 / (float)679; // <-- the first number is the output range of your ADC when 240V AC is being measured<br />
Line 259: const float  phaseCal = 1.0;<br />
&nbsp;&nbsp;Instructions for setting these values are in the comments.</p>
<p>_________________________________________________________</p>
<p>If rev3a does not suit your supplier's energy meter (if you cannot balance the load to give zero export when you would otherwise be exporting less than 2 kW), you could use the latest (rev6a) that has an adjustment for the meter characteristic (SWEETZONE_IN_JOULES). If you do not have the radio module, you will need to remove (or comment out) <i>rf12_initialize( ... )</i> at line 371 and <i>send_rf_data( )</i> at line 652. Everything else that you do not use can remain.</p>
<p>The other things you might have to change are:<br />
Line 49: #define CYCLES_PER_SECOND 50<br />
&nbsp;&nbsp;to suit your supply<br />
Line 50: #define SWEETZONE_IN_JOULES 3600<br />
&nbsp;&nbsp;to suit your energy supplier's meter<br />
Line 208: const float powerCal_grid = 0.0346;  // for CT1</p>
<p>_________________________________________________________</p>
<p>You do not need a spare energy meter. If you can see your energy supplier's meter, that is all you need. The diverter will try to balance the energy diverted so that there is zero average energy flowing in from the grid. For example, if you are generating 2.4 kW and using 1 kW in your house, when the diverter is working correctly it will divert 1.4 kW to your heater and the supplier's meter will show zero import.<br />
You should try to calibrate the diverter as accurately as you can, but a small error will not give you a big problem, because the diverter is balancing the load around zero and it is only measuring the difference between energy imported and energy exported.</p>
<p>Which terms in the article do you not understand?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24870"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/6993" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Ali72&#039;s picture" title="Ali72&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/6993" title="View user profile.">Ali72</a> on Wed, 29/10/2014 - 14:18.</div>
    <div class="content">
     <p>Hi, i will try to load and modify the software with your indications and i let you know if everything is ok. I was lost with those operations with setting powercal, and all other ops like antiflicker&nbsp;etc....</p>
<p>Now with your explanation everything is ok, i manage to set the setup and i hope it will work good!</p>
<p>Thank you very much!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24873"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Wed, 29/10/2014 - 14:57.</div>
    <div class="content">
     <p>Hi Ali72,</p>
<p>Many different versions of my Mk2 PV Router code have been posted.&nbsp; They all do the same basic job but the later versions have some extra features that you may find to be useful.&nbsp; My <a href="http://openenergymonitor.org/emon/node/1757">Summary Page</a> has a complete list of all these sketches.&nbsp; This <a href="http://openenergymonitor.org/emon/Choosing%20an%20Energy%20Diverter">Building Blocks article</a> by Robert has a table which summarises what they all do.</p>
<p>The simplest sketch is Mk2_PV_Router_mini_3.ino.&nbsp; It may be best to try this one first on your hardware.&nbsp;</p>
<p>Robin (calypso_rae)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25139"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/6993" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Ali72&#039;s picture" title="Ali72&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/6993" title="View user profile.">Ali72</a> on Sat, 15/11/2014 - 10:25.</div>
    <div class="content">
     <p>Hello all,</p>
<p>I uploaded&nbsp;the mini 3ino.&nbsp;version to my Arduino, and it&#39;s working, the energy meter is staying or move slightly from left to right, but when another appliance&nbsp;&nbsp;is starting the diverter not put the load to off state and it still consuming from the grid. There is a setting that i miss?</p>
<p>Thank you!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25148"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sat, 15/11/2014 - 14:04.</div>
    <div class="content">
     <p>From what you write, it seems that the basic operation of the diverter is correct. But if you do not have enough PV power to support all the loads (except the heater that is the diverted load), then what you are seeing will indeed happen. If you do have enough surplus power, then there is a problem. The only possibilities that I can think of are that either your CT is not measuring the current properly (and that could be that the calibration is wrong), or that it is in the wrong place. Is the diverter CT on the grid side of the point where all the loads (including your diverted load) are connected? Does your hardware follow Robin's original circuit diagram <a href="http://openenergymonitor.org/emon/sites/default/files/Mk2_CircuitSchematic.pdf" title="http://openenergymonitor.org/emon/sites/default/files/Mk2_CircuitSchematic.pdf">http://openenergymonitor.org/emon/sites/default/files/Mk2_CircuitSchemat...</a> ?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25149"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/6993" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Ali72&#039;s picture" title="Ali72&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/6993" title="View user profile.">Ali72</a> on Sat, 15/11/2014 - 15:41.</div>
    <div class="content">
     <p>Hello,&nbsp;</p>
<p>yes, i use that schematics from your link, the calibrate is ok, right now i have an import&nbsp;&nbsp;of 90watts&nbsp;from grid&nbsp;and the serial output is tell - 96&nbsp;. If the PV is generate 1,5kw and the appliance load is 0,8kw then the serial output is positive, 710watts.</p>
<p>In this condition the Diverter load is working ok, and my 0,7kw&nbsp;Oil heater is working, but if another appliance start and the total load exceed the total PV power then the serial output is reporting me the amount used with - , but the triac is not going off and continue to import 0.7kw of power from grid.</p>
<p>Is this ok?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25150"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sat, 15/11/2014 - 16:09.</div>
    <div class="content">
     <p><i>"If the PV is generate 1,5kw and the appliance load is 0,8kw then the serial output is positive, 710watts."</i> That is correct operation.</p>
<p><i>"... but the triac is not going off and continue to import 0.7kw of power from grid."</i> That is wrong. If your total load without the heater (the one that is controlled by the diverter) is greater than the total PV power, then the diverter should be off.</p>
<p>Again, is your CT in the correct place, like this: <a href="http://openenergymonitor.org/emon/sites/default/files/mk2typical.png" title="http://openenergymonitor.org/emon/sites/default/files/mk2typical.png">http://openenergymonitor.org/emon/sites/default/files/mk2typical.png</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25151"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/6993" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Ali72&#039;s picture" title="Ali72&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/6993" title="View user profile.">Ali72</a> on Sat, 15/11/2014 - 17:52.</div>
    <div class="content">
     <p>Hi, yes the CT is clamped to the cable that came from grid&nbsp;meter before to enter in the junction box, when i export power the serial output is with positive, aca 740w, and when i import is with minus.</p>
<p>The readings are correct because i have an OWL PV meter system that is counting the import and export and have the same output like PV diverter, very close readings.</p>
<p>Only problem is the triac it is not off when i importing, i will check the schematics again to see where is the problem, but if the readings are ok, i think is some problems in the software side with the triac on off sequence!</p>
<p>My hardware is Arduino mega, but i think is not a problem.</p>
<p>&nbsp;</p>
<p>Thank you !</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25160"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1165" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="richmc&#039;s picture" title="richmc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1165" title="View user profile.">richmc</a> on Sun, 16/11/2014 - 12:34.</div>
    <div class="content">
     <p>I&#39;ve just skim read the posts from Ali, I belive he said he&#39;s using the Arduino Mega not the Uno dosn&#39;t he need to change some of the pin connections? (or better still use an Uno) I have no experence of the Mega, but something is nagging me from a previous post.</p>
<p>&nbsp;</p>
<p>And Hi everyone.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25169"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sun, 16/11/2014 - 16:26.</div>
    <div class="content">
     <p>Hi Ali, (and Rich!)</p>
<p>For the Mk2 Router to work as intended, the input sensors have to be set up correctly.&nbsp; An easy way to check this is with my RawSamplesTool, there is a link on my <a href="http://openenergymonitor.org/emon/node/1757">Summary Page</a>.</p>
<p>When a decent amount of power is flowing, the display should look something like this.&nbsp; I do this check for&nbsp; every system that I build.&nbsp; This particular display has three traces, one for voltage and two for current.&nbsp; For the basic Mk2 diverter, such as the mini_3, only one current sensor is needed.</p>
<p>4<br />
3<br />
2<br />
1<br />
0<br />
No of cycles recorded = 1<br />
cycleCount 852,&nbsp; samplesRecorded 53<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; v&nbsp; 2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br />
min_V 177,&nbsp; max_V 844<br />
min_I1 510,&nbsp; max_I1 511<br />
min_I2 248,&nbsp; max_I2 773</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25194"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/6993" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Ali72&#039;s picture" title="Ali72&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/6993" title="View user profile.">Ali72</a> on Mon, 17/11/2014 - 16:09.</div>
    <div class="content">
     <p>Hello,</p>
<p>This is what i got, it&#39;s ok or not.</p>
<p>illis() now = 0<br />
recordingMayStartAt 5000<br />
4<br />
3<br />
2<br />
1<br />
0<br />
No of cycles recorded = 3<br />
cycleCount 254, &nbsp;samplesRecorded 179<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c.v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vc. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c.v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp; &nbsp; &nbsp; &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v &nbsp;c. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |<br />
minVoltage 151, &nbsp;maxVoltage 872, &nbsp;minCurrent 509, &nbsp;maxCurrent 514</p>
<p>
Raw data from stored cycle: &lt;Vsample&gt;,&lt;Isample&gt;[cr]<br />
179, &lt;&lt;&lt; No of sample pairs<br />
525,510<br />
558,510<br />
588,511<br />
617,511<br />
644,510<br />
671,511<br />
701,511<br />
733,511<br />
747,510<br />
771,511<br />
811,511<br />
851,511<br />
861,512<br />
844,512<br />
841,512<br />
833,512<br />
830,512<br />
816,511<br />
806,511<br />
809,511<br />
812,511<br />
796,511<br />
749,511<br />
743,511<br />
712,510<br />
668,511<br />
636,510<br />
600,511<br />
565,511<br />
528,511<br />
490,511<br />
460,511<br />
429,510<br />
404,511<br />
376,511<br />
343,511<br />
318,511<br />
290,511<br />
262,510<br />
245,510<br />
193,512<br />
165,511<br />
151,510<br />
163,510<br />
173,510<br />
168,510<br />
199,510<br />
214,510<br />
194,512<br />
185,511<br />
214,511<br />
245,510<br />
249,511<br />
291,509<br />
312,510<br />
347,512<br />
387,511<br />
425,511<br />
459,511<br />
499,511<br />
535,511<br />
566,511<br />
591,511<br />
615,511<br />
645,511<br />
678,511<br />
704,511<br />
739,510<br />
765,511<br />
781,511<br />
791,511<br />
818,511<br />
809,511<br />
803,510<br />
806,510<br />
806,510<br />
808,510<br />
844,511<br />
868,510<br />
847,512<br />
802,510<br />
763,511<br />
772,511<br />
739,511<br />
693,511<br />
674,511<br />
631,510<br />
592,511<br />
555,511<br />
519,511<br />
484,511<br />
455,510<br />
426,510<br />
398,511<br />
371,510<br />
345,510<br />
314,511<br />
282,511<br />
259,511<br />
233,511<br />
226,509<br />
198,510<br />
209,510<br />
218,511<br />
210,512<br />
189,514<br />
162,511<br />
156,510<br />
195,510<br />
219,510<br />
224,509<br />
220,510<br />
267,511<br />
288,512<br />
326,511<br />
349,511<br />
384,511<br />
424,511<br />
463,511<br />
500,511<br />
538,510<br />
568,511<br />
595,511<br />
619,510<br />
647,510<br />
676,511<br />
706,511<br />
741,511<br />
758,511<br />
781,511<br />
827,511<br />
841,510<br />
866,511<br />
868,512<br />
872,511<br />
867,512<br />
860,513<br />
844,512<br />
806,511<br />
798,511<br />
809,512<br />
793,511<br />
741,511<br />
728,511<br />
702,511<br />
660,511<br />
631,510<br />
588,511<br />
552,511<br />
511,511<br />
476,510<br />
447,511<br />
421,511<br />
395,510<br />
366,510<br />
336,511<br />
303,511<br />
280,510<br />
254,511<br />
238,511<br />
197,510<br />
172,510<br />
184,510<br />
212,510<br />
215,511<br />
202,511<br />
161,510<br />
159,510<br />
190,510<br />
206,510<br />
214,510<br />
234,511<br />
270,510<br />
281,510<br />
323,511<br />
359,510<br />
394,511<br />
428,510<br />
467,510</p>
<p>I have, i think a shortcircuit between pin 6 and 5 on Moc driver, and now when i plug to 220v the input and the output to the load, the load remains off not on like before&nbsp;and i have a 0.32&nbsp;-0.99 readings, i think this is the normal behaviour&nbsp;?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25198"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Mon, 17/11/2014 - 22:05.</div>
    <div class="content">
     <p>What are those 0.32 -0.99 readings - I cannot understand what you mean there.</p>
<p>Your voltage input looks fine, if somewhat distorted on the peaks, but the current is very small. What was the actual current when you took that reading above? Which current transformer are you using, and what value is the burden resistor? It might be necessary to get more signal by increasing the value of the burden resistor, though that will mean you will have to recalibrate the sketch.</p>
<p>You should not make a connection to pin 5 of the MOC3041. The data sheets marks it as "NC" - No Connection - and a note says "Do not connect - Triac substrate".  If you have connected it, I think it is likely that the  internal triac will not operate correctly and might well have been damaged. You also need to make sure that you have connected the external triac, the BTA 41, correctly as under a very light load, the load current will be carried by the MOC3041 and the BTA 41 will not have enough current to latch.<br />
I cannot think of an easy way for you to test the driver on its own, but you can easily test the complete output circuit with a 9 V battery and a resistor of about 470 &Omega;. Connect the battery and resistor in series with the input (pins 1 &amp; 2) of the MOC3041, with the positive to pin 1. If the output turns on, and turns off when you remove the battery, it's probable that the output switch is working.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25200"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/6993" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Ali72&#039;s picture" title="Ali72&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/6993" title="View user profile.">Ali72</a> on Tue, 18/11/2014 - 06:46.</div>
    <div class="content">
     <p>HI, the readings that i posted was with a broken wire from CT sensor, after repair it looks good and the 0,..-0,... readings disappeared and instead the corect&nbsp;import at that time was displayed aka -134. After i remove the shortcircuit&nbsp;from the MOC driver,&nbsp;the triac stay finally&nbsp;off when the readings are with minus and i hope today will have some PV output to see if the diverting is working ok.</p>
<p>Thank you all for support, have a good day!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25223"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 18/11/2014 - 14:10.</div>
    <div class="content">
     <p>It's funny how the manufacturer tends to know how their device should be used. You should <b>ALWAYS</b> follow their data sheet examples.</p>
<p>And I've checked Robin's circuit diagram too - that is also correct to the data sheet.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27920"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="dmyorks&#039;s picture" title="dmyorks&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by dmyorks (not verified) on Thu, 19/02/2015 - 09:19.</div>
    <div class="content">
     <p>3kw immersion/mk2 blowout - what happened next....? Real life example</p>
<p>There was a discussion back in the early days of mk2 around short circuit protection for the triac - in the end deemed too expensive vs low triac cost and (relatively) easy swapout.</p>
<p>Last weekend my immersion failed/shorted due to normal age/corrosion issues whilst my early version mk2 was running. here's what I found.</p>
<p>Old style fuse wire went off with a bang in the consumer unit,and the mk2 stopped working.</p>
<p>On opening up the box, I found the triac switched live had burned through at the crimped switch terminal on the override switch. No signs of overheat/damage to the triac.</p>
<p>With hindsight looks like the fuse wire could have been incorrectly spec'd (but no easy way to tell - will replace with a breaker) but reassuring that heatsink/triac could hang in there regardless. With a new crimped live was back up and running in no time !</p>
<p><i>[Duplicate post deleted - Moderator (RW)]</i></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27970"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Fri, 20/02/2015 - 08:41.</div>
    <div class="content">
     <p>Interesting, I&#39;ve heard about a few cases of crimped connections failing.&nbsp; Apart from the screw connectors which are rated at 25A minimum, all power connections in Mk2 systems that I build are soldered.&nbsp; So in the event of an immersion heater becoming shorting out, it would be a direct battle between the fuse/circuit-breaker and the triac as to which would survive the longest.</p>
<p>Providing that the immersion still presented some resistance, the overload current would only be present for a fraction of the time.&nbsp; The system may be able to struggle on in this state until the surplus power exceeded some limit, and then something would have to give.</p>
<p><em>On opening up the box, I found the triac switched live had burned through at the crimped switch terminal on the override switch. No signs of overheat/damage to the triac.</em></p>
<p>I wonder why the circuit failed at this point.&nbsp; Power doesn&#39;t normally flow through the override switch.&nbsp; Maybe that connection had already quietly expired.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37893"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/8593" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="saggers&#039;s picture" title="saggers&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/8593" title="View user profile.">saggers</a> on Tue, 05/01/2016 - 10:32.</div>
    <div class="content">
     <p>I'm trying to calibrate a arduino pv router using the sketch cal both displays. I dont have a display but it says it also sends the information to the serial port. I've set the correct analogue pins for my voltage and current sensors. And I've made sure the pin saving hardware is blanked out. The program runs. Prints some information on the serial page on the connected laptop but doesn't appear to show current draw on my ct. Any ideas where I'm going wrong? </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37895"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 05/01/2016 - 11:37.</div>
    <div class="content">
     <p>There isn't a sketch of Robin's called "cal both displays". Exactly which one of Robin's many sketches are you using?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37897"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Tue, 05/01/2016 - 13:10.</div>
    <div class="content">
     <p>The sketch <strong><em>cal_bothDisplays_1.ino</em></strong> is available from my website via the <a href="http://mk2pvrouter.co.uk/13601.html">Downloads page</a>.&nbsp; It is a version of my interrupt-based Mk2i PV Router code which displays the measured value for either of two channels via the 4-digit display that is supported by my own PCB.&nbsp;</p>
<p>The sketches on my website are intended for people who are using my own hardware.&nbsp; The same software will run on any Atmega 328 platform such as the emonTx or Arduino Uno, but the IO port allocations may need to be changed.</p>
<p>If anyone wants one, my original 1-phase Mk2 PV Router PCB is available for the cost of the postage.&nbsp; This has a minor tracking error which is easy enough to fix.&nbsp; Kits of parts, including for the display, are also available via my <a href="http://mk2pvrouter.co.uk/13779.html">Shop page</a>, as are my email details.</p>
<p>All of the software on my website is available in an equivalent form (for the emonTx) via my <a href="http://openenergymonitor.org/emon/node/1757">Summary page</a> on this forum.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37899"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/8593" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="saggers&#039;s picture" title="saggers&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/8593" title="View user profile.">saggers</a> on Tue, 05/01/2016 - 13:33.</div>
    <div class="content">
     <p>That's it the cal_bothdisplays_1.ino sketch. The sketch it linked to had to be copy and pasted to Arduino as it didn't download just display it on the web page. I've changed the ok pins to what I have set up and not much happens. Should it give constant readings or is it a one time measurement? Thanks</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37901"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 05/01/2016 - 15:34.</div>
    <div class="content">
     <p>Sorry, I only know the sketches that are posted here, and what I think Robin is saying is if you buy his hardware, he'll support that. But if you buy your hardware from elsewhere, then it's up to you to get it working, as he cannot know exactly what you have and how you have connected everything.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37918"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Tue, 05/01/2016 - 20:34.</div>
    <div class="content">
     <p>The Easily website that I use appears to have changed the way that files are accessed.&nbsp; Rather than being downloaded with a randomized name, the file now opens up in a new window.&nbsp; This may be a better way for the requested information to be accessed.</p>
<p><em>Should it give constant readings or is it a one time measurement?</em></p>
<p>Looking at the section of code in question, the data for the 4-digit display is updated each second with the appropriate value in Watts.&nbsp; The same data is sent to the Serial Monitor by means of a Serial statement in the called function, <em>configureValueForDisplay()</em>.&nbsp; This process will repeat endlessly, once per second, while the sketch is running.</p>
<pre>
        // Once per second, the contents of the selected accumulator is
        // converted to Joules and displayed as Watts.  Both accumulators
        // are then reset.
        //
        if(perSecondCounter &gt;= CYCLES_PER_SECOND)
        {
          perSecondCounter = 0;   
          int powerInWatts;
          
          if(powerChannel == GRID) {
            powerInWatts = energyThisSecond_grid / IEU_per_Joule_grid; }
          else {
            powerInWatts = energyThisSecond_diverted / IEU_per_Joule_diverted; }
          
          configureValueForDisplay(powerInWatts);
          energyThisSecond_grid = 0;
          energyThisSecond_diverted = 0;
        }
        else
        {
          perSecondCounter++;
        }

</pre>         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37988"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/8593" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="saggers&#039;s picture" title="saggers&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/8593" title="View user profile.">saggers</a> on Thu, 07/01/2016 - 18:31.</div>
    <div class="content">
     <p>OK my bad. After a post on here about what I wanted to achieve I was thinking that buying an emon tx shield would allow me to do pv diversion, energy and temperature monitoring. So I bought the parts then realised it was not a simple job to make it all work. I then decided to just use the shield for the pv diversion for the current and&nbsp;voltage sensor, and have bought an emon v3 and emonbase for my energy monitoring, keeping the 2 seperate. I was thinking I just had to adjust the sketch with regards to the io pins, calibrate it and away I go, using an ssr as the output. This is when the problems started. I have since come across this post, and after looking at the schematics for both devices realise the input electronics is completly different.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39900"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mk2 PV Controller, with triac</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sat, 27/02/2016 - 19:08.</div>
    <div class="content">
     <p>Right from the start of this project in 2012, the DC content has been removed from the stream of voltage samples by subtracting a DC offset value.&nbsp; This value is determined by a Low Pass Filter which is updated ever mains cycle.&nbsp; During each mains cycle, the difference between each new V-sample and the DC Offset value is determined and added to an accumulator.&nbsp; By the end of the cycle, these &#39;signed&#39; offsets will have largely cancelled themselves out.&nbsp; 1% of any residual value is fed back into the filter.</p>
<p>The above description is based on how this logic has always worked, which is not as I intended.&nbsp; My intention was that the feedback should be 1% of the <em><strong>average </strong></em>offset of the ~50 samples during the preceding mains cycle, not 1% of their total.&nbsp; When 50 values are summed, the average value will be 0.02 of their total.&nbsp; Hence the required amount of feedback will be 0.01 x 0.02 = 0.0002, rather than 0.01 as has been always used to date.</p>
<p>With such a large amount of feedback, the DC Offset is unlikely to remain at a constant level as was intended.&nbsp; Instead, it jumps back and forth around the correct point.&nbsp; So why hasn&#39;t this caused a problem with the operation of any Mk2 PV Router code? &nbsp; Although the DC offset at any one moment may not be correct, any consequential error will soon be lost when averaged over several mains cycles.&nbsp; However, the system will clearly work better when the DC removal scheme is set up as intended, hence my posting this update now.</p>
<p>The latest version of my original &#39;Mk2&#39; code which uses <em>analogRead()</em> is <em>Mk2_PV_Router_mini_3.ino</em>.&nbsp; The port allocations for this code were made for the emonTx V2.&nbsp; I have today updated the LPF section of this code as above, and checked its performance on an emonTx v2 (photo).&nbsp; The new version is attached as <em>Mk2_PV_Router_mini_3a.ino</em>.&nbsp; The only change of significance between these two versions is that &quot; * 0.01&quot; has become &quot; * 0.0002&quot;.</p>
<p>For the later &#39;Mk2&#39; code which is based on integer maths, the feedback portion was derived using a right-shift of 2^6 = 64.&nbsp; The exact value does not matter; 2^7 would work just as well.&nbsp; But this amount of right-shift is only appropriate when the <strong><em>average </em></strong>DC offset value is being used, rather than the total.&nbsp; When applied to the total of 50+ values, the feedback portion should be correspondingly smaller.</p>
<p>The latest code in my &#39;Mk2i&#39; line is <em>Mk2i_PV_Router_rev6a.ino</em>.&nbsp; Most of the Mk2 code on the <a href="http://mk2pvrouter.co.uk/13601.html">Downloads page </a>of my own website is based on this Mk2i line.&nbsp; The LPF implementation is identical for both.&nbsp; To correct the amount of feedback in this code simply requires that &quot;&gt;&gt;6&quot; be changed to &quot;&gt;&gt;12&quot;.&nbsp; The updated section looks like this:</p>
<pre>
if (polarityConfirmedOfLastSampleV != NEGATIVE)
{
  // This is the start of a new -ve half cycle (just after the zero-crossing point)
  // which is a convenient point to update the Low Pass Filter for DC-offset removal
  // The portion which is fed back into the integrator is approximately one percent
  // of the average offset of all the Vsamples in the previous mains cycle.
  // 
  long previousOffset = DCoffset_V_long;
  DCoffset_V_long = previousOffset + (cumVdeltasThisCycle_long&gt;&gt;12);
  cumVdeltasThisCycle_long = 0;
</pre><p>The same change will be appropriate for any &quot;continuous&quot; code that is based on any of my offerings to date.&nbsp; As far as I am aware, the text string &quot;&gt;&gt;6&quot; does not occur anywhere else in my code.&nbsp; So wherever this string appears in this context, it would seem sensible to change it to &quot;&gt;&gt;12&quot; at the earliest opportunity</p>
<p>My apologies for the inconvenience caused.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<div class="item-list"><ul class="pager"><li class="pager-first first"><a href="/emon/node/841" title="Go to first page" class="active">« first</a></li>
<li class="pager-previous"><a href="/emon/node/841?page=1" title="Go to previous page" class="active">‹ previous</a></li>
<li class="pager-item"><a href="/emon/node/841" title="Go to page 1" class="active">1</a></li>
<li class="pager-item"><a href="/emon/node/841?page=1" title="Go to page 2" class="active">2</a></li>
<li class="pager-current last">3</li>
</ul></div><form action="/emon/node/841?page=2"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-YtnQ5UP2_F6NF1cQ-ZOb1ZFlSC73RR6SajpI0qY1CLU" value="form-YtnQ5UP2_F6NF1cQ-ZOb1ZFlSC73RR6SajpI0qY1CLU"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org">https://community.openenergymonitor.org</a></p>
   
</div>

<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
