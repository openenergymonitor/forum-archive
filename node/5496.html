<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/5496 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:27:43 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>PLS HELP: Counting S0-pulses and monitoring. --&gt; redis and Windows | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">PLS HELP: Counting S0-pulses and monitoring. --&gt; redis and Windows</h3>
        <span class="submitted">Submitted by <a href="../user/6717.html" title="View user profile.">brutzler</a> on Fri, 01/08/2014 - 18:51</span>
        <div class="content"><p>Hi,</p>
<p>Now I am desperating.....</p>
<p>I am measuring one S0-Counter from the power supply of a heating-pump and two DHT22-sensors (temp and humidity) with an arduino board. Then sending a &quot;Get http...&quot;-string with these 5 values to emoncms. Sending with a sample rate of 30 sec.&nbsp;<br />
	The s0-counter makes 2000 imp/kWh.</p>
<p>My processes for this input are:</p>
<ul>
<li>
		x 0.0005</li>
<li>
		Accumulator</li>
<li>
		kWh to kWh/d</li>
<li>
		kWh to power</li>
</ul>
<p>But I do not see any values on kWh/d In the feeds there is an inactive</p>
<p>Can I add the 4th process= Is this working?. Because there is an inactive too.</p>
<p>The Wh_accumulator stays inactive too, when i use it.</p>
<p>&nbsp;</p>
<p>Actually I do not know how to go on. Every hint would be appreciated.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="5527.html" class="topic-previous" title="Go to previous forum topic">‹ emoncms.org upgrade to v8.3.5 breaks the zoom visualisation</a>
              <a href="5538.html" class="topic-next" title="Go to next forum topic">Use existing data loggers to feed server ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-22853"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PLS HELP: Counting S0-pulses and monitoring. --> redis and Windows</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sat, 02/08/2014 - 15:21.</div>
    <div class="content">
     <p>What do you have working on that processchain?</p>
<p>I recommend creating a &quot;test&quot; log to feed, move that up the chain to the top, position 1.</p>
<p>Observe &quot;test&quot; and if you are happy with what you see move &quot;test&quot; down to position 2 and so on, checking the output at each stage.</p>
<p>What does this input receive? I assume it&#39;s pulses since last update.&nbsp;</p>
<p>You could try accumulating in watts rather than kw&#39;s if the change is too small to register&nbsp;</p>
<p>&nbsp;</p>
<ul>
<li>
		x 0.5</li>
<li>
		accumulator</li>
<li>
		x 0.001</li>
<li>
		kWh to kWh/d</li>
<li>
		kWh to power</li>
</ul>
<p>If the accumulator was working I would expect the &quot;kWh to kWh/d&quot; and &quot;kWh to power&quot; to work as expected.&nbsp;</p>
<p>Tell us what values you have and we may be able to spot something</p>
<p>Paul</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22855"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6717.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="brutzler&#039;s picture" title="brutzler&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PLS HELP: Counting S0-pulses and monitoring. --> redis and Windows</h3>

    <div class="submitted">Submitted by <a href="../user/6717.html" title="View user profile.">brutzler</a> on Sat, 02/08/2014 - 18:10.</div>
    <div class="content">
     <p>Hi Paul,</p>
<p>ok.. here some more infos:</p>
<p>Yes the input is pulse since last input. As i told you, i am reading a single-phase&nbsp; S0-counter with 2000 imp/kWh.</p>
<p>For testing my feeds, i am actually simulating a power consumption of 1200w/h. therefore i let my arduino send a value of 20 every 30sec.</p>
<p>I see the difference to my process list is only that you accumulate W instead of kW.</p>
<p>As expected: x 0.5/accu/x 0.001 is working as expected.</p>
<p>But the feeds after the processes kWh to kWh/d and kWh to power are the same as after the accumulator. And both processes are declared as inactive in the feeds-list. For this step I made two feeds.</p>
<p>&nbsp;</p>
<p>I have made some screenshots and put it into a pdf. Hope this is readable for you.</p>
<p>&nbsp;</p>
<p>Actually I am working with&nbsp; v8.2.8</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22856"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PLS HELP: Counting S0-pulses and monitoring. --> redis and Windows</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sat, 02/08/2014 - 18:49.</div>
    <div class="content">
     <p>The last 2 graphs show the accumulated total is being passed through the&nbsp;&quot;kWh to kWh/d&quot; and &quot;kWh to power&quot; processes but the the &quot;feeds&quot; screenshot shows those 2 feeds are inactive.</p>
<p>The first line of both the <a href="https://github.com/emoncms/emoncms/blob/master/Modules/input/process_model.php#L301">&quot;kWh to kWh/d&quot; process</a>&nbsp;and the <a href="https://github.com/emoncms/emoncms/blob/master/Modules/input/process_model.php#L515">&quot;kWh to power&quot; process&nbsp;</a>&nbsp;is basically a bypass if redis is not available, so it looks like that maybe where the issue lies, do you have redis&nbsp;installed? and is the <a href="https://github.com/emoncms/emoncms/blob/master/default.settings.php#L14">redis setting set to true</a> in the settings file?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22857"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6717.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="brutzler&#039;s picture" title="brutzler&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PLS HELP: Counting S0-pulses and monitoring. --> redis and Windows</h3>

    <div class="submitted">Submitted by <a href="../user/6717.html" title="View user profile.">brutzler</a> on Sat, 02/08/2014 - 19:09.</div>
    <div class="content">
     <p>Hi,</p>
<p>I found what you talking off:<strong> -</strong>&gt; &quot;process_model.php&quot;</p>
<p><strong>if (!$redis) return $value; // return if redis is not available</strong></p>
<p>&nbsp;</p>
<p>But actually I never heard about redis :-(</p>
<ul>
<li>
		YES Redis is enablet in settings. That was already true in the &quot;emoncms-master&quot;</li>
<li>
		And NO, i did not install it seperately. Never read in the installation doc, that this is neccessary.&nbsp; -&gt; <a href="http://emoncms.org/site/docs/installwindows">http://emoncms.org/site/docs/installwindows</a></li>
</ul>
<p>Can it be, that the doc-file is rather old, and the need of redis was coming up later?</p>
<p>Now i will have a look, how to install under Windows. will reply after then.</p>
<p>&nbsp;</p>
<p>Thanx for your quick and good help.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22858"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6717.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="brutzler&#039;s picture" title="brutzler&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PLS HELP: Counting S0-pulses and monitoring. --> redis and Windows</h3>

    <div class="submitted">Submitted by <a href="../user/6717.html" title="View user profile.">brutzler</a> on Sat, 02/08/2014 - 20:28.</div>
    <div class="content">
     <p>Oh oh...looks not good</p>
<p>have found this thread: <a href="3451.html">http://openenergymonitor.org/emon/node/3451</a></p>
<p>Sounds like a knock-out for us windows user. Or take a very early release (&lt;7.0)</p>
<p>Thought it would be a workaround to take the mysql-engine instead of the PHPFIWA. --&gt; inactive</p>
<p>&nbsp;</p>
<p>Makes me somehow disappointed. A very good software, spent much time on getting it run, and then such an end :-(</p>
<p>&nbsp;</p>
<p>The main question is now for me: Why do functions like &quot;power_to_kWh&quot; run without probs (and without redis) and &quot;kwh_to_kwhd&quot; need redis???</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Update:</p>
<p>New hope??</p>
<p><a href="3749.html">http://openenergymonitor.org/emon/node/3749</a></p>
<p>In this thread Trystan talks about optional redis. This was in March 2014. Having a release from July, i was in hope that this would be already implemented. Hmmm...&nbsp; Naive as I am, i tried to set the redis_enabled on false in the settings.php. But this was without success..</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22860"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PLS HELP: Counting S0-pulses and monitoring. --> redis and Windows</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sat, 02/08/2014 - 21:21.</div>
    <div class="content">
     <p>I&#39;m afraid I&#39;m getting getting a little&nbsp;out of my depth here, I don&#39;t run emoncms on windows, I&#39;ve no experience of pulse counting and I&#39;m stlll&nbsp;learning about the feed engines myself.</p>
<p>You could take a look at &nbsp;<a href="https://github.com/emoncms/emoncms/blob/master/Modules/input/process_model.php#L388-L404">&quot;Wh increments to kWh/d&quot;</a> I think it may help, or if you are updating every 30secs and the pulses since last update are 20, surely 20x0.5=10w per30secs&nbsp;x 120 = 1200w/hr therefore input x 60 (0.5x120)= power so you could use</p>
<ul>
<li>
		x 60</li>
<li>
		log to feed &quot;power in watts&quot;</li>
<li>
		power to kwh</li>
<li>
		power to kwh/d</li>
</ul>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22862"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6717.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="brutzler&#039;s picture" title="brutzler&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PLS HELP: Counting S0-pulses and monitoring. --> redis and Windows</h3>

    <div class="submitted">Submitted by <a href="../user/6717.html" title="View user profile.">brutzler</a> on Sat, 02/08/2014 - 22:16.</div>
    <div class="content">
     <p>OK,</p>
<p>you even helped me a lot. Thx for this</p>
<p>3 new ways for me:</p>
<ul>
<li>
		&nbsp;Take releas &lt;7.0 (not so good idea, I think)</li>
<li>
		calculate via power as you suggest.</li>
<li>
		&quot;Wh increments to kWh/d&quot; . Is declared in the process_model.php as &quot;<u><strong>k</strong></u>whinc_to_kwhd&quot; . Will have to see. If so, then its only a factor of 1000</li>
</ul>
<p>&nbsp;</p>
<p>But parallel i will go on and look for the &quot;optional redis&quot; stuff.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22997"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6717.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="brutzler&#039;s picture" title="brutzler&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PLS HELP: Counting S0-pulses and monitoring. --> redis and Windows</h3>

    <div class="submitted">Submitted by <a href="../user/6717.html" title="View user profile.">brutzler</a> on Tue, 12/08/2014 - 07:06.</div>
    <div class="content">
     <p>Made it now in a different way.</p>
<p>I do not count any more the pulses with my arduino. I am measuring the time between two pulses, and calculating the actual power on the arduino. Then sending the power-value to emoncms and</p>
<ul>
<li>
		log to feed &quot;power in watts&quot;</li>
<li>
		power to kwh</li>
<li>
		power to kwh/d</li>
</ul>
<p>like Paul suggested.</p>
<p>So i have a better resolution. and can make an average-calculation over some values if necessary.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/5496"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-hZ442oVn4QtXs2yIXHCl2F4bTAzbsQsiq7YdPLFskSU" value="form-hZ442oVn4QtXs2yIXHCl2F4bTAzbsQsiq7YdPLFskSU"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
