<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Smaller current CT? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/emon/sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="/emon/modules/node/node.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/defaults.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/system.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/system-menus.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/user/user.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/modules/mollom/mollom.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/forum/forum.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/modules/views/css/views.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/comment/comment.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/themes/emon3/style.css?r" />
<style type="text/css" media="all">@import "/emon/sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="/emon/" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="/emon/">Home</a> » <a href="/emon/forum">Forums</a> » <a href="/emon/forum/4">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Smaller current CT?</h3>
        <span class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Mon, 17/12/2012 - 19:54</span>
        <div class="content"><p>The CT clamp which comes with the EmonTX kit is rated up to 100A but, of course, our domestic current consumption will rarely get up anywhere near 100A.</p>
<p>As I understand it, we would get more accuracy if we used a CT clamp which more closely matches the load used.&nbsp; Is this correct?&nbsp; And, if so, is anyone aware of a source of split-core CT clamps around the 40Amp mark?</p>
<p>Thanks,</p>
<p>Jack</p>
  <div class="forum-topic-navigation clear-block">
          <a href="/emon/node/3289" class="topic-previous" title="Go to previous forum topic">‹ Problem in setting up CT sensor with arduino</a>
              <a href="/emon/node/10174" class="topic-next" title="Go to next forum topic">Raspberry Pi 2 or Intel NUC ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-8313"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Mon, 17/12/2012 - 20:38.</div>
    <div class="content">
     <p>In short, yes and no. There are c.t&#39;s for smaller primary currents, but they tend to have 1 V p-p outputs maximum, which rather negates any advantage that the smaller ratio gives you - unless you run your Arduino with a 1 V reference.</p>
<p>The YHDC 30 A c.t. appears to be the same unit as the 100 A version, but with an added internal burden.</p>
<p>I&#39;m pretty sure a lot of people here would like to have one, if it exists at a reasonable price.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8323"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Tue, 18/12/2012 - 10:16.</div>
    <div class="content">
     <p>Thanks for the reply.&nbsp; Yeah, I&#39;ve only been able to find split-core CT clamps with voltage outputs (either 1V or 0.333V).&nbsp; How hard would it be to convert the EmonTX to use a 1V reference or to amplify the input voltage?&nbsp; (I&#39;m sorry, I&#39;m somewhat clueless about analog electronics - I know we can use an op-amp to amplify a voltage but I don&#39;t know how easy it is to ensure that amp has a linear response)&nbsp; Actually, <a href="https://forum.sparkfun.com/viewtopic.php?f=14&amp;t=23105">here&#39;s a great forum topic on the sparkfun forum</a> where someone uses an op-amp with a CT clamp.</p>
<p>Just for reference, here are the split-core CT clamps I found:</p>
<ul>
<li>
		Farnell stock the SCT-0400-005 and -025 and -050 (the last number indicates the input current).&nbsp; These each cost &pound;18.88 (inc VAT) and produce a 0.333V output at rated current</li>
<li>
		The middle of<a href="http://imall.iteadstudio.com/electronic-components/sensor/im120628007.html"> this page</a> gives a table giving the input current and output mode for the SCT-013-000, -005, -010, -015, -020, -025, -030, -050 and -060.&nbsp;<strike> The SCT-013-000 is the model used with the EmonTX and produces a 33mA current.</strike>&nbsp;&nbsp; [Edited by Robert Wall: This is incorrect, it is 100 A / 50 mA]</li>
<li>
		All others produce a 1V output.&nbsp; Many of these models are also available on eBay.</li>
<li>
		Rapid sell a wide range of split-core CT clamps made by Manutech.&nbsp; These all produce a 0.333V AC output at rated current (although a couple of expensive clamps are listed as having &quot;no burden resistor&quot;). Prices range from &pound;13 to &pound;81 per clamp.</li>
</ul>
<p>(edit: I&#39;ve had to remove most the links in order to not trigger the forum&#39;s spam filter.&nbsp; I know spam is a PITA to filter but surely it&#39;s a mistake to disallow users to post links to on-line shops in a forum where folks discuss DIY electronics projects?)</p>
<p>After monitoring our home&#39;s power consumption for a while, I can safely say that we very rarely draw above 5kW (22Amps) so I&#39;d be very, very eager to use a 25 or 30 Amp CT on our main supply (and maybe a 5Amp CT on our lighting circuit)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8330"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 18/12/2012 - 11:10.</div>
    <div class="content">
     <p>Sorry Jack, I&#39;ve had to edit your post. The site you quote is untrustworthy and the particular data I&#39;ve deleted is simply wrong. <a href="http://openenergymonitor.org/emon/buildingblocks/report-yhdc-sct-013-000-current-transformer">See here</a>. Please don&#39;t publish false &quot;facts&quot;.</p>
<p>As you&#39;re adding extra electronics anyway, it would be quite simple to amplify the c.t. output. I&#39;ve no idea where you get the idea that the output won&#39;t be linear, any distortion that the amp adds will be a couple of orders of magnitude less than the c.t&#39;s own distortion. The problem you will have is limiting the output to the reference voltage of the ATMega.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8332"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Tue, 18/12/2012 - 11:49.</div>
    <div class="content">
     <blockquote><p><em>The site you quote is untrustworthy and the particular data I&#39;ve deleted is simply wrong</em></p>
</blockquote>
<p>Woops, sorry.&nbsp; I had assumed that data from the distributor would be correct (especially given that I&#39;d seen that data from two separate distributors).&nbsp; Sorry (I hate incorrect info as much as anyone!)</p>
<blockquote><p><em>As you&#39;re adding extra electronics anyway, it would be quite simple to amplify the c.t. output.</em></p>
</blockquote>
<p>OK, great - I might well give that a go&nbsp; if I get time.</p>
<blockquote><p><em>I&#39;ve no idea where you get the idea that the output won&#39;t be linear</em></p>
</blockquote>
<p>I simply didn&#39;t know whether it would be linear or not - I felt it best not to assume it would be.&nbsp; But thanks for clarifying that it&#39;ll be more than sufficiently linear.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8336"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Tue, 18/12/2012 - 12:44.</div>
    <div class="content">
     <p>Thinking a bit more about this... I&#39;m thinking of using 2 CT clamps...</p>
<p>The CT clamps SCT-400-005 and SCT-400-025 (both of which are available from Farnell and both produce 0.333V at their rated currents) have an accuracy of +-1% from 10%-130% of their rated current.&nbsp; Which means the 25 Amp version maintains its 1% accuracy from 2.5Amps upwards.&nbsp; 2.5A is still considerably more than our houses uses most of the time (we usually use around 1 Amp).&nbsp; So I&#39;m thinking of using two CT clamps: a 5 Amp and a 50 Amp.&nbsp; The 5 Amp is accurate down to 0.5 Amps whilst the 50 Amp is accurate down to 5Amps.&nbsp; They would each have their own op-amps set to ensure that the ATMEGA never sees &gt; 3.3v (I assume that if the op-amp is powered from a 3.3v source then it&#39;ll never be able to produce &gt; 3.3v).The outputs from these op-amps would feed separate analog input pins on the ATMEGA.&nbsp; Then the code just needs some simple logic to decide which of the two op-amps to use (if the 5A input is saturated then use the 50A input).</p>
<p>What worries me now is: what would happen to a 5A CT clamp if exposed to 50 Amps? (assume that nothing bad will happen but I haven&#39;t been able to find anything in the spec sheets to tell me either way)</p>
<p>Thanks, Jack</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8346"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 18/12/2012 - 15:06.</div>
    <div class="content">
     <p>If you give a c.t. too much overcurrent, the core will saturate, and the output levels off. You can see that with the 100 A c.t. when I fed it 250 A. The core warms up, which not good for its life expectancy. I can&#39;t quantify that, I don&#39;t know what the temperature rating is - the data sheet is secretive in that area. If it got too warm, it could conceivably damage the insulation on the primary winding, which would definitely be not good.<br />
	Unless there is no other way, I don&#39;t recommend it.</p>
<p>Accuracy: You need to measure one but I would have expected the magnitude of the current to remain a lot better than that to much lower currents, it&#39;s probably the phase angle that goes out of tolerance first. I&#39;d expect the behaviour to be very similar to the 100 A version.</p>
<p><em>I assume that if the op-amp is powered from a 3.3v source then it&#39;ll never be able to produce &gt; 3.3v.&nbsp; </em>Correct.</p>
<p><em>if the 5A input is saturated then use the 50A input</em>. If you still need two c.t&#39;s, you could use the same logic as Atmel in their app.note - it&#39;s proven.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8347"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Tue, 18/12/2012 - 16:20.</div>
    <div class="content">
     <p>Thanks for the reply.</p>
<blockquote><p><em>Accuracy: You need to measure one but I would have expected the magnitude of the current to remain a lot better than that to much lower currents</em></p>
</blockquote>
<p>Yes, sorry - I should&#39;ve been explicit about what got me worried about accuracy in the first place.</p>
<p>I have a simple test rig setup (it&#39;s far from ideal but it&#39;s safe and it appears to work):</p>
<p><img alt="" src="http://farm9.staticflickr.com/8339/8282102634_eb031c8fa8_z.jpg" style="width: 640px; height: 480px;" /></p>
<p>The &quot;test rig&quot; consists of a mains extension lead with 40cm of insulation cut away and a chunky meter tail spliced into the live connection (I used a meter tail so I could test the capacitance of the foil &quot;capacitance probe&quot;).&nbsp; My &quot;reference meter&quot; is a <a href="https://www.wattsupmeters.com/secure/products.php?pn=0&amp;wai=0&amp;spec=1">WattsUp Pro .NET</a> which claims to have a measurement accuracy of +/- 1.5% (above 60 watts).&nbsp; It reports RMS volts, RMS current, &quot;true RMS watts&quot; (real power, I guess), power factor and apparent power.</p>
<p>As can be seen in the photo, I was testing with my wife&#39;s hair dryer which has two speeds.&nbsp; Readings on low speed:</p>
<table border="1" cellpadding="1" cellspacing="1" style="width: 500px;">
<tbody>
<tr>
<td>
				&nbsp;</td>
<td>
				WattsUp</td>
<td>
				emonTX</td>
</tr>
<tr>
<td>
				RMS amps</td>
<td>
				3.62 A</td>
<td>
				2.82 A</td>
</tr>
<tr>
<td>
				real power</td>
<td>
				623 W</td>
<td>
				612 W</td>
</tr>
<tr>
<td>
				apparent power</td>
<td>
				870 VA</td>
<td>
				680 VA</td>
</tr>
<tr>
<td>
				power factor</td>
<td>
				0.70</td>
<td>
				0.90</td>
</tr>
</tbody>
</table>
<p>Readings on high speed:</p>
<table border="1" cellpadding="1" cellspacing="1" style="width: 500px;">
<tbody>
<tr>
<td>
				&nbsp;</td>
<td>
				WattsUp</td>
<td>
				emonTX</td>
</tr>
<tr>
<td>
				RMS amps</td>
<td>
				6.72 A</td>
<td>
				6.73 A</td>
</tr>
<tr>
<td>
				real power</td>
<td>
				1600 W</td>
<td>
				1600 W</td>
</tr>
<tr>
<td>
				apparent power</td>
<td>
				1600 VA</td>
<td>
				1600 VA</td>
</tr>
<tr>
<td>
				power factor</td>
<td>
				1.00</td>
<td>
				1.00</td>
</tr>
</tbody>
</table>
<p>It was the &quot;low speed&quot; data which originally made me worried that maybe the CT clamp was misbehaving at low currents.</p>
<p>But after some more experimentation with high-PF loads (toaster, 75W incandescent lamp, 50W soldering iron, kettle) I&#39;m coming to a different conclusion... I think the emonTX appears to agree very well with the WattsUp for high-PF loads (even small loads like the soldering iron).&nbsp; But low-PF loads confuse it.&nbsp; Which maybe makes me think that it&#39;s not the CT that&#39;s to blame but, rather, it might be that we&#39;re not taking enough samples of the current waveform (or perhaps the CT is distoring the phase angle).</p>
<p>Let me quickly try to increase the sampling of the current waveform and report back...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8349"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Tue, 18/12/2012 - 16:34.</div>
    <div class="content">
     <p>I very quickly through together some &quot;faster sampling&quot; code. The &quot;faster&quot; code doesn&#39;t implement any of the clever tricks discussed elsewhere on the forum, it just doesn&#39;t sample voltage.</p>
<p>Here are the results for the &quot;slow&quot; setting of the hair dryer.&nbsp; Remember my reference meter claims we should be measuring 3.6 A.</p>
<table border="1" cellpadding="1" cellspacing="1" style="width: 500px;">
<tbody>
<tr>
<td>
				&nbsp;</td>
<td>
				slow sampling</td>
<td>
				faster sampling</td>
</tr>
<tr>
<td>
				current samples per cycle</td>
<td>
				17</td>
<td>
				45</td>
</tr>
<tr>
<td>
				RMS current</td>
<td>
				2.83 A</td>
<td>
				2.85 A</td>
</tr>
</tbody>
</table>
<p>So faster sampling doesn&#39;t appear to improve accuracy in this situation.&nbsp; But now I&#39;m really confused: what&#39;s causing the emonTX to underestimate the current so much for the low setting of my wife&#39;s hairdryer?!&nbsp;&nbsp; Let me try to dig out a purely resistive 500 W load...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8351"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Tue, 18/12/2012 - 17:37.</div>
    <div class="content">
     <p>Some more comparisons</p>
<p>(large deviations from WattsUp are marked in red):</p>
<p>RMS amps:</p>
<table border="1" cellpadding="1" cellspacing="1" style="width: 500px;">
<tbody>
<tr>
<td>
				&nbsp;</td>
<td>
				WattsUp</td>
<td>
				emonTX slow (17 s/c)</td>
<td>
				emonTX fast (45 s/c)</td>
</tr>
<tr>
<td>
				hair dryer (slow) (PF=0.70)</td>
<td>
				&nbsp;3.62 A</td>
<td>
				<span style="color:red">&nbsp;2.82 A</span></td>
<td>
				<span style="color:red">&nbsp;2.85 A</span></td>
</tr>
<tr>
<td>
				hair dryer (fast) (PF=1.00)</td>
<td>
				&nbsp;6.72 A</td>
<td>
				&nbsp;6.73 A</td>
<td>
				&nbsp;6.81 A</td>
</tr>
<tr>
<td>
				75 watt incandescent lamp (not on dimmer) (PF=0.95)</td>
<td>
				&nbsp;0.35 A</td>
<td>
				&nbsp;0.31 A</td>
<td>
				&nbsp;0.32 A</td>
</tr>
<tr>
<td>
				1.5kW toaster (PF=1.00)</td>
<td>
				&nbsp;6.50 A</td>
<td>
				&nbsp;6.51 A</td>
<td>
				&nbsp;6.52 A</td>
</tr>
<tr>
<td>
				soldering iron (temperature controlled) (PF=0.71)</td>
<td>
				&nbsp;0.33 A</td>
<td>
				&nbsp;0.31 A</td>
<td>
				&nbsp;0.30 A</td>
</tr>
<tr>
<td>
				75 watt incandescent dimmed to ~50% (PF=0.44)</td>
<td>
				&nbsp;0.34 A</td>
<td>
				<span style="color:red">&nbsp;0.28 A</span></td>
<td>
				<span style="color:red">&nbsp;0.27 A</span></td>
</tr>
<tr>
<td>
				hoover (speed 1/6) (PF=0.29)</td>
<td>
				&nbsp;3.90 A</td>
<td>
				&nbsp;3.80 A</td>
<td>
				&nbsp;3.70 A</td>
</tr>
<tr>
<td>
				hoover (speed 4/6) (PF=0.52)</td>
<td>
				&nbsp;6.25 A</td>
<td>
				&nbsp;6.12 A</td>
<td>
				&nbsp;5.97 A</td>
</tr>
<tr>
<td>
				hoover (speed 6/6) (PF=0.95)</td>
<td>
				&nbsp;8.70 A</td>
<td>
				&nbsp;8.70 A</td>
<td>
				&nbsp;8.66 A</td>
</tr>
</tbody>
</table>
<p>power factors reported by WattsUp.</p>
<p>The WattsUp and emonTX are reporting RMS amps once every second.</p>
<p>(edited to add more details to the descriptions of each appliance to address some of the questions raised in comments below)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8352"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1774" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1774.jpg" alt="PaulOckenden&#039;s picture" title="PaulOckenden&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1774" title="View user profile.">PaulOckenden</a> on Tue, 18/12/2012 - 16:55.</div>
    <div class="content">
     <p>Have you tested the accuracy of your WattsUp&nbsp;by comparing it with, for example, the pulses on a utility meter?</p>
<p>P.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8353"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Tue, 18/12/2012 - 17:05.</div>
    <div class="content">
     <blockquote><p><em>Have you tested the accuracy of your WattsUp&nbsp;by comparing it with, for example, the pulses on a utility meter?</em></p>
</blockquote>
<p>That&#39;s a good idea but unfortunately that would require turning off every load in our house except our test load, which isn&#39;t practical (my wife an 1 year old might complain!).&nbsp; I have compared the WattsUp to an EDF individual appliance monitor and an EDF whole-house meter <a href="http://jack-kelly.com/how_accurate_is_an_edf_individual_appliance_monitor">on my blog</a> and they agree very well (except the WattsUp samples once a second whilst the EDF IAM samples once every 6 seconds).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8354"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 18/12/2012 - 17:11.</div>
    <div class="content">
     <p>How did you calibrate your emonTx? (I&#39;m thinking: You might be in the situation where two wrongs make a right - but at one point only).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8355"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1774" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1774.jpg" alt="PaulOckenden&#039;s picture" title="PaulOckenden&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1774" title="View user profile.">PaulOckenden</a> on Tue, 18/12/2012 - 17:12.</div>
    <div class="content">
     <p>Slightly surprised by some of your power factors. Soldering iron, for example. I&#39;d have thought that would be purely resistive, so with a PF of 1.0. Likewise your 75W lamp.</p>
<p>Or am I being silly?</p>
<p>P.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8356"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 18/12/2012 - 17:17.</div>
    <div class="content">
     <p>Surely he&#39;s got a temperature-controlled iron with a thyristor/triac chopped waveform - just like his lamp which he says is on a dimmer? ! ! !</p>
<p>That&#39;s the clue - one of them (either emonTx or WattsUp) isn&#39;t getting the chopped waveform right.</p>
<p>And betcha the hairdryer does the same.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8357"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Tue, 18/12/2012 - 17:18.</div>
    <div class="content">
     <blockquote><p><em>Slightly surprised by some of your power factors. Soldering iron, for example. I&#39;d have thought that would be purely resistive, so with a PF of 1.0. Likewise your 75W lamp.</em></p>
</blockquote>
<p>Yeah, I was surprised by that, too.&nbsp; All the PFs I quoted are taken from the WattsUp (unless otherwise stated).</p>
<p>The soldering iron is a temperature-controller one (the Xytronik 168-3CD) but I would have thought that the heater is either &quot;on&quot; or &quot;off&quot;, hence should be purely resistive.&nbsp; I guess the lamp filament is, actually, a very small coil so perhaps that explains the lamp&#39;s slight inductance?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8358"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Tue, 18/12/2012 - 17:23.</div>
    <div class="content">
     <blockquote><p><em>just like his lamp which he says is on a dimmer? ! ! !</em></p>
</blockquote>
<p>Ah!&nbsp; I tested the lamp twice: once on a dimmer (with the dimmer set at about 50%) and once without a dimmer in the circuit.&nbsp; Sorry, I should&#39;ve made that clearer.&nbsp; I&#39;ve edited my table to make this explicit.</p>
<blockquote><p><em>That&#39;s the clue - one of them (either emonTx or WattsUp) isn&#39;t getting the chopped waveform right.</em></p>
</blockquote>
<p>That&#39;s certainly my best guess too.&nbsp; If the emonTX was failing to get the chopped waveform right then I&#39;d expect more rapid sampling to reduce the problem but faster sampling doesn&#39;t seem to change the emonTX&#39;s reported values.&nbsp; Which perhaps starts to point the finger of blame at the WattsUp?!</p>
<p>I wonder if it&#39;s too late to ask for a proper &#39;scope from Santa?!?!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8359"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 18/12/2012 - 17:25.</div>
    <div class="content">
     <p><em>&quot;<strong>slight</strong> inductance</em>&quot; - nowhere near enough to give you a p.f. of 0.44 !&nbsp; Have you worked out what inductance that actually is. I haven&#39;t but know it can&#39;t be anywhere near enough.</p>
<p>But think about the chopped current wave and the position of the current wave in relation to the voltage wave. As you decrease the conduction angle, the load looks increasingly inductive until at almost zero volts, the current wave is almost 90&deg; phase shifted.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8360"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 18/12/2012 - 17:28.</div>
    <div class="content">
     <p><em>&quot;I wonder if it&#39;s too late to ask for a proper &#39;scope from Santa?!?!</em>&quot;</p>
<p>If a week today you&#39;re out of luck, you could improvise with a sound card. See how I tested the c.t&#39;s and v.t. for how to do it and precautions.</p>
<p>You <em><u><strong>must</strong></u></em> be very careful with earths.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8361"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Tue, 18/12/2012 - 17:33.</div>
    <div class="content">
     <blockquote><p><em>&quot;<strong>slight</strong> inductance&quot; - nowhere near enough to give you a p.f. of 0.44</em></p>
</blockquote>
<p>Sorry, I think my table has caused more confusion!&nbsp; To clarify:</p>
<p>When the lamp was connected directly to my test rig (with no dimmer) the Watts Up reports a PF of 0.95.&nbsp; (I would have expected a PF of 1.00)</p>
<p>When the lamp was connected via a cheap dimmer set to about 50% the Watts Up reports a PF of 0.44 (caused by the waveform chopping done by the dimmer)</p>
<p>It was the first situation (with PF = 0.95) where I was surmising that the lamp&#39;s slight inductance might be responsible for the PF of 0.95 instead of 1.00.&nbsp; But I really am just guessing.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8363"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Tue, 18/12/2012 - 18:46.</div>
    <div class="content">
     <p>Some graphs...</p>
<p>I told my emonTX to store 200 current samples in an array and then spit them out to the serial port.</p>
<p>Here&#39;s the current waveform as sampled by the emonTX 45 times per cycle... the y-axis are filtered but unscaled current values:</p>
<p><strong>Hair dryer on low setting</strong> (note the very odd waveform shape...)</p>
<p><img alt="" src="http://xlk.org.uk/ext/hairdryer_low.png" style="width: 729px; height: 508px;" /></p>
<p>&nbsp;</p>
<p>If you recall, the emonTX was reporting lower RMS amps readings for the hair dryer on low setting compared to the WattsUp.&nbsp; I wonder if the WattsUp is failing to take consideration of the very odd negative 180 degrees of the current waveform?&nbsp; <strike>(Or maybe the WattsUp and emonTX disagree over the &quot;polarity&quot; of the current waveform???&nbsp; I guess most folks assume the current waveform will be the same no matter what the &quot;polarity&quot;; given that it&#39;s supposed to be a sine wave&nbsp; </strike>EDIT: never mind, obviously the &quot;polarity&quot; doesn&#39;t matter for root-mean-<strong>squared</strong> calcs!)</p>
<p>And, just to be sure the HPF wasn&#39;t doing anything odd, here&#39;s a graph of the raw analogRead() values (unfiltered):</p>
<p><img alt="" src="http://xlk.org.uk/ext/hairdryer_low_raw.png" style="width: 991px; height: 741px;" /></p>
<p>From which I conclude that the HPF isn&#39;t distorting the waveform (why should it?)</p>
<p>&nbsp;</p>
<p><strong>Hair dryer on high setting</strong> (much more sane waveform)...</p>
<p><img alt="" src="http://xlk.org.uk/ext/hairdryer_high.png" style="width: 984px; height: 663px;" /></p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8366"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 18/12/2012 - 18:51.</div>
    <div class="content">
     <p>You are looking at a half-wave rectified wave. The zero ought to be at the 503-504 count level, it has been shifted because neither the c.t. itself nor the h.p filter can preserve the true d.c. level.</p>
<p>Now if you do the maths, you&#39;ll see that the emonTx won&#39;t be reading the correct value, perhaps that&#39;s obvious. There is nothing you can do without using direct connections for both current and voltage inputs, and you can&#39;t do this without raising critical concerns over the safety issues.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8367"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1774" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1774.jpg" alt="PaulOckenden&#039;s picture" title="PaulOckenden&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1774" title="View user profile.">PaulOckenden</a> on Tue, 18/12/2012 - 19:31.</div>
    <div class="content">
     <p>If you&#39;re anywhere near Brighton you can borrow my portable scope for a few days, if you have the time/inclination to study further.</p>
<p>P.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8372"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Tue, 18/12/2012 - 19:45.</div>
    <div class="content">
     <blockquote><p><em>Now if you do the maths, you&#39;ll see that the emonTx won&#39;t be reading the correct value, perhaps that&#39;s obvious</em></p>
</blockquote>
<p>I <em>think</em> I understand what&#39;s going on!&nbsp; But not entirely confident.</p>
<blockquote><p><em>There is nothing you can do without using direct connections for both current and voltage inputs, and you can&#39;t do this without raising critical concerns over the safety issue</em>s.</p>
</blockquote>
<p>I&#39;m 99% sure the answer will be no, but: would it help at all to use a hardware HPF?</p>
<p>BTW, I&#39;m actually very impressed with how well the emonTX agrees with the WattsUp for the majority of appliances (the WattsUp .net Pro is a $235 meter - not mine, incidentally!)</p>
<p>I&#39;m going to email WattsUp to ask how rapidly their meter samples the voltage and current waveforms.</p>
<blockquote><p><em>If you&#39;re anywhere near Brighton you can borrow my portable scope for a few days</em></p>
</blockquote>
<p>That&#39;s extremely kind of you but I&#39;m a little distance from you (S.E. London).&nbsp; Also, to be honest, I&#39;m starting to come to the conclusion that, actually, the emonTX does a pretty damn good job out-of-the-box so I should stop tinkering and get on with the main &quot;meat&quot; of my project (implementing a reliable RF protocol and doing the capacitance-probe stuff).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8374"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 18/12/2012 - 20:23.</div>
    <div class="content">
     <p><em>&quot;I <u>think</u> I understand what&#39;s going on!</em>&quot;</p>
<p>The h.p. filter passes only high frequencies - by definition. d.c is zero frequency. The c.t. also doesn&#39;t pass d.c. - if you connect a car battery between true earth and the emonTx, it won&#39;t shift what you measure by 12 V!&nbsp; I think that&#39;s pretty intuitive, but if not, you&#39;ll just have to believe me. ;-)<br />
	But at the same time the h.p. filter allows the wave to balance itself so that the average voltage is zero, so the true zero (the flat base between the half-cycles) gets shifted negatively. You&#39;d see exactly the same thing with a real &#39;scope if you switch that channel to &quot;ac&quot;.</p>
<p>The rms value of the wave is naturally affected by the d.c. component. The best way to see this is to synthesize a sine wave in a spreadsheet and calculate the average and rms values. (Formula to be found in emonLib!).</p>
<p><em>&quot;would it help at all to use a hardware HPF?&quot;</em></p>
<p>Sack the 1%, your 99% is spot on. Any h.p. filter will do the same.</p>
<p>The only way to get the right answer would be either to somehow figure out where the true zero is and restore it in software, or (I think) a Hall effect current transducer would do the trick, but would itself have problems with d.c. stability (unless you use some pretty advanced techniques) or have a direct connection (current shunt).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8375"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 18/12/2012 - 20:37.</div>
    <div class="content">
     <p>Thinking about your capacitive v.t, you could minimise the external influences by screening it. The capacitance between the pickup foil and the (earthed) screen would - like the cable capacitance - need to be subtracted from the &#39;bottom&#39; capacitor.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8408"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Wed, 19/12/2012 - 14:04.</div>
    <div class="content">
     <p>jack_kelly said &quot;<em>never mind, obviously the &quot;polarity&quot; doesn&#39;t matter for root-mean-squared calcs!</em>&quot;</p>
<p>This isn&#39;t entirely true for the emonTx Jack. There is some leakage of voltage into the current circuit, both from a/c input and from the power supply or PC you are connected to. If this is in phase with the current all the samples will be slightly larger than they should be and so their squared values will be larger too. When the current and voltage are out of phase you get the opposite effect. Try swapping the direction of current flow through the CT when you have a small load like your 75W light bulb and you should see the effect.</p>
<p>The half wave rectified problem is an interesting one, as Robert says, you could probably do some post-processing and determine where 0 should be but it wouldn&#39;t work if had other balanced loads too. Maybe I can make a plug for a PLL :). If the load was purely resistive you know the current must be 0 at the voltage zero crossing so using a PLL (or hardware) to&nbsp;find this would enable you to determine the correct current offset. Falls down a bit with inductive loads though. Might even have a play with this myself</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8419"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Wed, 19/12/2012 - 15:47.</div>
    <div class="content">
     <p><em>&quot;If the load was purely resistive you know the current must be 0 at the voltage zero crossing so using a PLL (or hardware) to&nbsp;find this would enable you to determine the correct current offset. Falls down a bit with inductive loads though.</em>&quot;</p>
<p>I&#39;m afraid that I can&#39;t see a law for resistive-only loads any time soon - although the power companies would no doubt be over the moon at the thought!</p>
<p>I think Hall effect is the only practical non-invasive way.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8432"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Wed, 19/12/2012 - 21:54.</div>
    <div class="content">
     <blockquote><p><em>The half wave rectified problem is an interesting one, as Robert says, you could probably do some post-processing</em></p>
</blockquote>
<p>This thought kept me up last night!&nbsp; I&#39;ve implemented a &quot;lobe timing asymmetry detection&quot; algorithm (daft name, I know) which is describe in a new forum topic: <a href="http://openenergymonitor.org/emon/node/1705">Tracking DC-offset using lobe timing instead of an HPF</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8455"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Thu, 20/12/2012 - 11:11.</div>
    <div class="content">
     <p>Moving slightly back to the original topic of this thread...</p>
<p>The graph below of the raw analogRead values when measuring a dimmed lamp (drawing about 0.33 amps) surprised me a bit:</p>
<p><img alt="" src="http://xlk.org.uk/ext/lamp_raw.png" style="width: 506px; height: 468px;" /></p>
<p>I was surprised that we&#39;re only using 5 out of a possible 1024 ADC steps to sample this lamp (I know, I should have been able to work this out).&nbsp; Sure, we won&#39;t usually be presenting a mere 0.3 A to our CT clamp when it&#39;s connected to our home&#39;s incoming mains connection instead of my test rig; but we often will be presenting <em>steps</em> of only 0.3 A (or less) to our CT clamp (e.g. when a lamp is turned on or off).&nbsp; And, in my non-intrusive load monitoring research, these step-changes are <em>really</em> important! &nbsp; This got me thinking again about ways to improve our ADC resolution.</p>
<p>The &quot;standard&quot; answer to improving resolution in a situation like this is, as I understand it, to use an op-amp with switchable gains (where the gain is selected by the processor).&nbsp; The thing that worries me about this solution is that we&#39;d have to re-calibrate our DC-offset after switching gains.&nbsp; This isn&#39;t a problem if we switch gains rarely but imagine if we repeatedly and rapidly switched gains (e.g. my bread-maker turns its heater on and off rapidly to control temperature; imagine if the &quot;heater on&quot; state was above the threshold to switch gains whilst the &quot;heater off&quot; state was below that threshold).</p>
<p>It occurred to me that we could double our effective resolution if we full-wave-rectified the input signal before sending it to the ADC.&nbsp; Something like this:</p>
<p><a href="http://www.flickr.com/photos/37816297@N06/8290793432/" title="Untitled by Jack_Kelly, on Flickr"><img alt="Untitled" height="500" src="http://farm9.staticflickr.com/8071/8290793432_52c8eb2cd5.jpg" width="339" /></a></p>
<p>The top graph shows the present situation.&nbsp; A voltage of between 0 to 3.3v is delivered to the ADC.&nbsp; 0v represents the -ve peak whilst 3.3v represents the +ve peak.</p>
<p>The bottom graph shows the basic idea behind my suggestion: that we apply full-wave-rectification (and amplification) to the signal <em>prior </em>to the ADC.&nbsp; We also use a simple bit of hardware to detect whether the original signal is positive or negative and we communicate the sign to the ATMEGA by way of a single digital input.&nbsp; This way we can easily reconstruct the original full-wave signal in software.&nbsp; The ultimate aim is to double our effective resolution.&nbsp; Instead of using 1024 ADC steps to represent the original signal from -ve peak to +ve peak, we can use the full 1024 steps to represent 0 to +ve peak.</p>
<p>Implementing this in hardware would, I imagine, be relatively trivial if it weren&#39;t for the fact that diodes have a forward voltage drop, so we certainly can&#39;t just pass our CT input through a bridge rectifier.&nbsp; A bit of Googling uncovered the concept of a &quot;<a href="http://en.wikipedia.org/wiki/Precision_rectifier">precision full-wave rectifier</a>&quot; using 2 op-amps and 2 diodes which appears to compensate for the undesirable attributes of normal diodes.&nbsp; I imagine we would still need to generate a dual-rail (+3.3v, -3.3v) power supply from our battery though.</p>
<p>So I&#39;m now thinking of using a 25Amp CT clamp (outputting 0.333v when presented with 25A) in combination with a precision rectification circuit to increase the resolution of my current sensing circuitry.</p>
<p>Any thoughts?!&nbsp; Has anyone used a &quot;precision full-wave rectifier&quot;?&nbsp; Will it do odd things to the phase or distort the signal in some other way (I assume not)?&nbsp; Is this just a dumb idea that should never see the light of day?!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8460"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Thu, 20/12/2012 - 11:10.</div>
    <div class="content">
     <p>Another clever idea Jack but this one might be a bit more difficult to implement and may conflict with your LTAD algorithm (no 0 crossings?).</p>
<p>At first I thought it&#39;s a lot of trouble just to double the resolution but if you think about it it has much more potential than that. With the&nbsp;rectified signal referenced to ground&nbsp;there is no DC offset so you can set the resolution to anything&nbsp;you want simply by changing Vref. e.g switching to the internal 1.1V band gap reference would triple the resolution.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8463"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Thu, 20/12/2012 - 11:23.</div>
    <div class="content">
     <p>How do you determine the direction of the current or the power factor/phase angle? I think there is a little ambiguity creeping in.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8465"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Thu, 20/12/2012 - 11:32.</div>
    <div class="content">
     <blockquote><p><em>With the&nbsp;rectified signal referenced to ground&nbsp;there is no DC offset&nbsp; </em></p>
</blockquote>
<p>Oh yeah.&nbsp; I hadn&#39;t thought of that!&nbsp; It would be lovely to avoid having to use software tricks (like an HPF or LTAD) to remove the DC offset.</p>
<blockquote><p><em>switching to the internal 1.1V band gap reference would triple the resolution</em></p>
</blockquote>
<p>Very nice ;)</p>
<blockquote><p><em>...it&#39;s a lot of trouble...</em></p>
</blockquote>
<p>I assume the dual-rail power supply is the hardest bit about implementing this circuit (the <a href="http://www.play-hookey.com/analog/feedback_circuits/full-wave_rectifier.html">circuit diagram for the precision full-wave rectifier</a> itself doesn&#39;t look too hard to build).</p>
<p>How hard is it to cook up a dual-rail power supply from a battery?&nbsp; I guess the easiest thing is just to use four 1.5v batteries instead of 2 and take a center-tap from the battery pack?</p>
<p>Perhaps we don&#39;t even need a dual-rail supply?&nbsp; If we use a total of three op-amps: the first two are the precision full-wave rectifier for the 0.33 v input from the 25amp CT clamp.&nbsp; These, I assume, do need a dual-rail power supply but perhaps we can create a &plusmn;1.5v dual-rail supply just by voltage-dividing the 3v supply.&nbsp; Then, once we have our full-wave-rectified signal, we can use a single-rail op-amp (fed from the main +3.3v supply) to amplify the signal to occupy the full input range of the ADC.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8466"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Thu, 20/12/2012 - 11:35.</div>
    <div class="content">
     <p>Couldn&#39;t you extract the polarity of the current from the precision rectifier? There must be a node in there that changes with polarity. This could be extracted, fed into a digital input and used to invert the current value in software.</p>
<p>Once you&#39;ve got that the power factor/phase angle problem&nbsp;is no different than normal.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8468"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Thu, 20/12/2012 - 11:42.</div>
    <div class="content">
     <p>There are plenty of chips around that will generate a negative supply from a positive one. I don&#39;t think that&#39;s an issue.</p>
<p>You&#39;ll still need something like your LTAD algorithm because the half-wave case will be rectified at the false 0 point.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8469"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Thu, 20/12/2012 - 11:51.</div>
    <div class="content">
     <blockquote><p><em>Couldn&#39;t you extract the polarity of the current from the precision rectifier? There must be a node in there that changes with polarity. This could be extracted, fed into a digital input and used to invert the current value in software.</em></p>
</blockquote>
<p>Exactly what I was thinking when I wrote the rather hand-wavey sentence &quot;<em>We also use a simple bit of hardware to detect whether the original signal is positive or negative and we communicate the sign to the ATMEGA by way of a single digital input.</em>&quot;</p>
<p>Here&#39;s the diagram for a precision full-wave rectifier (taken from <a href="http://www.play-hookey.com/analog/feedback_circuits/full-wave_rectifier.html">play-hookey</a>)</p>
<p><img alt="" src="http://www.play-hookey.com/analog/feedback_circuits/images/full-wave_rectifier.gif" style="width: 600px; height: 250px;" /></p>
<p>If I understand the diagram correctly (which isn&#39;t as likely as I might want!) then the output of the left op-amp (after the right diode) is a half-wave rectified signal.&nbsp; So we could take that half-wave signal and amplify it a lot (so it effectively becomes a digital signal) and feed this signal into a digital input on the ATMEGA.&nbsp; This bit can then be used as a &quot;sign bit&quot; in software.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8470"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Thu, 20/12/2012 - 11:55.</div>
    <div class="content">
     <blockquote><p><em>the half-wave case will be rectified at the false 0 point</em></p>
</blockquote>
<p>I&#39;m not sure why this would be the case.&nbsp; Please can you baby-step me through the reasoning?&nbsp; (Sorry, I really should know more about AC electronics)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8472"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Thu, 20/12/2012 - 12:08.</div>
    <div class="content">
     <p><em>I&#39;m not sure why this would be the case.&nbsp; Please can you baby-step me through the reasoning?&nbsp; (Sorry, I really should know more about AC electronics)</em></p>
<p>It&#39;s really the same reason the HPF has trouble. The CT is a/c coupled so the average voltage on it must always be 0. This means the signal will always swing both positive and negative even if the real current is always positive.</p>
<p>One side of your CT will be the signal into your precision rectifier, the other side will presumably be connected to ground. The signal input will swing positive and negative around the average voltage, which is the point where an LPF would settle.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8474"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Thu, 20/12/2012 - 12:16.</div>
    <div class="content">
     <p>Ah, I get it - thank you.</p>
<p>Going back to something you said earlier:</p>
<blockquote><p><em>switching to the internal 1.1V band gap reference would triple the resolution</em></p>
</blockquote>
<p>Forgive my ignorance but is this switch something that can be done in software?&nbsp; I assume not.&nbsp; (At least, not unless we add a switch that the ATMEGA can control).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8476"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Thu, 20/12/2012 - 12:26.</div>
    <div class="content">
     <p>Yes, you can change the reference in software. The selection multiplexor is in the ADMUX register&nbsp;(the same register you used to read Vcc and select the input source). You can also select an external reference.</p>
<p>It&#39;s all well documented in the ATMega328 data sheet on the Atmel site and all the header files are included in the Arduino environment.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8482"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Thu, 20/12/2012 - 12:42.</div>
    <div class="content">
     <blockquote><p><em>It&#39;s all well documented in the ATMega328 data sheet on the Atmel site and all the header files are included in the Arduino environment.</em></p>
</blockquote>
<p>It must be about time for me to RTFM, I guess ;)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8528"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Fri, 21/12/2012 - 10:03.</div>
    <div class="content">
     <p>Regarding the current rating for CT clamps... say I get a CT clamp with a primary current rating of x amps.&nbsp; I assume that&#39;s x amps <em>peak</em> rather than x amps <em> RMS</em>.&nbsp; So if I want to measure a 25A RMS load then I need a <span style="font-family:monospace">25A x sqrt(2) = 35.4A</span> CT clamp.&nbsp; Is that correct?&nbsp; (The CT clamp data sheet doesn&#39;t appear to make this clear.&nbsp; Although most of the CT clamps I&#39;ve looked at claim to maintain their quoted accuracy from about 10%-130% of its rated current).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8537"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Fri, 21/12/2012 - 14:08.</div>
    <div class="content">
     <p>No.</p>
<p>Take a look at the test results for the YHDC c.t. All the numbers there are rms unless I state otherwise.</p>
<p>[And I do wish you&#39;d stop calling transformers &quot;clamps&quot; - every time I see that, I think you mean a busbar clamp].</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8539"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Fri, 21/12/2012 - 14:38.</div>
    <div class="content">
     <blockquote><p><em>No.</em></p>
</blockquote>
<p>OK.&nbsp; So a &quot;25A&quot; CT means a &quot;25A <em>RMS</em> CT&quot;.&nbsp; Thanks for clarifying.</p>
<blockquote><p><em>And I do wish you&#39;d stop calling transformers &quot;clamps&quot;&nbsp; </em></p>
</blockquote>
<p>I was under the impression that &quot;<em>CT clamp</em>&quot; is common short hand for &quot;<em>split-core current transformer for fitting round a cable without having to disconnect one end of the cable first</em>&quot;.&nbsp; <a href="http://en.wikipedia.org/wiki/Current_clamp">It&#39;s</a> <a href="http://uk.rs-online.com/mobile/p/energy-monitor-accessories/0214524/">not</a> <a href="http://arduino.cc/forum/index.php?topic=98500.0">like</a> <a href="http://www.powermeterstore.com/c1018/clamp-on_current_transformer.php">I&#39;m</a> <a href="http://www.amazon.co.uk/Current-Cost-Sensor-Clamp-CT/dp/B002FVNQHQ">the</a> <a href="http://www.currentcost.net/transmitterspec.html">only</a> <a href="http://www.ebay.co.uk/itm/Current-Sensor-CT-Clamp-Watts-Clever-Wireless-Energy-Monitors-2-3-phase-/280776520560">person</a> <a href="http://www.hioki.com/product/9277/index.html">to</a> <a href="http://store.homeseer.com/store/Powersave-Current-Cost-EnviR-CT-Clamp-P1413.aspx">call</a> <a href="http://www.mecoinst.com/meco-product-details/Clamp-on-CTs-Flexible-Ac-Current-Probe.aspx">it</a> a &quot;CT clamp&quot; ;)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8583"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Sat, 22/12/2012 - 09:26.</div>
    <div class="content">
     <p>I&#39;ve been thinking some more about this &quot;precision rectification&quot; circuit for improving ADC resolution for both V and I samples.&nbsp; Some quick notes:</p>
<ul>
<li>
		As far as I can tell, &quot;precision rectification&quot; is the only way to improve ADC resolution for V samples.&nbsp; We can&#39;t use a switchable-gain op-amp for V.</li>
<li>
		As Martin pointed out, &quot;precision rectification&quot; means that we no longer have to worry about getting a stable voltage bias circuit because our &quot;DC offset&quot; is ground.&nbsp; Although, of course, we can build <a href="http://openenergymonitor.org/emon/buildingblocks/acac-buffered-voltage-bias">a solid voltage bias using an op-amp in voltage following mode</a>.</li>
<li>
		Martin also pointed out that we can switch gain (when sampling current) just by changing the Vref, which can be done in software.&nbsp; One challenge with implementing this idea is that we&#39;d need to rapidly alternate the Vref between 1.1v (for measuring current) and 3.3v (for measuring voltage).&nbsp; How much time will this switch take?&nbsp; EmonLib&#39;s <a href="https://github.com/openenergymonitor/EmonLib/blob/master/EmonLib.cpp#LC212">EnergyMonitor::readVcc()</a> function waits 2ms between setting ADMUX and doing the analog to digital conversion.&nbsp; The ATmega328p manual (p240) says that &quot;<em>When the bandgap reference is used as input to the Analog Comparator, it will take a certain time for the voltage to stabilize. If not stabilized, the first conversion may give a wrong value.</em>&quot; Then, on p49, the manual explains that <em>&quot;The voltage reference has a start-up time that may influence the way it should be used... To save power, the reference is not always turned on. The reference is on... When the ADC is enabled</em>.&quot;&nbsp; So this suggests that, actually, we only need to wait when we<em> first turn on</em> the band-gap voltage ref and that the voltage reference is always on if the ADC is on which implies that we don&#39;t have to wait for stabilisation if the band-gap is already warmed up.&nbsp; Does anyone know how rapidly we can switch from using a stable 1.1v band-gap Vref to the 3.3v Vref and back again (assuming the ADC is left on all the time)? I also wonder if we could change ADMUX while a conversion is underway (I assume not).&nbsp; e.g. we tell the ADC to start converting a sample of V and then, before the answer has popped up, we change ADMUX ready to sample current.</li>
<li>
		Assuming my tiny knowledge of op-amps is vaguely correct, it would seem that we could combine &quot;precision rectification&quot; with a switchable gain op-amp for measuring current.&nbsp; But this is perhaps starting to look unpleasantly complex and, possibly, will introduce too much noise.</li>
</ul>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8586"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Sat, 22/12/2012 - 09:59.</div>
    <div class="content">
     <p>I did try switching to&nbsp;the internal reference rapidly once with the idea of checking the supply voltage at every sample but it didn&#39;t work, it seems you do need a delay. It didn&#39;t take this further after I realised that the 3.3V regulator tolerance (1% I think) is better than the band-gap reference (10% ?).</p>
<p>There is a mention somewhere about changing ADMUX after a conversion has started. You can do it quite early as the sample and hold takes place at the start of the process. I&#39;ll see if I can find the reference.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8600"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sat, 22/12/2012 - 13:44.</div>
    <div class="content">
     <p>MartinR</p>
<p>I think the difference between the regulator output and the band-gap reference is in <em>stability</em>, not <em>precision. </em>As I understand it, the band-gap voltage value is more uncertain initially, but maintains that voltage more precisely in the face of external influences (temperature and supply voltage principally), and time.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8608"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Sat, 22/12/2012 - 14:26.</div>
    <div class="content">
     <p>Hmmm... all this talk of wobbly voltage references is making me a little nervous... how hard would it be to build a more precise, external voltage reference?&nbsp; (forgive me; I have precisely zero experience with such circuit design).&nbsp; If I were to build an external v ref then I assume I could built two or three switchable precision v refs instead of building a switchable gain amp (assuming I also use precision rectification).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8611"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Sat, 22/12/2012 - 15:10.</div>
    <div class="content">
     <p>OK.&nbsp; I&#39;ve done a quick bit of googling!&nbsp; Farnell have a huge number of voltage reference ICs!&nbsp; e.g. <a href="http://uk.farnell.com/intersil/isl21010cfh330z-tk/v-ref-5-5vin-3v-0-2-3sot23/dp/2112003">this one</a> produces 3V +/- 0.2% given an input voltage of 3.1 - 5.5v.&nbsp; Tolerances down to 0.05% seem pretty common too.&nbsp; I&#39;m starting to quite like the idea of using two or three different external voltage references (e.g. 1v, 2v and 3v) in combination with precision full-wave rectification.&nbsp; <a href="http://www.ti.com/general/docs/lit/getliterature.tsp?baseLiteratureNumber=slyt183&amp;fileType=pdf&amp;track=no">TI have a nice introductory PDF</a> on voltage references.</p>
<p>So my hardware design is starting to look something like this:</p>
<ul>
<li>
		25A CT delivering 0.33v max -&gt; dual-rail op-amp to amplify to 3v peak to peak -&gt; precision full-wave rectifier -&gt; ATmega ADC input</li>
<li>
		AC-to-AC (or capacitance sensor) -&gt; resistor voltage divider to produce 3v peak to peak -&gt; precision full-wave rectifier -&gt; ATmega ADC input</li>
<li>
		the half-wave rectifiers within each full-wave rectifier will feed an op-amp with very high gain to produce a digital &quot;sign&quot; signal -&gt; ATmega digital input</li>
<li>
		three different external v refs -&gt; switch -&gt; ATmega AREF pin</li>
</ul>
<p>&nbsp;</p>
<p>Does this sound sensible?!&nbsp; It&#39;s starting to look like quite a lot of electronics work!</p>
<p>I guess one danger of using switchable v refs to change ADC range is that if we, say, use a v ref of 0.5V then we&#39;ll be amplifying very small inputs to the ATmega, and I suspect the ATmega&#39;s IC isn&#39;t the quietest environment in the world.&nbsp; So maybe it is better to use a switchable-gain amp instead of switchable v refs.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8613"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sat, 22/12/2012 - 15:21.</div>
    <div class="content">
     <p>There is some evidence that many constructors have had noise problems, so I would tread carefully if you are aiming to get accurate readings at low powers. Good PCB layout with good analogue layout practices and close attention to supplies and grounding will be essential.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8617"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Sat, 22/12/2012 - 15:56.</div>
    <div class="content">
     <p>ok, thanks, in which case I&#39;m leaning towards the idea of using a single precision v ref and a switchable-gain op amp for the CT feeding into a precision full-wave rectifier.&nbsp; That way the low amplitude signals will only exist in the CT, the cable from the CT and the first op-amp.&nbsp; The full-wave rectifier and ADC will always see relatively large amplitude signals, so the SNR should be reasonably good.</p>
<p>thanks again for all your help.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8620"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Sat, 22/12/2012 - 16:40.</div>
    <div class="content">
     <p>By the way, here&#39;s my basic maths which suggests I need both precision rectification <em>and</em> switchable-gain op-amp for measuring current...</p>
<p>If I use a 25A CT and precision rectification then those 25A can occupy the full 1024 steps of the ADC.&nbsp; So 1 amp would read 40 on the ADC.&nbsp; Hence a single ADC step would represent 1/40th of an amp or 5 watts.&nbsp; Ideally I&#39;m after a resolution of more like 0.5 watts.&nbsp; Hence I need a variable-gain op amp as well as precision rectification.&nbsp; (of course, this extra resolution will be no use if it&#39;s buried in noise!)</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8624"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1824" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1824" title="View user profile.">MartinR</a> on Sat, 22/12/2012 - 17:25.</div>
    <div class="content">
     <p>I thought you&#39;d decided 25A was RMS so peak will be ~35A&nbsp;so 28 samples?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8626"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Sat, 22/12/2012 - 17:58.</div>
    <div class="content">
     <p>yes, you're right! even more need for a switchable gain amp! </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8631"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Sat, 22/12/2012 - 22:24.</div>
    <div class="content">
     <p>maybe I should think about just using a high-bit-depth external ADC, like one that fluppie007 mentioned<a href="http://openenergymonitor.org/emon/node/1705#comment-8458"> in this comment.</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8635"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Sun, 23/12/2012 - 07:48.</div>
    <div class="content">
     <p>and now I'm thinking of using a raspberry Pi with a USB sound card and the same "sound card scope" circuit that Robert used to test the 100amp CT. </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8636"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sun, 23/12/2012 - 09:56.</div>
    <div class="content">
     <p>The Zeitnitz sound-card scope works nicely and I made use of this when playing around with direct &#39;Live&#39; measurements some months ago.&nbsp; At its core, however, it is just another sampling system for which appropriate input circuits have to be provided.&nbsp;</p>
<p>Having worked out how to get raw samples from the Arduino into a spreadsheet (thanks Robert!), good quality test data is now available by this alternative means.&nbsp; These values can then be analysed and displayed in whatever way is appropriate.&nbsp;&nbsp; This approach involves no extra hardware, and takes up no extra bench space</p>
<p>When using the scope, I found I needed to disconnect the Earth lead, otherwise the house kept tripping out :(</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8638"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1165" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="richmc&#039;s picture" title="richmc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1165" title="View user profile.">richmc</a> on Sun, 23/12/2012 - 10:37.</div>
    <div class="content">
     <p>This is the&#39; scope i have and would recommend it highly -</p>
<p><a href="http://www.ebay.co.uk/itm/Hantek-DSO2250-PC-Based-USB-digital-oscilloscope-DSO-2250-250MS-s-2CH-/121033693084?pt=BI_Oscilloscopes&amp;hash=item1c2e2b979c">http://www.ebay.co.uk/itm/Hantek-DSO2250-PC-Based-USB-digital-oscilloscope-DSO-2250-250MS-s-2CH-/121033693084?pt=BI_Oscilloscopes&amp;hash=item1c2e2b979c</a></p>
<p>This is also&nbsp;&nbsp;the supplier I got it from with no problems.</p>
<p>As an aside as Robert Wall said earlier the SCT transformers&nbsp;seem to all be the same windings and core wise, the voltage O/P types have burden resistors to suit a given conversion&nbsp;of Amps for 1V o/p so an 030 will give 1V for 30A thats not to say they can&#39;t measure higher as the basic one will operate to 100A, you just chose the one that gives the o/p range you need, for domestic measument the 030 works fine giving 1V at 30A. With the 100A you choose the burden to suit, I doubt if will saturate below 100A just give you a higher voltage, a &#39;scope will show if they are saturating.</p>
<p>The posts around the waveform for the hair drier were quite amusing, The manufacturers seem to plonk a diode in to give half power, thats common (not very good) practice&nbsp;and is used in electric paint strippers etc, in reality you&nbsp;may never be measuring a hairdrier at half load, I use an Eco Eye monitor and it not upset by the wifes hairdryer!</p>
<p>EDIT - If you want to measure 240V mains you will need a x100 probe (around &pound;20 if you shop around eBay)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8640"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sun, 23/12/2012 - 10:40.</div>
    <div class="content">
     <p><em>I use an Eco Eye monitor and it not upset by the wifes hairdryer!</em></p>
<p>Isn&#39;t that because the Eco Eye assumes that all waveforms are sinusoidal, and that the mains voltage is always at a constant level ;)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8650"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Sun, 23/12/2012 - 14:27.</div>
    <div class="content">
     <p>Robin wrote:</p>
<blockquote><p><em>The Zeitnitz sound-card scope works nicely and I made use of this when playing around with direct &#39;Live&#39; measurements some months ago.&nbsp; At its core, however, it is just another sampling system for which appropriate input circuits have to be provided.&nbsp;</em></p>
<p><em>Having worked out how to get raw samples from the Arduino into a spreadsheet (thanks Robert!), good quality test data is now available by this alternative means.&nbsp; These values can then be analysed and displayed in whatever way is appropriate.&nbsp;&nbsp; This approach involves no extra hardware, and takes up no extra bench space</em></p>
<p>&nbsp;</p>
</blockquote>
<p>Sorry, I should clarify my last post: I&#39;m now thinking of using a Raspberry Pi plus a 16-bit USB sound card not (just) as a cheap scope, but to actually<em> replace my emonTX</em>.&nbsp; i.e. the RPi will be responsible for measuring my whole-house power consumption.&nbsp; The CT will feed one microphone channel, the voltage measurement device will feed the other channel.</p>
<p>This setup appears to have several advantages over using an ATmega328:</p>
<ul>
<li>
		16 bit per channel at very cost-effective prices (16bpc ADC chips aren&#39;t cheap)</li>
<li>
		simultaneous sampling of I and V</li>
<li>
		up to 48kHz sampling of both I and V</li>
<li>
		minimal electronics to build.&nbsp; If I understand <a href="http://openenergymonitor.org/emon/buildingblocks/report-mascot-9v-acac-adaptor">Robert&#39;s design</a> correctly, we just need a couple of resistors and a couple of diodes per channel.&nbsp; No voltage bias circuit required (because the sound card can accept +/- AC).</li>
<li>
		hugely more processing power available on the RPi (700MHz ARM plus a reasonably beefy GPU)</li>
<li>
		easy to develop for (we can use &quot;full fat&quot; C++ or Python.&nbsp; AVR C++ doesn&#39;t include exceptions or the full STL). There are also lots of command-line apps that may be useful.</li>
<li>
		With the addition of a cheap USB hard disk, I could record the full waveform sampled at 48kHz.&nbsp; This is useful for doing disaggregation and/or experimenting with different DC-tracking algorithms (the CT will stil drift).</li>
</ul>
<p>Of course, there down sides.&nbsp; It&#39;s a little more expensive and a lot more power-hungry.</p>
<p>Rich wrote:</p>
<blockquote><p><em>As an aside as Robert Wall said earlier the SCT transformers&nbsp;seem to all be the same windings and core wise, the voltage O/P types have burden resistors to suit a given conversion&nbsp;of Amps for 1V o/p</em></p>
</blockquote>
<p>Very interesting!&nbsp; In which case I&#39;ll just stick with the 000 model and provide my own burden resistor.</p>
<blockquote><p><em>If you want to measure 240V mains you will need a x100 probe&nbsp; </em></p>
</blockquote>
<p>Would a &#39;scope probe provide better performance than an AC-to-AC adapter for measuring voltage?&nbsp; I assume so.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8654"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sun, 23/12/2012 - 16:02.</div>
    <div class="content">
     <p><em>&quot;Would a &#39;scope probe provide better performance than an AC-to-AC adapter for measuring voltage?&nbsp; I assume so.&quot;</em></p>
<p>But remember what I keep on saying about isolation! It&#39;s going to be <em>so easy</em> for someone to get badly hurt if you&#39;re making direct connections to the mains and something goes wrong or isn&#39;t right in the first place.</p>
<p>Did I ever post about a neighbour who had a new electric shower installed by a plumber who though he knew what he was doing? The idiot swapped line and neutral at the Henley Blocks he put in, and every single plug, socket, appliance and wire in the house was only protected from an earth fault by the supplier&#39;s 100 A fuse.&nbsp; If one of your students connected to a plug in that house, they could have become a fatality.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8656"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Sun, 23/12/2012 - 16:28.</div>
    <div class="content">
     <p>Ok, point well made, I'll stick with the AC to AC adapter! </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8659"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1165" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="richmc&#039;s picture" title="richmc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1165" title="View user profile.">richmc</a> on Sun, 23/12/2012 - 17:26.</div>
    <div class="content">
     <p>For your application Jack definitely an ac-ac adapter not the probe. I was referring to the &#39;scope I posted the eBay link to. And as you say the 000 will allow you to experiment with burden value.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8665"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Sun, 23/12/2012 - 18:12.</div>
    <div class="content">
     <p>I think most of us have gone through the phase of wanting to make direct measurements to the mains so as to really understand what&#39;s going on. &nbsp; Yes, it does work, but it&#39;s not a practical solution for the long-term.&nbsp; And its a bit scary too!!</p>
<p>Robert deserves a medal for the number of times he&#39;s had to haul people away from this particular precipice ...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8668"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Sun, 23/12/2012 - 19:07.</div>
    <div class="content">
     <p>one issue that is coming to light regarding sound cards is that they include a high pass filter in their input stage with a cut off around 10 to 20 hz.  of course, that shouldn't be a problem for measuring 'normal'  loads but it might complicate the measurement of half wave appliances (for the same reason that emonlib's hpf gets confused by half wave appliances). i have it on good authority that Santa (well, my PhD supervisor)  has bought me a cheap bench scope so I'll be able to do a direct comparison. </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8669"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Sun, 23/12/2012 - 19:08.</div>
    <div class="content">
     <p>and yes, Robert deserves a medal for multiple reasons ;)  </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8672"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Sun, 23/12/2012 - 20:02.</div>
    <div class="content">
     <p>incidentally, last year a group at MIT measured I and V in 6 homes at 15khz and published the data. </p>
<p>They used Two 200A TED CTs and Pico TA041 'scope probe to measure voltage (100:1 step down), connected to a National Instruments NI-9239 ADC (24-bit 15kHz)</p>
<p>i guess they are braver than me ;) (because they used a scope probe) </p>
<p><a href="http://redd.csail.mit.edu" title="http://redd.csail.mit.edu">http://redd.csail.mit.edu</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8680"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1165" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="richmc&#039;s picture" title="richmc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1165" title="View user profile.">richmc</a> on Mon, 24/12/2012 - 08:36.</div>
    <div class="content">
     <p>Nothing wrong with the correct use of a &#39;scope probe...............................with a scope. I wouldn&#39;t like to try it with a sound card though.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8682"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Mon, 24/12/2012 - 10:02.</div>
    <div class="content">
     <p>oh, I see. so the scope (or the fancy adc module used by the mit group)  handles isolation issues, not the scope probe itself. Thanks, I understand now. </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8685"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Mon, 24/12/2012 - 12:55.</div>
    <div class="content">
     <p>Just to confirm... some probes offer 2kV isolation but I assume that&#39;s 2kV <strong><em>between</em></strong> the scope probe&#39;s ground connection and the probe&#39;s signal connection?&nbsp; I assume the danger arises because the probe doesn&#39;t offer any protection of high voltages between<em><strong> earth</strong></em> and either of the probe connections?&nbsp; Is that about right?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8687"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Mon, 24/12/2012 - 14:52.</div>
    <div class="content">
     <p><em>&quot;Just to confirm... some probes offer 2kV isolation but I assume that&#39;s 2kV between the scope probe&#39;s ground connection and the probe&#39;s signal connection?&nbsp; I assume the danger arises because the probe doesn&#39;t offer any protection of high voltages between earth and either of the probe connections?&nbsp; Is that about right?&quot;</em></p>
<p>I&#39;m not sure of your terminology here. Most passive &#39;scope probes that I&#39;ve come across have a probe tip which is connected to the amplifier input by a screened cable. The cable screen is brought out to an earth clip. The earth clip is connected to the signal common, chassis and the case of the instrument, and that for safety must be earthed via the mains lead.&nbsp;</p>
<p>You can however have (expensive) isolation amplifiers or differential probes (e.g. <a href="http://uk.rs-online.com/web/p/oscilloscope-probes/7336145/" title="http://uk.rs-online.com/web/p/oscilloscope-probes/7336145/">http://uk.rs-online.com/web/p/oscilloscope-probes/7336145/</a> which incorporates the probes in one assembly and is battery powered) to go with your &#39;scope, these in effect contain the same &#39;front end&#39; as a &#39;scope but offer isolation between the probe &quot;earth&quot; (now more properly the signal reference or &#39;common&#39; connection - the black lead in the Agilent example above) and mains earth.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8689"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Mon, 24/12/2012 - 18:54.</div>
    <div class="content">
     <p>that's great, thanks for the clarification.  And happy Christmas! </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8964"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Tue, 08/01/2013 - 10:05.</div>
    <div class="content">
     <p>Hi,</p>
<p>So, I now have a Rigol DS1052E budget &#39;scope (yay!)</p>
<p>Given Robert&#39;s description of passive &#39;scope probes, I assume it would still be a very bad idea to try to measure the mains voltage waveform using a 100:1 passive probe by connecting the probe tip to live and the probe earth connection to neutral (because there may be a considerable voltage between neutral and earth).</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8966"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Tue, 08/01/2013 - 10:33.</div>
    <div class="content">
     <p>I would agree.&nbsp; Any non-temporary connection to the mains for measurement purposes is unlikely to gain approval in this place!</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8974"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 08/01/2013 - 13:45.</div>
    <div class="content">
     <p>And &quot;temporary&quot; might mean a few milliseconds while it blows up if you failed to measure and check the voltage first.</p>
<p>Don&#39;t ever be tempted to do what was common practice when I was an apprentice - remove the earth connection from the &#39;scope. Quite a lot of people leaned on the &#39;scope trolley and if they happened to be wearing leather-soled shoes they removed themselves very sharply with a few colourful words. That&#39;s because the electronics &quot;0 V&quot; common rail was actually at mains line potential.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8978"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Tue, 08/01/2013 - 14:04.</div>
    <div class="content">
     <p>OK!</p>
<p>Robert, how did you connect your sound card to the &quot;mains&quot; when you did your (very helpful) <a href="http://openenergymonitor.org/emon/buildingblocks/report-mascot-9v-acac-adaptor">report on the Mascot 9V AC/AC adapter</a>?&nbsp; At first glance, the circuit diagram appears to show that neutral is connected directly to the sound card&#39;s signal ground:</p>
<p><img alt="" src="http://openenergymonitor.org/emon/sites/default/files/mascotreport/mascot_report06.png" style="width: 934px; height: 447px;" /></p>
<p>I have precisely zero experience with variable transformers so I assume that I&#39;m just getting confused by the notation and that the far left of the diagram is the secondary winding of the transformer rather than a direct connection to live and neutral (and hence you have galvanic isolation from the mains)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8983"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/956" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/956" title="View user profile.">calypso_rae</a> on Tue, 08/01/2013 - 15:37.</div>
    <div class="content">
     <p>When I did this kind of test, my entire rig was tied directly to mains Neutral (hence the absence of any earths in scopes, power supplies etc.)</p>
<p>It did work, and it heated up several tanks of hot water during the summer, but is not to be recommended.&nbsp; Far too scary!!</p>
<pre>
         \\\|||///
          \\|||//

           O   O

            ~~~</pre><p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8993"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 08/01/2013 - 20:08.</div>
    <div class="content">
     <p>The diagram is accurate, there is a direct connection to neutral. I very carefully checked that the neutral voltage was indeed very close to earth (we have PME here - TN-C-S system) and then I very carefully checked and double-checked that all other equipment was earth-free and that I would be too whilst doing the measurements. And I did have a double-pole switch that broke both line and neutral, so the neutral connection was only present while I was actually making the measurements.</p>
<p>As Robin says, scary!&nbsp; I would have much preferred to do it in a better, safer way but as I&#39;ve survived 45 years in the industry,&nbsp; I do think I&#39;m aware of the dangers and took all reasonable precautions. I did mean every word in the warning at the top of the report. There&#39;s a big difference between a series of measurements in laboratory conditions spanning a few tens of minutes by someone who is aware of the dangers, and general use.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8996"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1332" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1332.jpg" alt="JBecker&#039;s picture" title="JBecker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1332" title="View user profile.">JBecker</a> on Tue, 08/01/2013 - 20:35.</div>
    <div class="content">
     <p>Jack, might be a bit out of the line of the last posts, but might still be interesting regarding your original idea to have more ADC resolution on the emontx:</p>
<p>I have done a very simple 12 bit ADC addon for the emontx using an MCP3208 (~&euro;3). It fits to the &#39;jeenode&#39; headers of the emontx. Practical results with an SCT-013-030 current clamp are so that I get a reading of 11.0W +/0.5W for an 11W ESL lamp. I have not done any further testing, for me it was just a proof of concept. Sampling of one channel takes ~10us, so it is around 10 times faster as with the ATmegas internal ADC.</p>
<p>If you (or someone else) are (is) interested, drop me a line.&nbsp; &nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9002"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Wed, 09/01/2013 - 11:05.</div>
    <div class="content">
     <p>Jorg, it would be interesting to know how much noise you pick up from the digital circuitry with that, and what the layout of your analogue circuitry is.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9004"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Wed, 09/01/2013 - 11:35.</div>
    <div class="content">
     <blockquote><p><em>&quot;I have done a very simple 12 bit ADC addon for the emontx using an MCP3208&quot;</em></p>
</blockquote>
<p>That is very interesting, thank you.</p>
<p>My current plan is to try using the line-input of the Intel Atom motherboard (model BOXD2700MUD) that I&#39;m using for data logging.&nbsp; The Intel motherboard with built-in Atom is about &pound;50 so it&#39;s quite a bit more expensive than an emonTX or RPi.&nbsp;&nbsp; But I needed an Atom PC for other reasons so it works out very cost effectively for my project.</p>
<p>One nice thing about the motherboard is that it has two stereo 96kHz 20-bit ADCs with built-in HPFs with cut offs around 10Hz.&nbsp; So my hope is that I&#39;ll be able to connect my CT and AC-AC adapter &quot;directly&quot; to the line-input of the motherboard (via some resistors and protection diodes but there should be no need for op-amps or bias voltage circuits).&nbsp; If I really wanted to I could sample at 96kHz but that&#39;s probably way above the frequency response of either the CT or AC-AC adapter ;).&nbsp; I might experiment with sampling at 96kHz and then down-sample in software to, say, 4kHz by taking the average of every 16 samples, hence increasing the effective SNR (because the averaging process will reduce any normally-distributed noise).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9007"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1332" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1332.jpg" alt="JBecker&#039;s picture" title="JBecker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1332" title="View user profile.">JBecker</a> on Wed, 09/01/2013 - 12:53.</div>
    <div class="content">
     <p>&#39;Layout&#39; is not the right word :-) As said, it was just a proof of concept and I had the chip lying around from an &#39;ancient&#39; project.</p>
<p>It&#39;s all done with single wires on a &#39;hole matrix&#39; pcb. I have added 10nF on every ADC input and an additional decoupling cap for the adc. These capacitors plus the adc are the only components on the board.</p>
<p>I will try to do a schematic and take some photos this evening.&nbsp;</p>
<p>Robert, how can I give meaningful information about the noise? Give numbers for power reading with input shorted or with CT connected (no load)? &nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9012"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1332" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1332.jpg" alt="JBecker&#039;s picture" title="JBecker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1332" title="View user profile.">JBecker</a> on Thu, 10/01/2013 - 09:01.</div>
    <div class="content">
     <p>I have drawn a small schematic (in Protel, so the schematic is attached as jpeg).</p>
<p>The code comes in two flavors, compact (MCP_Read()) or fast (MCP_ReadF()). In the fast version the for loop is unrolled, reading takes less than 8us on a 16MHz ATmega.</p>
<p>The ADC uses exactly the original analog circuitry of the emontx, adc channel numbers are the same. So it is very easy to change from internal ADC to external MCP3208 and vice versa. It would also be possible to read one channel with the internal ADC (voltage) and the other with the external MCP (current).</p>
<p>The circuit eats up nearly all the available I/Os. Instead of using IRQ to <strike>read</strike> write to DIN of the MCP, it would be possible to use DIO4 instead. You either sacrifice the pulse counting capability of the emontx or the DS18B20 temperature input.</p>
<p><strike>PS: pictures were so big, I decided not to attach them</strike>.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9017"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Wed, 09/01/2013 - 23:26.</div>
    <div class="content">
     <p>Jorg, the only meaningful way of comparing with what has been reported for various builds (emonTx / pcb, Arduino / stripboard etc) would be with a c.t. around a live conductor and connected but with no current drawn, because the usual complaint is &quot;my xxx reads x watts and nothing is switched on&quot;. While detailed measurements would be interesting, they would not be very meaningful because we would be comparing against what various users have reported over time - and their setup is often not specified!&nbsp; From the figures you quoted, the performance looks to be about a factor of 4 better than the emonTx / Arduino - as one would expect - and therefore the absolute noise (referred to the load current) is at least 4 times smaller than what we normally see (though as we know, where the zero sits in relation to the quantisation levels plays a part). So if you could note the indicated rms current - maybe a few times over a period to include any drift, that would be excellent, thanks.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9020"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/1332" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-1332.jpg" alt="JBecker&#039;s picture" title="JBecker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/1332" title="View user profile.">JBecker</a> on Thu, 10/01/2013 - 09:02.</div>
    <div class="content">
     <p>I just made a fast test with two different loads, all measurements averaged over 5 seconds. The results were compared to a VC870 digital multimeter with power measurement adapter.</p>
<pre>
*** no load  VC870: 0.5W 0.8VA ***
Vrms: 230.74  Irms: 0.067  Preal1:   0.7  Papp1:  15.3  kWh: 0.000
Vrms: 230.70  Irms: 0.061  Preal1:   0.6  Papp1:  14.0  kWh: 0.000
Vrms: 230.65  Irms: 0.056  Preal1:   0.6  Papp1:  12.9  kWh: 0.000
Vrms: 230.59  Irms: 0.060  Preal1:   0.6  Papp1:  13.9  kWh: 0.000
Vrms: 230.82  Irms: 0.058  Preal1:   0.3  Papp1:  13.4  kWh: 0.000
Vrms: 230.76  Irms: 0.056  Preal1:   0.3  Papp1:  12.9  kWh: 0.000
*** 300W halogen lamp two turns! VC870: 304,8W 304,8VA ***
Vrms: 229.52  Irms: 2.669  Preal1: 612.1  Papp1: 612.6  kWh: 0.001
Vrms: 229.61  Irms: 2.668  Preal1: 612.0  Papp1: 612.5  kWh: 0.002
Vrms: 229.54  Irms: 2.664  Preal1: 611.1  Papp1: 611.6  kWh: 0.003
Vrms: 229.54  Irms: 2.664  Preal1: 611.1  Papp1: 611.6  kWh: 0.003
Vrms: 229.42  Irms: 2.663  Preal1: 610.4  Papp1: 610.9  kWh: 0.004
Vrms: 229.40  Irms: 2.661  Preal1: 610.0  Papp1: 610.5  kWh: 0.005
Vrms: 229.34  Irms: 2.658  Preal1: 609.2  Papp1: 609.7  kWh: 0.005
Vrms: 229.49  Irms: 2.660  Preal1: 610.0  Papp1: 610.5  kWh: 0.006
*** no load  VC870: 0.5W 0.8VA ***
Vrms: 230.63  Irms: 0.060  Preal1:   0.1  Papp1:  13.8  kWh: 0.006
Vrms: 230.46  Irms: 0.056  Preal1:   0.3  Papp1:  12.9  kWh: 0.006
Vrms: 230.64  Irms: 0.059  Preal1:   0.4  Papp1:  13.7  kWh: 0.006
*** 11W ESL  VC870: 11.8W 17.6VA ***
Vrms: 230.50  Irms: 0.107  Preal1:  11.5  Papp1:  24.7  kWh: 0.006
Vrms: 230.38  Irms: 0.110  Preal1:  11.5  Papp1:  25.4  kWh: 0.006
Vrms: 230.47  Irms: 0.112  Preal1:  12.1  Papp1:  25.8  kWh: 0.006
Vrms: 230.29  Irms: 0.114  Preal1:  11.9  Papp1:  26.2  kWh: 0.006
Vrms: 230.53  Irms: 0.115  Preal1:  12.1  Papp1:  26.5  kWh: 0.006
Vrms: 230.54  Irms: 0.119  Preal1:  12.2  Papp1:  27.4  kWh: 0.006
Vrms: 230.58  Irms: 0.118  Preal1:  12.4  Papp1:  27.3  kWh: 0.006
Vrms: 230.62  Irms: 0.119  Preal1:  12.1  Papp1:  27.5  kWh: 0.006
Vrms: 230.41  Irms: 0.118  Preal1:  12.2  Papp1:  27.1  kWh: 0.006
Vrms: 230.77  Irms: 0.117  Preal1:  12.2  Papp1:  27.0  kWh: 0.006
</pre><p>Current and power values to be divided by 2 for the 300W lamp (two loops through current clamp).</p>
<p>Robert, if all this is OT, can you move it to another thread?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9023"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/2484" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-2484.jpg" alt="jack_kelly&#039;s picture" title="jack_kelly&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/2484" title="View user profile.">jack_kelly</a> on Thu, 10/01/2013 - 12:49.</div>
    <div class="content">
     <p>Here are some very quick experiments with the 20bit 96kHz ADC on my Intel Atom motherboard.</p>
<p>I used the standard OEM current transformer with a 22 ohm burden resistor (which gives about a 0.89V peak-to-peak output when presented with a 30 amps RMS primary current: 0.89V peak-to-peak is, according to WikiPedia, the standard for line inputs and 30amps RMS is, I believe, the most my house every pulls )</p>
<p>I connected the CT to a test rig with just an 11W CFL plugged in.</p>
<p>In both attached graphs, the lamp is off for the first third of the graph and is then switched on.&nbsp; I haven&#39;t calibrated this system yet so the y-axis is arbitrary.</p>
<p>There are two graphs attached.&nbsp; cfl_96kHz.png is the raw sample from the current transformer (after applying a 5Hz HPF in Audacity).</p>
<p>cfl_8kHz is the raw sample down-sampled to 8kHz.&nbsp; Note that the noise is considerably reduced.</p>
<p>This quick test suggests that this sound card ADC has plenty of dynamic range to work as a good energy monitor ;)&nbsp; and that sampling at 96kHz and then down-sampling to 8kHz does get rid of a lot of the noise.&nbsp; (I&#39;m only judging by eye at the moment, no quantitative measurements yet I&#39;m afraid)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27855"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/7148" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="bavitalsign&#039;s picture" title="bavitalsign&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/7148" title="View user profile.">bavitalsign</a> on Wed, 18/02/2015 - 09:28.</div>
    <div class="content">
     <p>Hi. I am also interested in checking the accuracy with the&nbsp;sound card. Currently I&#39;m using the Emontx V3 with adaptor and 100 A CT all from the OEM shop. I have gone through the report on Mascot and ideal AC to AC adaptor in the forum and also this&nbsp;design by Jack Kelly (here <a href="https://github.com/JackKelly/snd_card_power_meter" title="https://github.com/JackKelly/snd_card_power_meter">https://github.com/JackKelly/snd_card_power_meter</a>). &nbsp;I want to ask some basic things before I proceed</p>
<p>1. Is it possible to try this design&nbsp;safely on a normal breadboard (Considering the current ratings of this circuit)?</p>
<p>2. If I am correct, with Jack&#39;s circuit we just have to add fuses (along with resistances&nbsp;and diodes)in the circuit and plugin the AC-AC adapter from shop?</p>
<p>
Thanks</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27863"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Wed, 18/02/2015 - 15:00.</div>
    <div class="content">
     <p>I don't see how you could have sufficient current from this that would <i>not</i> be handled by breadboard. The CT output is normally (except if you have a fault downstream) limited to 50 mA per 100 A of primary current, or (from memory) about 200 mA when saturated, and the standard ac adapter has a continuous current of 670 mA and an internal impedance of around 6 &Omega; that will limit the current from that. "Veroboard" tracks are good to about 2 A for short periods, so the only problem is if you have a fault between the ac adapter input and the 10 k&Omega; dropper resistor. If that happens, I think (and I'm not going to test it!) that the internal protection in the adapter - a thermal fuse in the primary winding (see the data sheet) - would operate before anything happened to your breadboard.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27867"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/7148" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="bavitalsign&#039;s picture" title="bavitalsign&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Smaller current CT?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/7148" title="View user profile.">bavitalsign</a> on Wed, 18/02/2015 - 16:33.</div>
    <div class="content">
     <p>Ok Thank you. I will try to see the datasheet and test it... TC</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="/emon/node/1680?page=1"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-LFKDvCXINVHeNn92nxcZQHRZogWeYWXYpQJH22Hok2E" value="form-LFKDvCXINVHeNn92nxcZQHRZogWeYWXYpQJH22Hok2E"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org">https://community.openenergymonitor.org</a></p>
   
</div>

<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
