<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11751 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:49:25 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Experimenting with Node-RED Emoncms Node | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Experimenting with Node-RED Emoncms Node</h3>
        <span class="submitted">Submitted by <a href="../user/8298.html" title="View user profile.">Jon</a> on Fri, 04/12/2015 - 03:54</span>
        <div class="content"><p>I am looking for help configuring the Emoncms post node for Node-Red. &nbsp;Has someone used the Post side of node-red-node-emoncms?</p>
<p>&nbsp;</p>
<p>
<strong>Details:</strong><br />
After reading Glyn&rsquo;s post on <a href="http://openenergymonitor.blogspot.com/2015/11/node-red-emoncms-node.html">Node-RED Emoncms Node</a>&nbsp;I decided to give Node-Red a try. &nbsp;My short-term (install, learn, test) goal is to grab the room temperature from the Nest and post it to my emonPi emoncms. &nbsp;No real hard core reason why this is needed - I am trying Node-Red.</p>
<p>I&rsquo;ve installed the following items on my Mac:<br />
&nbsp;&nbsp; &nbsp;&bull;&nbsp;&nbsp; &nbsp;<a href="https://nodejs.org/dist/v0.12.8/node-v0.12.8.pkg">node.js</a> (v0.12.8)<br />
&nbsp;&nbsp; &nbsp;&bull;&nbsp;&nbsp; &nbsp;<a href="http://nodered.org/docs/getting-started/installation.html">Node-RED</a> (v0.12.2)<br />
&nbsp;&nbsp; &nbsp;&bull;&nbsp;&nbsp; &nbsp;<a href="http://flows.nodered.org/node/node-red-node-emoncms">node-red-node-emoncms</a> (v0.0.6)<br />
&nbsp;&nbsp; &nbsp;&bull;&nbsp;&nbsp; &nbsp;<a href="http://flows.nodered.org/node/node-red-contrib-nest">node-red-contrib-nest</a> (v0.1.6)</p>
<p>I can get these nodes (with flows) to work:<br />
&nbsp;&nbsp; &nbsp;&bull;&nbsp;&nbsp; &nbsp;Emoncms (In) Node: &nbsp;Fetches last emoncms feed value, returns numerical value.<br />
&nbsp;&nbsp; &nbsp;&bull;&nbsp;&nbsp; &nbsp;Nest Request Node: Returns all Nest device data</p>
<p>But I am struggling with is the Post data to Emoncms. &nbsp;There is no data written to Node 14 and no errors (that I can locate). &nbsp;Here is how the nodes are configured:</p>
<p><img alt="" src="../sites/default/files/Edit%20emoncms%20node_thumb_1.jpg" /></p>
<p><img alt="" src="../sites/default/files/Edit%20emoncms-server%20config%20node_thumb.jpg" /></p>
<p><strong>Edit function node: </strong>&nbsp;&nbsp;</p>
<p>msg.payload = {&quot;name&quot;:&quot;power1&quot;,&quot;value&quot;:&quot;100&quot;,&quot;unit&quot;:&quot;W&quot;};<br />
return msg;</p>
<p>Any thoughts on what I am doing wrong?</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11790.html" class="topic-previous" title="Go to previous forum topic">‹ Installing Node-RED and Adding Nodes on an emonPi</a>
              <a href="11786.html" class="topic-next" title="Go to next forum topic">Trouble using mqtt_input ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-36687"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8839.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="joyrider3774&#039;s picture" title="joyrider3774&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/8839.html" title="View user profile.">joyrider3774</a> on Fri, 04/12/2015 - 08:38.</div>
    <div class="content">
     <p>i have node-red flow&#39;s that work for input as well as output without a problem. i&#39;m using it with a modified button widget to update a feed with the status of my wemo insight as well as turn onn / off my wemo insight from within emoncms. It works without a problem with me however i&#39;m not using a function node at least i think so. I&#39;m using a template node where i have written kitchencontrol:0 or kitchencontrol:1 and that&#39;s what i send to emoncms.</p>
<p>so i don&#39;t know if it has double quotes or needs single quotes or no quotes at all. What i did find out was that i to use the write api key and once i had to reenter it to make it work again but don&#39;t think that&#39;s the problem.</p>
<p>You could try using a template once to write to the emoncms node as a test and see if that works.</p>
<p>i don&#39;t use emonpi though my node red and emoncms are installed on a windows pc although that shouldn&#39;t make a diffrence either</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36714"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8298.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-8298.jpg" alt="Jon&#039;s picture" title="Jon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/8298.html" title="View user profile.">Jon</a> on Fri, 04/12/2015 - 16:23.</div>
    <div class="content">
     <p>Willems - I changed the Function Node to a Template Node and no joy. &nbsp;I tried your name &amp; value of&nbsp;kitchencontrol:0 (without quotes), &#39;kitchencontrol:0&#39;, &nbsp;&quot;kitchencontrol:0&quot;, and&nbsp;{kitchencontrol:0} and none of those worked. &nbsp;</p>
<p><img alt="" src="../sites/default/files/Screen%20Shot%202015-12-04%20at%2010.16.33%20AM_thumb.jpg" /></p>
<p>I also tried&nbsp;updating the api RW key.</p>
<p>Not sure if this matters but I am using the low-write v8.5 of emoncms. &nbsp;I wonder if I need to be on v9?!?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36718"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8839.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="joyrider3774&#039;s picture" title="joyrider3774&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/8839.html" title="View user profile.">joyrider3774</a> on Fri, 04/12/2015 - 16:39.</div>
    <div class="content">
     <p>ah i don&#39;t know if you need emoncms v9.0 but i do have emoncms v 9.2 installed locally.</p>
<p>didn&#39;t the url /input/post.json can&#39;t remember exactly from the input api change over time ? if that&#39;s the case you need to adapt the source code of node-red-node-emoncms to to reflect to your old url if your input api is still also using /input/post.json that&#39;s not the problem then</p>
<p>that&#39;s the last thing i can think of</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36736"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8298.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-8298.jpg" alt="Jon&#039;s picture" title="Jon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/8298.html" title="View user profile.">Jon</a> on Sat, 05/12/2015 - 03:54.</div>
    <div class="content">
     <p>I don&#39;t know&nbsp;enough about the changes between version 8.5 and version 9.x since I am still on the old version. &nbsp;Has anyone else used Node-Red and the&nbsp;Post side of node-red-node-emoncms?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36741"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Sat, 05/12/2015 - 10:48.</div>
    <div class="content">
     <p>I&#39;ve just tested emoncms posting with latest version of nodeRED (V12.2). It worked fine for me, see below for screen grab and node export.&nbsp;</p>
<p>&nbsp;</p>
<p><a href="../sites/default/files/nodered_emoncms.html"><img alt="" src="../sites/default/files/nodered_emoncms.html" style="width: 700px; height: 346px;" /></a></p>
<p>&nbsp;</p>
<p>[{&quot;id&quot;:&quot;4889044b.b776fc&quot;,&quot;type&quot;:&quot;emoncms-server&quot;,&quot;z&quot;:&quot;5a0f1398.a5f0ec&quot;,&quot;server&quot;:&quot;http://192.168.0.35/emoncms&quot;,&quot;name&quot;:&quot;emoncms local post&quot;},{&quot;id&quot;:&quot;84272ebc.7bd8d&quot;,&quot;type&quot;:&quot;inject&quot;,&quot;z&quot;:&quot;5a0f1398.a5f0ec&quot;,&quot;name&quot;:&quot;&quot;,&quot;topic&quot;:&quot;&quot;,&quot;payload&quot;:&quot;1,2,3,4&quot;,&quot;payloadType&quot;:&quot;string&quot;,&quot;repeat&quot;:&quot;&quot;,&quot;crontab&quot;:&quot;&quot;,&quot;once&quot;:true,&quot;x&quot;:474,&quot;y&quot;:161,&quot;wires&quot;:[[&quot;b8215cbe.47dea&quot;,&quot;d3862714.2c79d8&quot;]]},{&quot;id&quot;:&quot;b8215cbe.47dea&quot;,&quot;type&quot;:&quot;emoncms&quot;,&quot;z&quot;:&quot;5a0f1398.a5f0ec&quot;,&quot;name&quot;:&quot;Emoncms&quot;,&quot;emonServer&quot;:&quot;4889044b.b776fc&quot;,&quot;nodegroup&quot;:&quot;1&quot;,&quot;x&quot;:794,&quot;y&quot;:130,&quot;wires&quot;:[]},{&quot;id&quot;:&quot;d3862714.2c79d8&quot;,&quot;type&quot;:&quot;debug&quot;,&quot;z&quot;:&quot;5a0f1398.a5f0ec&quot;,&quot;name&quot;:&quot;&quot;,&quot;active&quot;:true,&quot;console&quot;:&quot;false&quot;,&quot;complete&quot;:&quot;false&quot;,&quot;x&quot;:787,&quot;y&quot;:223,&quot;wires&quot;:[]}]</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36742"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Sat, 05/12/2015 - 10:54.</div>
    <div class="content">
     <p>In the above example I sent a CSV string &quot;1,2,3,4&quot;, I also tested sending &quot;power1:265,power2:123&quot; and this worked ok. See screen grab below&nbsp;</p>
<p>&nbsp;</p>
<p><a href="../sites/default/files/Screenshot%202015-12-05%20at%2010.53.31.png"><img alt="" src="../sites/default/files/Screenshot%202015-12-05%20at%2010.53.31.png" style="width: 700px; height: 394px;" /></a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36743"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Sat, 05/12/2015 - 10:55.</div>
    <div class="content">
     <p>If your still having trouble try viewing the error log:&nbsp;</p>
<p>$ tail /var/log/node-red.log&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36750"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4638.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="borpin123&#039;s picture" title="borpin123&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/4638.html" title="View user profile.">borpin123</a> on Sat, 05/12/2015 - 13:17.</div>
    <div class="content">
     <p>I&#39;m slightly lost here.&nbsp; Does Node-Red replace an MQTT broker such as mosquitto or do you need both?&nbsp; If ther is a good explanation somewhere I&#39;d love to read it :)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36760"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8298.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-8298.jpg" alt="Jon&#039;s picture" title="Jon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/8298.html" title="View user profile.">Jon</a> on Sat, 05/12/2015 - 17:19.</div>
    <div class="content">
     <p>Glyn - Thank you for the images and the info!&nbsp; I imported your JSON flow, updated the&nbsp;IP address, added my RW apikey and have the same issue. &nbsp;</p>
<p>After looking at the above images, I think the issue may be you are posting to a local network version of emoncms and I am trying to post to the emoncms installed on the emonPi.</p>
<p>Does node-red have the ability to post to the&nbsp;emonPi&nbsp;(v2)&nbsp;emoncms&nbsp;(vlow-write-v8.5)?</p>
<p><img alt="" src="../sites/default/files/Screen%20Shot%202015-12-05%20at%2011.13.24%20AM_thumb.jpg" /></p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36761"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8298.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-8298.jpg" alt="Jon&#039;s picture" title="Jon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/8298.html" title="View user profile.">Jon</a> on Sat, 05/12/2015 - 17:42.</div>
    <div class="content">
     <p>Brian - I just started looking at Node-Red on Monday (not an expert). &nbsp;I don&rsquo;t believe Node-RED replaces MQTT. &nbsp;Node-Red enables a non-programmer to do &ldquo;<em>Browser-based flow editing.&nbsp;Node-RED provides a browser-based flow editor that makes it easy to wire together flows using the wide range nodes in the palette. Flows can be then deployed to the runtime in a single-click.</em>&rdquo; &nbsp;(from <a href="http://nodered.org/" title="http://nodered.org">http://nodered.org</a>)</p>
<p>Node-RED does have Nodes to access MQTT. &nbsp;There are two that I have found.</p>
<p>The items I read thru are Glyn&rsquo;s blogs about Node-Red:</p>
<ul>
<li>Node-RED Emoncms Node
<ul>
<li><a href="http://openenergymonitor.blogspot.com/2015/11/node-red-emoncms-node.html" title="http://openenergymonitor.blogspot.com/2015/11/node-red-emoncms-node.html">http://openenergymonitor.blogspot.com/2015/11/node-red-emoncms-node.html</a></li>
</ul>
</li>
<li>Ambient Wind Energy Indicator using Node-RED and Blink(1) USB
<ul>
<li><a href="http://openenergymonitor.blogspot.com/2015/11/ambient-wind-energy-indicator-using.html" title="http://openenergymonitor.blogspot.com/2015/11/ambient-wind-energy-indicator-using.html">http://openenergymonitor.blogspot.com/2015/11/ambient-wind-energy-indica...</a></li>
</ul>
</li>
<li>emonPi, NodeRed and MQTT
<ul>
<li><a href="http://openenergymonitor.blogspot.com/2015/10/emonpi-nodered-and-mqtt.html" title="http://openenergymonitor.blogspot.com/2015/10/emonpi-nodered-and-mqtt.html">http://openenergymonitor.blogspot.com/2015/10/emonpi-nodered-and-mqtt.html</a></li>
</ul>
</li>
</ul>
<p>and this&nbsp;from Node-RED</p>
<ul>
<li>Node-RED Documentation
<ul>
<li><a href="http://nodered.org/docs/" title="http://nodered.org/docs/">http://nodered.org/docs/</a></li>
</ul>
</li>
</ul>
<p>Hope this helps!</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36782"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Sun, 06/12/2015 - 13:05.</div>
    <div class="content">
     <p>Correct,&nbsp;NodeRED does not run it&#39;s own MQTT server nor does it replace MQTT. In my blog post example I connected to the emonPi&#39;s&nbsp;Mosquitto&nbsp;MQTT&nbsp;server on port 1883.&nbsp;</p>
<p>I was posting from a RaspberryPi running NodeRED&nbsp;to the emonPi&nbsp;running emoncms, both on my local network. I also tested posting to emoncms.org.&nbsp;</p>
<p>I see no reason why it would not work posting to localhost. Are you running nodeRED on your emonPi and posting to emoncms on the same emonPi? Are you referencing the emoncms&nbsp;install in nodeRED&nbsp;via <a href="http://localhost/" title="http://localhost">http://localhost</a> in nodeRED or <a href="http://local/" title="http://local">http://local</a> IP address?&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36784"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8298.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-8298.jpg" alt="Jon&#039;s picture" title="Jon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/8298.html" title="View user profile.">Jon</a> on Sun, 06/12/2015 - 16:52.</div>
    <div class="content">
     <p>Glyn - For learning and testing purposes I am running Node-RED on my iMac and trying to post data to my emonPi&nbsp;emoncms. &nbsp;Once I get things working I&#39;ll install Node-Red on the emonPi. &nbsp;I am referencing emoncms&nbsp;via <a href="http://192.168.40.230/emoncms" title="http://192.168.40.230/emoncms">http://192.168.40.230/emoncms</a> (see image below). &nbsp;For what it is worth I can read values from the emoncms&nbsp;using the Node-RED &quot;Emoncms In&quot; (Fetches last emoncms feed value, returns numerical value.)</p>
<p>Does a firewall port need to be open on the emonPi? &nbsp;I have port 1883 open. &nbsp;Does anything need to be configured in the emonPi EmonHub Config Editor?</p>
<p><img alt="" src="../sites/default/files/Edit%20emoncms-server%20config%20node_thumb.jpg" /></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36789"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Sun, 06/12/2015 - 19:10.</div>
    <div class="content">
     <p>That all looks fine. Can you post to emoncms via your browser?</p>
<p>http://IPADDRESS/emoncms/input/post.json?json={power:200}&amp;apikey=xxxxxxxx</p>
<p>You should see &#39;ok&#39; responce&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36790"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8298.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-8298.jpg" alt="Jon&#039;s picture" title="Jon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/8298.html" title="View user profile.">Jon</a> on Sun, 06/12/2015 - 19:25.</div>
    <div class="content">
     <p>Yes,&nbsp;I receive an &quot;ok&quot; response, but I cannot locate where the value was written. &nbsp;Does a node need to be defined in above json post?</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36797"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Sun, 06/12/2015 - 22:17.</div>
    <div class="content">
     <p>Woops forgot the Node ID http://IP_ADDRESS/emoncms/input/post.json?node=1&amp;json={power:200}&amp;apikey=XXXXX</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36799"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8298.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-8298.jpg" alt="Jon&#039;s picture" title="Jon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/8298.html" title="View user profile.">Jon</a> on Sun, 06/12/2015 - 22:46.</div>
    <div class="content">
     <p>I posted this: http://192.168.40.230/emoncms/input/post.json?node=1&amp;json={power:200}&amp;apikey=myRWapikey. &nbsp;And yes, I received an &quot;ok&quot; response, but I cannot locate where the value was written. &nbsp;Nothing on the emonPi Node page and nothing in the emonhub or emoncms logs.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36813"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4638.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="borpin123&#039;s picture" title="borpin123&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/4638.html" title="View user profile.">borpin123</a> on Mon, 07/12/2015 - 16:51.</div>
    <div class="content">
     <p>Hi Glyn,</p>
<p>You are using a JSON string of {power:200}.&nbsp; In trying to debug what I am doing, I discover that running it through jsonlint, the string does not validate.&nbsp; It needs to be {&quot;power&quot;:200} to validate.</p>
<p>Or am I missing something?</p>
<p>Cheers, Brian.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36814"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4638.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="borpin123&#039;s picture" title="borpin123&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/4638.html" title="View user profile.">borpin123</a> on Mon, 07/12/2015 - 19:35.</div>
    <div class="content">
     <p>I&#39;ll move this to a new thread.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36890"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8298.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-8298.jpg" alt="Jon&#039;s picture" title="Jon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/8298.html" title="View user profile.">Jon</a> on Wed, 09/12/2015 - 21:10.</div>
    <div class="content">
     <p>Glyn - I thought I had read somewhere (though I cannot locate it at the moment) that we could not post to the emonPI&nbsp;emoncms because it is low-write. &nbsp;Did v9 (or v9.2) of emoncms change posting to the&nbsp;emonPI emoncms?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36897"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Thu, 10/12/2015 - 14:31.</div>
    <div class="content">
     <p>Hi Jon,&nbsp;</p>
<p>Posting to Emoncms on the emonPi&nbsp;with low write should work in exactly the same way as usual. The data is stored in the /home/pi/data which is always mounted as RW&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36902"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8298.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-8298.jpg" alt="Jon&#039;s picture" title="Jon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/8298.html" title="View user profile.">Jon</a> on Thu, 10/12/2015 - 18:56.</div>
    <div class="content">
     <p>I think I am making some progress by stumbling across something new (new to me!). &nbsp;I was going through the input_controller.php code (/var/www/emoncms/Modules/input/input_controller.php) trying to determine why none of the above would work for me. &nbsp;I came across some code that pointed me to&nbsp;http://192.168.40.230/emoncms/input/api. &nbsp;This is the <strong>Input API Help&nbsp;</strong>webpage of Input API examples and this&nbsp;webpage pointed me to&nbsp;http://192.168.40.230/emoncms/input/view. &nbsp;And this is where I located the POSTS and the data from the examples above. &nbsp;Eureka!</p>
<p>So I starting digging thru the various menus on the emonPi emoncms and I could not locate the Inputs View menu item. &nbsp;Is this not available? &nbsp;(my wife tells me I am blind so I could be missing the obvious!)</p>
<p><img alt="" src="../sites/default/files/Screen%20Shot%202015-12-10%20at%2012.47.40%20PM_thumb.jpg" /></p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36921"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 11/12/2015 - 12:08.</div>
    <div class="content">
     <p>Ah good find! Very sorry I did not think of this sooner. We hid the Inputs menu on the emonPi as to not confuse users as the Nodes menu performs the same job in a more user friendly way.</p>
<p>As you have found you can access this menu by going to&nbsp;<a href="http://192.168.40.230/emoncms/input/view">http://192.168.40.230/emoncms/input/view</a></p>
<p>The inputs menu will be exposed in the new version of the emonPi software we plan to launch in the next few weeks.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36929"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8298.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-8298.jpg" alt="Jon&#039;s picture" title="Jon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Experimenting with Node-RED Emoncms Node</h3>

    <div class="submitted">Submitted by <a href="../user/8298.html" title="View user profile.">Jon</a> on Fri, 11/12/2015 - 14:53.</div>
    <div class="content">
     <p>Glyn&nbsp;- glad we were able to figure it out! &nbsp;Thank you!</p>
<p>As part of troubleshooting&nbsp;I was trying to get the&nbsp;http://emonPi_IP/emoncms/input/post.json?node=1&amp;json={power:200}&amp;apikey=myRWapikey&nbsp;to throw an error. &nbsp;But when I typed an out-of-range Node number (node=41) it did not error. &nbsp;It looks like there is code in &quot;input_controller.php&quot; to catch this (line 214). &nbsp;Also the&nbsp;http://IPADDRESS/emoncms/input/post.json?json={power:200}&amp;apikey=xxxxxxxx&nbsp;(without a node) was also accepted.</p>
<p><img alt="" src="../sites/default/files/Screen%20Shot%202015-12-10%20at%2012-1.47.40%20PM_thumb%202.jpg" /></p>
<p>Only an incorrect apikey caused an error: &quot;<em>&lt;br /&gt;<br />
&lt;b&gt;Notice&lt;/b&gt;:&nbsp; Undefined index: write in &lt;b&gt;/var/www/emoncms/Modules/input/input_controller.php&lt;/b&gt; on line &lt;b&gt;22&lt;/b&gt;&lt;br /&gt;</em>&quot;.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11751"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-bwFoTB-ixGykTPGoBj3aqFCnOilwHugsr_6CQ8st5xI" value="form-bwFoTB-ixGykTPGoBj3aqFCnOilwHugsr_6CQ8st5xI"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/11751 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:49:31 GMT -->
</html>
