<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11974 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:12:01 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>emonPi Firmware &amp; info referenced on LCD | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">emonPi Firmware &amp; info referenced on LCD</h3>
        <span class="submitted">Submitted by <a href="../user/8298.html" title="View user profile.">Jon</a> on Mon, 11/01/2016 - 20:54</span>
        <div class="content"><p>When the emonPi powers up there is a quick screen that pops up with <strong>emonPi V2.00 - OpenEnergyMon</strong>. &nbsp;Is V2.00 the emonPi firmware version number?</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<img alt="" src="../sites/default/files/emonpi%20display%204.jpg" /></p>
<p>I ask because I started to do a&nbsp;emonPi Update and saw the paragraph:</p>
<blockquote><p><em><strong>Update emonPi</strong><br />
Downloads latest Emoncms changes from Github and updates emonPi firmware. See important notes in <a href="https://github.com/openenergymonitor/emonpi/blob/master/firmware/CHANGE LOG.md">emonPi firmware change log</a>.</em></p>
</blockquote>
<p>I clicked on the&nbsp;emonPi firmware change log link and saw firmware 3.1 and 3.0:</p>
<blockquote><p><em><strong>Change Log</strong><br />
V3.1 Jan 15<br />
Display &quot;Raspberry Pi Booting&quot; message at startup &amp; don&#39;t sample from CT input channel when no CT is physically connected to that input</em></p>
</blockquote>
<p>&nbsp;</p>
<p>So is V2.00 the firmware of the emonPi?&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11973.html" class="topic-previous" title="Go to previous forum topic">‹ new emonpi does not show values after changng ip adress</a>
              <a href="5142.html" class="topic-next" title="Go to next forum topic">DC Sensing project ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-38164"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonPi Firmware & info referenced on LCD</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 11/01/2016 - 23:02.</div>
    <div class="content">
     <p>I noticed the v2.0 too, yes it is the emonPi&nbsp;firmware and yes there is a v3.0 and v3.1,&nbsp;they are continuous sampling rather than discrete&nbsp;and use a different library (emonLibCM).</p>
<p>It&#39;s not clear to me it it&#39;s an error in the updating process or if they are not yet fully released.</p>
<p>The &quot;<a href="https://github.com/openenergymonitor/emonpi/blob/master/update">update</a>&quot; script is <a href="https://github.com/openenergymonitor/emonpi/blob/master/firstbootupdate#L24">called by &quot;firstbootupdate&quot;</a> if there is no &quot;emonpiupdate.log&quot; found,&nbsp;that script then <a href="https://github.com/openenergymonitor/emonpi/blob/master/update#L61">calls the &quot;emonpiupdate&quot;</a>&nbsp;which is <a href="https://github.com/openenergymonitor/emonpi/blob/master/emonpiupdate#L12">hardcoded to upload &quot;emonPi_RFM69CW_RF12Demo_DiscreteSampling&quot;</a>&nbsp;, so as far as I can tell it will always upload the latest discrete sampling sketch.</p>
<p>There is a separate <a href="https://github.com/openenergymonitor/emonpi/blob/master/firmware/compiled/update">updater&nbsp;in emonpi/firmware/compiled</a> that is hard coded to install the continuous sampling firmware but unless I&#39;m missing something this would get over-written again at the next full update, it does say it <a href="https://github.com/openenergymonitor/emonpi/tree/master/firmware/compiled#1-run-emonpi-update-from-local-emoncms">should install via the emoncms&nbsp;method</a>, but I think there is an error in the main &quot;update&quot; script, I think is is supposed to point to this &quot;firmware/compiled/update&quot;&nbsp;script not the &quot;emonpiupdate&quot; script, I haven&#39;t tried&nbsp;&nbsp;editing it&nbsp;as that will stop&nbsp;the whole repo being updated from git due to un saved edits but I guess it would at least test the theory.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38174"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonPi Firmware & info referenced on LCD</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Tue, 12/01/2016 - 09:43.</div>
    <div class="content">
     <p>Hi Guys,&nbsp;</p>
<p>Well spotted! Correct, V3.x firmware is yet to be released. We are still testing the continuous sampling firmware. It&#39;s nearly ready. The V3.x firmware is located in the new ~/emonpi/firmware directory structure. V2.0 is the latest Discrete Sampling firmware.&nbsp;</p>
<p>If you want to test CS V3.x firmware just you can force uploading of V3.x vu running ~/emonpi/firmware/compiled/./update</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38228"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8298.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-8298.jpg" alt="Jon&#039;s picture" title="Jon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonPi Firmware & info referenced on LCD</h3>

    <div class="submitted">Submitted by <a href="../user/8298.html" title="View user profile.">Jon</a> on Wed, 13/01/2016 - 18:55.</div>
    <div class="content">
     <p>I&#39;ve been reviewing the v3.x updates and I am not sure I understand&nbsp;continuous sampling versus&nbsp;discrete sampling. &nbsp;I think I understand discrete sampling (e.g.,&nbsp;at time zero the voltage is 122.2 volts &amp; 16.6 ms later it is 122.3 volts, etc.). &nbsp;But since the emonPi is a microprocessor, how does sampling&nbsp;become continuous?</p>
<p>I read through&nbsp;<a href="11722.html">Continuous Sampling EmonPi and EmonTx v3.4 examples</a> thread and a few other threads. And I dug through the Internet looking for various articles (most being way over my head).</p>
<p>I am guessing continuous sampling is for power. &nbsp;But&nbsp;is voltage or AC cycles sampled differently also?</p>
<p>Could someone explain&nbsp;continuous sampling versus discrete sampling in simple terms or point me to a beginners article? &nbsp; Thank you! &nbsp; Jon</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38232"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonPi Firmware & info referenced on LCD</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 13/01/2016 - 21:23.</div>
    <div class="content">
     <p>You&nbsp;should really have started a new thread for this.</p>
<p>&quot;Discrete sampling&quot; and &quot;continuous sampling&quot; are simple names tagged onto rather more complicated concepts. So they must not be taken literally.</p>
<p>&quot;Discrete sampling&quot; uses&nbsp;the analogRead&nbsp;function to command the ADC&nbsp;to get a voltage sample. When that sample is returned, the sketch uses the ADC&nbsp;again, this time to get a current sample. That process is repeated approximately 50 times per cycle (less for a 60 Hz cycle) for 10 cycles, the resulting values of current, voltage and power are averaged. If you have a second or more current inputs, the process is repeated for each, then&nbsp;the result is transmitted.&nbsp;The sketch sleeps for 10 s and&nbsp;repeats the whole process <em>ad infinitum</em>.</p>
<p>&quot;Continuous &nbsp;sampling&quot; uses the ADC in a totally different manner. The sketch starts the ADC, instructing it to perform conversions continuously and&nbsp;generate an interrupt each time a conversion completes. When the sketch receives the&nbsp;interrupt, it recovers the result of the conversion and sets up the next channel to be converted. (Pause for a moment because this is where most people get lost: There are 3 conversions that are relevant. There&#39;s&nbsp;a conversion in progress, the interrupt routine&nbsp;has just set up the next conversion and it&#39;s processing the result of the last conversion.) &nbsp;Continuing, the ADC&nbsp;measures the voltage, then the 4 current channels, then repeats the process indefinitely. Meanwhile, the main sketch accumulates the values and every 10 s, calculates the averages and transmits the results. Because the ADC is working in parallel with the main sketch, the actual sample rate is much faster but the rate in terms&nbsp;of sample sets is slower than the discrete sampling - but then all 4 current channels are being read &quot;simultaneously&quot;.</p>
<p>Therefore, the&nbsp;&quot;Discrete sampling&quot; sketch is suitable only&nbsp;for systems where changes happen infrequently, whereas the&nbsp;&quot;Continuous &nbsp;sampling&quot; sketch is suitable for any system, including loads that are rapidly switched, like induction hobs and Robin&#39;s or MartinR&#39;s energy diverters.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11974"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-UPyyl0dsZLYubZiRxT6kRSZlCn813CFAYiXidsKTnLg" value="form-UPyyl0dsZLYubZiRxT6kRSZlCn813CFAYiXidsKTnLg"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
