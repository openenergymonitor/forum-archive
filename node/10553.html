<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/10553 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:31:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>EmonTX shortest sleep time | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">EmonTX shortest sleep time</h3>
        <span class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Fri, 01/05/2015 - 05:04</span>
        <div class="content"><p>what is the shortest sleep time the EmonTX&nbsp;can be set to? I&#39;m looking for a faster response time and it&#39;s powered by the mains. I intend running it with 4CT&#39;s and 2&nbsp;temperature sensors which are going to be attached to the HWC so sampling rate isn&#39;t important.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="10570.html" class="topic-previous" title="Go to previous forum topic">‹ EmonTX V3.4 which continuous sketch for Grid, PV &amp; HW diversion?</a>
              <a href="10522.html" class="topic-next" title="Go to next forum topic">RFM69Pi GPIO access ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-30014"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Fri, 01/05/2015 - 10:27.</div>
    <div class="content">
     <p>You can reduce it to as little as you want, provided you leave enough time to send the data.</p>
<p>Have you considered using one of Robin's "continuous" sketches instead of the "discrete samples" default? The snag is with those, you'll need to add in code for the temperature measurements. Or you could look at MartinR's PLL energy diverter - strip out the diverter code, add two currents and one more temperature sensor.</p>
<p>If you stay with the discrete samples sketches, you might want to look at how much data you are going to accumulate. If you've got your own server, that's fine, but if you've got an SD card in a RPi, it could be a problem and if you're using emoncms.org, Trystan doesn't like anyone sending more frequently than every 10 s, as it's a bit unsociable to hog all the resources.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30015"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Fri, 01/05/2015 - 10:42.</div>
    <div class="content">
     <p>Do you have any idea how much data it generates per sample? I&#39;m guessing it&#39;s a matter of cutting and pasting between sketches to add in the temperature code to the continuous sampling? With the delay caused by moving data half way around the world (I&#39;m in New Zealand)&nbsp;the lag between turning a light off and it appearing on the app is too long to make sense of things as it is so I think this needs to be moved onto the pi on a memory stick</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30017"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Fri, 01/05/2015 - 14:45.</div>
    <div class="content">
     <p><i>"Do you have any idea how much data it generates per sample?"</i></p>
<p>You'll need to look up Trystan's documentation about the databases to get that: <a href="https://github.com/openenergymonitor/documentation/tree/master/BuildingBlocks/TimeSeries" title="https://github.com/openenergymonitor/documentation/tree/master/BuildingBlocks/TimeSeries">https://github.com/openenergymonitor/documentation/tree/master/BuildingB...</a></p>
<p>If you're storing a lot of data very frequently, you might want to consider running your RPi off a hard disk.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30020"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Fri, 01/05/2015 - 21:50.</div>
    <div class="content">
     <p>The &quot;continuous&quot; code that I posted <a href="10171.html">here </a>for the emonTx V3.2 supports 4 CTs and one temperature sensor.&nbsp; I have never used more than one temperature sensor&nbsp;but I know that similar code of mine&nbsp;has been upgraded to operate&nbsp; in this way.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30021"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Fri, 01/05/2015 - 21:55.</div>
    <div class="content">
     <p>Thanks for the link, I have a EmonTX V3.4 do you know if there are any differences from a code point of view?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30030"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Sat, 02/05/2015 - 10:48.</div>
    <div class="content">
     <p>No problem, I posted a similar sketch for the emonTx V3.4 at</p>
<p><a href="10203.html">http://openenergymonitor.org/emon/node/10203</a></p>
<p>The code changes between V3.2 and V3.4 are very few, just for the different RF arrangement.&nbsp; One of the IO port allocations needs to be changed on account of the different version of Jeelib library that is uses.&nbsp;</p>
<p>My various sketches are listed on a <a href="1757.html">Summary Page</a> which is always near the top of the&nbsp; Forum-&gt;General section.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30033"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Sat, 02/05/2015 - 12:36.</div>
    <div class="content">
     <p>I just took a quick look at the summary page - thanks very much for posting, it looks very useful indeed. I&#39;ll have time to take a proper look&nbsp;next week. I&#39;m not convinced my phase calculation is correct as I&#39;ve changed the burden resistors and calibration of both the voltage and current to match the expected values, so I&#39;m expecting the phase offset may not be correct now.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30034"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 02/05/2015 - 13:43.</div>
    <div class="content">
     <p>The phase error of the transformers, both current and voltage, is dependent upon their working point, the former more so because current varies over a much greater range than voltage. So if you've changed the burden value, the phase calibration will almost certainly need checking.</p>
<p>Having said that, with 'real' loads (those having power factors close to 1 as normally found in a home), phase calibration makes little difference [cos(0&deg;) isn't vastly different to cos(10&deg;)]. But if you get small, highly reactive loads such as you have with some appliances on 'standby', then the error can be huge. See the reports in Building Blocks for the gory details.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30037"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Sat, 02/05/2015 - 20:39.</div>
    <div class="content">
     <p>That reflects some of what I&#39;m seeing. I&#39;ve got a 35w motor in the spa running 24/7 for a start and also 10 micro inverters which cause the solar channel to suggest it&#39;s generating 30w&nbsp;in pitch darkness. I&#39;ll do some reading and see what I can make of it. I had s current cost ENVIR before and the CT channel over read heaps on low power before under reading as the resistive loads kicked in&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30038"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 02/05/2015 - 22:10.</div>
    <div class="content">
     <p>What sort of currents are you measuring, and which CTs are you using? If you don't require the full 100 A maximum current, you can improve the accuracy over a reduced range by changing to a more appropriate CT - though I recognise that this might be hard and/or expensive if you must have a split-core one. We expect the accuracy to start to deteriorate below around 2% of maximum, and below &frac12;% you can expect little more than an indication of current, the ADC error is indeterminate (because it depends on where the quiescent input sits in relation to the ADC steps, and that's essentially random and variable) and can be quite large in percentage terms. A small amount of noise actually helps at those currents, as it can add some dither, but if you're recording generation at night, that's probably mainly digital noise that you're seeing.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30039"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Sat, 02/05/2015 - 22:24.</div>
    <div class="content">
     <p>CT1 - 60A max 31 ohms burden</p>
<p>CT2 &amp; CT3 13A max 180 ohms burden</p>
<p>CT4 6.5A max 360 ohms burden</p>
<p>all using standard CT, the lower order ones could be changed for a thread through type and the larger one could at a push. That&#39; one is in&nbsp;the back of a crowded meter box so potentially it&nbsp;has the most pickup from other wires. I&#39;m going to trip the solar breaker tonight to see if the noise goes, it&#39;s in a different fuse board and is not that close to other cables so the pickup could just be noise from the micro inverters.&nbsp;I&#39;ve extended the lead in that one with mic cable by 1.1 metres&nbsp;and&nbsp;my meter suggests I haven&#39;t got a short between ground and one of the legs. Curiously enough the solar CT buzzed before I plugged it in, I was generating about 1.5kw at the time. I&#39;ve added a minus 30w to the web monitor for now to remove the nighttime watts.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30040"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 02/05/2015 - 23:23.</div>
    <div class="content">
     <p>Unfortunately, while increasing the burden value increases the voltage, there is a price to pay in increased phase error - that's why I suggest a CT with a lower ratio. I wouldn't suggest changing the one on the 60 A circuit, but I think you should see an improvement if you change the others - provided of course they are of reasonable quality.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30041"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Sun, 03/05/2015 - 07:07.</div>
    <div class="content">
     <p>What fun! Do you have any suggestions for types to try? Its complicated by living in NZ as I&#39;ll have to mail order everything.&nbsp;Is it possible to have a different phase value for each CT? Their use is further complicated too as:</p>
<p>CT1 is main incoming power (60A Fuse), CT2 is from 10 soon to be 11 or 12 micro inverters (3Kw Max, 16A Breaker), CT3 is from a Sola Controlla&nbsp;diverting to the HWC (3KW Max, 10A breaker that should trip but doesn&#39;t) and CT4&nbsp;is from a Sola Controlla slave unit diverting to a spa pool (1.5KW element) although I guess at least CT3 &amp; CT4 should have unity power factor even if they don&#39;t have a perfect sine wave!</p>
<p>Maybe its easier just to pull one of the CT&#39;s and try it in the main CT1 input with an electric fire plugged in and see what your phasecal sketch suggests followed by recalibrating everything.</p>
<p>Do you reckon adding about 2 metres of balanced&nbsp;Mic cable onto one of the CT&#39;s&nbsp;would upset the CT calibration enough to need recalibration of it individually&nbsp;or will the value I get from another one plugged into the same input be near enough?&nbsp;</p>
<p>Curiously I&#39;ve just checked the solar and the 29 phantom&nbsp;watts of generation overnight drops to 1 watt if&nbsp;I turn off either the breaker on the roof or the breaker in the distribution board, granted its not negative but there must be some odd spikey power draw at work there.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30045"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Sun, 03/05/2015 - 08:54.</div>
    <div class="content">
     <p>One further question, if I update to continuous sampling code how can I limit the updates to the web version of EmonCMS to 10 seconds whilst having the local pi version updated As often as possible?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30049"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 03/05/2015 - 11:11.</div>
    <div class="content">
     <p><i>" suggestions for types to try"</i><br />
See what is available locally (to NZ). You need a current output, the actual current doesn't matter as long as it is in the mA region (i.e. not 1 A or 5 A) and you need enough power to drive 1.1 V rms across your burden. That's a figure that is often omitted from the data sheets, so sleuthing or asking is usually necessary.</p>
<p><i>"Is it possible to have a different phase value for each CT?"</i><br />
Yes.</p>
<p><i>"10A breaker that should trip but doesn't"</i><br />
[Robert puts on Chartered Electrical Engineer's hat] You need to get that sorted out without delay. Meanwhile, I hope your fire insurance is good. Just check that you don't have <a href="http://singletrackworld.com/forum/topic/fake-stuff">a fake breaker</a> in there.</p>
<p><i>"even if they don't have a perfect sine wave"</i><br />
In that case, assuming it's 'peaky', you need to allow more headroom so that the peaks don't clip. So if it's a 10 A rms true sine, it will have a peak-peak value of 2.828 A, if it's 'peaky', it could have a peak-peak value of a lot more - maybe up to 10 A.</p>
<p><i>"adding about 2 metres of balanced Mic cable"</i><br />
... should make no real difference. Remember the CT is a current source, so as long as it doesn't run out of voltage itself, the voltage drop in the cable doesn't come into the sums. But you need to calibrate each particular combination of input and CT, because there are uncertainties in the value of both.</p>
<p><i>"there must be some odd spikey power draw at work there"</i><br />
Quite likely it's checking up on the supply to make sure it's still there, etc, and generally keeping itself alive ready for when the sum comes up.</p>
<p><i>"how can I limit the update..."</i><br />
I don't know - Paul (pb66) should be able to suggest something, he's the GitHub expert.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30056"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 03/05/2015 - 16:19.</div>
    <div class="content">
     <p>I've found my list:</p>
<pre>
Hardware & hardware-related differences

				V3.2				V3.4
Library			#include &lt;RFu_JeeLib.h&gt;		#include &lt;JeeLib.h&gt;
RF			#define RF69_COMPAT 0		#define RF69_COMPAT 0 ('12B) 
                                                     or #define RF69_COMPAT 1 ('69CW)
DIP SW			not present			const byte DIP_switch1 = 8;
                                                        const byte DIP_switch2 = 9;
Battery voltage		not present			const byte battery_voltage_pin = 7;

Pulse input pin		Dig 2				Dig 3
Pulse interrupt		IRQ 0				IRQ 1		
</pre>         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30057"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Sun, 03/05/2015 - 16:54.</div>
    <div class="content">
     <p><em>One further question, if I update to continuous sampling code how can I limit the updates to the web version of EmonCMS to 10 seconds whilst having the local pi version updated As often as possible?</em></p>
<p>My &quot;continuous&quot; sketches will transmit as often as you want them to.&nbsp; The transmitted data is for the period that has elapsed since the last transmission.&nbsp;&nbsp; If you want something to be updated at a slower rate but with the same data, you are likely to lose some data &#39;packets&#39; unless you do some intermediate processing of the received data.</p>
<p>Maybe I&#39;ve not understood the question.&nbsp; Why would having &quot;continuous sampling code&quot; make any difference to how your received data is processed?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30059"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Sun, 03/05/2015 - 19:07.</div>
    <div class="content">
     <p>This is possibly where I&#39;m not understanding the system correctly. As I understand it currently&nbsp;EmonTX&nbsp;samples current and voltage, turns them into watts and transmits the result before going to speed for 10 seconds.</p>
<p>emonbase&nbsp;site listening on 433MHz&nbsp;and when it receives a transmission it forwards it to EmonCMS locally and remotely.</p>
<p>so if I upgrade to continuous sampling the wait 10 seconds but is removed and almost continuous data is sent to EmonCMS&nbsp;hogging the resources? Not a great problem for me as emonbase isn&#39;t doing anything else but won&#39;t it upset the shared EmonCMS&nbsp;in the UK?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30060"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Sun, 03/05/2015 - 19:23.</div>
    <div class="content">
     <p>Ok I&#39;ll pull both CT&#39;s and recalibrate. Fortunately the most calibration is needed on CT1 and it will have to deal with the lions share of odd loads because most of these appear after the sun has gone down. I&#39;ll calibrate this around 500 watts for phase as its in the 150-500 watt range that I&#39;m interested in the finer details. Above that the big stuff kicks in which apart from the heat pumps is resistive loads such as the kettle / spa heater / coffee machine / toaster.</p>
<p>Last time I looked at alternative CT&#39;s locally they were prohibitively expensive so I&#39;ll see how close the results are to what I need. Solar diversion is handled elsewhere so I don&#39;t need the fine level of control from this system.&nbsp;</p>
<p>Moving onto the breaker it&#39;s likely a combination of type c breakers as standard over here plus the former lossy cable both to the heater and to the house&nbsp;causing sufficient volt drop to derate it. I&#39;ve rewired it in 4mm which increased the power draw and shortly after I added the sola&nbsp;controla&nbsp;so it&#39;s not really had a full load on it recently.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30064"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sun, 03/05/2015 - 20:35.</div>
    <div class="content">
     <p>The discreet sketches do sleep for the most part and then do a quick sample and send, where as the continuous sampling sketches do not sleep they sample continuously throughout the periods between sending the data.</p>
<p>The update interval is independent or the sample interval and defines&nbsp;how often the data is reported by the emonTx&nbsp;to th&nbsp;emonbase<span style="line-height: 20.7999992370605px;">&nbsp;</span><span style="line-height: 20.7999992370605px;">(usually 10 secs)&nbsp;</span><span style="line-height: 1.6;">. possible RF collisions can prevent the update interval being too frequent, but with one device on RF or a direct connection you can get a much shorter update interval. A shorter update interval doesn&#39;t improve the accuracy but it does improve the responsiveness and therefore appear more accurate.</span></p>
<p>Although if everyone started&nbsp;bombarding the emoncms.oeg server once every second or so it would have a melt down so a slower interval is expected. However you can have your cake and eat it if you want to have a short update interval from the emonTx&nbsp;to give faster&nbsp;ressponse&nbsp;on your local emoncms&nbsp;you can set a limit in emonhub to only update emoncms.org every eg&nbsp;10seconds&nbsp;regardless of how fast the data is produced locally.</p>
<p>In the reporters section of emonhub.conf, add &quot;interval = 10&quot; to the [[[runtimesettings]]] for the emoncms.org reporter and then you can decrease the time between sends in the sketch.</p>
<p>This gets around the issue&nbsp;highlighted by Robin as all the data points are sent but just in batches so as not to over work the server,</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30065"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Sun, 03/05/2015 - 20:36.</div>
    <div class="content">
     <p>Thanks very much, I&#39;ve just switched to a continuous sketch and&nbsp;I&#39;ve changed the settings on the pi and rebooted.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30066"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Sun, 03/05/2015 - 20:48.</div>
    <div class="content">
     <p>I&#39;ve just tried the phasecal sketch from the MK2 Solar Diverter project, it allows me to input the phasecal&nbsp;values and the increment and then just sits there - does this sketch work on a V3.4?</p>
<p>value of PHASECAL_MAX?<br />
&nbsp;PHASECAL_MAX = 1.00<br />
value of PHASECAL_MIN?<br />
&nbsp;PHASECAL_MIN = 0.25<br />
value of PHASECAL_INCREMENT?<br />
&nbsp;PHASECAL_INCREMENT = 0.05<br />
In NORMAL mode ...</p>
<p>The initial value of PHASECAL is 0.25</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30067"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 03/05/2015 - 21:20.</div>
    <div class="content">
     <p><i>"does this sketch work on a V3.4"</i><br />
No, not without changing some I/O allocations. Look at lines 16 &amp; 17. (You'll find the I/O for the V3.4 in the Wiki.)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30068"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Mon, 04/05/2015 - 02:58.</div>
    <div class="content">
     <p>Thanks - changing &quot;byte voltagesensorpin&quot; from 2 to 0 did the trick, and I ended up with a phasecal value of 1.55, however that seems to have made the Solar input overread despite recalibrating&nbsp;both that and the grid CT with an electric fire. I did try the continuous_kwhtotals sketch as it seems to allow different phasecal&nbsp;values per channel&nbsp;but it didn&#39;t seem to do anything despite loading the missing timer library.</p>
<p>For now I&#39;ve changed the update interval to every second and its giving much better responsiveness on the local pi, however I won&#39;t know how well its all working until later, when the solar shuts down as as&nbsp;the varying solar output courtesy of passing clouds is distorting things.</p>
<p>The solar CT also doesn&#39;t quite close properly and can chatter if its unplugged so I&#39;ll visit this again once the 2 I have in the post arrive in case the tiny gap is enough to screw the calibration up between it sitting under my desk and residing on the solar input cable</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30070"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3426.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3426.jpg" alt="Bill Thomson&#039;s picture" title="Bill Thomson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/3426.html" title="View user profile.">Bill Thomson</a> on Mon, 04/05/2015 - 03:22.</div>
    <div class="content">
     <p>Hi Sheppy,</p>
<p>What particular micro-inverters do you have? My system behaves similar to yours. I have 30 Enphase M215s and 6 M250s. The inverters draw about 45W at night, but it&#39;s a <em>very</em> reactive load. (power factor of about 0.08) It causes my TED5000 to report the micros as &quot;generating&quot; ~45W at night...</p>
<p>Regards,</p>
<p>Bill</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30071"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Mon, 04/05/2015 - 03:27.</div>
    <div class="content">
     <p>Hi Bill,</p>
<p>Renesola&nbsp;Micro Replus 250W x 10</p>
<p>Mine reports&nbsp;around 29-31w&nbsp;of generation at night whereas the monitoring box reports 0w. So far I&#39;ve just used the + calibration function in EmonCMS with -31 in the box which stops it being reported as real power. It does mean first thing in a morning the graphs are off but its near enough until a better solution appears.</p>
<p>The phantom generation&nbsp;sounds like a micro inverter thing, they probably sniff part of the waveform every cycle to ensure the grid supply exists.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30072"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3426.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3426.jpg" alt="Bill Thomson&#039;s picture" title="Bill Thomson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/3426.html" title="View user profile.">Bill Thomson</a> on Mon, 04/05/2015 - 03:28.</div>
    <div class="content">
     <p><em>The solar CT also doesn&#39;t quite close properly and can chatter if its unplugged so I&#39;ll visit this again once the 2 I have in the post arrive in case the tiny gap is enough to screw the calibration up between it sitting under my desk and residing on the solar input cable</em></p>
<p>A CT that doesn&#39;t close completely will definitely not operate correctly. The two surfaces must be touching i.e. no gap, for proper operation.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30073"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3426.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3426.jpg" alt="Bill Thomson&#039;s picture" title="Bill Thomson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/3426.html" title="View user profile.">Bill Thomson</a> on Mon, 04/05/2015 - 03:31.</div>
    <div class="content">
     <p><em>The phantom generation&nbsp;sounds like a micro inverter thing, they probably sniff part of the waveform every cycle to ensure the grid supply exists.</em></p>
<p>&nbsp;</p>
<p>I&#39;ve read some posts (can&#39;t remember which forum, atm) that indicate some of the string inverters behave similarly.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30074"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Mon, 04/05/2015 - 05:09.</div>
    <div class="content">
     <p>That all makes sense.</p>
<p>When the 2 CT&#39;s I have in the post arrive I will recalibrate and see if I can simply put a cable tie around this&nbsp;CT to ensure its closed when installed, it clips home but has a tiny gap.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30078"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Mon, 04/05/2015 - 08:19.</div>
    <div class="content">
     <p><em>sheppy: This is possibly where I&#39;m not understanding the system correctly. As I understand it currently&nbsp;EmonTX&nbsp;samples current and voltage, turns them into watts and transmits the result before going to speed for 10 seconds.</em></p>
<p>The performance of the emonTx is entirely dependent on the resident software.&nbsp; &nbsp;The various sketches - both discrete and continuous - will all run on any of these Atmega 368 platforms: emonTx&nbsp;V2 or V3, Arduino Uno, or my own <a href="../../../mk2pvrouter.co.uk/media/aa5b46504c2694abffff8110d4355564.html">Mk2 PV Router boards</a>.&nbsp; Only the IO port allocations need to be changed.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30082"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Mon, 04/05/2015 - 09:22.</div>
    <div class="content">
     <p>Yes it&#39;s all starting to make sense now, I&#39;ve never touched Arduino or Linux i/ GIT n any detail so the learning curve has been a bit steep!</p>
<p>i wonder why the released version of the continuous sampling sketch with KWh totals didn&#39;t work - totally blank serial display and no flashing LED. I think that one may work well for me as I can have different phasecal values for each CT which would help with my 3 different burden resistors</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30083"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 04/05/2015 - 09:33.</div>
    <div class="content">
     <p><em>i wonder why the released version of the continuous sampling sketch with KWh totals didn&#39;t work - totally blank serial display and no flashing LED</em></p>
<p>Which version did you try? those&nbsp;symptoms can been the result of a v3.2 to v3.4 mismatch as the sketch stalls at initializing the RFM since it&#39;s not found with the incorrect pin allocations.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30085"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Mon, 04/05/2015 - 09:44.</div>
    <div class="content">
     <p>The one at</p>
<p><a href="https://github.com/openenergymonitor/emonTxFirmware/tree/master/emonTxV3/RFM/emonTxV3.4/emonTxV3_4_continuous_kwhtotals" title="https://github.com/openenergymonitor/emonTxFirmware/tree/master/emonTxV3/RFM/emonTxV3.4/emonTxV3_4_continuous_kwhtotals">https://github.com/openenergymonitor/emonTxFirmware/tree/master/emonTxV3...</a></p>
<p>&nbsp;</p>
<p><em>Duplicate post deleted - BT</em></p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30086"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Mon, 04/05/2015 - 09:46.</div>
    <div class="content">
     <p>I&#39;ve been using the one on GIT in&nbsp;</p>
<p>tree/master/emonTxV3/RFM/emonTxV3.4/emonTxV3_4_continuous_kwhtotals</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30087"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 04/05/2015 - 10:35.</div>
    <div class="content">
     <p>Did you set the&nbsp;<a href="https://github.com/openenergymonitor/emonTxFirmware/blob/master/emonTxV3/RFM/emonTxV3.4/emonTxV3_4_continuous_kwhtotals/emonTxV3_4_continuous_kwhtotals.ino#L11">#define RF69_COMPAT 0 or 1 line</a> correctly?</p>
<p>the same symptoms are also common to the sketch not finding the expected RFM module too.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30089"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Mon, 04/05/2015 - 10:41.</div>
    <div class="content">
     <p>Didn&#39;t know about that, as it has something like set to rf69&nbsp;on the folder, will check in the morning, please let me know if you think of anything else. We&#39;re 11 hours ahead of the UK so I can only post late at night or early in the morning</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30099"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Mon, 04/05/2015 - 20:21.</div>
    <div class="content">
     <p>sheppy, it&#39;s a long time since I had anything to do with the &#39;kwhtotals&#39; sketch that you&#39;ve been using.&nbsp;</p>
<p>I would recommend using either of the &quot;Mk2&quot; sketches that I posted recently for the emonTx V3.&nbsp; Although offered as a diverter for surplus power, these sketches can function perfectly well as a continuous monitor of power on four channels.&nbsp; One of these sketches has been set up for the RFM12B, the other is for the RFM69CW.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30100"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Mon, 04/05/2015 - 20:32.</div>
    <div class="content">
     <p>I&#39;ll give them a go - the problem is I have no way of measuring the house current to check the calibration&nbsp;due to the &quot;unique&quot; way they wire up a 3 phase meter as an import export meter over here, once you add in a liberal dose of non linear power draw by gadgets I have no real idea whether the monitor is telling the truth once it&#39;s installed, compared to the calibrated values.</p>
<p>Over here they feed the single phase&nbsp;power through a 3-phase smart meter first forward on phase 1&nbsp;and then backwards on phase 2. This means the load on the smart meter always says zero and I only get usage on the web a couple of days later. NZ is in many ways a forward looking country but their implementation of import / export meters is a bit backward!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30105"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Tue, 05/05/2015 - 07:33.</div>
    <div class="content">
     <p>I&#39;ve just taken a look at your sketch and was thinking of where my open energy monitor journey is likely to end. Do you reckon your sketch can&nbsp;be easily modified to monitor:</p>
<p>Grid import/export on CT1</p>
<p>Solar generation on CT2</p>
<p>Diverted Load 1 power and energy on CT3</p>
<p>Diverted Load 2 power and energy on CT4</p>
<p>Temperature 1 middle of hot water cylinder</p>
<p>Temperature 2 bottom of hot water cylinder</p>
<p>Temperature 3 spa pool</p>
<p>Monitoring of diverted energy could be enhanced by a line of code that reads&nbsp;something like &quot;if diverted energy is greater than SolarPV, diverted energy value = 0&quot; to get around override heating due to winter clouds or guests using all the hot water.</p>
<p>All of this with near realtime updates to emonCMS running on the local pi with&nbsp;different phasecal settings to reflect the different CT burden resistors and cable lengths&nbsp;without actually controlling anything as I have another box doing that.</p>
<p>Can you recommend a specific sketch to use with&nbsp;emonTxV3_4_as_Mk2Router.ino to calibrate the phase for each CT? I&#39;ve just calibrated the voltage and current with an electric fire and my meter and I&#39;ve got the following values</p>
<p>CT4 0.017, 360Ohm Burden, max current 6.5A</p>
<p>CT3 0,033 180Ohm Burden, max current 13A</p>
<p>CT2&nbsp;0,033&nbsp;180Ohm&nbsp;Burden, max current 13A</p>
<p>CT1&nbsp;0,148&nbsp;39Ohm&nbsp;Burden, max current 60A</p>
<p>Unfortunately the phantom overnight solar&nbsp;power of around 42Watts positive I had with the descrete sampling sketch is now around&nbsp;74Watts which is too far out for accurate solar monitoring at the start end end of the day as we head into winter down here. Also the grid power is under reading a bit so my guess is power factor problems are around especially as the background load right now is an inverter fridge, small electric pump, 2 PC&#39;s&nbsp;and various standby items..</p>
<p>I&#39;ve taken a look at&nbsp;emonTxV3_4_continuous_kwhtotals.ino and found&nbsp;#define RF69_COMPAT 0, changing that to a 1 fixed&nbsp;the problem and it now works, the results I get from this sketch seem more consistent than the periodic sampling one&nbsp;however it doesn&#39;t report the voltage so I can&#39;t calibrate it properly due to only one meter and a slightly varying mains voltage.&nbsp;It also seems to stop the moment I unplug the serial board so maybe it suffers from excessive&nbsp;power use.</p>
<p>For this sketch GIT says &quot;set to RFM69CW by default&quot; on the folder which is incorrect - is there a way of reporting this?</p>
<p>I hope this all makes sense - its been a long day!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30110"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Tue, 05/05/2015 - 11:20.</div>
    <div class="content">
     <p>Yes, it may be possible for a single processor to do all that you&#39;re looking for, but the code for this is unlikely to exist in exactly the form that you require.&nbsp; You will need to decide on an existing sketch that you can use as your base build, and then add the extra functionality that you require.&nbsp; By regularly checking and saving as you go, you will hopefully get there in the end ...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30123"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shortest sleep time</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Tue, 05/05/2015 - 18:20.</div>
    <div class="content">
     <p>Thanks, as this thread is now long and a little different from the original title I&#39;ll start a new one to aid anyone else in future</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/10553"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-nwC6oyxpG4Z5PP3AD4xdX3NE15Yjapfm4ZsjYUMPhiw" value="form-nwC6oyxpG4Z5PP3AD4xdX3NE15Yjapfm4ZsjYUMPhiw"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
