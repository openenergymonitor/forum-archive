<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/3298 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:08:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>rfm12pi feeds inactive after events module install | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">rfm12pi feeds inactive after events module install</h3>
        <span class="submitted">Submitted by <a href="../user/4604.html" title="View user profile.">Iain</a> on Sat, 07/12/2013 - 17:45</span>
        <div class="content"><p>Hi all,</p>
<p>We&#39;ve installed the event and report modules into emoncms and ran the database updates. Now the rfmi2pi feeds are no longer updating.</p>
<blockquote><p>sudo apt-get update<br />
		sudo apt-get install php5-mcrypt php5-curl<br />
		cd /var/www/emoncms/Modules<br />
		sudo git clone <a href="https://github.com/emoncms/event.git" title="https://github.com/emoncms/event.git">https://github.com/emoncms/event.git</a></p>
</blockquote>
<p>The file /var/log/rfmi12pi.log has the following error:</p>
<blockquote><p>Call to a member function fetch_object() on a non-object in /var/www/emoncms/Modules/raspberrypi/raspberrypi_model.php</p>
</blockquote>
<p>It looks like it can&#39;t set up the access to the database. We&#39;ve connected using mysqld and the databases are all there and running.</p>
<p>I&#39;ve also tried the following to fix it with no luck:</p>
<p class="rteindent1">sudo service rfm12piphp stop<br />
	cd /var/www/emoncms<br />
	git pull<br />
	cd /var/www/emoncms/Modules<br />
	git pull<br />
	cd /var/www/emoncms/Modules/raspberrypi<br />
	git pull<br />
	sudo cp /var/www/emoncms/Modules/raspberrypi/rfm12piphp /etc/init.d/<br />
	sudo chmod 755 /etc/init.d/rfm12piphp<br />
	sudo update-rc.d rfm12piphp defaults<br />
	sudo service rfm12piphp start<br />
	sudo reboot</p>
<p>Anyone got any suggestions?</p>
<p>Cheers, Iain</p>
  <div class="forum-topic-navigation clear-block">
          <a href="3360.html" class="topic-previous" title="Go to previous forum topic">‹ Question about CTs and spacing around wire</a>
              <a href="3389.html" class="topic-next" title="Go to next forum topic">Raspberry boot problem with  the downloaded image: emoncmsraspberrypihdd_stack.tar.gz (791Mb),  ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-16630"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4604.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Iain&#039;s picture" title="Iain&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: rfm12pi feeds inactive after events module install</h3>

    <div class="submitted">Submitted by <a href="../user/4604.html" title="View user profile.">Iain</a> on Sun, 08/12/2013 - 09:34.</div>
    <div class="content">
     <p>Okay, so we spent a while debugging it.</p>
<p>It doesn&#39;t appear to be a database issue.</p>
<p>I uncommented the line raspberry_run.php line 135 which is:</p>
<p class="rteindent1">echo $remotedata.&quot;\n&quot;;</p>
<p>The $remotedata&nbsp;variable was empty except for the JSON []</p>
<p>The frequency was also wrong in the output, it said 433 MHz but ours was set to 868.&nbsp;</p>
<p>We noticed that the light on the rfm12pi board was lit constantly and not blinking.</p>
<p>We shutdown the pi and removed and reseated the rfm board. Now it doesn&#39;t light up at all.</p>
<p>Anyone got any ideas?</p>
<p>Cheers, Iain</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16639"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4604.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Iain&#039;s picture" title="Iain&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: rfm12pi feeds inactive after events module install</h3>

    <div class="submitted">Submitted by <a href="../user/4604.html" title="View user profile.">Iain</a> on Sun, 08/12/2013 - 15:39.</div>
    <div class="content">
     <p>I&#39;ve attached the log output from a test run with the python gateway:</p>
<p>2013-12-08 15:34:12,893 DEBUG Opening serial port: /dev/ttyAMA0<br />
	2013-12-08 15:34:13,019 INFO Setting RFM2Pi | baseid: 15<br />
	2013-12-08 15:34:14,025 INFO Setting RFM2Pi | frequency: 8<br />
	2013-12-08 15:34:15,029 INFO Setting RFM2Pi | sgroup: 210<br />
	2013-12-08 15:34:16,238 INFO Serial RX:</p>
<p>2013-12-08 15:34:16,241 WARNING Misformed RX frame: [&#39;\x00&#39;]<br />
	2013-12-08 15:34:16,449 INFO Serial RX: Available commands:<br />
	2013-12-08 15:34:16,452 WARNING Misformed RX frame: [&#39;Available&#39;, &#39;commands:&#39;]<br />
	2013-12-08 15:34:16,669 INFO Serial RX:&nbsp;&nbsp; 123 x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Toggle configuration change protection, 1=Unlocked<br />
	2013-12-08 15:34:16,672 WARNING Misformed RX frame: [&#39;123&#39;, &#39;x&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;-&#39;, &#39;Toggle&#39;, &#39;configuration&#39;, &#39;change&#39;, &#39;protection,&#39;, &#39;1=Unlocked&#39;]<br />
	2013-12-08 15:34:16,889 INFO Serial RX:&nbsp;&nbsp; &lt;nn&gt; i&nbsp;&nbsp;&nbsp;&nbsp; - set node ID (standard node ids are 1..26)<br />
	2013-12-08 15:34:16,893 WARNING Misformed RX frame: [&#39;&lt;nn&gt;&#39;, &#39;i&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;-&#39;, &#39;set&#39;, &#39;node&#39;, &#39;ID&#39;, &#39;(standard&#39;, &#39;node&#39;, &#39;ids&#39;, &#39;are&#39;, &#39;1..26)&#39;]<br />
	2013-12-08 15:34:17,308 INFO Serial RX:&nbsp;&nbsp; &lt;n&gt; b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - set MHz band (4 = 433, 8 = 868, 9 = 915)<br />
	2013-12-08 15:34:17,311 WARNING Misformed RX frame: [&#39;&lt;n&gt;&#39;, &#39;b&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;-&#39;, &#39;set&#39;, &#39;MHz&#39;, &#39;band&#39;, &#39;(4&#39;, &#39;=&#39;, &#39;433,&#39;, &#39;8&#39;, &#39;=&#39;, &#39;868,&#39;, &#39;9&#39;, &#39;=&#39;, &#39;915)&#39;]<br />
	2013-12-08 15:34:17,528 INFO Serial RX:&nbsp;&nbsp; &lt;nnn&gt; g&nbsp;&nbsp;&nbsp; - set network group (RFM12 only allows 212, 0 = any)<br />
	2013-12-08 15:34:17,531 WARNING Misformed RX frame: [&#39;&lt;nnn&gt;&#39;, &#39;g&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;-&#39;, &#39;set&#39;, &#39;network&#39;, &#39;group&#39;, &#39;(RFM12&#39;, &#39;only&#39;, &#39;allows&#39;, &#39;212,&#39;, &#39;0&#39;, &#39;=&#39;, &#39;any)&#39;]<br />
	2013-12-08 15:34:17,745 INFO Serial RX:&nbsp;&nbsp; &lt;n&gt; c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - set collect mode (advanced, normally 0)<br />
	2013-12-08 15:34:17,748 WARNING Misformed RX frame: [&#39;&lt;n&gt;&#39;, &#39;c&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;-&#39;, &#39;set&#39;, &#39;collect&#39;, &#39;mode&#39;, &#39;(advanced,&#39;, &#39;normally&#39;, &#39;0)&#39;]<br />
	2013-12-08 15:34:17,963 INFO Serial RX:&nbsp;&nbsp; ...,&lt;nn&gt; a - send data packet to node &lt;nn&gt;, with ack<br />
	2013-12-08 15:34:17,966 WARNING Misformed RX frame: [&#39;...,&lt;nn&gt;&#39;, &#39;a&#39;, &#39;-&#39;, &#39;send&#39;, &#39;data&#39;, &#39;packet&#39;, &#39;to&#39;, &#39;node&#39;, &#39;&lt;nn&gt;,&#39;, &#39;with&#39;, &#39;ack&#39;]<br />
	2013-12-08 15:34:18,477 INFO Serial RX:&nbsp;&nbsp; ...,&lt;nn&gt; s - send data packet to node &lt;nn&gt;, no ack<br />
	2013-12-08 15:34:18,480 WARNING Misformed RX frame: [&#39;...,&lt;nn&gt;&#39;, &#39;s&#39;, &#39;-&#39;, &#39;send&#39;, &#39;data&#39;, &#39;packet&#39;, &#39;to&#39;, &#39;node&#39;, &#39;&lt;nn&gt;,&#39;, &#39;no&#39;, &#39;ack&#39;]<br />
	2013-12-08 15:34:18,694 INFO Serial RX:&nbsp;&nbsp; &lt;n&gt; l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - turn activity LED on DIG8 on or off<br />
	2013-12-08 15:34:18,697 WARNING Misformed RX frame: [&#39;&lt;n&gt;&#39;, &#39;l&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;-&#39;, &#39;turn&#39;, &#39;activity&#39;, &#39;LED&#39;, &#39;on&#39;, &#39;DIG8&#39;, &#39;on&#39;, &#39;or&#39;, &#39;off&#39;]<br />
	2013-12-08 15:34:18,906 INFO Serial RX: Current configuration:<br />
	2013-12-08 15:34:18,908 WARNING Misformed RX frame: [&#39;Current&#39;, &#39;configuration:&#39;]<br />
	2013-12-08 15:34:19,118 INFO Serial RX: 65 i1* g12 @ 433 MHz&nbsp; Lock: 1<br />
	2013-12-08 15:34:19,121 WARNING Misformed RX frame: [&#39;65&#39;, &#39;i1*&#39;, &#39;g12&#39;, &#39;@&#39;, &#39;433&#39;, &#39;MHz&#39;, &#39;&#39;, &#39;Lock:&#39;, &#39;1&#39;]<br />
	2013-12-08 15:34:19,575 INFO Serial RX:<br />
	2013-12-08 15:34:19,578 WARNING Misformed RX frame: [&#39;\x01&#39;]</p>
<p>It appears to hang after the x01 frame warning.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16641"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: rfm12pi feeds inactive after events module install</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Sun, 08/12/2013 - 15:59.</div>
    <div class="content">
     <p>Hello Iain, is your emoncms install being hosted on the raspberrypi? the empty $remotedata would ok if this was the case.</p>
<p>It would be interesting to know what line the first error you reported above originated from:</p>
<p>&quot;The file /var/log/rfmi12pi.log has the following error:</p>
<p>&nbsp;&nbsp;&nbsp; Call to a member function fetch_object() on a non-object in /var/www/emoncms/Modules/raspberrypi/raspberrypi_model.php&quot;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16642"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4604.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Iain&#039;s picture" title="Iain&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: rfm12pi feeds inactive after events module install</h3>

    <div class="submitted">Submitted by <a href="../user/4604.html" title="View user profile.">Iain</a> on Sun, 08/12/2013 - 16:06.</div>
    <div class="content">
     <p>Hi Trystan,</p>
<p>The emoncms&nbsp;install is indeed on the raspberrypi.</p>
<p>The line that reported it was : Line 29</p>
<p class="rteindent1">$row = $result-&gt;fetch_object();</p>
<p>The result object is a mysql query and the fact that we&#39;d just updated the db schema with the /admin/view made us think it might be an issue in connecting to the database.</p>
<p>The events module required:</p>
<p class="rteindent1">sudo apt-get update</p>
<p class="rteindent1">sudo apt-get install php5-mcrypt php5-curl</p>
<p>Do you have any thoughts?</p>
<p>EDIT: I should add that&nbsp;/emoncms/raspberrypi/get.json does seem to return the settings okay.</p>
<p>Thanks, Iain</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16979"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4861.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4861.jpg" alt="doddz3h&#039;s picture" title="doddz3h&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: rfm12pi feeds inactive after events module install</h3>

    <div class="submitted">Submitted by <a href="../user/4861.html" title="View user profile.">doddz3h</a> on Sun, 22/12/2013 - 23:17.</div>
    <div class="content">
     <p>Just thought I&#39;d pipe in to update anyone that might experience a similar thing in the future.</p>
<p>We managed to fix this eventually, more rather than pot luck than anything.</p>
<p>I went through the git repos for the modules and emon&nbsp;doing pulls to update, noticing one failed with a index corruption error. I deleted the suspect folder and cloned it back down. Still nothing working at this stage. &nbsp;Rebooting, reseating the module hadn&#39;t worked.</p>
<p>Then, the breakthrough came when I was in minicom and I removed and reseated the RFM2PI module. Previously minicom had been responding with weird data, generally being unresponsive but after reseating it now it seemed to respond as expected. Through that I was able to see that the config seemed wrong so I corrected that and data began printing in the console. It was some faffing around making sure it was on the right group (it was on the 0 for all setting) which eventually resulted in the data getting passed onto emoncms.</p>
<p>So with that in mind I would speculate that it was a corrupt git repo causing some havoc by having invalid settings getting applied to the RFM12 at startup. But still, very confused as to how this happened when we were meerly installing new modules.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/3298"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-1A7ZRpSRQgl2riqPz2cxDjF-Yhz3CG6V8u9doCDkRxM" value="form-1A7ZRpSRQgl2riqPz2cxDjF-Yhz3CG6V8u9doCDkRxM"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
