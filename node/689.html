<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/689 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:34:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>GLCD Solar PV sketch cumulative totals wrong | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">GLCD Solar PV sketch cumulative totals wrong</h3>
        <span class="submitted">Submitted by Guest on Mon, 21/05/2012 - 18:57</span>
        <div class="content"><p>After a couple of weeks regularly unplugging my GLCD, I&#39;ve finally managed to leave it powered up for a few days. I&#39;ve noticed today that the cumulative totals for the grid and solar PV generation are way out, looks like they haven&#39;t been resetting at midnight.</p>
<p>Sketch running is the most recent one with the PWM fading of the LEDs (which is very nice by the way), I do believe this issue was occuring before the PWM code was introduced, I&#39;m sure I noticed it after I performed the 3.3V mod with the previous sketch running.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="727.html" class="topic-previous" title="Go to previous forum topic">‹ XBee</a>
              <a href="713.html" class="topic-next" title="Go to next forum topic">emonTX at 4 Mhz ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-4537"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/783.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-783.gif" alt="Lloyd&#039;s picture" title="Lloyd&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by <a href="../user/783.html" title="View user profile.">Lloyd</a> on Mon, 21/05/2012 - 19:35.</div>
    <div class="content">
     <p>I&#39;m in the same position, but not had time to investigate very far. &nbsp;If the glcd does not get a time update (base unplugged) then it seems they do get reset overnight, if base is running, then it does not reset the daily totals.. &nbsp;I&#39;m not running the latest version, and I don&#39;t have 3.3v mod. Strangely, &nbsp; I thought this was working and then it stopped, and I don&#39;t remember making any changes.</p>
<p>Lloyd</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4539"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/905.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="robw&#039;s picture" title="robw&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by <a href="../user/905.html" title="View user profile.">robw</a> on Mon, 21/05/2012 - 20:10.</div>
    <div class="content">
     <p>Im also seeing this. &nbsp;<br />
	It did work for a while but im not sure what made it start and i know at the mo its definatly not working.</p>
<p>Running latest code. With mods</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4540"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Mon, 21/05/2012 - 20:46.</div>
    <div class="content">
     <p>For the KWh totals to work the time on the emonGLCD needs to be correct. This could come from the emonBase&nbsp;or could be set manually in the sketch. You should be able to check if the time is correct by pressing one the buttons (I think it&#39;s the top one). If the emonGLCD is reading the correct power values then the problem is probably due to the emonGLCD not knowing when it&#39;s midnight when it needs to reset the KWh counters.&nbsp;</p>
<p>Please let me know if the problem is due to the time issue. I&#39;m not ruling out a bug the crept into the code during one of the last commits. Are you running the latest code?&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4541"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/783.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-783.gif" alt="Lloyd&#039;s picture" title="Lloyd&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by <a href="../user/783.html" title="View user profile.">Lloyd</a> on Mon, 21/05/2012 - 20:57.</div>
    <div class="content">
     <p>I'm using relatively old code. The time is correct, but if it is being regularly updated by emonbase, the totals do not get reset. I'll turn off my emon base tonight and confirm.</p>
<p>Lloyd</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4543"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/783.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-783.gif" alt="Lloyd&#039;s picture" title="Lloyd&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by <a href="../user/783.html" title="View user profile.">Lloyd</a> on Tue, 22/05/2012 - 06:35.</div>
    <div class="content">
     <p>Once again last night, with emonbase off, my totals got reset.</p>
<p>Lloyd</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4549"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Tue, 22/05/2012 - 13:49.</div>
    <div class="content">
     <p>Right, I think I&#39;ve found (and fixed) the bug. The problem was with the emonBase code. The current version on GitHub should have fixed the problem. I&#39;ve simulated midnight but the acid test will come at midnight tonight!&nbsp;</p>
<p>The problem was a line that I added a while back to stop the emonBase&nbsp;sending 00:00:00 to the emonGLCD as this was happening when the server returned a null value. The emonGLCD was getting mistakenly set to midnight when the server did not response. This line was causing 23:59 to be sent continuously&nbsp;until 01:01 which as you experienced resulted in the emonGLCD missing it&#39;s trigger at midnight to reset the counters. The problem was I used AND instead of OR! The line now reads:</p>
<p><span class="k" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; border-image: initial; font-weight: bold; color: rgb(51, 51, 51); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; ">if</span><span style="color: rgb(51, 51, 51); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; "> </span><span class="p" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; border-image: initial; color: rgb(51, 51, 51); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; ">(</span><span class="n" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; border-image: initial; color: rgb(51, 51, 51); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; ">hour</span><span class="o" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; border-image: initial; font-weight: bold; color: rgb(51, 51, 51); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; ">&gt;</span><span class="mi" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; border-image: initial; color: rgb(0, 153, 153); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; ">0</span><span style="color: rgb(51, 51, 51); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; "> </span><span class="o" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; border-image: initial; font-weight: bold; color: rgb(51, 51, 51); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; ">||</span><span style="color: rgb(51, 51, 51); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; "> </span><span class="n" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; border-image: initial; color: rgb(51, 51, 51); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; ">mins</span><span class="o" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; border-image: initial; font-weight: bold; color: rgb(51, 51, 51); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; ">&gt;</span><span class="mi" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; border-image: initial; color: rgb(0, 153, 153); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; ">0</span><span style="color: rgb(51, 51, 51); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; "> </span><span class="o" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; border-image: initial; font-weight: bold; color: rgb(51, 51, 51); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; ">||</span><span style="color: rgb(51, 51, 51); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; "> </span><span class="n" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; border-image: initial; color: rgb(51, 51, 51); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; ">sec</span><span class="o" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; border-image: initial; font-weight: bold; color: rgb(51, 51, 51); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; ">&gt;</span><span class="mi" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; border-image: initial; color: rgb(0, 153, 153); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; ">0</span><span class="p" style="margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; border-top-width: 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-style: initial; border-color: initial; border-image: initial; color: rgb(51, 51, 51); font-family: 'Bitstream Vera Sans Mono', Courier, monospace; line-height: 14px; white-space: pre; ">) then send current time to the emonGLCD</span></p>
<p>If you update your emonBase&nbsp;to the latest version on GitHub the problem should be fixed:&nbsp;<a href="https://github.com/openenergymonitor/NanodeRF/tree/master/NanodeRF_Power_RTCrelay_GLCDtemp">https://github.com/openenergymonitor/NanodeRF/tree/master/NanodeRF_Power_RTCrelay_GLCDtemp</a></p>
<p>I&#39;ve also stripped out the RTC library from the emonBase to simplify things, there is no point the emonBase keeping track of time it&#39;s self when it receives the correct time from the server every 10&#39;s!</p>
<p>Please let me know if this works for you.&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4552"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/783.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-783.gif" alt="Lloyd&#039;s picture" title="Lloyd&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by <a href="../user/783.html" title="View user profile.">Lloyd</a> on Tue, 22/05/2012 - 18:05.</div>
    <div class="content">
     <p>Have retrofitted your changes into the version I&#39;m running, and will let you know how I get on tomorrow.</p>
<p>Lloyd</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4559"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="vworp&#039;s picture" title="vworp&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by vworp (not verified) on Wed, 23/05/2012 - 17:51.</div>
    <div class="content">
     <p>Didn&#39;t work for me.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4561"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/783.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-783.gif" alt="Lloyd&#039;s picture" title="Lloyd&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by <a href="../user/783.html" title="View user profile.">Lloyd</a> on Wed, 23/05/2012 - 19:35.</div>
    <div class="content">
     <p>Didn&#39;t work well for me either. &nbsp;I&#39;m checking for the colons in the time string, and then assuming that I have valid time. &nbsp;I&#39;ll let you know tomorrow how I get on.</p>
<p>&nbsp;</p>
<div>
	// Decode date time string to get integers for hour, min, sec, day</div>
<div>
	// We just search for the characters and hope they are in the right place</div>
<div>
	char val[1];</div>
<div>
	&nbsp;</div>
<div>
	if (line_buf[25]==&#39;:&#39; &amp;&amp; line_buf[28]==&#39;:&#39;) {&nbsp;</div>
<div>
	&nbsp; val[0] = line_buf[23]; val[1] = line_buf[24];</div>
<div>
	&nbsp; int hour = atoi(val);</div>
<div>
	&nbsp; val[0] = line_buf[26]; val[1] = line_buf[27];</div>
<div>
	&nbsp; int mins = atoi(val);</div>
<div>
	&nbsp; val[0] = line_buf[29]; val[1] = line_buf[30];</div>
<div>
	&nbsp; int sec = atoi(val);</div>
<div>
	&nbsp; val[0] = line_buf[11]; val[1] = line_buf[12];</div>
<div>
	&nbsp; int day = atoi(val);</div>
<div>
	&nbsp;</div>
<div>
	&nbsp; // cludge for BST</div>
<div>
	&nbsp; hour++;</div>
<div>
	&nbsp; if (hour==24) hour=0;</div>
<div>
	&nbsp;</div>
<div>
	&nbsp; emonbase.hour = hour; &nbsp; &nbsp;</div>
<div>
	&nbsp; emonbase.mins = mins;</div>
<div>
	&nbsp; emonbase.sec = sec;</div>
<div>
	&nbsp;</div>
<div>
	}</div>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4566"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/783.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-783.gif" alt="Lloyd&#039;s picture" title="Lloyd&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by <a href="../user/783.html" title="View user profile.">Lloyd</a> on Thu, 24/05/2012 - 08:00.</div>
    <div class="content">
     <p>So far so&nbsp;good.&nbsp; Totals&nbsp;reset last night.</p>
<p>Lloyd</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4583"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 25/05/2012 - 09:28.</div>
    <div class="content">
     <p>Sorry for the slow response, my emonGLCD got accidently turned off then I have been away. Last night I observed my emonGLCD resetting fine at midnight. Is it working for you now?</p>
<p>I have made a few tweaks to the emonGLCD&nbsp;example code this morning. I&#39;ve removed &#39;seconds&#39; to stop the emonBase sending &#39;seconds&#39; via RF since this was a bit of waste of time and bandwidth. I&#39;ve also added in the option to set a &#39;Time Difference&#39; to make the emonGLCD match local time if the emoncms server is not on local time. I know this is something many of you have been added yourselves.&nbsp;</p>
<p>I&#39;ve also added PWM&nbsp;red LED brightness control into the Home Energy Monitor emonGLCD example. The brightness of the red LED corresponds to the amount of power being consumed. Let me know what you think? It&#39;s easy to turn it off if you don&#39;t like it!&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4584"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/783.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-783.gif" alt="Lloyd&#039;s picture" title="Lloyd&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by <a href="../user/783.html" title="View user profile.">Lloyd</a> on Fri, 25/05/2012 - 11:10.</div>
    <div class="content">
     <p>Hi&nbsp;Glyn</p>
<p>As I said above, your code did not work for me,&nbsp;the clock was almost permanently&nbsp;being set to 1am. This&nbsp;was as a result of the url&nbsp;not always having valid time data (Each&nbsp;time I post to emoncms I get a number&nbsp;of lines back, only one of which contains the time.&nbsp; This is because I don&#39;t use the json url -&nbsp;it was too unreliable.)&nbsp; The code I posted above, where I actually look&nbsp;for&nbsp;the colons in the time string has worked for me for the past two nights, so I will stick with&nbsp;that.</p>
<p>Lloyd</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4585"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 25/05/2012 - 12:57.</div>
    <div class="content">
     <p>Ah right, it seems like you have a different problem since your not using JSON. Glad you&#39;ve solved it.</p>
<p>Is anyone here using the stock github emon example sketches? Is your time resetting correctly?&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4587"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="vworp&#039;s picture" title="vworp&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by vworp (not verified) on Fri, 25/05/2012 - 21:37.</div>
    <div class="content">
     <p>I&#39;m using the stock nanodeRF sketch. Time is right on the GLCD, but cumulative totals still aren&#39;t resetting.</p>
<p>Well, when I say time is right, time is out one hour due to BST, but that&#39;s another issue.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4589"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 25/05/2012 - 22:11.</div>
    <div class="content">
     <p>I&#39;ve just watched my emonGLCD&nbsp;kWh total reset in front of my eyes!:</p>
<p><a href="../sites/default/files/emonGLCD_timeReset.jpg"><img alt="" src="../sites/default/files/emonGLCD_timeReset.jpg" style="width: 400px; height: 300px; " /></a></p>
<p>I&#39;m running stock&nbsp;emon&nbsp;example sketches straight&nbsp;from&nbsp;GitHub. You need to update both your&nbsp;emonGLCD&nbsp;an&nbsp;NanodeRF&nbsp;sketches. As I explained in the <a href="689.html#comment-4549">post above</a> the problem was with the&nbsp;NanodeRF&nbsp;code. The latest emonGLCD code has got an option to set a time zone&nbsp;difference. See line 85 in the Home Energy Monitor example.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4655"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="vworp&#039;s picture" title="vworp&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by vworp (not verified) on Sat, 02/06/2012 - 15:35.</div>
    <div class="content">
     <p>Sorry for the late reply. I&#39;ve reloaded both sketches and cumulative totals seem to reset every night now.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4729"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/905.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="robw&#039;s picture" title="robw&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: GLCD Solar PV sketch cumulative totals wrong</h3>

    <div class="submitted">Submitted by <a href="../user/905.html" title="View user profile.">robw</a> on Fri, 08/06/2012 - 19:12.</div>
    <div class="content">
     <p>I can also confirm that its working for me.. &nbsp;with the code from github</p>
<p>Iv only updated the GLCD&nbsp;for info.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/689"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-ikQCgJj2cIUO4vjw_kmfg8vp1i1Es5pBRnSM0PHmqFo" value="form-ikQCgJj2cIUO4vjw_kmfg8vp1i1Es5pBRnSM0PHmqFo"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/689 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:34:47 GMT -->
</html>
