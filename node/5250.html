<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/5250 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:27:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>How to build an Energy Monitoring Android App p1 | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">How to build an Energy Monitoring Android App p1</h3>
        <span class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Sun, 01/06/2014 - 11:48</span>
        <div class="content"><p>Glyn and I have wanted to write an android app to make it easier to access energy monitoring data from phones and tablets for sometime.</p>
<p>Last year, we took part in a student project to develop an Emoncms Android App with Mathew Keegan, who, at the time, was studying at Aberystwyth University. Mathew made good progress on the foundations of the app which I&#39;ve uploaded to github here: <a href="https://github.com/emoncms/AndroidAppDev/tree/master/MathewKeeganAberUni">https://github.com/emoncms/AndroidAppDev/tree/master/MathewKeeganAberUni</a></p>
<p>I&#39;ve been trying to learn Android app programming to understand what Mathew has developed. I followed a couple of Hello World tutorials, explored networking and how to update the display. I&#39;ve written my notes as a tutorial: How to build an Energy Monitoring Android App part 1 here:</p>
<h3><a href="https://github.com/openenergymonitor/documentation/blob/master/BuildingBlocks/AndroidApp/AndroidAppPart1.md">Tutorial: How to build an Energy Monitoring Android App part 1</a></h3>
<p><img alt="" src="../../../github.com/openenergymonitor/documentation/raw/master/BuildingBlocks/AndroidApp/files/OnPhone.html" style="width: 500px; height: 375px;" /></p>
<p>I&#39;m going to try and continue development in this style by writing tutorials on how to do each step.</p>
<p>I think everyone should all be able to build their own software if they want to. Given the rising use of tablets and mobiles as our personal computing devices, having at least a basic understanding of how to build an app is enlightening, and it&#39;s satisfying to see the results on your phone. Even if you&#39;ve only dabbled in software before, I encourage you to try the tutorial. Please ask if anything needs clarifying. Feel free to send me a github pull request with edits to the tutorial.</p>
<p>My next tutorial will focus on how to use the android graphics canvas to draw a graph that looks like the myelectric graph in the emoncms &quot;myelectric&quot; module.</p>
<p>If you try the tutorial, please let me know how it goes for you.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="1966.html" class="topic-previous" title="Go to previous forum topic">‹ showing 40 feeds to multiple users</a>
              <a href="6051.html" class="topic-next" title="Go to next forum topic">Emoncms on an shared Linux Server (1and1) could not creat feed ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-21740"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4638.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="borpin123&#039;s picture" title="borpin123&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/4638.html" title="View user profile.">borpin123</a> on Sun, 01/06/2014 - 12:37.</div>
    <div class="content">
     <p>Excellent :)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21758"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6434.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6434.png" alt="tingenek&#039;s picture" title="tingenek&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/6434.html" title="View user profile.">tingenek</a> on Wed, 04/06/2014 - 09:15.</div>
    <div class="content">
     <p>Why not do it in Processing instead? Much simpler Android experience. Get a single reading and display:</p>
<pre>
String url = &quot;http://emoncms.org/feed/value.json?apikey=[YOURKEY]&amp;id=43834&quot;;
float currentReading;
String[] fontList;
PFont androidFont;

void setup() {
size(displayWidth, displayHeight);
smooth();
fontList = PFont.list();
androidFont = createFont(fontList[0], 40, true);
textFont(androidFont);
//Get latest reading
getReading();
}

void draw() {
background(0);
text(&quot;KWh: &quot; + currentReading,20,40);
}

void getReading() {
String lines[] = loadStrings(url);
currentReading =  Float.parseFloat(split(lines[0], &#39;&quot;&#39;)[1]); 
}</pre><p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21774"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Mon, 02/06/2014 - 22:39.</div>
    <div class="content">
     <p>@tingenek, Interesting! thanks for the snippet</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21781"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Tue, 03/06/2014 - 09:39.</div>
    <div class="content">
     <p>@tingenek, would you be interested in writing a tutorial on using processing to build the app? I know it creates more work for us but I think it would be great to have tutorials on writing this in processing and android java, that way we can learn about the different approaches and have an understanding of how we might achieve the same result via different approaches, advantages, disadvantages etc, I&#39;ve added the android app so far to the new software part in building blocks: <a href="../buildingblocks.html" title="http://openenergymonitor.org/emon/buildingblocks">http://openenergymonitor.org/emon/buildingblocks</a> It would be amazing to have a processing tutorial there too.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21787"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6434.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6434.png" alt="tingenek&#039;s picture" title="tingenek&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/6434.html" title="View user profile.">tingenek</a> on Tue, 03/06/2014 - 11:29.</div>
    <div class="content">
     <p>Happy to.&nbsp;</p>
<p>Is there a &quot;demo&quot; feed I can read to save me having to make/update one that I can use in the code? Happily, you can use MQTT with Processing as well so might be handy for later :-)&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21792"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/689.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-689.jpg" alt="tgmaxx&#039;s picture" title="tgmaxx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/689.html" title="View user profile.">tgmaxx</a> on Wed, 04/06/2014 - 16:02.</div>
    <div class="content">
     <p>Great work Trystan!</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21795"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Tue, 03/06/2014 - 16:00.</div>
    <div class="content">
     <p>Thanks! Yes there&#39;s a demo feed here: <a href="http://emoncms.org/feed/value.json?apikey=7f1b46367a013db07d2d65e588d2ad93&amp;id=43348" title="http://emoncms.org/feed/value.json?apikey=7f1b46367a013db07d2d65e588d2ad93&amp;id=43348">http://emoncms.org/feed/value.json?apikey=7f1b46367a013db07d2d65e588d2ad...</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21796"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Tue, 03/06/2014 - 16:02.</div>
    <div class="content">
     <p>Been working on the next part, tutorial on drawing a myelectric style graph using canvas, tried to keep the first part generic so that its applicable for java, processing, javascript:</p>
<p><a href="https://github.com/openenergymonitor/documentation/blob/master/BuildingBlocks/DrawingABarChart/DrawingABarChart.md" title="https://github.com/openenergymonitor/documentation/blob/master/BuildingBlocks/DrawingABarChart/DrawingABarChart.md">https://github.com/openenergymonitor/documentation/blob/master/BuildingB...</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21811"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6434.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6434.png" alt="tingenek&#039;s picture" title="tingenek&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/6434.html" title="View user profile.">tingenek</a> on Wed, 04/06/2014 - 15:37.</div>
    <div class="content">
     <p>Great. Just to make sure I read the api correctly, is this the right way to get the readings for the last seven days?<br />
	<a href="http://emoncms.org/feed/data.json?apikey=7f1b46367a013db07d2d65e588d2ad93&amp;id=43348&amp;start=1401291144382&amp;end=1401895944382&amp;dp=7" title="http://emoncms.org/feed/data.json?apikey=7f1b46367a013db07d2d65e588d2ad93&amp;id=43348&amp;start=1401291144382&amp;end=1401895944382&amp;dp=7">http://emoncms.org/feed/data.json?apikey=7f1b46367a013db07d2d65e588d2ad9...</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21818"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4638.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="borpin123&#039;s picture" title="borpin123&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/4638.html" title="View user profile.">borpin123</a> on Wed, 04/06/2014 - 20:43.</div>
    <div class="content">
     <p>Have you looked at aChartEngine for the charts? Trying to get my head around it :) Not too much in the way of tutorials that I have found.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21820"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 04/06/2014 - 21:19.</div>
    <div class="content">
     <p>@tingenek, sounds like your making good progress if your getting historical data! This is the api you want, this will request the average daily power in watts from feed 43348 which is a power feed. You can then convert average daily power to kWh by multiplying by 0.024.</p>
<p><a href="http://emoncms.org/feed/average.json?&amp;apikey=7f1b46367a013db07d2d65e588d2ad93&amp;id=43348&amp;start=1399420800000&amp;end=1402002710020&amp;interval=86400" title="http://emoncms.org/feed/average.json?&amp;apikey=7f1b46367a013db07d2d65e588d2ad93&amp;id=43348&amp;start=1399420800000&amp;end=1402002710020&amp;interval=86400">http://emoncms.org/feed/average.json?&amp;apikey=7f1b46367a013db07d2d65e588d...</a></p>
<p>Alternatively you could request the watt hour count at the end of each day with the same api but feed 43402. But maybe its easier to start with the power feed approach for now? Looking forward to seeing the processing app, Il get processing installed on my laptop here.</p>
<p>@borpin123, havent tried aChartEngine, looks interesting!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21843"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/317.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-317.jpg" alt="Sergegsx&#039;s picture" title="Sergegsx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/317.html" title="View user profile.">Sergegsx</a> on Thu, 05/06/2014 - 21:26.</div>
    <div class="content">
     <p>Trystan I would like to thank you once again for your excellent work and dedication on very good documentation.</p>
<p>I have been wanting to start Android programming for ages, and your first tutorial finally made me start learning. Thanks !</p>
<p>After following you first tutorial I got everything working, but it does not take long for the app to freeze. By adding some extra debuggin I found this...</p>
<blockquote><p>String urlstring = params[0];<br />
		&nbsp;&nbsp;<strong> Log.i(&quot;EmonLog&quot;, &quot;URL Instance...&quot;);</strong><br />
		&nbsp;&nbsp; URL url = new URL(urlstring);<br />
		&nbsp;<strong>&nbsp; Log.i(&quot;EmonLog&quot;, &quot;HTTP Connecting: &quot; + urlstring);</strong><br />
		&nbsp;&nbsp; HttpURLConnection urlConnection = (HttpURLConnection) url.openConnection();</p>
<p>&nbsp;&nbsp; try {<br />
		&nbsp;&nbsp;&nbsp; <strong>Log.i(&quot;EmonLog&quot;, &quot;InputStream reader&quot;);</strong></p>
<p>&nbsp;&nbsp;&nbsp; InputStream reader = new BufferedInputStream(<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; urlConnection.getInputStream());<br />
		&nbsp;&nbsp;&nbsp; <strong>Log.i(&quot;EmonLog&quot;, &quot;</strong><strong>Saving to text variable</strong><strong>&quot;);</strong></p>
<p>&nbsp;&nbsp;&nbsp; String text = &quot;&quot;;<br />
		&nbsp;&nbsp;&nbsp; int i = 0;<br />
		&nbsp;&nbsp;&nbsp; while ((i = reader.read()) != -1) {<br />
		&nbsp;&nbsp;&nbsp;&nbsp; text += (char) i;<br />
		&nbsp;&nbsp;&nbsp; }<br />
		&nbsp;&nbsp;&nbsp; Log.i(&quot;EmonLog&quot;, &quot;HTTP Response: &quot; + text);<br />
		&nbsp;&nbsp;&nbsp; result = text;</p>
</blockquote>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>The LogCat...</p>
<p>&nbsp;</p>
<blockquote><p>06-06 00:15:20.833: I/EmonLog(10090): Periodic<br />
		06-06 00:15:20.833: I/EmonLog(10090): URL Instance...<br />
		06-06 00:15:20.833: I/EmonLog(10090): HTTP Connecting: <a href="http://emoncms.org/feed/value.json?apikey=0xxxxxxxxxxxxxxxx03669b5676abf&amp;id=35089" title="http://emoncms.org/feed/value.json?apikey=0xxxxxxxxxxxxxxxx03669b5676abf&amp;id=35089">http://emoncms.org/feed/value.json?apikey=0xxxxxxxxxxxxxxxx03669b5676abf...</a><br />
		06-06 00:15:20.833: I/EmonLog(10090): InputStream reader<br />
		06-06 00:15:21.044: I/EmonLog(10090): Parsing the reader<br />
		06-06 00:15:21.044: I/EmonLog(10090): HTTP Response: &quot;2640.39&quot;<br />
		06-06 00:15:21.044: I/EmonLog(10090): HTTP Disconnecting<br />
		06-06 00:15:21.044: I/EmonLog(10090): Periodic 2640.39<br />
		06-06 00:15:21.044: I/EmonLog(10090): UIHandler 2640.39<br />
		06-06 00:15:21.286: I/EmonLog(10090): Periodic<br />
		06-06 00:15:21.286: I/EmonLog(10090): URL Instance...<br />
		06-06 00:15:21.286: I/EmonLog(10090): HTTP Connecting: <a href="http://emoncms.org/feed/value.json?apikey=0xxxxxxxxxxxxxxxxxc03669b5676abf&amp;id=35089" title="http://emoncms.org/feed/value.json?apikey=0xxxxxxxxxxxxxxxxxc03669b5676abf&amp;id=35089">http://emoncms.org/feed/value.json?apikey=0xxxxxxxxxxxxxxxxxc03669b5676a...</a><br />
		06-06 00:15:21.286: I/EmonLog(10090): InputStream reader</p>
</blockquote>
<p>&nbsp;</p>
<p>I have run multiple tests and it always get frozen in InputStream&nbsp;reader, therefore not reaching the next log line which I have called &quot;Saving to text variable&quot;.</p>
<p>Anyone has an idea on whats going on?</p>
<p>Thanks and once again, congrats !</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21845"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/317.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-317.jpg" alt="Sergegsx&#039;s picture" title="Sergegsx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/317.html" title="View user profile.">Sergegsx</a> on Thu, 05/06/2014 - 21:56.</div>
    <div class="content">
     <p>seems like this is helping quite a lot so far, will continue testing...</p>
<p>&nbsp;</p>
<blockquote><p>HttpURLConnection urlConnection = (HttpURLConnection) url.openConnection();</p>
<p>&nbsp;&nbsp; try {<br />
		&nbsp;&nbsp;&nbsp; Log.i(&quot;EmonLog&quot;, &quot;InputStream reader&quot;);<br />
		&nbsp;&nbsp;&nbsp; <strong>urlConnection.setConnectTimeout(5000);<br />
		&nbsp;&nbsp;&nbsp; urlConnection.setReadTimeout(5000);</strong><br />
		&nbsp;&nbsp;&nbsp; InputStream reader = new BufferedInputStream(urlConnection.getInputStream());</p>
</blockquote>
<p>&nbsp;</p>
<p>I have added a counter on the number of updates, will leave it on and see for how long it goes without freezing.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21850"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Fri, 06/06/2014 - 07:58.</div>
    <div class="content">
     <p>Thankyou Sergegsx, hearing that makes it worth it to write it! I got that issue too so great to hear you&#39;ve got a fix, is it still working today?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21857"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/317.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-317.jpg" alt="Sergegsx&#039;s picture" title="Sergegsx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/317.html" title="View user profile.">Sergegsx</a> on Fri, 06/06/2014 - 12:22.</div>
    <div class="content">
     <p>Trystan the truth is I have learned so much from your site, from you and from many members of the forum like Robert Wall, calypso, and others. I cant express my gratitude!</p>
<p>Regarding the &quot;fix&quot; it is working great ! It has been working ever since I posted without freezing, so yeah it works. I have noticed that from time to time the value of power appears blank, I guess due to a problem in the response from the server. I will try to add a check in which if the value obtained is empty or &quot;&quot; then do not update the value.</p>
<p>also, as well as the update counter (which is really useful for this test program) I want to add a &quot;last update x seconds ago&quot;.</p>
<p>I am on my firsts steps on Android but really happy and very thankful cause it was your tutorial which made me decide on finally start learning (had been in my &quot;to do&quot; list for ...years).</p>
<p>Regards.</p>
<p>&nbsp;</p>
<p>edit: works...</p>
<p>&nbsp;</p>
<blockquote><p>result = result.replaceAll(&quot;\&quot;&quot;, &quot;&quot;);<br />
		&nbsp;&nbsp;&nbsp; if (result == &quot;&quot;){<br />
		&nbsp;&nbsp;&nbsp;&nbsp; Log.i(&quot;EmonLog&quot;, &quot;**** EMPTY VALUE &quot; + result);<br />
		&nbsp;&nbsp;&nbsp; } else&nbsp;{<br />
		&nbsp;&nbsp;&nbsp; powervalue = result;<br />
		&nbsp;&nbsp;&nbsp; }<br />
		&nbsp;&nbsp;&nbsp;<br />
		&nbsp;&nbsp;&nbsp; Log.i(&quot;EmonLog&quot;, &quot;Periodic &quot; + powervalue);<br />
		&nbsp;&nbsp;&nbsp; counter_updates ++;</p>
</blockquote>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21858"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6434.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6434.png" alt="tingenek&#039;s picture" title="tingenek&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/6434.html" title="View user profile.">tingenek</a> on Fri, 06/06/2014 - 15:48.</div>
    <div class="content">
     <p>Afternoon&#39;s coding in Processing now on github:&nbsp;https://github.com/Tingenek/emoncms2/tree/master</p>
<p>Very rough first draft/hardcoded/minimal error handling. Works on my SII phone with android 2.35.</p>
<p>You don&#39;t need a phone to try it out as it will work on a desktop just as well.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21861"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Fri, 06/06/2014 - 19:35.</div>
    <div class="content">
     <p>Thanks Sergegsx, Good idea to have an last updated seconds ago. Maybe there could be some kind of indicator that turns red if it fails to fetch an update more than 3 or so times consecutively.</p>
<p>@Tingenek, looks brilliant! Il try and get it running here, still need to install processing.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21862"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6434.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6434.png" alt="tingenek&#039;s picture" title="tingenek&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/6434.html" title="View user profile.">tingenek</a> on Fri, 06/06/2014 - 20:37.</div>
    <div class="content">
     <p>Let me know how you get on.</p>
<p>Processing can be a bit picky about what android sdk bits you install.&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23805"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6780.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ewiandr&#039;s picture" title="ewiandr&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/6780.html" title="View user profile.">ewiandr</a> on Mon, 15/09/2014 - 01:11.</div>
    <div class="content">
     <p>G&#39;day,</p>
<p>How can i add a second feed to the display?</p>
<p>Thanks</p>
<p>Andy</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24959"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/317.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-317.jpg" alt="Sergegsx&#039;s picture" title="Sergegsx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to build an Energy Monitoring Android App p1</h3>

    <div class="submitted">Submitted by <a href="../user/317.html" title="View user profile.">Sergegsx</a> on Mon, 03/11/2014 - 20:37.</div>
    <div class="content">
     <p>Hello,</p>
<p>I hope this tutorials keep coming, I have now learned quite a lot on Android but still a super beginner. Anyway, I thought I should point out an important issue with one piece of the code in this example.</p>
<blockquote><p>
<strong>String result =</strong> new MyAsyncTask().execute().<strong>get();</strong></p>
</blockquote>
<p>The purpose of using AsyncTask is to prevent the user interface freezing during the HTTP request (that could take a 2 seconds or more). However, if you use the <strong>.get() </strong>then it will wait until it gets a response to continue, therefore the main purpose of AsyncTask is lost.</p>
<p>The results should be handled in the onpostexecute inside the AsyncTask. This will be executed whenever the<br />
doInBackground&nbsp;has finished.</p>
<p>Although my knowledge in Android is still extreme small, I hope someone finds this useful, it took me a while to figure everything out.</p>
<p>Thanks Trystan again for your work!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/5250"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-K3n0eFxzgr1pqAFc4ZzcFj7JfmHBsbxPX38ZSYspLp4" value="form-K3n0eFxzgr1pqAFc4ZzcFj7JfmHBsbxPX38ZSYspLp4"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
