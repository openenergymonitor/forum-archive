<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/734 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:57:27 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>calibration of ICAL and VCAL | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">calibration of ICAL and VCAL</h3>
        <span class="submitted">Submitted by Guest on Tue, 12/06/2012 - 06:24</span>
        <div class="content"><p>Im running my arduino with 5V</p>
<p>&nbsp;</p>
<p>now when im using the following page:&nbsp;<a href="https://learn.openenergymonitor.org/?redirect=ct-and-ac-power-adaptor-installation-and-calibration-theory">http://openenergymonitor.org/emon/buildingblocks/ct-and-ac-power-adaptor-installation-and-calibration-theory</a></p>
<p>Im ending up with ridiculous answers</p>
<p>for the voltage side:</p>
<p>for the voltage my resistors are both&nbsp;10Kohm&nbsp;where that for&nbsp;emontx&nbsp;are&nbsp;470Kohm, however, the ratio is still 1/11 since they add up for the same voltage divider. and 9V for 230V adapter:</p>
<p>&nbsp;</p>
<pre style="width: 700px; background-color: rgb(238, 238, 238); padding: 0.75em 1.5em; font-size: 14px; border: 1px solid rgb(221, 221, 221); color: rgb(0, 0, 0); line-height: 17px; text-align: left; ">
counts = (input pin voltage / 3.3) x 1024</pre><div>
<pre style="width: 700px; background-color: rgb(238, 238, 238); padding: 0.75em 1.5em; font-size: 14px; border: 1px solid rgb(221, 221, 221); color: rgb(0, 0, 0); line-height: 17px; text-align: left; ">
input pin voltage = adapter output voltage / 11</pre><p>&nbsp;</p>
<pre style="width: 700px; background-color: rgb(238, 238, 238); padding: 0.75em 1.5em; font-size: 14px; border: 1px solid rgb(221, 221, 221); color: rgb(0, 0, 0); line-height: 17px; text-align: left; ">
adapter output voltage = mains voltage x transformer ratio</pre><p>where im taking mains voltage to be 230v and the transformer ratio (230/9)</p>
<p>therefore my final calculation is:</p>
<p>counts = ((230*230/9)/(11*5)) * 1024</p>
<p>counts =109433.5354</p>
<p>&nbsp;</p>
<pre style="width: 700px; background-color: rgb(238, 238, 238); padding: 0.75em 1.5em; font-size: 14px; border: 1px solid rgb(221, 221, 221); color: rgb(0, 0, 0); line-height: 17px; text-align: left; ">
Vmains = count x a constant</pre><p>230=109433.5354 *Vcal</p>
<p>0.002=VCAL</p>
<p>for the current side:</p>
<p>im using a 33ohm resistor and 10Kohm&nbsp;resistor and yhdc sct&nbsp;013 000 again following the calculations</p>
<p>&nbsp;</p>
<pre style="width: 700px; background-color: rgb(238, 238, 238); padding: 0.75em 1.5em; font-size: 14px; border: 1px solid rgb(221, 221, 221); color: rgb(0, 0, 0); line-height: 17px; text-align: left; ">
current constant = (100 / 0.050) / 18 = 111.11</pre><p>therefore im working it like this</p>
<p>(100/0.05)/33 =66.6 for ICAL</p>
<h1 style="margin-bottom: 0.5em; font-size: 1.5em; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; line-height: 17px; text-align: left; ">
		&nbsp;</h1>
<p>i think im putting wrong values &nbsp;if someone can help me in one way or another please, i will appreciate it, since now i was able to get the xbees working and the webserver is up, and this is taking readings.. however the readings i am receiving for a simple fan stand of 60w&nbsp; 50 Hz and 240V are like 20000W for reactive power and 330 for Vrms for example</p>
<p>thanks a lot</p>
</div>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="749.html" class="topic-previous" title="Go to previous forum topic">‹ soldered board can&#039;t read correctly, what part of circuit problem could be if not soldered well ?</a>
              <a href="716.html" class="topic-next" title="Go to next forum topic">3G Bandwidth  ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-4783"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: calibration of ICAL and VCAL</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 12/06/2012 - 12:46.</div>
    <div class="content">
     <p>You have your transformer ratio the wrong way up. The transformer ratio is defined in this line:</p>
<blockquote><pre style="width: 700px; background-color: rgb(238, 238, 238); padding: 0.75em 1.5em; font-size: 14px; border: 1px solid rgb(221, 221, 221); color: rgb(0, 0, 0); line-height: 17px; text-align: left; ">
adapter output voltage = mains voltage x transformer ratio</pre></blockquote>
<p>Read the calibration page again and understand where the numbers come from. Then put your numbers into the calculations. You should get a value close to 280. (That is if your transformer really gives 9 V out with 230 V in, it might say that on the label but don&#39;t believe it if you can measure it accurately - there&#39;s a thing called &quot;transformer regulation&quot; - also briefly explained on the calibration page).</p>
<p>The calibration page says that the Arduino supply voltage (5 V) is already included in the calculations. You need to trace through the software in the sketch and the library to see why this is so.</p>
<p>&nbsp;</p>
<blockquote><p>(100/0.05)/33 =66.6 for ICAL</p>
</blockquote>
<p>I think you hit a wrong button or didn&#39;t read your calculator correctly when you did this sum!</p>
<p>Finally, you must not expect great accuracy when you are reading very small currents. See here <a href="https://learn.openenergymonitor.org/?redirect=measurement-implications-of-adc-resolution-at-low-current-values%c2%a0%c2%a0" title="http://openenergymonitor.org/emon/buildingblocks/measurement-implications-of-adc-resolution-at-low-current-values  ">http://openenergymonitor.org/emon/buildingblocks/measurement-implication...</a> You can expect significant errors when the current is below about 1 A.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4800"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="polando&#039;s picture" title="polando&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: calibration of ICAL and VCAL</h3>

    <div class="submitted">Submitted by polando (not verified) on Wed, 13/06/2012 - 12:22.</div>
    <div class="content">
     <p>so here you are taking that the voltage of the mains is always 230 V. what if I want to read it directly??? and therefore work these equations with the voltage of the mains being read constantly?? do i have to insert a voltage probe which goes into and arduino analog in &nbsp;or toggle the pins..something????&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4804"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: calibration of ICAL and VCAL</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 13/06/2012 - 13:45.</div>
    <div class="content">
     <blockquote><p>&quot;so here you are taking that the voltage of the mains is always 230 V.&quot;</p>
</blockquote>
<p>No, I am saying that the voltage of the mains is NEVER exactly 230 V, but varies according to how much power everyone else in the neighbourhood/country is using. That is the purpose of measuring it with the voltage input.</p>
<p>All you need to do with the transformer is measure the mains voltage (TAKE CARE!) then measure the output voltage. Better, measure both at the same time using two meters. You use these two numbers in your calculation to get the voltage calibration constant. That is all. You do not need to do any measuring on or with the Arduino.</p>
<p>You need to do this because the label on your transformer says &quot;9 V output&quot;&nbsp; but in practice, it gives 9 V at full load. You are not using it at full load, so you need to know the output voltage with no load. It is likely to be up to 25% higher than 9 V, depending on exactly how the transformer was designed and made.</p>
<p>Once you have calculated the constant, check the voltage that the Arduino outputs and see how different it is from the true mains voltage. The difference should be less than 10%. If it is, alter the constant so that you read the correct voltage. If it is not, either you have made a mistake in your calculations, of you have a problem with your circuit that you need to find and correct.</p>
<p>When your Arduino is in use measuring voltage and current, it does not matter that the voltage is not 230 V, the input to the Arduino will vary as the mains voltage varies.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/734"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-8njd1Q7svjPtP7Dt8k9ZASWCw6eiwySNcEcWVd2Ko8A" value="form-8njd1Q7svjPtP7Dt8k9ZASWCw6eiwySNcEcWVd2Ko8A"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
