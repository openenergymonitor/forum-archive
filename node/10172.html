<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/10172 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:11:01 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Solar: generation meter and consumer unit are in separate buildings | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Solar: generation meter and consumer unit are in separate buildings</h3>
        <span class="submitted">Submitted by <a href="../user/7698.html" title="View user profile.">jmessenger</a> on Sat, 14/02/2015 - 22:18</span>
        <div class="content"><p>I have my inverter in the garage and my consumer unit far away in the house.&nbsp; They are at least 30m apart, and separated by lots of thick walls (making radio penetration difficult).</p>
<p>There&#39;s Ethernet in both places, and I could run a cable between them but it would be about 60m in length.&nbsp; What&#39;s the best I can do for solar power monitoring?</p>
<p>Thanks!</p>
  <div class="forum-topic-navigation clear-block">
          <a href="10192.html" class="topic-previous" title="Go to previous forum topic">‹ Cannot get Local monitoring</a>
              <a href="10181.html" class="topic-next" title="Go to next forum topic">Newbie. Trouble geting OpenEnergyMonitor to work ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-27723"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar: generation meter and consumer unit are in separate buildings</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 14/02/2015 - 23:07.</div>
    <div class="content">
     <p>Where does the solar inverter feed into your electricity distribution system?<br />
And what exactly do you want to monitor, if anything, apart from the solar infeed?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27741"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7698.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-7698.jpg" alt="jmessenger&#039;s picture" title="jmessenger&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar: generation meter and consumer unit are in separate buildings</h3>

    <div class="submitted">Submitted by <a href="../user/7698.html" title="View user profile.">jmessenger</a> on Sun, 15/02/2015 - 18:47.</div>
    <div class="content">
     <p>The grid supply enters and goes directly to the main consumer unit in the house.&nbsp; An MCB feeds the supply to the garage, where there is another consumer unit.&nbsp; The inverter is connected to an MCB in this subsidiary consumer unit. Other MCBs feed other demands.&nbsp; It&#39;s like <a href="../applications/solarpv.html">type 2</a> in the sense that consumption cannot be measured separately.</p>
<p>I&#39;d like to monitor (a) generation,&nbsp; (b) total consumption and (c) nett consumption/contribution from/to the grid.&nbsp; Ideally I&#39;d like to be in a position to divert surplus generation into another load, but this is a future project.</p>
<p>As I understand it, one potential approach would be to</p>
<ul>
<li>measure &quot;(c)&quot; adjacent to the master consumer unit, using an emonTx with an AC/AC converter</li>
<li>measure &quot;(a)&quot; with another emonTx adjacent to the generation meter</li>
<li>work out &quot;(b)&quot; from the other measurements in some other computer, e.g., in an EmonLCD or a base station.&nbsp; It&#39;s an open question whether I can site a base station somewhere where the radio signals from the emonTxs can both reach it.</li>
</ul>
<p>What is a sensible limit to the length of the cable from the current clamp to the emonTx?</p>
<p>Thanks for your help.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27751"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar: generation meter and consumer unit are in separate buildings</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 15/02/2015 - 22:29.</div>
    <div class="content">
     <p>From that, I assume that the "other demands" in the garage are significant, If they were not, then the easy solution would have been to measure the garage feed, but you'd clearly thought about that. </p>
<p>I've never tried a 60 m CT cable run, I've done around 10 m, using twin twisted screened pair ("microphone") cable, earthing the screen only at the CT end. I've not done the sums on phase shift due to cable capacitance at around 100 pF/m, but as the system impedance is around 100 Ω, I wasn't going to bother either! Sensitivity doesn't come into consideration (except as a second-order effect) as the CT is a current, not voltage, source. 60 m ought to be do-able if there are no serious sources of interference.</p>
<p>If Paul (pb66) can confirm that a Raspberry Pi and EmonHub can get data from the LAN, what about something like an Ethernet-equipped Arduino and emonTx Shield in the garage to measure generation?</p>
<p>If you're thinking of a diverter, what you're generating doesn't actually matter, all you need to measure is the nett power at the grid connection. (Because the diverter trims the dump load to give nett zero import/export whenever it can.)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27755"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7698.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-7698.jpg" alt="jmessenger&#039;s picture" title="jmessenger&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar: generation meter and consumer unit are in separate buildings</h3>

    <div class="submitted">Submitted by <a href="../user/7698.html" title="View user profile.">jmessenger</a> on Mon, 16/02/2015 - 00:11.</div>
    <div class="content">
     <p>Lots of good ideas here.&nbsp; Thanks.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27796"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7698.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-7698.jpg" alt="jmessenger&#039;s picture" title="jmessenger&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar: generation meter and consumer unit are in separate buildings</h3>

    <div class="submitted">Submitted by <a href="../user/7698.html" title="View user profile.">jmessenger</a> on Mon, 16/02/2015 - 22:51.</div>
    <div class="content">
     <p>Looking at the code for EmonHub, there is indeed a facility to receive data over the LAN.&nbsp; There&#39;s an Interfacer called EmonHubSocketInterfacer which can receive standard ASCII representations of packets in the format &quot;NodeID val1 val2 ...\r\n&quot; or &quot;timestamp NodeID val1 val2&quot; over TCP/IP.&nbsp; I think it should be configured like this</p>
<pre>
[interfacers]
# This interfacer manages my LAN comms
[[LANcomms]]
    Type = EmonHubSocketInterfacer
    [[[init_settings]]]
        port_nb = 50022
    [[[runtimesettings]]]
        timestamped = false</pre><p>Then to submit a value (for test purposes for example, or maybe from a script), to submit a reading of one value &quot;440&quot; from node 11 to the emonBase running at address 192.168.0.1, one could use:</p>
<pre>
% echo -e &quot;11 440\r\n&quot; | nc 192.168.0.1 50022
</pre><p>If using say and Arduino Uno and an EmonTx shield then this would be done in code instead.&nbsp; A fair degree of trial and error would probably be required.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27803"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar: generation meter and consumer unit are in separate buildings</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 17/02/2015 - 01:01.</div>
    <div class="content">
     <p>Sorry, I managed to miss this thread somehow.&nbsp;</p>
<p>Yes (as you have now discovered yourself) emonhub&nbsp;can accept data via a socket from the LAN, there are a couple of discusions happening at the moment which inspired me to start the &#39;<a href="10176.html">emonhub modules &quot;sandbox&quot;&nbsp;thread</a>&#39; it sounds like you are well versed in this area so please feel free to pass comment,&nbsp;</p>
<p>Also see this thread on&nbsp;<a href="6100.html">creating and&nbsp;using an&nbsp;EmonHubSocketInterfacer</a>&nbsp;thread, I will also&nbsp;link a couple of other example threads.</p>
<p>I&nbsp;hadn&#39;t thought of sending values from script as you suggest, that open a whole new avenue of thought thanks for that.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27854"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar: generation meter and consumer unit are in separate buildings</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Wed, 18/02/2015 - 09:22.</div>
    <div class="content">
     <p>this echo should do the same as well..&nbsp;</p>
<p>echo -e &quot;11 440\r\n&quot; &gt; /dev/tcp/192.168.0.1/50022</p>
<p>Linux - don&#39;t know about other OS&#39;s</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27858"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar: generation meter and consumer unit are in separate buildings</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 18/02/2015 - 17:34.</div>
    <div class="content">
     <p>Thanks for the one-liners, tried both and found they both work although&nbsp;the newline isn&#39;t needed, just the return.</p>
<blockquote><p>echo -e &quot;11 440\r&quot;&nbsp;| nc 192.168.0.1 50022</p>
<p>echo -e &quot;11 440\r&quot; &gt; /dev/tcp/192.168.0.1/50022</p>
</blockquote>
<p>both work, but only on the local machine (which is all we want&nbsp;here)&nbsp;as do both of these which simplify it further.</p>
<blockquote><p>echo -e &quot;11 440\r&quot;&nbsp;| nc localhost 50022</p>
<p>echo -e &quot;11 440\r&quot; &gt; /dev/tcp/localhost/50022</p>
</blockquote>
<p>This makes life much easier eg it negates the need to initiate a script when using cron to send a value at a set time, the command and values&nbsp;can be added directly to crontab. fantastic!</p>
<p>Paul</p>
<p>EDIT - Not meaning to hijack your thread, but just for the sake of&nbsp;completeness, I tried running directly from a&nbsp;crontab&nbsp;entry&nbsp;and found you need to force &quot;bash&quot; using a complete path&nbsp;rather than let crontab default to &quot;sh&quot; for example to run at midnight every night you would use</p>
<blockquote><p>00 00 * * *&nbsp;* * * /bin/bash -c &#39;echo -e &quot;11 440\r&quot; &gt; /dev/tcp/localhost/50022&#39;</p>
</blockquote>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27888"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dBC&#039;s picture" title="dBC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar: generation meter and consumer unit are in separate buildings</h3>

    <div class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Wed, 18/02/2015 - 21:06.</div>
    <div class="content">
     <p>Yes, that /dev/tcp stuff is all bash trickery. &nbsp;They&#39;ve coded it to make it look like you&#39;re redirecting to a device node, but if you check there is no /dev/tcp/... &nbsp; &nbsp;bash parses all that and manages the network connections internally. &nbsp; Piping into nc is for real though, and so works with any shell. &nbsp;For even more flexibility, consider socat&nbsp;rather than&nbsp;nc.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27913"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7698.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-7698.jpg" alt="jmessenger&#039;s picture" title="jmessenger&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar: generation meter and consumer unit are in separate buildings</h3>

    <div class="submitted">Submitted by <a href="../user/7698.html" title="View user profile.">jmessenger</a> on Wed, 18/02/2015 - 23:57.</div>
    <div class="content">
     <p>Thanks for the feedback and links! I&#39;ll look into them.</p>
<h2>General description of my setup</h2>
<p>I have a commercial RHI biomass system (a pellet boiler).&nbsp; To monitor this, I have a RPi in the garage already, receiving radio from an EmonTx dedicated to monitoring the pellet boiler&#39;s auger motor. The EmonTx is running a very custom script to accurately measure the auger on-times, and I don&#39;t think I can add a current measurement without screwing up the loop timing.&nbsp; So, I may add another EmonTx there to measure the solar generation (and add a few temperature sensors I&#39;d like to have there too, on the hot water store and maybe on the demand circuits).&nbsp; That would feed data into the existing Rpi.&nbsp; The I would add another EmonTx near the consumer unit in the house (measuring overall consumption, and maybe one day doing divert, but see note below, and perhaps measuring some subcircuits like lights and individual ring mains). Then I have to decide what would receive the radio data from that, given that it&#39;s too far away for radio to reach the garage (though I could go the Ethernet Arduino + EmonTx shield route). Probably a second Rpi in the house receiving signals from room EmonTHs (or a long string of oneWire temp sensors?).&nbsp;</p>
<p>The Gararge RPi also runs a script and some software derived from libmbus to read the data from the heat meter and that gets fed into emonCMS.&nbsp; I&#39;d be happy to share this code if people are interested.</p>
<p>I have two emonCMS servers.&nbsp; One is in the garage&#39;s RPi, and one is on my main Linux server.&nbsp; I do it this way so that the RPi can run without writing values to the FLASH (having learnt the hard way what happens if you do that) and also because the Linux machine runs nice and fast and provides a slicker response to my browser.</p>
<p>So, given all that, I now think I may not need to use the EmonHubSocketInterfacer, because my existing Garage RPi can receive the generation readings and my Linux machine&#39;s emonCMS can do the calculations based on local and remotely generated feeds!</p>
<h2>Note on solar diversion in my case</h2>
<p>I have a problem coming up with a sensible load to divert power into.&nbsp; Sure, I have a couple of water tanks with immersion heaters.&nbsp; The problem is that the pellet boiler commercial RHI is so generous that there is absolutely no economic benefit to me to generate hot water from excess electrical generation. Battery systems don&#39;t seem viable as a store-and-use-later approach.&nbsp; If I had an electric car to charge, that would make sense. So it almost seems best to let that power go back into the grid.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27915"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar: generation meter and consumer unit are in separate buildings</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 19/02/2015 - 00:08.</div>
    <div class="content">
     <p><i>"(or a long string of oneWire temp sensors?). "</i></p>
<p>Generally, this doesn't seem to be a good idea, unless you use the dedicated driver IC.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/10172"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-bpEnEr3dpJkEoG8IcfjynLmPgU0GT7_T-XnJouBfbCg" value="form-bpEnEr3dpJkEoG8IcfjynLmPgU0GT7_T-XnJouBfbCg"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
