<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11319 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 13:45:26 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>ESP8266 MQTT WIFI energy monitor project | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/3.html">Archived: General Discussion</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">ESP8266 MQTT WIFI energy monitor project</h3>
        <span class="submitted">Submitted by <a href="../user/8768.html" title="View user profile.">hwstar</a> on Thu, 01/10/2015 - 01:59</span>
        <div class="content"><p>I built an open source printed board using an ATMEL 90E24 energy monitoring chip, and an ESP8266. If precautions are taken and the user is comfortable working with mains voltages, then this solution may be of interest to this group.&nbsp; I have a couple of these boards monitoring the output of my solar inverter, and the AC input to my battery charger. Because the link is RF,&nbsp; isolation is achieved, however, the board does have mains voltages present on it, so it should be housed in an insulated electrical box where no one can touch it when it is powered on. The firmware uses MQTT and JSON to send measurement and metering data back to the requester.</p>
<p>&nbsp;</p>
<p>For project details please visit my Github page at <a href="https://github.com/hwstar/HW-AC-Emeter" title="https://github.com/hwstar/HW-AC-Emeter">https://github.com/hwstar/HW-AC-Emeter</a></p>
<p>&nbsp;</p>
<p style="border:3px solid red; padding: 5px;">This project should only be attempted by someone having the training, qualifications, experience and equipment to work on live circuits at mains voltage. You must read and understand the warnings in the accompanying documentation. You must not proceed with this project unless you are certain that you are competent to do so.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11404.html" class="topic-previous" title="Go to previous forum topic">‹ emonGLCD - Display 4 ct readings - help needed</a>
              <a href="11405.html" class="topic-next" title="Go to next forum topic">OpenEnergyMonitor development history update October 2015 ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-34645"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: ESP8266 MQTT WIFI energy monitor project</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 02/10/2015 - 12:13.</div>
    <div class="content">
     <p>Wow, this looks really interesting. I have recently heard of the&nbsp;90E24 chip. How are you getting on with this? What are your long term plans for this project? I would love to post a guest blog post on our blog about your developments.&nbsp;</p>
<p>I like that you have used the ESP8266&nbsp;and MQTT. How difficult did you find interfacing with the&nbsp;90E24? Have you experiment with the 3-phase version?&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34649"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: ESP8266 MQTT WIFI energy monitor project</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Fri, 02/10/2015 - 14:16.</div>
    <div class="content">
     <p>Lovely project indeed, great potential in this solution. Subscribing to the topic</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34650"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8768.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-8768.jpg" alt="hwstar&#039;s picture" title="hwstar&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: ESP8266 MQTT WIFI energy monitor project</h3>

    <div class="submitted">Submitted by <a href="../user/8768.html" title="View user profile.">hwstar</a> on Fri, 02/10/2015 - 15:20.</div>
    <div class="content">
     <p>I wanted to build my own measurement devices, because I have an small 1kW solar system and battery bank serving as an offline UPS which provides power to my servers and PC &#39;s during the day, and I wanted to monitor the output of the inverter and the AC&nbsp; input to the charger.</p>
<p>I chose the 90E24 because it can be had for 1.60USD, has a SSOP28 package which is relatively easy to solder, and it can use an inexpensive shunt resistor as the current measuring device.</p>
<p>There are actually 2 forms of the project, one uses&nbsp; the ESP8266, and the other uses the Arduino as a&nbsp; standalone energy monitoring box.</p>
<p>I have no desire to sell this project as a product. I really only wanted to solve a problem, and share my work with the open source/open hardware community.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>The 90E24 interfacing was trivial. &nbsp; Having to lock and unlock the register banks was the most challenging part of the firmware development.&nbsp; Also some of the registers have signed values, while others have two&#39;s complement values.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>The big challenge with the 90E24 is accurate calibration without laboratory-grade test equipment. I have only been able to get 1-2% due to the lack of the proper test equipment. The 90E24 is capable of 0.2%.&nbsp; The mains voltage jumps around quite a bit in my neighborhood especially in the afternoon.&nbsp; If you have a programmable AC source, and precision loads you can get more stable voltage calibration, and your current calibration will be easier as well.</p>
<p>I have not used the 3 phase version of the part. In my part of the US, we can&#39;t get 3 phase power in a residence. It is only available to commercial customers.</p>
<p>I have revision A boards out for fabrication to address the rework requiements on the rev X1 board. These should show up in Early November. Once I have tested these, I will upload the rev A board design and schematic to Github.</p>
<p>&nbsp;</p>
<p>Steve Rodgers</p>
<p>hwstar</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34667"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/317.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-317.jpg" alt="Sergegsx&#039;s picture" title="Sergegsx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: ESP8266 MQTT WIFI energy monitor project</h3>

    <div class="submitted">Submitted by <a href="../user/317.html" title="View user profile.">Sergegsx</a> on Sat, 03/10/2015 - 15:31.</div>
    <div class="content">
     <p>Very nice work. Subscribing to the topic also.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34670"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: ESP8266 MQTT WIFI energy monitor project</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Sat, 03/10/2015 - 21:35.</div>
    <div class="content">
     <p>Great work, might you have any spare PCB&#39;s? I would be happy to pay and cover all shippings costs. Looking forward to having a play.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34672"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8768.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-8768.jpg" alt="hwstar&#039;s picture" title="hwstar&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: ESP8266 MQTT WIFI energy monitor project</h3>

    <div class="submitted">Submitted by <a href="../user/8768.html" title="View user profile.">hwstar</a> on Sun, 04/10/2015 - 00:02.</div>
    <div class="content">
     <p>&nbsp;</p>
<p>I have no assembled boards left, only board blanks. I&#39;m saving the remaining parts for the rev A build. Can you build an smt board? If so, I can send you some board blanks for the cost of shipping.</p>
<p>I have 11 of the rev X1 blanks left. I got 14 from Elecrow, and built 3 of them for my use.</p>
<p>The rev X1 boards will require rework (2 cuts and a jumper). The rework is documented on my Github site.</p>
<p>I have rev A board blanks on their way to me via slowboat from Elecrow, but they won&#39;t be here till the beginning of November. These have the rework incorporated, and also bring 3.3V to pin 3 of the serial connector for the ESP8266.</p>
<p>Steve Rodgers</p>
<p>hwstar</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34675"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: ESP8266 MQTT WIFI energy monitor project</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Sun, 04/10/2015 - 08:07.</div>
    <div class="content">
     <p>Hi Steve,</p>
<p>Thanks a lot. Yes, I&#39;m happy to assemble SMT no problem. I have seen the required&nbsp;rework&nbsp;documentation&nbsp;on your github, this should not be a problem. Please PM me your details and I&#39;ll send over payment.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34998"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8768.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-8768.jpg" alt="hwstar&#039;s picture" title="hwstar&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: ESP8266 MQTT WIFI energy monitor project</h3>

    <div class="submitted">Submitted by <a href="../user/8768.html" title="View user profile.">hwstar</a> on Fri, 16/10/2015 - 15:20.</div>
    <div class="content">
     <p>&nbsp;</p>
<p>An update:</p>
<p>I received and tested the revision A design. Testing of 2 boards on the bench is complete with no issues. Rev A incorporates the X1 rework, makes the ground plane clearance 0.016 inches instead of 0.008 inches, removes some of the mode pin pullup/pulldowns and adds 3.3V to pin 3 of the programming connector through a zero ohm resistor.</p>
<p>The Revision A schematic. BOM and board design are now available on my Github site at: <a href="https://github.com/hwstar/HW-AC-Emeter" title="https://github.com/hwstar/HW-AC-Emeter">https://github.com/hwstar/HW-AC-Emeter</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11319"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-2PBMw0boNTJgQegygAAD5ffQ1IGE8las1YkAESL6FOc" value="form-2PBMw0boNTJgQegygAAD5ffQ1IGE8las1YkAESL6FOc"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/11319 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 13:45:27 GMT -->
</html>
