<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/959 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:06:13 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>DS18B20 temperature sensor | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/3.html">Archived: General Discussion</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">DS18B20 temperature sensor</h3>
        <span class="submitted">Submitted by Guest on Sat, 18/08/2012 - 10:07</span>
        <div class="content"><p>Hi, Trying to add temperature to emontx with no luck. I using lastest emontx and have DS18D20 water proof kit.</p>
<p>Tried temperature search sketch and com is blank.</p>
<p>When I use emontx temperature power sketch it provides power ok but -12700 -12700 -12700 -12700 for temperature 1-4 ( note using one DS18B20 only). Assume this is to be expected if address is wrong in sketch in the first place?</p>
<p>I have checked wiring and looks ok , even comfirmed color code also white-data, red--VCC.</p>
<p>The solder links are untouched e.g. unjoined.</p>
<p>Any help appreciated.</p>
<p>Cheers</p>
<p>Peter</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="1955.html" class="topic-previous" title="Go to previous forum topic">‹ Help troubleshooting communication between raspberry pi and emontx</a>
              <a href="1943.html" class="topic-next" title="Go to next forum topic">Battery-efficient pulse measurement ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-5804"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 temperature sensor</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Sat, 18/08/2012 - 20:46.</div>
    <div class="content">
     <p>&nbsp;Hi Peter,&nbsp;</p>
<p>It sounds like you are doing everything correct Can you measure the voltage on the VCC, data and GND connections on the sensor? Do your connections match those on the diagram on this page:&nbsp;<a href="../emontx/reference%20.html">http://openenergymonitor.org/emon/emontx/reference%20</a>&nbsp;?</p>
<p>I take it that you have the correct software librarys and the example sketches compile ok?</p>
<p>Good luck,</p>
<p>Glyn.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-5807"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="PeterN&#039;s picture" title="PeterN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 temperature sensor</h3>

    <div class="submitted">Submitted by PeterN (not verified) on Sun, 19/08/2012 - 07:39.</div>
    <div class="content">
     <p>Hi Glyn, I'm using latest libraries and sketches to compile and they upload ok. Yes used diagram you refer to even double checked color code e.g. data white, Vcc red.</p>
<p>Checked Voltage on jack with sensor pluged in and out (same values): readings were 5.09V Gnd - Vcc and 4.09V Gnd - data.</p>
<p>Cheers</p>
<p>Peter</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-5808"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 temperature sensor</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Sun, 19/08/2012 - 09:05.</div>
    <div class="content">
     <p>&nbsp;Mmm, that sounds perfect. Could you try the 'simple' example in included in the temperature control library with the one wire bus set to digital 6? It should be set to 6 in the emontx temperature examples&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-5809"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="PeterN&#039;s picture" title="PeterN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 temperature sensor</h3>

    <div class="submitted">Submitted by PeterN (not verified) on Sun, 19/08/2012 - 09:58.</div>
    <div class="content">
     <p>runs ok, same output ds18b20 plugged in or out,&nbsp; result below</p>
<p><u><em>Single</em></u></p>
<p>Requesting temperatures...DONE<br />
Temp C: 0.00 Temp F: 32.00<br />
Requesting temperatures...DONE<br />
Temp C: 0.00 Temp F: 32.00<br />
Requesting temperatures...DONE<br />
Temp C: 0.00 Temp F: 32.00<br />
Requesting temperatures...DONE<br />
&nbsp;</p>
<p><em><u>Simple</u></em></p>
<p>Temperature for the device 1 (index 0) is: 0.00<br />
Requesting temperatures...DONE<br />
Temperature for the device 1 (index 0) is: 0.00<br />
Requesting temperatures...DONE<br />
&nbsp;</p>
<p>Checked voltages again and look ok&nbsp; e.g. 4v on (top jack) data and 5 v on Vcc (middle).</p>
<p>Think I need more kit to check which is at fault emontx or DS18B20. All kits tied up at present on trial so will have to wait till trial finished, other suggestions? Many Thanks. Cheers Peter</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-5814"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rogerrally&#039;s picture" title="rogerrally&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 temperature sensor</h3>

    <div class="submitted">Submitted by rogerrally (not verified) on Sun, 19/08/2012 - 19:57.</div>
    <div class="content">
     <p>I have just been struggling with the same issue of getting my temperature sensing to work.</p>
<p>Try using the OneWire -&nbsp;DS18x20_Temperature example sketch.</p>
<p>But change the following line from</p>
<p>OneWire&nbsp; ds(10);&nbsp; // on pin 10</p>
<p>to</p>
<p>OneWire&nbsp; ds(4);&nbsp; // on pin 4</p>
<p>This then worked for me and gave me the following information on my waterproof DS18B20</p>
<p>ROM = 28 E0 BB E0 3 0 0 A5<br />
&nbsp; Chip = DS18B20<br />
&nbsp; Data = 1 A0 1 4B 46 7F FF 10 10 6E&nbsp; CRC=6E<br />
&nbsp; Temperature = 26.00 Celsius, 78.80 Fahrenheit<br />
No more addresses.<br />
&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-5826"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 temperature sensor</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Mon, 20/08/2012 - 19:59.</div>
    <div class="content">
     <p>&nbsp;Hi Peter,</p>
<p>It sounds like you might have a faulty sensor if you haven't had any luck I will send you a sensor which has been tested to work.&nbsp;</p>
<p>Drop us an email to <a href="mailto:contact@megni.co.uk">contact@megni.co.uk</a> and I'll sort it</p>
<p>&nbsp;</p>
<p>All the best ,</p>
<p>.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7518"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2233.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="mlmunro&#039;s picture" title="mlmunro&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 temperature sensor</h3>

    <div class="submitted">Submitted by <a href="../user/2233.html" title="View user profile.">mlmunro</a> on Wed, 21/11/2012 - 16:10.</div>
    <div class="content">
     <p>This exact same thing is happening to me. How did this get fixed ?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7519"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1958.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1958.png" alt="fluppie007&#039;s picture" title="fluppie007&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 temperature sensor</h3>

    <div class="submitted">Submitted by <a href="../user/1958.html" title="View user profile.">fluppie007</a> on Wed, 21/11/2012 - 16:21.</div>
    <div class="content">
     <p>I added a 10000ms delay before the sketch uploads the address to the terminal screen. Otherwise I had no time to open the terminal/com screen.</p>
<p>See my attached sketch!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7520"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2233.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="mlmunro&#039;s picture" title="mlmunro&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 temperature sensor</h3>

    <div class="submitted">Submitted by <a href="../user/2233.html" title="View user profile.">mlmunro</a> on Wed, 21/11/2012 - 16:34.</div>
    <div class="content">
     <p>OK, I think i have figured this one out by myself, the instructions say that the sensor can be wired up two ways and then show a diagram that includes the (unrelated at that point) picture of how to wire up the pulse sensor as well as the temperature sensor. That&#39;s the wiring that I have used (the pulse wiring) thinking that it was the recommended way to wire of the two.</p>
<p>It says that it is recommended not to use the parasite power version of wiring for reliability so I assumed that the diagram without the parasite label was the correct wiring (wrong)</p>
<p>Hope this helps others in the same position.</p>
<p>Cheers</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7554"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2233.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="mlmunro&#039;s picture" title="mlmunro&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 temperature sensor</h3>

    <div class="submitted">Submitted by <a href="../user/2233.html" title="View user profile.">mlmunro</a> on Thu, 22/11/2012 - 14:48.</div>
    <div class="content">
     <p>No, not working</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7558"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1894.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Ian Eagland&#039;s picture" title="Ian Eagland&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 temperature sensor</h3>

    <div class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Thu, 22/11/2012 - 16:46.</div>
    <div class="content">
     <p>Hi</p>
<p>White wire to tip</p>
<p>Red wire to middle ring</p>
<p>Black wire to body ring</p>
<p>Check with a meter that you have continuity on all the wires from where they are soldered to the plug contact. I just had a dodgy plug where the tip was open circuit to the tag you solder to. I think it was a badly riveted.</p>
<p>Regards</p>
<p>Ian</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7562"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 temperature sensor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 22/11/2012 - 23:01.</div>
    <div class="content">
     <p><em>&quot;I think it was a badly riveted.</em>&quot;</p>
<p>Very likely - I&#39;ve had some of those. Soldering the rivet effects a permanent cure.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9395"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 temperature sensor</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Fri, 25/01/2013 - 21:02.</div>
    <div class="content">
     <p>Hi guys.</p>
<p>Same kind of trouble here. Brand new kit, trying temperature first. No luck.</p>
<p>All libs are freshly pulled.</p>
<p>I believe my wiring is correct. It looks like this :</p>
<p><a href="https://learn.openenergymonitor.org/?redirect=DS18B20-temperature-sensing"><img alt="" src="../sites/default/files/Temperature%203-wire%20jack.png" /></a></p>
<p>I checked continuity from soldering point to plug contact.</p>
<p><strong>EmonTX temperature power sketch</strong></p>
<p>-12700 -12700 -12700 -12700</p>
<p><strong>Voltages</strong></p>
<p>Gnd (sleeve) : 0 V</p>
<p>Vdd (ring) : 5.26V</p>
<p>Data (tip) : 3.94V</p>
<p><strong>temperature control library &#39;simple&#39; example / one wire bus set to digital 6</strong></p>
<p>Requesting temperatures...DONE<br />
	Temperature for the device 1 (index 0) is: 0.00</p>
<p><strong>temperature control library &#39;single&#39; example / one wire bus set to digital 6</strong></p>
<p>Requesting temperatures...DONE<br />
	Temp C: 0.00 Temp F: 32.00&nbsp;</p>
<p><strong>OneWire -&nbsp;DS18x20_Temperature example sketch / OneWire&nbsp; ds(4);&nbsp; // on pin 4</strong></p>
<p>No more addresses.&nbsp;</p>
<p><strong>EmonTX temperature search sketch</strong></p>
<p>I added the following code to setup() :</p>
<p>&nbsp; delay(3000);<br />
	&nbsp;<br />
	&nbsp; Serial.print(&quot;Nb : &quot;);<br />
	&nbsp; Serial.println(numberOfDevices);</p>
<p>and I get</p>
<p>Nb : 0&nbsp;</p>
<p>&nbsp;</p>
<p>Anything else I should be checking ?</p>
<p>Thanks in advance.</p>
<p>---------------------------------------------------------</p>
<p>Edit :</p>
<blockquote><p><a href="1902.html">Robert Wall</a> : Is the plug fully home and Is the socket making 3 good connections?</p>
</blockquote>
<p>OK, thank you Robert. I didn&#39;t push hard enough (the whole thing looks so fragile...)</p>
<p>Now, I do get something :</p>
<p><strong>EmonTX temperature search sketch</strong></p>
<p>Nb : 1<br />
	{ 0x28, 0x80, 0x1D, 0x4E, 0x04, 0x00, 0x00, 0x0F }&nbsp;</p>
<p><strong>EmonTX temperature power sketch</strong></p>
<p>2118 -12700 -12700 -12700</p>
<p>Since the code reads</p>
<p>emontx.T1 = sensors.getTempC(address_T1) * 100;</p>
<p>room temperature should be about 21,2 &deg;C.</p>
<p>A cheap commercial device on a wall nearby reads 20,6&deg;C</p>
<p>Great, now I can move on.</p>
<p>I leave the whole message here as an illustration of how you can find yourself searching for complicated answers to address trivial issues. And as a collection of tests to perform in such occasions, as well as a pointer to Robert&#39;s useful hint.</p>
<p>And while I was writing, output went down to</p>
<p>2062 -12700 -12700 -12700</p>
<p>meaning 20,6 &deg;C.</p>
<p>Fine.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/959"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-7OhuOFfQkqKHy5JXeC3R4daSbyOgFxsAY_LiWPMXjlc" value="form-7OhuOFfQkqKHy5JXeC3R4daSbyOgFxsAY_LiWPMXjlc"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
