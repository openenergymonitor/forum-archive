<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/2081 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:53:37 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Water usage dashboard example? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Water usage dashboard example?</h3>
        <span class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Sat, 02/03/2013 - 00:45</span>
        <div class="content"><p>I&#39;m fooling around with a pulse counter on the 5L events I get from my water meter. &nbsp;So far I&#39;ve come up with a fairly basic dashboard to display the data:</p>
<p><a href="http://emoncms.org/dBCC/ermwater" title="http://emoncms.org/dBCC/ermwater">http://emoncms.org/dBCC/ermwater</a></p>
<p>My front-end h/w does the accumulation and memory function. &nbsp;The feed to emoncms is basically &quot;5L ticks since birth&quot; (so always gets bigger).</p>
<p>Currently I have emoncms do a &nbsp;&#39; x 5&#39; and display the feed. &nbsp;That blue number perfectly matches the dials you&#39;ll find on the real water meter. &nbsp;I also use the rate_of_change operator to display the current flow rate. &nbsp;It&#39;d be nice to add a daily usage bar graph. &nbsp;I suspect everything I need is there in one of those operators + visualisations, but I&#39;m having trouble getting my head around how they all work.</p>
<p>Does anyone have an example water meter dashboard they&#39;re willing to share please?</p>
  <div class="forum-topic-navigation clear-block">
          <a href="2764.html" class="topic-previous" title="Go to previous forum topic">‹ Sending time to Emoncms</a>
              <a href="2762.html" class="topic-next" title="Go to next forum topic">[SOLVED] Dashboard saved incorrectly : backslashes are present in content field of dashboard tables ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-12563"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Water usage dashboard example?</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Mon, 03/06/2013 - 15:31.</div>
    <div class="content">
     <p>I would also be very interested....</p>
<p>&nbsp;</p>
<p>my meter pulses for every 1 LTr and the number on the emontx just rises...</p>
<p>&nbsp;</p>
<p>would be nice with a dashboard that displays flow rate and a graph that goes up and down with the usage.. ie 0 when none is used and bumps up to lets say 10 when i do a toilet flush....</p>
<p>could i just have the emontx send the values needed or is there a smarter way?</p>
<p>/bo</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12569"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Water usage dashboard example?</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Mon, 03/06/2013 - 15:54.</div>
    <div class="content">
     <p>its much like on this one: <a href="../applications/water.html" title="http://openenergymonitor.org/emon/applications/water">http://openenergymonitor.org/emon/applications/water</a></p>
<p>only that this guide did not say how its done behind the scenes</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12577"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Water usage dashboard example?</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Mon, 03/06/2013 - 21:59.</div>
    <div class="content">
     <p>also just discovered that i now get a negative value for water.... is there a roolover limit or something like that?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12580"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Water usage dashboard example?</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Mon, 03/06/2013 - 22:32.</div>
    <div class="content">
     <p>i have attached my sketch for messureing the water usage.... will give it a nights sleep and see if i can figure it</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12761"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Water usage dashboard example?</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Sat, 08/06/2013 - 23:12.</div>
    <div class="content">
     <p>finaly i got my sketch right...</p>
<p>&nbsp;</p>
<p>but in emoncms is it possible to show both the liter number sent from the node and flowrate with logging on both numbers?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13114"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1178.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1178.jpg" alt="alco&#039;s picture" title="alco&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Water usage dashboard example?</h3>

    <div class="submitted">Submitted by <a href="../user/1178.html" title="View user profile.">alco</a> on Thu, 20/06/2013 - 20:46.</div>
    <div class="content">
     <p>Hi,</p>
<p>I made my pulse reader just a few days ago with an optical sensor on the flowmeter spinningwheel. It counts every liter of water. But there is an catch with reading these optical pulses, the sensor could be &quot;latching&quot; when the spinningwheel holds exactly at the sensor..So I build a few lines into my sketch for checking on that. It could be usefull for you to?</p>
<p>This is the intresting part of my sketch:</p>
<table border="1" cellpadding="1" cellspacing="1" style="width: 500px;">
<tbody>
<tr>
<td>
				if (((millis() - timeLast) &gt; SENSORtimer) || (gasThis &gt;= maxPulse)) {<br />
				&nbsp;&nbsp;&nbsp; emontx.Pulse = waterPulses;<br />
				&nbsp;&nbsp;&nbsp;<br />
				&nbsp;&nbsp; #ifdef SERIAL<br />
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.print(&quot;Send:\t&quot;);&nbsp;&nbsp;&nbsp;&nbsp;<br />
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.print(emontx.Pulse);&nbsp;&nbsp;&nbsp;<br />
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.print(&quot;\t&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
				&nbsp;&nbsp;&nbsp; #endif</p>
<p>				&nbsp;&nbsp;<br />
				&nbsp;&nbsp;&nbsp; timeLast = millis();<br />
				&nbsp;&nbsp;&nbsp; gasThis = 0;<br />
				&nbsp; }</p>
<p>				// read the pulse sensor<br />
				&nbsp; magState = digitalRead(magPin);<br />
				&nbsp; // Check for change. No need for de-bounce as the sensor latches.<br />
				&nbsp; if (magState != magLast &amp;&amp; magLast != -1) {<br />
				&nbsp;&nbsp;&nbsp; if (magState == 1 &amp;&amp; magLast != -1) {&nbsp;<br />
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; waterPulses++;<br />
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gasThis++;<br />
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; flashLed(200);<br />
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.print(&quot;On&nbsp; &quot;);<br />
				&nbsp;&nbsp;&nbsp; } else {<br />
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; flashLed(100);<br />
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.print(&quot;Off &quot;);<br />
				&nbsp;&nbsp;&nbsp; }<br />
				&nbsp;&nbsp;&nbsp; Serial.println (gasThis);<br />
				&nbsp; }<br />
				&nbsp; magLast = magState;</td>
</tr>
</tbody>
</table>
<div>
	&nbsp;</div>
<div>
	So I count every pulse within the sensortime window. after that I reset the counter (waterPulses++) to zero.</div>
<div>
	My feed reports every 15 seconds the amount of pulses (one pulse = 1 liter.</div>
<div>
	&nbsp;</div>
<div>
	I can make a graph with the default emoncms zoom,simplezoom or bargraph but that&#39;s no fun..the Yaxis scale is to big and it don&#39;t adapt to the (small) scale of water liters (about 300Liter a day). How did you alter those bargraph?</div>
<div>
	&nbsp;</div>
<div>
	P.S. I made 2 dashboards public. you can take a look at: <a href="http://energy.bluemotica.nl/alco/water">http://energy.bluemotica.nl/alco/water</a></div>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-14801"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Water usage dashboard example?</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Tue, 03/09/2013 - 12:09.</div>
    <div class="content">
     <p>hi</p>
<p>&nbsp;</p>
<p>i did all the maths on the emon tx..... sadly i figured a few days ago its not correct</p>
<p>&nbsp;</p>
<p>looking at your code now.... i would like to have math done on emoncms instead</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-14802"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Water usage dashboard example?</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Tue, 03/09/2013 - 12:16.</div>
    <div class="content">
     <p>your dashboards look fantastic....</p>
<p>&nbsp;</p>
<p>only that the water once says power... but not your fault</p>
<p>&nbsp;</p>
<p>will be back later</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-14815"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Water usage dashboard example?</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Tue, 03/09/2013 - 16:07.</div>
    <div class="content">
     <p>any chance you are willing to share the whole sketch?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/2081"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-zy_Yo-iXn_pf_gSY6Dh80uXXVoqz6-Aw23CX1Er6Df8" value="form-zy_Yo-iXn_pf_gSY6Dh80uXXVoqz6-Aw23CX1Er6Df8"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/2081 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:53:37 GMT -->
</html>
