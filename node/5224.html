<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>EmonTX2 + AD5206 Newbie Help Robert.... | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/emon/sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="/emon/modules/node/node.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/defaults.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/system.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/system-menus.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/user/user.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/modules/mollom/mollom.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/forum/forum.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/modules/views/css/views.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/comment/comment.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/themes/emon3/style.css?r" />
<style type="text/css" media="all">@import "/emon/sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="/emon/" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="/emon/">Home</a> » <a href="/emon/forum">Forums</a> » <a href="/emon/forum/4">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">EmonTX2 + AD5206 Newbie Help Robert....</h3>
        <span class="submitted">Submitted by <a href="/emon/user/4073" title="View user profile.">dod</a> on Mon, 26/05/2014 - 17:48</span>
        <div class="content"><p>I have been trying to fudge glcd code into an&nbsp;emontx2 but cant seem to get the rf side to produce the correct values.</p>
<p>I have attached the sketch.</p>
<p>essentially I am trying to get the emontx2 board to listen for data via the rfm12b which is received from the emontx3</p>
<p>when the value of power2+4 is greater than 2000w the arduino&nbsp;talks to the ad5206 and sets a digital pot value.</p>
<p>The data doesnt make sense in the serial</p>
<p>Any Ideas?</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="/emon/node/5251" class="topic-previous" title="Go to previous forum topic">‹ High-Amp Commercial 3-Phase Monitoring with emonTx V3</a>
              <a href="/emon/node/5246" class="topic-next" title="Go to next forum topic">32 current sensors? mux chip? ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-21587"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX2 + AD5206 Newbie Help Robert....</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Mon, 26/05/2014 - 18:45.</div>
    <div class="content">
     <p>I think I&#39;m missing part of the story here. What are your node numbers, what are the data structures that are carrying the data? What is the RPi doing to the data on the way past - is it indeed going through the RPi?</p>
<p><em>&quot;essentially I am trying to get the emontx2 board to listen for data via the rfm12b which is received from the emontx3</em>&quot;</p>
<p>Unless the emontx3 is out of range of the emontx2, I wouldn&#39;t bother going through the RPi. Just use the packet that&#39;s transmitted by the emontx3.&nbsp; That is what the GLCD actually does.</p>
<p>Have you read the Building Blocks article about the RFM12B - part 2 in particular?&nbsp; If your emonTx3 is using the default sketch, you&#39;re actually using&nbsp;power1, power2 &amp; power3 from the emonTx3.</p>
<p>I think there&#39;s evidence of some muddle going on here, you&#39;re printing emontx.power2+emontx.power3 twice then comparing emontx.power2+emontx.power4 to a constant, so you&#39;re not even looking at what you&#39;re comparing. To start with, print ALL the values that come across just so that you can verify that you are getting the basic data correctly.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21595"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/4073" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-4073.png" alt="dod&#039;s picture" title="dod&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX2 + AD5206 Newbie Help Robert....</h3>

    <div class="submitted">Submitted by <a href="/emon/user/4073" title="View user profile.">dod</a> on Mon, 26/05/2014 - 20:34.</div>
    <div class="content">
     <p>Hi Robert thanks for the reply.</p>
<p>yes, I&#39;m going directly or trying to.</p>
<p>so essentially using the emontx2 hardware as a glcd stripping out the LCD &amp; Rtc code.</p>
<p>the emontx3 is node 9 group 212 868Mhz</p>
<p>the raspberry pi is node 15, I don&#39;t care about the pi, I simple want the tx2&nbsp;to listen to tx3</p>
<p>on a iPad now, but will re-read</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21709"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/4073" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-4073.png" alt="dod&#039;s picture" title="dod&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX2 + AD5206 Newbie Help Robert....</h3>

    <div class="submitted">Submitted by <a href="/emon/user/4073" title="View user profile.">dod</a> on Fri, 30/05/2014 - 13:47.</div>
    <div class="content">
     <p>I read part 2 properly and have tried to use the receiver only code but I only get data if I comment out</p>
<p>if (rf12_crc == 0 &amp;&amp; (rf12_hdr &amp; RF12_HDR_CTL) == 0)</p>
<p>&nbsp;</p>
<p>Does this mean I have poor comms ?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21721"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX2 + AD5206 Newbie Help Robert....</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Fri, 30/05/2014 - 21:14.</div>
    <div class="content">
     <p>It might mean that. It could also be that the serial print in the lines before is screwing up the RFM12B. Put a few milliseconds delay in after those prints before you check the radio. An outside possibility is that the packet you are sending is illegal - not having the correct checksum for example.<br />
	&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21736"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/4073" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-4073.png" alt="dod&#039;s picture" title="dod&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX2 + AD5206 Newbie Help Robert....</h3>

    <div class="submitted">Submitted by <a href="/emon/user/4073" title="View user profile.">dod</a> on Sun, 01/06/2014 - 11:43.</div>
    <div class="content">
     <p>Hmm, its an unmodified emontx3 doing the trasmitting and the emonglcd picks it all up and the Rpi sends it to emoncms.</p>
<p>its just the emontx2 as a receiver im having issues with, that said in my other post&nbsp;oem_gateway image and basefail I do get basefail messages despite the clock being set correctly on the glcd etc.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21737"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/4073" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-4073.png" alt="dod&#039;s picture" title="dod&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX2 + AD5206 Newbie Help Robert....</h3>

    <div class="submitted">Submitted by <a href="/emon/user/4073" title="View user profile.">dod</a> on Sun, 01/06/2014 - 11:43.</div>
    <div class="content">
     <p>I will try&nbsp;and add some delay and see what happens</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21738"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/4073" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-4073.png" alt="dod&#039;s picture" title="dod&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX2 + AD5206 Newbie Help Robert....</h3>

    <div class="submitted">Submitted by <a href="/emon/user/4073" title="View user profile.">dod</a> on Sun, 01/06/2014 - 12:00.</div>
    <div class="content">
     <p>Here is the latest version of code loaded into the unit and a screen shot with the following hashed out</p>
<p>if (rf12_crc == 0 &amp;&amp; (rf12_hdr &amp; RF12_HDR_CTL) == 0)</p>
<p>If I leave that in then no data arrives at all.</p>
<p>the power1 looks correct and Vrms but the rest is wrong.</p>
<p>The Raspberry Pi is picking up ok as seen in the emoncms shot.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21739"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/4073" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-4073.png" alt="dod&#039;s picture" title="dod&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX2 + AD5206 Newbie Help Robert....</h3>

    <div class="submitted">Submitted by <a href="/emon/user/4073" title="View user profile.">dod</a> on Sun, 01/06/2014 - 12:10.</div>
    <div class="content">
     <p>I think it is RF based, a dect phone, switching that off and it seems ok now !</p>
<p>Thank you for your help, now to the AD5206&nbsp;!</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="/emon/node/5224"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-drel38z659iq0JadA1I10nJpGcYPLzU6c8XoeFvGiBE" value="form-drel38z659iq0JadA1I10nJpGcYPLzU6c8XoeFvGiBE"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org">https://community.openenergymonitor.org</a></p>
   
</div>

<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
