<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/10984 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:58:55 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Installed 8.5, how do I backup/restore inputs and feeds from emoncms.org? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Installed 8.5, how do I backup/restore inputs and feeds from emoncms.org?</h3>
        <span class="submitted">Submitted by <a href="../user/6791.html" title="View user profile.">a234525</a> on Mon, 13/07/2015 - 21:05</span>
        <div class="content"><p>I&#39;ve been uploading data to emoncms.org for nearly a year. I didn&#39;t configure the local emoncms at the time.</p>
<p>I&#39;ve now installed 8.5 using the SD card image on a Pi, and would like to log locally as well as upload to emoncms.org. I want to import all the inputs/feeds/dashboards from emoncms.org to the Pi.</p>
<p>I have installed the useful scripts folder and am using the backup.php script. It <strong>does </strong>appear to have downloaded the feed data to /home/pi/data/php* directories.</p>
<p>In the web browser it hasn&#39;t restored the inputs or other data for me. Is it supposed to?</p>
<p>When I run backup.php I get the following notices.</p>
<p><strong>Notice: Undefined index: phpfiwa in /var/www/emoncms/Modules/usefulscripts/backup/backup.php on line 107</strong></p>
<p>Should this script restore all the feeds/inputs and dashboards?</p>
<p>&nbsp;</p>
<p>thanks!</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11010.html" class="topic-previous" title="Go to previous forum topic">‹ Power metering a single solar panel</a>
              <a href="10975.html" class="topic-next" title="Go to next forum topic">emonTx 3.4.1 red led staying on, not mismatched sketch and radio module ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-32184"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Installed 8.5, how do I backup/restore inputs and feeds from emoncms.org?</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Mon, 13/07/2015 - 21:54.</div>
    <div class="content">
     <p>In short, no.</p>
<p>The script only downloads the feed data, and you would have to manually re-establish the relationship between inputs &amp; feeds, as well as laying out your dashboards again.</p>
<p>If your local emoncms&nbsp;is not recognizing the downloaded data folders, you may wish to <a href="6085.html">check the permissions</a> assigned to them.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32187"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Installed 8.5, how do I backup/restore inputs and feeds from emoncms.org?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 13/07/2015 - 23:04.</div>
    <div class="content">
     <p>I understood it also backed up the inputs if backup.php is configured to &quot;link_to_local_emoncms&quot;</p>
<p><em>&quot;<a href="https://github.com/emoncms/usefulscripts/blob/master/readme.md">Set $link_to_local_emoncms to true if you wish to access your data within a local installation of emoncms. Set $local_emoncms_location and $local_emoncms_userid to link to your local emoncms installation.&quot;</a></em></p>
<p>the <a href="https://github.com/emoncms/usefulscripts/blob/master/backup/lib/inputs.php">inputs.php</a> looks like it is written to insert the backed-up inputs into the local table and since the processlist is included, the links between inputs and feeds should be carried over.</p>
<p>The error message you are getting is probably&nbsp;due to using the &quot;low-write&quot; version included on an SDcard which will not have a phpfiwa directory, you can get around the &quot;backing-up&quot; error by adding the directory to recieve the backups but you will not be able to use them with the low-write version.</p>
<p>You can convert phpfiwa to phpfina&nbsp;quite easily using the&nbsp;<a href="https://github.com/emoncms/usefulscripts/blob/master/convertdata/phpfiwa_to_phpfina.php">phpfiwa_to_phpfina.php</a>&nbsp;script, the script&nbsp;will also move them to&nbsp;the phpfina directory (but you may need to edit the feed &quot;type&quot; in the&nbsp;feeds table with phpmyadmin).</p>
<p>I haven&#39;t used the &quot;linked&quot; backup script myself but it appears to have all the bits to work except for dashboards and multigraphs, I would recommend creating a new user in the local&nbsp;emoncms with no inputs or feeds and use that account userid&nbsp;and local apikey&nbsp;to avoid any input issues caused by inputs with the same nodeid etc.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32200"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6791.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="a234525&#039;s picture" title="a234525&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Installed 8.5, how do I backup/restore inputs and feeds from emoncms.org?</h3>

    <div class="submitted">Submitted by <a href="../user/6791.html" title="View user profile.">a234525</a> on Tue, 14/07/2015 - 08:54.</div>
    <div class="content">
     <p>I started with a new user id on the local instance. I think it only lets me create one user.</p>
<p>Here are the settings in backup.php. There isn&#39;t anywhere for the local apikey that I can see. I have put in the write key for emoncms.org</p>
<p>Not sure what to try next?</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; $remote_server = &quot;http://emoncms.org&quot;;<br />
&nbsp;&nbsp;&nbsp; // NEEDS TO BE YOUR WRITE APIKEY (ELEVATED PERMISSIONS FOR FULL DATA EXPORT)<br />
&nbsp;&nbsp;&nbsp; $remote_apikey = &quot;[mykeyhere]&quot;;</p>
<p>&nbsp;&nbsp;&nbsp; $link_to_local_emoncms = true;<br />
&nbsp;&nbsp;&nbsp; $local_emoncms_location = &quot;/var/www/emoncms/&quot;;<br />
&nbsp;&nbsp;&nbsp; $local_emoncms_userid = 1;<br />
&nbsp;&nbsp;&nbsp; $backup_inputs = true;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32205"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4782.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4782.png" alt="AllenConquest&#039;s picture" title="AllenConquest&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Installed 8.5, how do I backup/restore inputs and feeds from emoncms.org?</h3>

    <div class="submitted">Submitted by <a href="../user/4782.html" title="View user profile.">AllenConquest</a> on Tue, 14/07/2015 - 09:32.</div>
    <div class="content">
     <p>To retrieve the inputs from emoncms.org you need to set the&nbsp;$backup_inputs to true.</p>
<p>I am getting another issue though. I have backed up all the data from emoncms.org and can see the feeds and inputs in my local emoncms. On the feeds screen I can click on the little eye icon to visualize the feed data. These all seems to be working except any feed that is a DAILY datatype (kWhd&nbsp;feeds). Any ideas why these are not working in 8.5 ?</p>
<p>Allen</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32207"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Installed 8.5, how do I backup/restore inputs and feeds from emoncms.org?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 14/07/2015 - 10:12.</div>
    <div class="content">
     <p>v8.5 no longer supports SQL based feeds, Trystan wants to take emoncms in the direction of using queries to provide daily totals, see&nbsp;<a href="https://github.com/emoncms/emoncms#branches">https://github.com/emoncms/emoncms#branches</a>&nbsp;for info on variants.</p>
<p>I believe the v8.5.2 extended branch supports all feed types, but you need to add the <a href="https://github.com/emoncms/emoncms/blob/Extended/default.settings.php#L22-L28">&quot;engines_hidden&quot;</a> section to the settings.php for v8.5.2 to function and comment out the engines you do NOT want to hide (so the array is empty to get all the feeds (upside down, I know)</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32214"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4782.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4782.png" alt="AllenConquest&#039;s picture" title="AllenConquest&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Installed 8.5, how do I backup/restore inputs and feeds from emoncms.org?</h3>

    <div class="submitted">Submitted by <a href="../user/4782.html" title="View user profile.">AllenConquest</a> on Tue, 14/07/2015 - 12:17.</div>
    <div class="content">
     <p>Hi Paul,</p>
<p>Is there an upgrade path for moving from a DAILY SQL based feed? I found the&nbsp;sql_to_phptimeseries_mv.php script and successfully used that to convert the feeds to phptimeseries. But I still can&#39;t get the visualizations to work. Am I missing something? I don&#39;t really want to loose all that historical data, or are you saying it can now be recreated using the normal readings (and if so how?).</p>
<p>Allen</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32215"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4782.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4782.png" alt="AllenConquest&#039;s picture" title="AllenConquest&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Installed 8.5, how do I backup/restore inputs and feeds from emoncms.org?</h3>

    <div class="submitted">Submitted by <a href="../user/4782.html" title="View user profile.">AllenConquest</a> on Tue, 14/07/2015 - 12:24.</div>
    <div class="content">
     <p>Hi Paul,</p>
<p>Some visualizations are working, such as the Stacked Solar with my kWhd&nbsp;feeds, but others such as bargraph are not.&nbsp;</p>
<p>Allen</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32216"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Installed 8.5, how do I backup/restore inputs and feeds from emoncms.org?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 14/07/2015 - 12:37.</div>
    <div class="content">
     <p><em>&quot;Master (v8.4)&nbsp;- in the process of being replaced by the v8.5 branch. v8.5 will break older installations of emoncms that are using the older feed engines: timestore, phptimestore and mysqltimeseries, the upgrade procedure has not yet been written, if you have an existing system thats working then stay on this branch. If your setting up a new emoncms installation use the v8.5 branch.&quot;</em></p>
<p>This is from the &quot;branches&quot; link and it advises against upgrading to&nbsp;the v8.5 for existing users (local emoncms) I think using the data (backed up) from emoncms.org&nbsp;maybe puts you&nbsp;in the &quot;existing&quot; rather than &quot;new&quot; installation group.</p>
<p>v8.5 relies on producing the daily totals from a query at runtime, so no the feeds are not recreated as such, in that they are never written to disc, but they are recreated in part on the fly each time you view the graph.</p>
<p>It is discussed a fair bit in the forum but off hand I cannot point you to a specific place, sorry.</p>
<p>I know this will sound bizzare, but the &quot;extended&quot; branch is actually more stable and still uses the sql feeds, so in this instance the &quot;extended&quot; branch could be a stepping stone towards adopting the mainstream version and dropping the sql if you choose to, the support seems to be better for the low-write and extended versions too,&nbsp;the v8.5 seems to be getting left out a&nbsp;little.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32217"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4782.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4782.png" alt="AllenConquest&#039;s picture" title="AllenConquest&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Installed 8.5, how do I backup/restore inputs and feeds from emoncms.org?</h3>

    <div class="submitted">Submitted by <a href="../user/4782.html" title="View user profile.">AllenConquest</a> on Tue, 14/07/2015 - 13:54.</div>
    <div class="content">
     <p>Hi Paul,</p>
<p>I have moved over to the Extended branch and downloaded the data again. Now the visualizations are working.</p>
<p>Thanks for your patience!</p>
<p>Allen</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32390"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6791.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="a234525&#039;s picture" title="a234525&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Installed 8.5, how do I backup/restore inputs and feeds from emoncms.org?</h3>

    <div class="submitted">Submitted by <a href="../user/6791.html" title="View user profile.">a234525</a> on Sun, 19/07/2015 - 21:30.</div>
    <div class="content">
     <p>I still haven&#39;t been able to restore any inputs to my local instance. Anyone any ideas?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/10984"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-HwugaefpGvYgpxHUJnSnMtzX4iHof2nmUviv8RQNT0g" value="form-HwugaefpGvYgpxHUJnSnMtzX4iHof2nmUviv8RQNT0g"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/10984 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:58:55 GMT -->
</html>
