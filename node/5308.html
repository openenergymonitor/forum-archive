<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/5308 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:56:59 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>eMonCMS with nGinX | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">eMonCMS with nGinX</h3>
        <span class="submitted">Submitted by <a href="../user/5678.html" title="View user profile.">mircsicz</a> on Mon, 16/06/2014 - 14:27</span>
        <div class="content"><p>Hi there,</p>
<p>I&#39;ve setup eMonCMS&nbsp;on a Nginx hosting server. I can see the Login but when trying to register to that new server I can&#39;t...</p>
<p>Error log is empty, access.log has only this:</p>
<p>xx.143.141.yy - - [16/Jun/2014:16:22:37 +0200] &quot;-&quot; 400 0 &quot;-&quot; &quot;-&quot;<br />
	xx.143.141.yy - - [16/Jun/2014:16:22:37 +0200] &quot;POST /user/register.json HTTP/1.1&quot; 200 2631 &quot;https://my.domain.net/&quot; &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.153 Safari/537.36&quot;</p>
<p>Here&#39;s a Screenshot:</p>
<p><a href="../../../www.dropbox.com/s/cudmhu42u7db9gi/Screenshot%202014-06-16%2016.23.15.html" title="https://www.dropbox.com/s/cudmhu42u7db9gi/Screenshot%202014-06-16%2016.23.15.png">https://www.dropbox.com/s/cudmhu42u7db9gi/Screenshot%202014-06-16%2016.2...</a></p>
<p>&nbsp;</p>
<p>Hope you can help...</p>
<p>&nbsp;</p>
<p>Edit: As I could not make it work on the hosting server I installed another instance on a FreeBSD&nbsp;Jail, after some fiddling I got it to start but end up in exactly the same mess. There&#39;s the exact same red bar in the register window...</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11033.html" class="topic-previous" title="Go to previous forum topic">‹ Logging import/export separately (from one input)</a>
              <a href="11028.html" class="topic-next" title="Go to next forum topic">emoncms.org raw data graphs frozen? ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-21998"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: eMonCMS with nGinX</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 17/06/2014 - 15:19.</div>
    <div class="content">
     <p>I&#39;m no expert on emonCMS, but I would suspect it is a permissions/paths problem with your database engines.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22000"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5678.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-5678.png" alt="mircsicz&#039;s picture" title="mircsicz&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: eMonCMS with nGinX</h3>

    <div class="submitted">Submitted by <a href="../user/5678.html" title="View user profile.">mircsicz</a> on Tue, 17/06/2014 - 15:28.</div>
    <div class="content">
     <p>Hi Robert,</p>
<p>I&#39;ve checked the perm&#39;s so many time&#39;s I can&#39;t imagine it being that simple...</p>
<p>But to double check again, those are the path&#39;s I&#39;m aware of:</p>
<p>&nbsp;</p>
<ul>
<li>
		EmonCMS install-dir</li>
<li>
		/var/lib/php*</li>
</ul>
<p>Did I mis one?</p>
<p>&nbsp;</p>
<p>Greetz</p>
<p>Mircsicz</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-22009"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5678.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-5678.png" alt="mircsicz&#039;s picture" title="mircsicz&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: eMonCMS with nGinX</h3>

    <div class="submitted">Submitted by <a href="../user/5678.html" title="View user profile.">mircsicz</a> on Tue, 17/06/2014 - 22:25.</div>
    <div class="content">
     <p>found a way to make it work:</p>
<p>modified the hints from:</p>
<p><a href="http://www.mylesgray.com/ardunio-hacking/how-to-run-emoncms-on-nginx-and-php5-fpm/" title="http://www.mylesgray.com/ardunio-hacking/how-to-run-emoncms-on-nginx-and-php5-fpm/">http://www.mylesgray.com/ardunio-hacking/how-to-run-emoncms-on-nginx-and...</a></p>
<p>and</p>
<p><a href="http://www.ismsolar.com/blog/creando-un-sistema-de-monitorizacion-de-alto-rendimiento" title="http://www.ismsolar.com/blog/creando-un-sistema-de-monitorizacion-de-alto-rendimiento">http://www.ismsolar.com/blog/creando-un-sistema-de-monitorizacion-de-alt...</a></p>
<p>&nbsp;</p>
<p>What work&#39;s for me on a hosting server with froxlor-admin-panel is this:</p>
<p>server {<br />
	&nbsp;&nbsp;&nbsp; listen xx.xx.xx.xx:80;<br />
	&nbsp;&nbsp;&nbsp; server_name edm.my-domain.de;<br />
	&nbsp;&nbsp;&nbsp; access_log /var/customers/logs/ONE-edm.my-domain.de-access.log combined;<br />
	&nbsp;&nbsp;&nbsp; error_log /var/customers/logs/ONE-edm.my-domain.de-error.log error;<br />
	&nbsp;&nbsp;&nbsp; root /var/customers/webs/ONE/edm.my-domain.de/;<br />
	&nbsp;&nbsp;&nbsp; index index.php index.html index.htm;</p>
<p>&nbsp;&nbsp;&nbsp; location / {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rewrite ^/(.*)$ /index.php?q=$1 last;<br />
	&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp; location ~* ^.+.(jpg|jpeg|gif|css|png|js|ico|xml)$ {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; expires 30d;<br />
	&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp; location ~ \.php$ {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try_files $uri =404;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fastcgi_split_path_info ^(.+\.php)(/.+)$;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fastcgi_pass unix:/var/run/nginx/ONE-edm.my-domain.de-php-fpm.socket;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fastcgi_index index.php;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; include /etc/nginx/fastcgi_params;<br />
	&nbsp;&nbsp;&nbsp; }<br />
	}</p>
<p>&nbsp;</p>
<p>Hope this helps someelse safe some time!</p>
<p>&nbsp;</p>
<p>Greetz</p>
<p>Mircsicz</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29717"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7974.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="simsasaile&#039;s picture" title="simsasaile&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: eMonCMS with nGinX</h3>

    <div class="submitted">Submitted by <a href="../user/7974.html" title="View user profile.">simsasaile</a> on Fri, 17/04/2015 - 23:38.</div>
    <div class="content">
     <p>Hi,</p>
<p>I&#39;d love to run emonCMS with nginx, and I&#39;m able to run the site and to log in, but some function are still not working.</p>
<p>For example the dial at the dashboard doesn&#39;t work and I can&#39;t send data to emonCMS via Ethernet and API.</p>
<p>This is my nginx-config:</p>
<p>&nbsp;</p>
<pre>
server {
        listen 80;
        listen [::]:80;
        server_name emon.myserver.de;
        ssl_certificate /etc/nginx/ssl/cert.crt;
        ssl_certificate_key /etc/nginx/ssl/key.key;

        root /home/myserver/emoncms/;
         index index.php index.html index.htm;
        # rewrite ^/(.*)$ /index.php?q=$1 last;

        location / {
        rewrite ^/(.*)$ /index.php?q=$1 last;
         root /home/myserver/emoncms/;
        }
         location ~* ^.+.(jpg|jpeg|gif|css|png|js|ico|xml)$ {
         expires 30d;
         root /home/myserver/emoncms/;
        }
        # To allow POST on static pages
        #error_page  405     =200 $uri;
        #add_header &#39;Access-Control-Allow-Methods&#39; &#39;GET, POST, OPTIONS, PUT, DELETE&#39;;

        location ~ \.php {
                fastcgi_split_path_info ^(.+\.php)(/.+)$;
                fastcgi_param  PATH_INFO          $fastcgi_path_info;

              #  fastcgi_pass 127.0.0.1:9000;
                fastcgi_pass unix:/var/run/php5-fpm.sock;
                fastcgi_index index.php;
                fastcgi_param  SCRIPT_FILENAME  /home/myserver/emoncms$fastcgi_script_name;
                include /etc/nginx/fastcgi_params;
                fastcgi_intercept_errors        on;
        }
                # Optional: Don&#39;t log access to assets
                access_log off;
}</pre><p>&nbsp;</p>
<p>I hope someone has a clue how to get it working!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29799"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: eMonCMS with nGinX</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Mon, 20/04/2015 - 16:17.</div>
    <div class="content">
     <p>Hello simsasaile, I recently tried running emoncms.org on nignx but didnt see a visible performance increase or drop in server load, this was my test sites available configuration:</p>
<p>server {<br />
&nbsp;&nbsp; &nbsp;listen 80 default_server;<br />
&nbsp;&nbsp; &nbsp;# listen [::]:80 default_server ipv6only=on;</p>
<p>&nbsp;&nbsp; &nbsp;root /usr/share/nginx/html/emoncms;<br />
&nbsp;&nbsp; &nbsp;index index.php index.html index.htm;</p>
<p>&nbsp;&nbsp; &nbsp;# Make site accessible from <a href="http://localhost/" title="http://localhost/">http://localhost/</a><br />
&nbsp;&nbsp; &nbsp;server_name localhost;</p>
<p>&nbsp;&nbsp; &nbsp;location / {<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;# First attempt to serve request as file, then<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;# as directory, then fall back to displaying a 404.<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;try_files $uri $uri/ =404;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;# Uncomment to enable naxsi on this location<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;# include /etc/nginx/naxsi.rules<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rewrite ^/(.*)$ /index.php?q=$1 last;<br />
&nbsp;&nbsp; &nbsp;}</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; location ~* ^.+.(jpg|jpeg|gif|css|png|js|ico|xml)$ {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; expires 30d;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; root /usr/share/nginx/html/emoncms;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp; &nbsp;# pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000<br />
&nbsp;&nbsp; &nbsp;location ~ \.php$ {<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;fastcgi_split_path_info ^(.+\.php)(/.+)$;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;# NOTE: You should have &quot;cgi.fix_pathinfo = 0;&quot; in php.ini<br />
&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; # With php5-cgi alone:<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; # fastcgi_pass 127.0.0.1:9000;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;# With php5-fpm:<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;fastcgi_pass unix:/var/run/php5-fpm.sock;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;fastcgi_index index.php;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;include fastcgi_params;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
}</p>
<p>
&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29812"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7974.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="simsasaile&#039;s picture" title="simsasaile&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: eMonCMS with nGinX</h3>

    <div class="submitted">Submitted by <a href="../user/7974.html" title="View user profile.">simsasaile</a> on Tue, 21/04/2015 - 00:51.</div>
    <div class="content">
     <p>Hey Trystan,</p>
<p>thank you for sharing your configuration!<br />
I tried it, but it only works at my ubuntu-server with one extra line added in the &nbsp;location ~ \.php$ { section:</p>
<p>fastcgi_param&nbsp; SCRIPT_FILENAME&nbsp; $document_root$fastcgi_script_name;</p>
<p>Sadly with this configuration I have still the problem that the dial shows zero. But I found out that the problem is actually that the feeds are marked as inactive and there value is zero too.&nbsp;</p>
<p>If I open the same emonCMS installation with apache2 it&#39;s all working. The reason I&#39;d like to use nginx is that I operate already some sites with nginx, and using nginx would allow me to have emonCMS as an subdomain of my site.</p>
<p>I&#39;d be quite happy, if someone has an Idea how to get it working!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29848"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7974.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="simsasaile&#039;s picture" title="simsasaile&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: eMonCMS with nGinX</h3>

    <div class="submitted">Submitted by <a href="../user/7974.html" title="View user profile.">simsasaile</a> on Wed, 22/04/2015 - 08:53.</div>
    <div class="content">
     <p>Hey everyone, I solved my problem :)</p>
<p>The problem was, that I still pushed my data to the port where apache was listening. I changed that in emonhub.conf to the port nginx is running, and now I get all the data :)</p>
<p>Thanks again for your help!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30999"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3052.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="engeeaitch&#039;s picture" title="engeeaitch&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: eMonCMS with nGinX</h3>

    <div class="submitted">Submitted by <a href="../user/3052.html" title="View user profile.">engeeaitch</a> on Sun, 07/06/2015 - 10:08.</div>
    <div class="content">
     <p>Hi - I&#39;m also trying to get nginx working (I&#39;m using the latest version so that I can take advantage of the security updates).</p>
<p>Here is my config file:</p>
<p>server {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; root /var/www/rpi_thermostat/emoncms;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index index.php index.html index.htm;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; location / {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # First attempt to serve request as file, then<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # as directory, then fall back to displaying a 404.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try_files $uri $uri/ /index.html;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rewrite ^/(.*)$ /index.php?q=$1 last;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; location ~ \.php$ {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fastcgi_split_path_info ^(.+\.php)(/.+)$;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # NOTE: You should have &quot;cgi.fix_pathinfo = 0;&quot; in php.ini</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # With php5-fpm:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fastcgi_pass unix:/var/run/php5-fpm.sock;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fastcgi_index index.php;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; include fastcgi_params;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
}</p>
<p>
If comment out the rewrite statement, the login page loads correctly - but I get a login failure when I enter my details.</p>
<p>With the rewrite statement uncommented, the html loads, but the css files and scripts do not load.</p>
<p>I suspect it might be to do with the params file.&nbsp; Here are my settings:</p>
<p>fastcgi_param&nbsp;&nbsp; QUERY_STRING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $query_string;<br />
fastcgi_param&nbsp;&nbsp; REQUEST_METHOD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $request_method;<br />
fastcgi_param&nbsp;&nbsp; CONTENT_TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $content_type;<br />
fastcgi_param&nbsp;&nbsp; CONTENT_LENGTH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $content_length;</p>
<p>#fastcgi_param&nbsp; SCRIPT_FILENAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $request_filename;<br />
#fastcgi_param&nbsp;&nbsp; SCRIPT_FILENAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $document_root$fastcgi_script_name;<br />
fastcgi_param&nbsp;&nbsp; SCRIPT_FILENAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $fastcgi_script_name;<br />
fastcgi_param&nbsp;&nbsp; SCRIPT_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $fastcgi_script_name;<br />
fastcgi_param&nbsp;&nbsp; PATH_INFO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $fastcgi_path_info;<br />
fastcgi_param&nbsp;&nbsp; REQUEST_URI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $request_uri;<br />
fastcgi_param&nbsp;&nbsp; DOCUMENT_URI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $document_uri;<br />
fastcgi_param&nbsp;&nbsp; DOCUMENT_ROOT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $document_root;<br />
fastcgi_param&nbsp;&nbsp; SERVER_PROTOCOL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $server_protocol;</p>
<p>fastcgi_param&nbsp;&nbsp; GATEWAY_INTERFACE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CGI/1.1;<br />
fastcgi_param&nbsp;&nbsp; SERVER_SOFTWARE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nginx/$nginx_version;</p>
<p>fastcgi_param&nbsp;&nbsp; REMOTE_ADDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $remote_addr;<br />
fastcgi_param&nbsp;&nbsp; REMOTE_PORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $remote_port;<br />
fastcgi_param&nbsp;&nbsp; SERVER_ADDR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $server_addr;<br />
fastcgi_param&nbsp;&nbsp; SERVER_PORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $server_port;<br />
fastcgi_param&nbsp;&nbsp; SERVER_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $server_name;</p>
<p>fastcgi_param&nbsp;&nbsp; HTTPS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $https if_not_empty;</p>
<p># PHP only, required if PHP was built with --enable-force-cgi-redirect<br />
fastcgi_param&nbsp;&nbsp; REDIRECT_STATUS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 200;</p>
<p>Any ideas please?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31176"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7974.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="simsasaile&#039;s picture" title="simsasaile&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: eMonCMS with nGinX</h3>

    <div class="submitted">Submitted by <a href="../user/7974.html" title="View user profile.">simsasaile</a> on Wed, 10/06/2015 - 23:11.</div>
    <div class="content">
     <p>Hi,</p>
<p>this is the config&nbsp;I&#39;m currently using:</p>
<p>
server {<br />
&nbsp; &nbsp; &nbsp;listen 80;<br />
# &nbsp; &nbsp; listen 443 ssl;</p>
<p>
&nbsp; &nbsp; #ssl_certificate /etc/nginx/ssl/mycert.crt;<br />
&nbsp; &nbsp; #ssl_certificate_key /etc/nginx/ssl/mykey.key;</p>
<p>&nbsp; &nbsp; # Add perfect forward secrecy<br />
&nbsp; &nbsp; #ssl_ciphers EECDH+AESGCM:EDH+AESGCM:EECDH:EDH:!MD5:!RC4:!LOW:!MEDIUM:!CAMELLIA:!ECDSA:!DES:!DSS:!3DES:!NULL;<br />
&nbsp; &nbsp; #ssl_prefer_server_ciphers on;</p>
<p>&nbsp; &nbsp; #Fixing the poodle<br />
&nbsp; &nbsp; #ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</p>
<p>&nbsp; &nbsp; root /var/www/rpi_thermostat/emoncms;<br />
&nbsp; &nbsp; index index.php index.html index.htm;</p>
<p>&nbsp; &nbsp; # Make site accessible from <a href="http://localhost/" title="http://localhost/">http://localhost/</a><br />
&nbsp; &nbsp; server_name localhost;</p>
<p>&nbsp; &nbsp; location / {<br />
&nbsp; &nbsp; &nbsp; &nbsp; # First attempt to serve request as file, then<br />
&nbsp; &nbsp; &nbsp; &nbsp; # as directory, then fall back to displaying a 404.<br />
&nbsp; &nbsp; &nbsp; &nbsp; try_files $uri $uri/ =404;<br />
&nbsp; &nbsp; &nbsp; &nbsp; # Uncomment to enable naxsi on this location<br />
&nbsp; &nbsp; &nbsp; &nbsp; # include /etc/nginx/naxsi.rules<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rewrite ^/(.*)$ /index.php?q=$1 last;<br />
&nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; location ~* ^.+.(jpg|jpeg|gif|css|png|js|ico|xml)$ {<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; expires 30d;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; root /var/www/rpi_thermostat/emoncms; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000<br />
&nbsp; &nbsp; location ~ \.php$ {<br />
&nbsp; &nbsp; &nbsp; &nbsp; fastcgi_split_path_info ^(.+\.php)(/.+)$;<br />
&nbsp; &nbsp; &nbsp; &nbsp; # NOTE: You should have &quot;cgi.fix_pathinfo = 0;&quot; in php.ini</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; # With php5-cgi alone:<br />
&nbsp; &nbsp; &nbsp; &nbsp; # fastcgi_pass 127.0.0.1:9000;<br />
&nbsp; &nbsp; &nbsp; &nbsp; # With php5-fpm:<br />
&nbsp; &nbsp; &nbsp; &nbsp; fastcgi_pass unix:/var/run/php5-fpm.sock;<br />
&nbsp; &nbsp; &nbsp; &nbsp; fastcgi_index index.php;<br />
&nbsp; &nbsp; &nbsp; &nbsp; include fastcgi_params;<br />
&nbsp; &nbsp; &nbsp; &nbsp; fastcgi_param &nbsp;SCRIPT_FILENAME &nbsp;$document_root$fastcgi_script_name;<br />
&nbsp; &nbsp; &nbsp; &nbsp; }<br />
}</p>
<p>&nbsp;</p>
<p>I tested it also with the newest version, so it should work for you. The only thing which is&nbsp;not working are the apps-Modules, maybe we need an extra rewrite rule for that, I don&#39;t know. I would be glad if someone has a tip how to get them working too!</p>
<p>Cheers, Simsa</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31282"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3052.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="engeeaitch&#039;s picture" title="engeeaitch&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: eMonCMS with nGinX</h3>

    <div class="submitted">Submitted by <a href="../user/3052.html" title="View user profile.">engeeaitch</a> on Sun, 14/06/2015 - 15:56.</div>
    <div class="content">
     <p>I finally got this working using the following config file. Note that I used the try statement, rather than the rewrite statement following advice from the nginx wiki (common configuration pitfalls).&nbsp; Not sure what the &quot;apps-Modules&quot; are but everything seems to be working on my setup.</p>
<p>server {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; listen 80 default_server;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; server_name localhost;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; root /var/www/rpi_thermostat;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index index.php index.html index.htm;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; location / {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # First attempt to serve request as file, then<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # as directory, then fall back to displaying a 404.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try_files $uri $uri/ =404;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; location /emoncms {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try_files $uri $uri/ /emoncms/index.php?q=$uri&amp;$args;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; location ~ \.php$ {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fastcgi_split_path_info ^(.+\.php)(/.+)$;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # NOTE: You should have &quot;cgi.fix_pathinfo = 0;&quot; in php.ini</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # With php5-fpm:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fastcgi_pass unix:/var/run/php5-fpm.sock;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fastcgi_index index.php;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; include fastcgi_params;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
}</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32602"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7974.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="simsasaile&#039;s picture" title="simsasaile&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: eMonCMS with nGinX</h3>

    <div class="submitted">Submitted by <a href="../user/7974.html" title="View user profile.">simsasaile</a> on Sat, 25/07/2015 - 13:47.</div>
    <div class="content">
     <p>Hey&nbsp;engeeaitch,</p>
<p>thanks for sharing your improved nginx configuration!&nbsp;<br />
I tested it now, and with your configuration the apps-moduls (<a href="https://github.com/emoncms/app" title="https://github.com/emoncms/app">https://github.com/emoncms/app</a>) are working too!</p>
<p>I&#39;m very glad about that!<br />
Many greetings,<br />
Simsa</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/5308"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-3yG-D4EshqrWfOpweOnJFlb41A-LH24EQcuic1yK6y4" value="form-3yG-D4EshqrWfOpweOnJFlb41A-LH24EQcuic1yK6y4"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
