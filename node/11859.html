<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11859 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:49:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>New Nodes module / what do I do wrong | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">New Nodes module / what do I do wrong</h3>
        <span class="submitted">Submitted by <a href="../user/1958.html" title="View user profile.">fluppie007</a> on Wed, 23/12/2015 - 21:16</span>
        <div class="content"><p>In emonhub.conf:</p>
<blockquote><p>[[5]]<br />
&nbsp;&nbsp;&nbsp; nodename = emonTx_3.2_1<br />
&nbsp;&nbsp;&nbsp; firmware = V2_3_emonTxV3_4_DiscreteSampling / niet zeker<br />
&nbsp;&nbsp;&nbsp; hardware = emonTx_(NodeID_DIP_Switch1:OFF)<br />
&nbsp;&nbsp;&nbsp; [[[rx]]]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; names = power1,power2,power3,power4,Vrms,temp1,temp2,temp3,temp4,temp5,temp6,pulse<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; datacodes = h,h,h,h,h,h,h,h,h,h,h,L<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; scales = 1,1,1,1,0.01,0.1,0.1,0.1,0.1,0.1,0.1,1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; units = W,W,W,W,V,C,C,C,C,C,C,p</p>
</blockquote>
<p>In emonhub&#39;s log file (node is not getting updated with this config):</p>
<blockquote><p>2015-12-23 21:03:25,102 DEBUG&nbsp;&nbsp;&nbsp; RFM2Pi&nbsp;&nbsp;&nbsp;&nbsp; 512 NEW FRAME : OK 5 0 0 0 0 0 0 0 0 0 0 190 0 190 0 0 0 0 0 0 0 0 0 0 0<br />
2015-12-23 21:03:25,109 WARNING&nbsp; RFM2Pi&nbsp;&nbsp;&nbsp;&nbsp; 512 RX data length: 24 is not valid for datacodes [&#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;L&#39;]</p>
<p>2015-12-23 21:08:44,366 DEBUG&nbsp;&nbsp;&nbsp; RFM2Pi&nbsp;&nbsp;&nbsp;&nbsp; 594 NEW FRAME : OK 5 0 0 0 0 0 0 0 0 0 0 190 0 190 0 0 0 0 0 0 0 0 0 0 0<br />
2015-12-23 21:08:44,374 WARNING&nbsp; RFM2Pi&nbsp;&nbsp;&nbsp;&nbsp; 594 RX data length: 24 is not valid for datacodes [&#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;L&#39;]</p>
</blockquote>
<p>When removing this from emonhub.conf the data gets forwarded to my emonCMS account, see attachment.</p>
<p>Any ideas?</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11854.html" class="topic-previous" title="Go to previous forum topic">‹ emoncms dashboard - [SOLVED]</a>
              <a href="11695.html" class="topic-next" title="Go to next forum topic">Low-write mode - your thoughts please ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-37418"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New Nodes module / what do I do wrong</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 23/12/2015 - 21:45.</div>
    <div class="content">
     <p>The logs highlight a difference between the expected and&nbsp;actual payload being received.</p>
<p>Your node is defined as 12 values, the first 11 are signed 2 byte ints and the 12th&nbsp;a unsigned 4 byte long (=26 bytes).</p>
<p>the received payload is only 24 bytes, so emonhub&nbsp;cannot map the data. the payload needs to be increased by 2 bytes in the sketch, or the definition adjusted in emonhub.conf.&nbsp;</p>
<p>The reason it passes the data when the definition is removed is it is not mandatory to define the nodes and the default datacode is h (signed ints) &nbsp;so it will assume the 24bytes received to be 12 signed ints unless it is told otherwise.</p>
<p>Things to check are that the 12th (pulse) value is defined as a long in the sketch and possibly if the number of temp sensors is calculated is there 6 or only 5?</p>
<p>Paul</p>
<p>PS just seen the title again &quot;nodes module&quot; did&nbsp;you mean &quot;nodes section&quot; in emonhub.conf? your image is of the inputs page and the &quot;nodes module&quot; would not of displayed the data without a &quot;nodes section&quot; entry in emonhub.conf as it insists on full details of every node, just checking in case I got the wrong idea.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37429"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1958.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1958.png" alt="fluppie007&#039;s picture" title="fluppie007&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New Nodes module / what do I do wrong</h3>

    <div class="submitted">Submitted by <a href="../user/1958.html" title="View user profile.">fluppie007</a> on Wed, 23/12/2015 - 22:39.</div>
    <div class="content">
     <p>I wanted the nodes section of emoncms to be filled by default with the right parsing 0.01 or 0.1 etc. So I tried to modify the supplied node configuration in emonhub.conf to suit my needs. After saving the mods, emoncms stopped transferring the data to emoncms.org and was also not putting the data on the MQTT bus.</p>
<p>I attached the previous screenshot to show how my unparsed/unconfigured data gets sent to emoncms.org</p>
<p>Because maybe it&#39;s a stupid typo or misinterpretation of the predefined node configs in emonhub.conf</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37431"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1958.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1958.png" alt="fluppie007&#039;s picture" title="fluppie007&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New Nodes module / what do I do wrong</h3>

    <div class="submitted">Submitted by <a href="../user/1958.html" title="View user profile.">fluppie007</a> on Wed, 23/12/2015 - 22:45.</div>
    <div class="content">
     <p>Changing the L to h does the trick... Didn&#39;t know what it really meant...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37433"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New Nodes module / what do I do wrong</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 23/12/2015 - 22:51.</div>
    <div class="content">
     <p>As long as the datacodes in emonhub.conf match the sketches payload definition precisely you should be ok.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11859"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form--rhnCkWMqS9O8cJI4FyNVcB7I0pApi1n_2OUjldc9JU" value="form--rhnCkWMqS9O8cJI4FyNVcB7I0pApi1n_2OUjldc9JU"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
