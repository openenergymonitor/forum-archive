<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/10506 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 13:48:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/3.html">Archived: General Discussion</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion</h3>
        <span class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Wed, 22/04/2015 - 12:50</span>
        <div class="content"><p>I have a fully built&nbsp;emonTX&nbsp;v2.2 that doesn&#39;t use an RF but simply outputs its CT readings to the serial port that are logged to emoncms.</p>
<p>My real purpose behind starting off with the emontx was to get the pv diversion&nbsp;working.&nbsp;</p>
<p>Having invested in the emontx v2.2 I want to be able to use this for pv diversion but also don&#39;t want to loose the emoncms logging.&nbsp;</p>
<p>My emontx is already fully built for 3 x CTs, 1 x temp and 1 x Pulse.&nbsp;</p>
<p>Firstly do I need to modify the hardware to get the MK2 trigger working out of the Pulse socket?</p>
<p>Secondly what&#39;s the best starting point software to use in my case, today I am logging Grid CT and Solar CT and Temperature.&nbsp;</p>
<p>I guess I&#39;d want to keep those logged, but also log the Diverted power via the 3rd CT.&nbsp;</p>
<p>Is this all possible, or am I trying to do too much.&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="10554.html" class="topic-previous" title="Go to previous forum topic">‹ Tesla</a>
              <a href="10409.html" class="topic-next" title="Go to next forum topic">EmonCMS in a Software as a Service Infrastructure ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-29870"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 22/04/2015 - 15:12.</div>
    <div class="content">
     <p>Have you looked at "Choosing an energy diverter?" You should find most of the answers in there.</p>
<p>It's possible that you will be trying to do too much, the only way will be to start with Robin's Mk2i rev6a and then add the third CT and temperature, and see if the workload check complains each time.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29874"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion</h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Wed, 22/04/2015 - 15:37.</div>
    <div class="content">
     <p>Two questions :</p>
<p>Do I need to remove the 10K resistor R8 sitting on the pulse reading socket, or can that be left there?</p>
<p>The rev6a seems to have everything I need except for Phasecal, do I need that? Or shall I not worry about the absence of Phasecal on the rev6a.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29883"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Wed, 22/04/2015 - 18:37.</div>
    <div class="content">
     <p>The <a href="10171.html">Mk2 code</a> that I posted recently for the emonTx V3.2 should do virtually everything that&#39;s needed.&nbsp; To get this to run on the V2, only the IO port allocations would need to be changed.</p>
<p>That code doesn&#39;t support pulse counting but it should be possible to either:</p>
<p>- use the polling mechanism that was in many of my early Mk2 sketches;</p>
<p>- transfer the interrupt-based mechanism from the sketch you&#39;re using already.</p>
<p>With its revised structure, the main processor is only lightly loaded, probably around 55%.&nbsp; Meanwhile the ADC is running flat out.&nbsp; All of the Mk2&#39;s measurement and control activities takes place within the ISR, so there should be no likelihood of overloading the processor by adding extra tasks within the loop().</p>
<p>When measuring real power, phase-shift has very little effect.&nbsp; I posted a video a while back which showed that a good degree of balance was maintained even with phaseCal set to 5.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29886"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion</h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Wed, 22/04/2015 - 20:25.</div>
    <div class="content">
     <p>I don&#39;t actually need the pulse counting, just trying to reuse a full populated emontx&nbsp;board to work as monitor and pv router.</p>
<p>Hence I am trying to reuse the Pulse 3.5mm socket that is already mounted on the board as my Trigger output. But this has the 10K R8 across it, which I presume I need to remove so that I can use it as a 3.3v trigger.&nbsp;</p>
<p>rev6a seems to use&nbsp;outputForTrigger = 9 so I guess I will need to use&nbsp;outputForTrigger = 5 if I want to use the Pulse port as the Trigger output. Question is, I can use the interrupt&nbsp;output as the Digital output?</p>
<p>P.S. :&nbsp;emonTxV3_as_Mk2Router_serial_direct seems like a good starting point for me, because I don&#39;t need/want the RF and I need to see the data on the serial port directly. Only issue is the fellow who kindly posted this hadn&#39;t tested it. Plus I have to adapt it for V2.2</p>
<p>First things first,&nbsp;I think there is no option but to get my immersion wired properly directly to the MCU, currently some bright electrician had the boiler, pump, valves, softner, timer etc all hanging off the same 2.5mm T&amp;E! That&#39;s OK, when I&#39;m meant to be using either immersion or boiler, but not when I&#39;m diverting PV.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29895"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion</h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Wed, 22/04/2015 - 22:39.</div>
    <div class="content">
     <p>Just had a go at altering the pin declaration from the 3.2&nbsp;code base to suit the 2.2. Would this be correct?</p>
<p>Tried to keep the variable declarations the same otherwise I will land up having to make a lot of code modifications.</p>
<p>Also wanted to keep this consistent with the Solar monitoring example where Solar CT is in 1, Grid CT is in 2. So am using CT3 for diverted power. There is no CT4 on the emon 2.2 (it&#39;s called&nbsp;currentSensor_CT2 in the code!)</p>
<p>&nbsp;</p>
<p>/* --------------------------<br />
&nbsp;* allocation of digital pins for use with a emonTx 2.2)<br />
&nbsp;*<br />
&nbsp;*/<br />
const byte triggerControl = 3; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Using the Pulse plug on the V2.2 as the trigger. Remove R8 (10K) and maybe remove the SJ1 too so that you don&#39;t supply any power to the Pulse plug.<br />
const byte tempSensorPin = 4; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// &lt;-- data input from the DS18B20 sensor&nbsp;<br />
const byte LEDpin = 9; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // &lt;-- used as an output for the on-board LED</p>
<p>/* ---------------------------<br />
&nbsp;* allocation of analogue pins for use with a emonTx 2.2)<br />
&nbsp;*/<br />
const byte voltageSensor = 16; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // &nbsp;A2 is for the voltage sensor<br />
const byte currentSensor_CT1 = 17; &nbsp; &nbsp; &nbsp; // &nbsp;A3 is CT1 on the emonTx V2 (PV Gen)<br />
const byte currentSensor_CT2 = 18; &nbsp; &nbsp; &nbsp; // &nbsp;set to A4 as not used on the emonTx V2&nbsp;<br />
const byte currentSensor_grid = 14; &nbsp; &nbsp; &nbsp;// &nbsp;A0 is CT2 on the emonTx V2 (Grid)<br />
const byte currentSensor_diverted = 15; &nbsp;// &nbsp;A1 is CT3 on the emonTx V2 (PV diverter)<br />
const byte powerForDallasSensor = 19; &nbsp; &nbsp;// &nbsp;set to A5 as not used on the emonTx V2&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29897"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion</h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Wed, 22/04/2015 - 23:11.</div>
    <div class="content">
     <p>Looking at</p>
<p>// powerCal is the RECIPR0CAL of the power conversion rate. &nbsp;A good value&nbsp;<br />
// to start with is therefore 1/20 = 0.05 (Watts per ADC-step squared)<br />
//<br />
const float powerCal_grid = 0.045; &nbsp;// for grid power at CT4 (burden = 120R)<br />
const float powerCal_diverted = 0.25; &nbsp;// for diverted power at CT3 (burden = 22R)<br />
const float powerCal_CT2 = 0.25; &nbsp;// for real power at CT2 (burden = 22R)<br />
const float powerCal_CT1 = 0.25; &nbsp;// for real power at CT1 (burden = 22R)</p>
<p>&nbsp;</p>
<p>How is this calculated if the burden resistor is 18R (emontx default)&nbsp;or 24R (my build)</p>
<p>What should the powerCal for 24R and the shop sold CTs sensors.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29899"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 23/04/2015 - 00:54.</div>
    <div class="content">
     <p>To work out powerCal, you'll need to go through the whole of the comments in the rev 6a sketch, and work out the ADC steps per volt and the ADC steps per amp, then multiply them for the value of powerCal. </p>
<p>So the starting value (component tolerances neglected) for voltage is:<br />
240 V input gives 11.6 V output (Ideal adapter) divided down by (10 / (10 + 100) = 1.054 V at the ADC.<br />
1024 ADC steps is nominally 3.3 V at the ADC.<br />
Therefore voltage is 1.363 steps/V.</p>
<p>For Current:<br />
100 A gives 50 mA, which gives 1.2 V across 24 &Omega;<br />
Therefore current is 3.72 steps/A.</p>
<p>So I make your powerCal to be 0.197 W/step<sup>2</sup> for the input with the 24 &Omega; burden.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29900"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion</h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Thu, 23/04/2015 - 06:18.</div>
    <div class="content">
     <p>Thanks a lot for this. I would have never worked that out.<br />
Are my pin numbers right for the emontx 2.2<br />
I started getting a pin confused when emonlib refers to the ct inputs as 3, 0, 1 and voltage input as 2, when all these have diffirent Arduino pin numbers. (not helped by the fact that they don't match with the physical pin numbers of the chip!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29904"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 23/04/2015 - 10:35.</div>
    <div class="content">
     <p>If you look in the Wiki, there's an annotated photo of the V2 with pretty much everything you would want to know in the way of I/O designations.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29908"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion</h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Thu, 23/04/2015 - 15:34.</div>
    <div class="content">
     <p>Thanks for that. Port Map is what I should have been looking for. But that looks OK. Just note sure I should be assigning the unused stuff to the pins that have the special functions like SDA and SCL but we&#39;ll soon find out.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29920"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion</h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Fri, 24/04/2015 - 19:33.</div>
    <div class="content">
     <p>So after I learnt that the analogue&nbsp;Arduino&nbsp;numbers depend on how you read them.My analogue pin assignments above were all wrong! (but I&#39;m sure you guys knew that and were allowing me to learn - so thank you).</p>
<p>&nbsp;</p>
<p>I know my emontx&nbsp;2.2 using the oem sketch is reading voltage and current correctly after calibration.&nbsp;</p>
<p>My Mk2 router on a emontx 2.2&nbsp;using Robin&#39;s&nbsp;emontx 3.2 sketch modified&nbsp;is reading the Vrms&nbsp;about 47Volts higher.</p>
<p>So what do I start calibrating?</p>
<p>Update : So I adjusted the&nbsp;voltageCal = 0.725 and Vrms now matches what my energy meter is saying.Also adjusted the powerCal values to match the power readings. So it's looking better. Need to work out how to get the power to display decimals.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29999"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion</h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Thu, 30/04/2015 - 13:42.</div>
    <div class="content">
     <p>Why is it better to drive the load with an Active Low, rather than an Active High? Is it a timing issue i.e. its faster to get from High to Low, than from Low to High?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30000"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 30/04/2015 - 14:33.</div>
    <div class="content">
     <p>It's a matter of the available voltage swing and component tolerances, and being able to meet the worst-case conditions. </p>
<p>If you stop to think about it, timing doesn't matter, because all you're doing is pre-arming the trigger IC. As long as it's armed (or disarmed) somewhere in the half cycle after the voltage has risen sufficiently but before the zero crossing, it will take care of triggering the triac, which will happen after the zero crossing and as soon as there's enough gate current.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30002"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Thu, 30/04/2015 - 21:26.</div>
    <div class="content">
     <p>When I first came up with the Mk2 design, there were a lot of details to sort out.&nbsp; Robert checked the drive capability of the Atmega processor and informed me that the best way to control the MOC3041 trigger device was to use an active-low signal via a 180 Ohm series resistor.&nbsp; As so it has always been.</p>
<p>The 180R value is for use with a 5V Arduino.&nbsp; With a 3.3V emonTx, the series resistor needs to be less than this.&nbsp; I have always used 120 Ohms, but this is not guaranteed to work according to the datasheets.&nbsp; If anyone has found that this value has failed to give reliable performance with a 3.3V system, but a lower valued resistor has worked correctly, I would be most interested to hear about this.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30003"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Starting today to build a Robin Mk2 with an emontx 2.2 - what software version does reporting and divertion</h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Thu, 30/04/2015 - 22:05.</div>
    <div class="content">
     <p>The MOC3041 only needs 15mA to latch. So your 120R @ 3.3V is supplying it with plenty of current I would have thought. Why did you think it wouldn&#39;t work?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/10506"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-lvzGGVmme1VCN_UZELu5Edyy_UHh4_50Km-pCvm_pnM" value="form-lvzGGVmme1VCN_UZELu5Edyy_UHh4_50Km-pCvm_pnM"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/10506 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 13:48:57 GMT -->
</html>
