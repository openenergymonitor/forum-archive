<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11234 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:43:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Upgrading from emonpi to v9 | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Upgrading from emonpi to v9</h3>
        <span class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 10/09/2015 - 19:09</span>
        <div class="content"><p>Continued from post&nbsp;<a href="11009.html#comment-34031">http://openenergymonitor.org/emon/node/11009#comment-34031</a>​</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11295.html" class="topic-previous" title="Go to previous forum topic">‹ emoncms 9.0 api - set processlist</a>
              <a href="11664.html" class="topic-next" title="Go to next forum topic">Node Red post to local emoncms ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-34032"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Thu, 10/09/2015 - 19:16.</div>
    <div class="content">
     <p>Over on the main thread Tom said</p>
<p>&quot;</p>
<p>I verified MQTT publish to emoncms inputs works:&nbsp;emonhub is not required.</p>
<p>/var/www/emoncms/scripts/phpmqtt_input.php needs to be running and can be invoked using Paul&#39;s script mentioned above.</p>
<p>To publish to emoncms inputs:</p>
<p>Make sure MQTT is enabled with proper server IP in settings.php</p>
<p>Make sure userid&nbsp;number&nbsp;matches your id in file /var/www/emoncms/scripts/phpmqtt_input.php</p>
<p>also,&nbsp;basetopic is set there to rx</p>
<p>Subscribe to rx/#<br />
Set topic to: rx/node/key<br />
Set message to your data</p>
<p>If the key is not given, it defaults to &quot;0&quot;</p>
<p>Best Regards,</p>
<p>Tom&quot;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34033"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Thu, 10/09/2015 - 19:29.</div>
    <div class="content">
     <p>,</p>
<p>thanks for the reply.</p>
<p>In settings the server is set to 127.0.0.1 as its running on the pi - does it need the actual 192.168.x.x address?</p>
<p>phpmqtt_input.php is running via&nbsp;Pauls&nbsp;script</p>
<p>On the previous version the topics containing the information were found at topic:</p>
<p>emonhub/rx/10/values - does this all have to change? If so where?</p>
<p>In&nbsp;phpmqtt_input.php I have&nbsp;</p>
<p>$mqttsettings&nbsp;= array(<br />
&nbsp; &nbsp; &nbsp; &nbsp; &#39;userid&#39; =&gt; 1,<br />
&nbsp; &nbsp; &nbsp; &nbsp; &#39;basetopic&#39; =&gt; &quot;rx&quot;<br />
&nbsp; &nbsp; );</p>
<p>which is exactly the same as in the previous version, what does the&nbsp;userid&nbsp;refer to - my login or something else?</p>
<p>I can subscribe to&nbsp;emonhub/rx/# with another program and see the messages flowing which&nbsp;EMONCMS&nbsp;doesn&#39;t see.</p>
<p>AND changing the basetopic to &quot;emonhub/rx&quot; doesn&#39;t seem to do anything</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34035"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 10/09/2015 - 19:27.</div>
    <div class="content">
     <p><em>In settings the server is set to 127.0.0.1 as its running on the pi - does it need the actual 192.168.x.x address?</em> YES followed by the port number</p>
<p><em>emonhub/rx/10/values - does this all have to change? If so where?</em><br />
by changing whatever you are using to send the mqtt message to use rx/10 instead of emonhub/rx/10</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34036"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Thu, 10/09/2015 - 19:58.</div>
    <div class="content">
     <p>OK, I&#39;ve changed that and as a test I&#39;ve got openhab to translate the topic</p>
<p>emonhub/rx/10/values to rx/10/values</p>
<p>I now can see the full message on rx/10/values but I only see a single value in the inputs tab and nothing in nodes where it should be.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34037"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 10/09/2015 - 20:22.</div>
    <div class="content">
     <p>So, has a node 10 been created in &#39;Inputs&#39; whose value represents the mqtt value?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34038"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Thu, 10/09/2015 - 20:25.</div>
    <div class="content">
     <p>yes but only the first value</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34039"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Thu, 10/09/2015 - 20:26.</div>
    <div class="content">
     <p>Fortunately the topic is a single line in EMONHUB.conf as I&#39;ve just discovered, and deleting the value changes the topic to rx/10</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34040"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 10/09/2015 - 20:26.</div>
    <div class="content">
     <p>What do you mean &#39;the first value&#39;?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34041"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Thu, 10/09/2015 - 20:31.</div>
    <div class="content">
     <p>From an EMONTX the data is something like&nbsp;284,225,1,0,236.99,36,47,58,0,0,0,0</p>
<p>Inputs shows 284, whereas in Nodes we have</p>
<p>Rx ID Name Last updated Value<br />
1 power1 inactive W<br />
2 power2 inactive W<br />
3 power3 inactive W<br />
4 power4 inactive W<br />
5 Vrms inactive V<br />
6 temp1 inactive C<br />
7 temp2 inactive C<br />
8 temp3 inactive C<br />
9 temp4 inactive C<br />
10 temp5 inactive C<br />
11 temp6 inactive C<br />
12 pulse inactive p</p>
<p>&nbsp;</p>
<p>where each line should be an output of the EMONTX</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34042"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 10/09/2015 - 20:51.</div>
    <div class="content">
     <p>Well, if I string comma delimited values together, say 50,60,70,80 it works fine for me, check the format that you are using to publish&nbsp;the messages.</p>
<p>Paul</p>
<p><img alt="" src="../sites/default/files/mqtt.jpg" style="width: 720px; height: 191px;" /></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34044"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Thu, 10/09/2015 - 21:06.</div>
    <div class="content">
     <p>I think its the &quot;values&quot; in the topic rx/10/values that is screwing it up. Problem is I can&#39;t find where that comes from, I know the emonhub in the original topic of &quot;emonhub/rx/10/values&quot; came from emonhub.conf as I&#39;ve managed to remove it.</p>
<p>Changing the topic on my other MQTT inputs makes them work so that is at least progress.</p>
<p>How does emoncms usually get its RFM radio inputs - maybe I can retro fit this bit alone?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34045"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 10/09/2015 - 21:09.</div>
    <div class="content">
     <p>...via a RF add-on module &amp;&nbsp;emonhub</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34046"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Thu, 10/09/2015 - 21:20.</div>
    <div class="content">
     <p>Which version of emonhub - is there an updated V9 version of it or is it the one you mentioned earlier in the other thread? I need to get publish to MQTT working first before I can switch though, and that doesn&#39;t work at the moment.</p>
<p>1 Log to feed &nbsp;test (feed last value:78.00)<br />
2 Publish to MQTT &nbsp;/test/kevin</p>
<p>​the feed works, but subscribing to /test/# shows no messages<br />
&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34047"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 10/09/2015 - 21:31.</div>
    <div class="content">
     <p>Works fine here!</p>
<p>It might be helpful to do a little work on the format of your mqtt&nbsp;messages, and how you want your overall system to work.</p>
<p>Good luck!<br />
&nbsp;</p>
<p>Paul</p>
<p><img alt="" src="../sites/default/files/values.jpg" style="width: 229px; height: 424px;" /></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34048"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Thu, 10/09/2015 - 22:18.</div>
    <div class="content">
     <p>OK, I&#39;ll do further experiments to see just what I have to do to make this work. I&#39;ll start with deleting the EMONCMS folder and doing a straight install with nothing added, maybe that way publish to MQTT will work. Once I know what limitations I have on topics to make it work,&nbsp;I&#39;ll design a sensible topic tree. So far I&#39;ve just used topics I haven&#39;t used before so I know anything new hasn&#39;t appeared before.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34052"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Fri, 11/09/2015 - 02:50.</div>
    <div class="content">
     <p>I&#39;ve tried renaming the emoncms instance, following the precedure on the other thread to git clone a new v9 and then renaming emonhub and installing a new one again from the procedure on the other page. It still didn&#39;t work and as a bonus the updates on the original when I restored them back was intermittent so I&#39;ve restored the lot from an image.</p>
<p>I&#39;ve then downloaded a fresh emonpi image to a blank memory card, checked the emontx was reporting values before I&nbsp;ran the update script. I&nbsp;then renamed emoncms&nbsp;to oldemoncms&nbsp;and git cloned v9. I ran the phpmqtt_input.php from a command prompt and after editing /home/pi/data/emonhub.conf to change the topic from emonhub/rx to rx I&nbsp;can see the messages flowing. Again only the first value is viewable because the word &quot;values&quot; is listed in the keys column on the inputs page.&nbsp;I then discovered I can&#39;t create feeds because the feed name already exists - it doesn&#39;t as this is a blank image, and the feeds tab sits there saying updating. The path the the feed engine I was trying to use exists but the location is empty as this is a new image with no feeds created.&nbsp;I then added publish to MQTT as the only action and no messages were published, although this may be misleading due to the feeds page being broken.</p>
<p>For now I think I&#39;ve hit a blank and I&#39;ll live in hope that someone more knowledgeable than I can work out where the word &quot;values&quot; is coming from (my guess is possibly /home/pi/emonhub/src/interfacers/EmonHubMqttInterfacer.py which is linked to /usr/share/emonhub) Once this word no longer appears, the inputs may start to display all the values rather than the first one. Then the broken feeds page can be fixed etc.</p>
<p>I&#39;ll be out and about when the day shift returns so I&#39;ll wish whoever picks up this challenge good luck in finding what it is that needs to be done.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34056"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Fri, 11/09/2015 - 09:28.</div>
    <div class="content">
     <p><em>I&#39;ve then downloaded a fresh emonpi image to a blank memory card...and git cloned v9</em></p>
<p>Why download an image of specific software, and then try &amp; change it? Wouldn&#39;t it be less problematic&nbsp;to simply&nbsp;follow the normal <a href="https://github.com/emoncms/emoncms/blob/9.0/docs/RaspberryPi.md">emoncms installation guide</a>?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34058"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Fri, 11/09/2015 - 09:37.</div>
    <div class="content">
     <p>Without some input from Trystan you will need to delve into the code to decipher what there is, what you need and if that can be done in the settings or requires edits to the code.</p>
<p>For example the &quot;inputs&quot; topic appears to be hard&nbsp;coded in&nbsp;<a href="https://github.com/openenergymonitor/emonhub/blob/emon-pi/src/interfacers/EmonHubMqttInterfacer.py#L96">EmonHubMqttInterfacer.py#L96</a>, you can try editing in your local copy to see if that resolves anything but if you are getting a single input value then I suspect there may be a message&nbsp;format issue, I couldn&#39;t find all the relevant parts to confirm that either way when I looked.</p>
<p>What is your end goal? I know you are trying to get v9 emoncms&nbsp;working but what are your overall requirements?</p>
<p>As Paul says why not create your own image? the image you have chosen is quite unique version wise as the &quot;emon-pi&quot; variant of emonHub and the &quot;v8.5 low-write with the nodes&nbsp;module&nbsp;instead of a inputs module&quot; are pretty much dedicated to each other.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34131"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Sun, 13/09/2015 - 23:42.</div>
    <div class="content">
     <p>Hi Paul and Paul,</p>
<p>My Goal is to upgrade whist retaining both the MQTT outputs from the incoming EMONTX data which I use as inputs into OpenHAB, and the monitoring data that I&#39;ve accumulated so far. A lot of systems in my house rely on this so reinventing everything to do without MQTT will be time consuming and very disruptive, if indeed the OpenHAB Binding works with V9. I perhaps naively assumed that as the EMONPI&nbsp;was the latest energy monitoring system&nbsp;from the shop that it was going to be the one to follow into the future, especially as the image worked quite well out of the box and had been standardised for both EMONPI and the RFM69 module.</p>
<p>I downloaded another copy of the image as&nbsp;I was trying to isolate what on my setup if anything was causing this not to work. I also wanted a&nbsp;debugging environment that doesn&#39;t upset what I&#39;ve got running reliably everytime I needed to try something to see if it fixes the problem.</p>
<p>Is it likely that the EMONPI Image will become a dead end development&nbsp;wise and those that are interested in V9 need to start again?</p>
<p>Kevin</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34134"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Mon, 14/09/2015 - 08:29.</div>
    <div class="content">
     <p><em>...Is it likely that the EMONPI Image will become a dead end development wise...</em></p>
<p>No, I would say most unlikely, because it was primarily written to support the emonpi hardware. It&#39;s just that v9 is in the spotlight at the moment because it is being actively developed by a third party.</p>
<p>Like most new product releases, any major issues experienced by users are being addressed fairly swiftly, and I&#39;m sure that T &amp; G are&nbsp;taking on board all feedback, and will&nbsp;make updates in due course.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34143"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 14/09/2015 - 17:16.</div>
    <div class="content">
     <p><em>&quot;the MQTT outputs from the incoming EMONTX data which I use as inputs into OpenHAB&quot; D</em>o you mean emonhub posting the data it has&nbsp;received from the emonTx direct to openHab or&nbsp;the &quot;publish to mqtt&quot; from&nbsp;&nbsp;emoncms? or both?</p>
<p>Currently only the &quot;emon-pi&quot; variant of emonHub and v8.5 low-write intercommunicate by mqtt&nbsp;so you are a&nbsp;bit tied to that image unless you construct your own image with&nbsp;a&nbsp;little chopping and hacking as the various bits are not as&nbsp;readily interchangeable as they could be , unless you&nbsp;just&nbsp;use the &quot;publish to&nbsp;mqtt&quot; processes.&nbsp;&nbsp;</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34153"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Mon, 14/09/2015 - 23:40.</div>
    <div class="content">
     <p>I use the v8.5 low-write intercommunicate by MQTT version, this version doesn&#39;t have a &quot;publish to mqtt&quot; from EMONCMS&nbsp;option, or if it does I can&#39;t find out how to enable it.</p>
<p>Using it this way I do need to double handle some inputs to get them added together in both EMONCMS and in OpenHAB, but it seems to work and I haven&#39;t hit the hardware limits yet.</p>
<p>I also don&#39;t have anywhere near enough knowledge to hack my own version so for now I&#39;ll sit back and hope that one day a MQTT compliant upgrade route appears for the EMONPI image.</p>
<p>Kevin</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34154"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Mon, 14/09/2015 - 23:52.</div>
    <div class="content">
     <p>What is your main difficulty in following the standard installation guide for v9?</p>
<p>That version would provide not perfect, but probably workable MQTT&nbsp;publish &amp; subscribe, am I missing something?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34158"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Tue, 15/09/2015 - 03:20.</div>
    <div class="content">
     <p>I had no inputs when I did that and adding the nodes module gave me all my current inputs listed as they are in my current version&nbsp;but they didn&#39;t&nbsp;&nbsp;update. Looking in the logs Emonhub&nbsp;was publishing them as MQTT and Openhab&nbsp;which is also running on the Pi&nbsp;saw them, so that bit was still working, but v9 did not.&nbsp;Starting&nbsp;the MQTT input script and changing&nbsp;the EMONHUB topics allowed&nbsp;the first output&nbsp;from my EMONTX&nbsp;to appear in &quot;inputs&quot;&nbsp;but the published topic having&nbsp;/values on&nbsp;the end seems to cause only the first one to appear. So to get it to work, I suspect it&nbsp;either needs EMONHUB to stop putting &quot;values&quot; on the end of the topic RX/10/Values or for EMONCMS V9 to work&nbsp;with it and spit the comma separated values into individual inputs as happens now in the V8.5 Low Write EMONPI&nbsp;Nodes module. My concern also is even if I do find out where &quot;/values&quot; and stop it that in the future an update will break it again.</p>
<p>Take a look at the bottom of the main V9 thread, it&#39;s all in there</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34162"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Tue, 15/09/2015 - 08:29.</div>
    <div class="content">
     <p><em>I had no inputs when I did that...</em></p>
<p>Did you do that - or did you download an emonpi image, delete the emoncms folder &amp; install v9?? - which is the wrong way to go about it, for the reasons stated above.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34182"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Wed, 16/09/2015 - 06:23.</div>
    <div class="content">
     <p>I&#39;ve tried many different things, none of which worked,&nbsp;needing to retain a working system did limit the things I could do, which resulted ultimately in&nbsp;downloading&nbsp;the emonpi image onto a replacement card to see whether I could at least prove that it could be made to work without scrapping&nbsp;everything and starting again.</p>
<p>For now I&#39;ve spent way too long on V9, so I&#39;ve walked away until a definitive working upgrade path&nbsp;appears for the emonpi image, if it doesn&#39;t I&#39;ll stay on 8.5 VLow&nbsp;Write as it works albeit without the latest features&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34907"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8424.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="JBlackham&#039;s picture" title="JBlackham&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/8424.html" title="View user profile.">JBlackham</a> on Tue, 13/10/2015 - 22:17.</div>
    <div class="content">
     <p>I wish there was a V9 image that I could just flash my pi with an use with the EmonTX. &nbsp;Sadly after many days I am walking away from this defeated. &nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36412"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4005.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="maze42&#039;s picture" title="maze42&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/4005.html" title="View user profile.">maze42</a> on Sat, 28/11/2015 - 19:42.</div>
    <div class="content">
     <p>I have the same setup as sheepy&nbsp;(emoncms v 9, openhab and emonhub) and also run into this problem with the &quot;/values&quot; in the end of the mqtt messages sent from emonhub. I can&acute;t see&nbsp;any input in emoncms&nbsp;but have no problem to get Txnode data into openhab from emonhub.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36415"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Sat, 28/11/2015 - 19:50.</div>
    <div class="content">
     <p>I think I&#39;ve <a href="11234.html#comment-34035">answered this question already&nbsp;above.</a></p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36420"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4005.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="maze42&#039;s picture" title="maze42&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Upgrading from emonpi to v9</h3>

    <div class="submitted">Submitted by <a href="../user/4005.html" title="View user profile.">maze42</a> on Sat, 28/11/2015 - 22:38.</div>
    <div class="content">
     <p>yes, I hear what you say, but&nbsp;I still &nbsp;don`t know how to make emonhub&nbsp;not sending the&nbsp;last &quot;/values&quot; part of the mqtt message to emoncms. I must have missed some important&nbsp;part of the installation procedure.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11234"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-cvwQHO88CVtnLwAyLobiQEe2nZaoqMrsjinpAY_fqpw" value="form-cvwQHO88CVtnLwAyLobiQEe2nZaoqMrsjinpAY_fqpw"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
