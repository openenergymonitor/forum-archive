<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/5902 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:41:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Investigating before buying | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Investigating before buying</h3>
        <span class="submitted">Submitted by Guest on Wed, 08/10/2014 - 02:37</span>
        <div class="content"><p>Hi All,</p>
<p>The emonTx v3&nbsp;looks like the product for me, but just thought I would ask a bit of advice&nbsp;as this is a new project for me and I need to get everything I need when I am in the UK later this month. &nbsp;Sorry if this is a bit long winded and rambling I am getting my thoughts together on this :-)</p>
<p>I live overseas and our power supply is poor, we currently get shore power(110 Volt) for an average of 8 hours per day, we also have &nbsp;a&nbsp;1200AH&nbsp; battery bank, 24 volts to an inverter/charger.</p>
<p>We normally get power at night and this will charge the battery bank, but many days we need to start the generator to either run heavy loads or top up the battery bank to ensure we get through the evening(you can&#39;t rely on shore power everyday)</p>
<p>The national electrical supplier is somewhat crap at getting the bill right and I often feel they just makes them up and the kw/h price is above that of the UK</p>
<p>I would like to monitor energy usage while on shore power and generator so I can argue with them, they do seem to know they &#39;cheat&#39; but you need to prove it and they have just placed all meters on a pole 5 meters above ground :-)</p>
<p>The inverter/charger has max charge of 70 amps @ 24 Volts in bulk charge mode and I am working on some software to monitor it, it has a rs485 interface and I have the protocol, also it is pseudo sine wave&nbsp;therefore it is probably better to use it&#39;s built in reporting for this, but I want to feed it into the same logging software, I would like to know how big an effort that would be ?</p>
<p>The generator and shore power have a change over switch which seems to be the ideal place to install the current monitors, anyone see problems with that?</p>
<p>The generator belongs to the landlord and seems a bit under voltage I had to set the inverter to kick in at 80 volts as when on generator, it would constantly flick between charge and invert, in addition the shore power is not best regulated either, will that cause issues?</p>
<p>I already have a few RPi, Arduino and a new&nbsp;SRF Shield for Arduino by Ciseco with a RPi link for it waiting in the UK I bought as a Kickstarter&nbsp;project a little while back, will I be able to use this link?</p>
<p>How much memory is spare in the emon Tx&nbsp;3 Arduino, I would like to use two power relays that switch on the water lift pump and the swimming pool filters when generator or shore power is available, the lift pump will be fitted with a float switch so that the Arduino can switch of this pump when the header tank is full. &nbsp;The pool filter pump needs to be switched on for a given amount of time per day, will I be able to fit the code for this into the emon or am I better off using a separate&nbsp;Arduino?</p>
<p>Any advice or observations would be greatly appreciated, I am proficient in coding, electronics and electrical distribution</p>
<p>&nbsp;</p>
<p>EDIT:- Just reading more and I think the system&nbsp;I want may be better achieved with 2 x Version 2, this would allow me to use 2 x 9 volt transformers one from the generator &amp; one from the inverter, with power supplied to the units via the inverter. &nbsp;The house power outlets alternate between inverter, shore and generator. &nbsp;I also have a spare PLC that can work the pumps using a single output from each board, which would make that part easier.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="5912.html" class="topic-previous" title="Go to previous forum topic">‹ What to buy and where to start  (1st Timer)</a>
              <a href="5909.html" class="topic-next" title="Go to next forum topic">Complain about my Pre-Loaded Raspberry Pi Gateway 4GB SD card  ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-24378"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Investigating before buying</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 08/10/2014 - 13:40.</div>
    <div class="content">
     <p>I think all that is do-able, but I&#39;m not entirely clear what you want to measure and control. As I understand it:</p>
<p>Your mains incomer is 110 V, 50 or is it 60 Hz, single phase?<br />
	You have a generator.<br />
	You have a changeover switch to select mains or generator as your main source of supply.</p>
<p>You want to separately monitor mains and generator to check your consumption hence the charges.</p>
<p>	You would like to monitor battery inverter output.</p>
<p>I think my first observation is to agree that all your monitoring and recording must be battery powered, so that it will ride through any switching or brown-outs, especially if you are using it for clock functions. There&#39;s no in-built real-time clock, so you would need some means of synchronising if you want things to happen at set times.</p>
<p>Monitoring the supply voltage will be essential; given that, the sketches can calculate real power accurately over any reasonable voltage range. But if all the infeeds (mains, generator and inverter) end up on the same busbar, I don&#39;t see a need for separate voltage monitors. Or can you run &#39;split&#39; with generator feeding some loads independently of the other supply?</p>
<p>The sketches can handle any (reasonable) wave shape (they should be good to about the 20th harmonic!), therefore real power from your inverter is not likely to be grossly inaccurate, and it might be easier to simply treat that as another infeed.&nbsp;</p>
<p>Regarding the choice of V2 or V3, they both have the same basic circuit and processor. The V2 has 3 current inputs, the V3 has 4, but the V2 has many more easily accessible I/O pins. On balance, I think I&#39;d go for the V2 in your application. I don&#39;t think you will need two emonTx&#39;s, &nbsp;it would be possible to convert a spare analogue I/O pin to a second voltage input if you wanted, with an add-on (strip-)board. You can use a <a href="3872.html">serial link between a RPi and emonTx</a>. I don&#39;t know that you can have two emonTx&#39;s on the same link, or that you can use i<sup>2</sup>c and serial to the Pi at the same time.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24388"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ianmac&#039;s picture" title="ianmac&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Investigating before buying</h3>

    <div class="submitted">Submitted by ianmac (not verified) on Wed, 08/10/2014 - 17:43.</div>
    <div class="content">
     <p>Thank you for the quick response, I have done a quick diagram of the layout and in red is where I think you are saying to attach the CT&#39;s and AC/AC adaptor</p>
<p>CT1 &amp; CT2 will monitor the Generator and Shore Power while CT3 will show me house general usage, pump usage will be CT1&nbsp;+ CT2 - CT3</p>
<p>Is that correct?</p>
<p>I will order a second V2 monitor as we may put in solar and friends may want one once they see it working, also I will not be back to the UK for at least 6 months.</p>
<p>If what I have drawn is correct would you please advise so I can place my order.</p>
<p>&nbsp;</p>
<p>Best regards</p>
<p>Ian</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24392"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Investigating before buying</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 08/10/2014 - 19:21.</div>
    <div class="content">
     <p>No, there&#39;s a problem there - with that arrangement you need to measure the voltage at two places, because the incoming voltage as seen by Consumer Unit 1 is not going to be the same as that seen by&nbsp;Consumer Unit 2.</p>
<p>Whether you need 1 or 2 emonTx V2&#39;s might depend on how and where your solar infeed is. I&#39;m guessing CU 2. If you&#39;re not happy with replicating the voltage input circuitry on stripboard and feeding into a spare analogue input (and extending emonLib or the interrupt loop if you use the &#39;continuous&#39; sketches, to use it) then you might need a second emonTx. Otherwise, you can probably get away with one.</p>
<p>Here&#39;s my take:</p>
<p>A single emonTx:<br />
	Current inputs:&nbsp;Shore, Generator, Inverter out; Voltage input: CU 1 voltage; AI4 with external circuit: CU2 voltage.</p>
<p>For the solar infeed, you would need to use AI5 and equip it with the fourth current input on the stripboard.</p>
<p>Two emonTx&#39;s:<br />
	No.1: &nbsp;Current inputs: Shore, Generator; Voltage input: CU 1 voltage.<br />
	No.2:&nbsp;&nbsp;Current input:&nbsp;Inverter out; Voltage input:&nbsp;CU2 voltage.</p>
<p>Both now have a spare current input for the solar infeed.</p>
<p>Pump usage is definitely not what you say - you&#39;ve forgotten the battery charger input - that&#39;s not the same as the output (inverter and battery efficiency, energy storage in the battery? ! ! !). If you want that separately, you will need two emonTx&#39;s.</p>
<p>One further thought that might complicate matters: Are you going to want to use a solar energy diverter to charge the battery bank only when there is surplus solar energy (i.e using one of <a href="../Choosing%20an%20Energy%20Diverter.html">these</a>). If so, now is the time to think about it! If you did do that, EmonTx 2 could handle that and the measurement. I&#39;m fairly certain a single emonTx would struggle under the load.</p>
<p>But one big caveat, which needs to be answered by someone who is familiar with the I<sup>2</sup>C and serial comms: I don&#39;t know that it&#39;s possible for two emonTx&#39;s to talk to eachother and to a RPi serially.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24397"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ianmac&#039;s picture" title="ianmac&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Investigating before buying</h3>

    <div class="submitted">Submitted by ianmac (not verified) on Wed, 08/10/2014 - 22:29.</div>
    <div class="content">
     <p>Robert,</p>
<p>Thank you very much for your time, the information is invaluable.</p>
<p>Extending the EmonTx2&nbsp;should not be a problem and the setup you give covers everything that I need at the moment, sticking with just one unit for now makes sense.</p>
<p>You are right, I totally forgot the inverter inefficiencies, brain dead today!</p>
<p>Any excess solar energy would be dumped to the water heater, I will get&nbsp;the bits for that when back in the UK and have a think how I want to handle the monitoring, monitoring of the Generator &amp; Shore power is the priority.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24399"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Investigating before buying</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 08/10/2014 - 22:46.</div>
    <div class="content">
     <p>If you are going to have an energy diverter eventually, you need to use one of the &quot;continuous&quot; sketches in the monitor. I know it&#39;s possible to change later, but it&#39;s best to start off right. You should find all the data you need for extending the V2 on the Wiki.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24400"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ianmac&#039;s picture" title="ianmac&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Investigating before buying</h3>

    <div class="submitted">Submitted by ianmac (not verified) on Wed, 08/10/2014 - 23:58.</div>
    <div class="content">
     <p>Thanks Robert,</p>
<p>I can&#39;t seem to see my other post that thanked you for your great critique&nbsp;of the drawing, Strange, anyway it said thank you in brief and I am going with the V2 option with the extra strip board. &nbsp;I will look at the wiki and get to grips with it all.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24407"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Investigating before buying</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 09/10/2014 - 09:14.</div>
    <div class="content">
     <p>It was stuck in the moderation queue. You couldn&#39;t see it but I could, and there isn&#39;t a flag on the post to distinguish it, so I didn&#39;t realise it was stuck there until I checked the queue this morning!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/5902"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-toPRFrqsY63aCZWAHLYiBceUn_nSERo_vBhMz8Dirrk" value="form-toPRFrqsY63aCZWAHLYiBceUn_nSERo_vBhMz8Dirrk"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
