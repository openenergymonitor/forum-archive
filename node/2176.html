<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/2176 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:38:39 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Resolved - EmonGLCD time not received | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Resolved - EmonGLCD time not received</h3>
        <span class="submitted">Submitted by Guest on Sat, 30/03/2013 - 07:48</span>
        <div class="content"><p>Hi,</p>
<p>My EmonGLCD does not receive time from NanodeRF it does send the temperature.<br />
	Watts are also being received, I used the latest Jeelibs for compiling.<br />
	Ideas as where this problem could be from?</p>
<p>Best regards,</p>
<p>Johan Addink</p>
<p>	Please be gentle I am a programming noob</p>
  <div class="forum-topic-navigation clear-block">
          <a href="2268.html" class="topic-previous" title="Go to previous forum topic">‹ Solar PV History Page</a>
              <a href="2253.html" class="topic-next" title="Go to next forum topic">Shared bias circuit ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-10728"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 30/03/2013 - 13:16.</div>
    <div class="content">
     <p>The time comes from the server that is running emoncms. Is your NanodeRF receiving the time? Every minute, the NanodeRF sends a request and the server responds with &quot;t13,05,39&quot; (the time in hh,mm,ss). It prints this to the Serial Monitor. Is that happening?</p>
<p>If it is, have you got the Node ID of the NanodeRF set correctly in the emonGLCD code? If that is wrong, the GLCD will be ignoring the time message.<br />
	&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10745"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="SUBjohan&#039;s picture" title="SUBjohan&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by SUBjohan (not verified) on Sat, 30/03/2013 - 20:29.</div>
    <div class="content">
     <p>Node ID of the NanodeRF&nbsp;was not set correct, it now works perfect.</p>
<p>Thank you very much for your help!</p>
<p>Greetz Johan</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10782"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="canary50&#039;s picture" title="canary50&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by canary50 (not verified) on Mon, 01/04/2013 - 07:44.</div>
    <div class="content">
     <p>I think I have the same problem, could you expand on this please ? What should the Node ID be ?</p>
<p>thanks</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10788"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 01/04/2013 - 11:47.</div>
    <div class="content">
     <p>As I wrote above, a Node ID is set in the NanodeRF. This is, if you like, its identity - it identifies where the message came from. You must specify in the receiver which messages to receive by specifying where they came from. Therefore, you must set the Node ID of the NanodeRF correctly in the emonGLCD, otherwise the GLCD will be ignoring the time message.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10795"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="canary50&#039;s picture" title="canary50&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by canary50 (not verified) on Mon, 01/04/2013 - 13:49.</div>
    <div class="content">
     <p>I know its me being slow ...</p>
<p>in the NanodeRF multimode sketch we have these lines</p>
<p>#define MYNODE 15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
	#define freq RF12_433MHZ&nbsp;&nbsp;&nbsp;&nbsp; // frequency<br />
	#define group 210&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // network group</p>
<p>in the GLCD solar PV sketch we have these lines</p>
<p>#define MYNODE 20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Should be unique on network, node ID 30 reserved for base station<br />
	#define freq RF12_433MHZ&nbsp;&nbsp;&nbsp;&nbsp;<br />
	#define group 210&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // network group, must be same as emonTx and emonBase</p>
<p>and in the emontx</p>
<p>#define freq RF12_433MHZ</p>
<p>#const int nodeID = 10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // emonTx RFM12B node ID<br />
	#const int networkGroup = 210;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>&nbsp;</p>
<p>I have tried changing the&nbsp;nanode sketch&nbsp;to read MYNODE 30 but no difference.</p>
<p>Have I totally got the wrong end of the stick &nbsp;?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10798"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 01/04/2013 - 14:09.</div>
    <div class="content">
     <p>In a word - yes!</p>
<p>The Node ID&#39;s you&#39;re trying to match are the Nanode&#39;s MYNODE 15 and where it is handled by the GLCD in the loop():</p>
<pre>
      if (node_id == 15)
      {
        RTC.adjust(DateTime(2012, 1, 1, rf12_data[1], rf12_data[2], rf12_data[3]));
        last_emonbase = millis();
      }</pre><p>The first line matches the Nanode&#39;s ID so the branch will be executed and the time set. If that&#39;s what you have in the GLCD, the problem is somewhere else - or it&#39;s out of range.</p>
<p>
	&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10800"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="canary50&#039;s picture" title="canary50&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by canary50 (not verified) on Mon, 01/04/2013 - 14:22.</div>
    <div class="content">
     <p>OK, thanks for the pointer, that all matches ......</p>
<p>I&#39;m guessing I&#39;m doing something wrong with IP addresses or emoncms subdirectory locations ?</p>
<p>I have emoncms setup at <a href="http://localhost/" title="http://localhost">http://localhost</a> the database name is emoncms-master</p>
<p>	Serial monitor output is</p>
<p>	[webClient]<br />
	DHCP status: 1<br />
	IP:&nbsp; 192.168.0.11<br />
	GW:&nbsp; 192.168.0.1<br />
	DNS: 8.8.8.8<br />
	DNS status: 1<br />
	SRV: 213.138.101.177<br />
	Data sent: /emoncms-master/api/post.json?apikey=###&amp;json={rf_fail:1}<br />
	Time request sent<br />
	Data sent: /emoncms-master/api/post.json?apikey=###&amp;node=20&amp;csv=1650<br />
	Data sent: /emoncms-master/api/post.json?apikey=###&amp;node=10&amp;csv=170,31,2,23994<br />
	Data sent: /emoncms-master/api/post.json?apikey=###&amp;node=10&amp;csv=171,30,1,24006<br />
	Data sent: /emoncms-master/api/post.json?apikey=###&amp;node=20&amp;csv=1650<br />
	Data sent: /emoncms-master/api/post.json?apikey=###&amp;node=10&amp;csv=170,24,0,24014<br />
	Data sent: /emoncms-master/api/post.json?apikey=###&amp;node=20&amp;csv=1650<br />
	Data sent: /emoncms-master/api/post.json?apikey=###&amp;node=10&amp;csv=170,30,2,24045<br />
	Data sent: /emoncms-master/api/post.json?apikey=###&amp;node=10&amp;csv=168,33,2,24015<br />
	Data sent: /emoncms-master/api/post.json?apikey=###&amp;node=20&amp;csv=1650<br />
	Data sent: /emoncms-master/api/post.json?apikey=###&amp;node=10&amp;csv=170,35,1,23975</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10805"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 01/04/2013 - 15:06.</div>
    <div class="content">
     <p>There doesn&#39;t appear to be a time coming back from your server. If you look at the Nanode sketch, the callback function should print &quot;Time: t15,49,20&quot; or something like that. It isn&#39;t there. You need to check that your server is behaving. (A quick test: change over to emoncms.org and see if the time comes in OK.)</p>
<p>Or maybe even send the time request by hand from your browser?</p>
<p class="rteindent1">emoncms.org/time/local.json?apikey=********************</p>
<p>works for emoncms.org, try something like</p>
<p class="rteindent1">http://localhost/********/time/local.json?apikey=********************</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10848"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="canary50&#039;s picture" title="canary50&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by canary50 (not verified) on Tue, 02/04/2013 - 20:29.</div>
    <div class="content">
     <p>sending the time request by hand&nbsp;from the browser works&nbsp;</p>
<p><a href="http://localhost/********/time/local.json?apikey=********************" title="http://localhost/********/time/local.json?apikey=********************">http://localhost/********/time/local.json?apikey=********************</a></p>
<p>but I only get a blank screen with</p>
<p><a href="http://emoncms.org/time/local.json?apikey=********************" title="http://emoncms.org/time/local.json?apikey=********************">http://emoncms.org/time/local.json?apikey=********************</a></p>
<p>serial monitor output is still</p>
<p>DNS status: 0<br />
	Data sent: /emoncms-master/api/post.json?apikey=######&amp;json={rf_fail:1}<br />
	Time request sent<br />
	DNS status: 0</p>
<p>and status led on nanode is red.</p>
<p>help again please !</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10852"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 02/04/2013 - 23:47.</div>
    <div class="content">
     <p>Yikes! I&#39;m thick!</p>
<p>I&#39;ve just realised: Why is this</p>
<p class="rteindent1">Serial monitor output is</p>
<p class="rteindent1">[webClient]<br />
	DHCP status: 1<br />
	IP:&nbsp; 192.168.0.11<br />
	GW:&nbsp; 192.168.0.1<br />
	DNS: 8.8.8.8<br />
	DNS status: 1<br />
	<strong>SRV: 213.138.101.177</strong>&nbsp;&nbsp; &lt;=====&nbsp; THE EMONCMS.ORG server address!&nbsp; It should be a 192.168....</p>
<p>So it looks like you&#39;re sending a request to emoncms.org with the APIkey for your private copy! You&#39;re a spammer, no wonder it&#39;s ignoring you.</p>
<p>Unless your router does DNS, it&#39;s probably safer to use the local IP address 192.168...... of your localhost (you need to check what that is - your router or Apache should tell you) and put</p>
<p class="rteindent1">char website[] PROGMEM = &quot;&quot;;</p>
<p>and basedir is &quot;emoncms-master&quot;<br />
	&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10856"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="canary50&#039;s picture" title="canary50&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by canary50 (not verified) on Wed, 03/04/2013 - 08:22.</div>
    <div class="content">
     <p>confusion still reigns ... sorry !</p>
<p>The IP address of <a href="http://localhost/" title="http://localhost">http://localhost</a> is a 127.0... number, are you suggesting it should be a 192.168... number ?</p>
<p>and should hisip be set to true or false ?&nbsp;</p>
<p>// change to true if you would like the sketch to use hisip<br />
	boolean use_hisip = false;</p>
<p>I seem to have tried everything but I am still consistently getting a &quot;rf fail&quot; message,</p>
<p>Data sent: /emoncms-master/api/post.json?apikey=####&amp;json={rf_fail:1}.</p>
<p>but I do seem to be getting data transmitted from emontx &amp; emonglcd</p>
<p>Data sent: /emoncms-master/api/post.json?apikey=####&amp;node=10&amp;csv=-216,460,1,23858<br />
	Data sent: /emoncms-master/api/post.json?apikey=####&amp;node=20&amp;csv=1625</p>
<p>I really appreciate the help you are giving !</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10864"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 03/04/2013 - 11:28.</div>
    <div class="content">
     <p>My problem is I haven&#39;t got your setup! What is certain is that the IP address that DNS is coming back with, 213.138.101.177, is wrong. And a 127.0... &nbsp; IP address is local <u>within your computer,</u> not within your LAN. What have you got in the top of the Nanode sketch for the server settings etc?</p>
<p>For the old Nanode sketches before they were cleaned up and rationalised, for a local Wampserver I had:</p>
<p class="rteindent1">#define PROGURL &quot;&quot;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;// Enter the emonCMS server domain name here inside the quotes. Else put an empty string if using a static IP address<br />
	&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;// e.g.&nbsp; #define PROGURL &quot;vis.openenergymonitor.org&quot;<br />
	#define PROG_IP&nbsp; {10,0,0,5}&nbsp;&nbsp; &nbsp;// Enter the emonCMS server static IP address here (COMMA-SEPARATED), else comment out the whole of this line</p>
<p>where the 10.0.... address is allocated by my (old) router, which corresponds to your 192.168... address range.</p>
<p>This was a long time ago and I didn&#39;t have success then going through DNS to get the IP address. Can you not interrogate you router and see what address it has allocated to the server? - I don&#39;t see a problem because you can probably tell the router to keep the same IP address for the server anyway, so then you would never need DNS to resolve it.<br />
	&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10883"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="canary50&#039;s picture" title="canary50&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by canary50 (not verified) on Wed, 03/04/2013 - 22:00.</div>
    <div class="content">
     <p>Very aware I&#39;m taking up a lot of time on this ......</p>
<p>I&#39;ve tried interrogating my Netgear router and using the DNS lookup facility&nbsp;it&nbsp;comes back with&nbsp;&nbsp;213.138.101.177. I&#39;ve tried whois and that comes back with the same IP address. If I Ping it, it fails.</p>
<p>If I type it (213.138.101.177.)&nbsp;into the browser bar I get to the Emoncms v3 beta website with the following message</p>
<p>Hello! This is the old entry point for the hosted openenergymonitor emoncms. The new entry point is emoncms.org, if you have an account on vis.openenergymonitor.org all your data can be accessed via emoncms.org just log in as usual.</p>
<p>You asked about server settings ....</p>
<p>// ethernet interface mac address, must be unique on the LAN<br />
	static byte mymac[] = { 0x42,0x31,0x42,0x21,0x30,0x31 };</p>
<p>// 1) Set this to the domain name of your hosted emoncms - leave blank if posting to IP address<br />
	char website[] PROGMEM = &quot;emoncms.org&quot;;</p>
<p>// or if your posting to a static IP server:<br />
	static byte hisip[] = { 192,168,1,10 };</p>
<p>// change to true if you would like the sketch to use hisip<br />
	boolean use_hisip = false;&nbsp;</p>
<p>// 2) If your emoncms install is in a subdirectory add details here i.e &quot;/emoncms3&quot;<br />
	char basedir[] = &quot;/emoncms-master&quot;;</p>
<p>// 3) Set to your account write apikey<br />
	char apikey[] = &quot;###&quot;;</p>
<p>//IP address of remote sever, only needed when posting to a server that has not got a dns domain name (staticIP e.g local server)<br />
	byte Ethernet::buffer[700];<br />
	static uint32_t timer;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10886"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 04/04/2013 - 00:40.</div>
    <div class="content">
     <p><em>&quot;I&#39;ve tried interrogating my Netgear router ... </em>&quot;&nbsp; Well, if you&#39;re asking DNS what the IP address of emoncms.org is, it will give you that address. It&#39;s a bit like asking the way to Sainsbury&#39;s when you want to go to the Co-Op!<br />
	(When you get time, it might be a good idea to read up on what DNS does.)</p>
<p>Here is your problem:</p>
<p><em>// 1) Set this to the domain name of your hosted emoncms - leave blank if posting to IP address<br />
	char website[] PROGMEM = &quot;<strong>emoncms.org</strong>&quot;;</em></p>
<p>That is the <em><strong>website</strong></em> emoncms.org hosted by OEM, and use_hisip is false so it is going there. What you should be looking for is the IP address of the machine that is your local server that your <strong><em>local program</em></strong> emoncms is running on.</p>
<p>I don&#39;t have your set-up, however 192,168,1,10 looks as if it could be correct, so you need to set use_hisip to true and tell your router to always use that IP for the server - that&#39;s what a static IP address means (the machine is identified to the router by its MAC). Your APIkey of course needs to the one you see when you create an account and log in to emoncms on your local server.</p>
<p>When you do that, the Nanode should report something like:</p>
<p>[webClient]<br />
	DHCP status: 1<br />
	IP:&nbsp; 192.168.0.11<br />
	GW:&nbsp; 192.168.0.1<br />
	DNS: 8.8.8.8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;===== (not sure it will report these - you&#39;re not interested anyway<br />
	DNS status: 1&nbsp;&nbsp;&nbsp;&nbsp; &lt;===== as you&#39;re not using DNS)<br />
	<strong>SRV: 192.168.1.10</strong></p>
<p>and with a bit of luck, values might appear in emoncms.</p>
<p>It&#39;s too late now - if I get time tomorrow afternoon, I&#39;ll set up a NanodeRF to work into my Wampserver and check that all that is correct.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10892"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Thu, 04/04/2013 - 09:32.</div>
    <div class="content">
     <p>Not sure if this has been covered but are you using the static IP Nanode example to post to you local server?</p>
<p><a href="https://github.com/openenergymonitor/NanodeRF/tree/master/NanodeRF_multinode_static_IP" title="https://github.com/openenergymonitor/NanodeRF/tree/master/NanodeRF_multinode_static_IP">https://github.com/openenergymonitor/NanodeRF/tree/master/NanodeRF_multi...</a></p>
<p>you will need to change the lines:</p>
<p>static byte hisip[] = { 213,138,101,177};&nbsp;</p>
<p>static byte myip[] = { 192,168,1,200 };&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //NanodeRF static IP address - not needed if using DHCP<br />
	static byte gwip[] = { 192,168,1,254 };&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // gateway ip address - not needed if using DHCP</p>
<p>to which from the posts above are the details of your local network</p>
<p>static byte hisip[] = { 192,168,1,10};<br />
	static byte myip[] = { 192,168,0,11 };&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //NanodeRF static IP address - not needed if using DHCP<br />
	static byte gwip[] = { 192,168,0,1 };&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // gateway ip address - not needed if using DHCP</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10894"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="canary50&#039;s picture" title="canary50&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by canary50 (not verified) on Thu, 04/04/2013 - 10:25.</div>
    <div class="content">
     <p>thanks, been using multinode so switched over to multinode static, changed lines as suggested but stil no joy.</p>
<p>Serial monitor output</p>
<p>[webClient]<br />
	IP:&nbsp; 192.168.0.11<br />
	Gateway:&nbsp; 192.168.0.1<br />
	Server: 192.168.1.10<br />
	Data sent: emoncms-master/api/post.json?apikey=###&amp;json={rf_fail:1}</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10896"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Thu, 04/04/2013 - 10:35.</div>
    <div class="content">
     <p>Does the line&nbsp;emoncms-master/api/post.json?apikey=###&amp;json={rf_fail:1} work if you place it in your web browser manually?</p>
<p>Does it return an ok?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10910"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Fri, 05/04/2013 - 00:59.</div>
    <div class="content">
     <p>I&#39;ve just downloaded a fresh copy of emoncms and re-installed on my Wampserver, and with that and these settings at the top of an otherwise &quot;as downloaded&quot; copy of NanodeRF_multinode_static_IP.ino it&#39;s all working for me.</p>
<pre>
static byte mymac[] = { 0x42,0x31,0x42,0x21,0x30,0x31 };
char website[] PROGMEM = &quot;&quot;;
boolean use_hisip = true; 
static byte hisip[] = { 192,168,1,64};    // IP of Machine on which Wampserver is running
static server IP (hisip)
boolean use_staticIP = true; 
static byte myip[] = { 192,168,1,66 };    //NanodeRF static IP address - not needed if using DHCP
static byte gwip[] = { 192,168,1,254 };   // gateway ip address - not needed if using DHCP
char basedir[] = &quot;/emoncms-dev&quot;;</pre><p>(I had been getting no response out of Wampserver, despite the requests successfully reaching index.php).</p>
<p>Have you looked at your Apache access log and error log?&nbsp; In the access log, if Apache is receiving the requests (i.e. they are reaching your server) you should see lines like:</p>
<pre>
192.168.1.66 - - [05/Apr/2013:01:43:16 +0100] &quot;GET /emoncms-dev/input/post?
apikey=deadbeef12345678900987654321feeda&amp;node=10&amp;csv=2,39,-1,39,0,37 HTTP/1.0&quot; 200 2</pre><p>Of course, there shouldn&#39;t be anything in the error log. If there is anything relevant in there, it might be a good clue.<br />
	&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10915"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="canary50&#039;s picture" title="canary50&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by canary50 (not verified) on Fri, 05/04/2013 - 07:50.</div>
    <div class="content">
     <p>OK, I&#39;ll try all of that and let you know. Thanks again for the guidance.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-11477"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3620.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="IanL&#039;s picture" title="IanL&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by <a href="../user/3620.html" title="View user profile.">IanL</a> on Fri, 19/04/2013 - 19:57.</div>
    <div class="content">
     <p>At the risk of confusing the thread, I need to go back to the starting discussion.&nbsp; (Apologies if this is the wrong way to approach a thread that has moved on from the original subject.)</p>
<p>My problem is described accurately by the original poster, I cannot get time on the GLCD.</p>
<p>Robert&#39;s first post in this thread asks:</p>
<blockquote><p>&quot;The time comes from the server that is running emoncms. Is your NanodeRF receiving the time? Every minute, the NanodeRF sends a request and the server responds with &quot;t13,05,39&quot; (the time in hh,mm,ss). It prints this to the Serial Monitor. Is that happening?&quot;</p>
</blockquote>
<p>In my case, the answer is no.&nbsp; The output from serial monitor is:</p>
<p>NanodeRF_multinode_bulksend<br />
	My IP: 192.168.1.78<br />
	GW IP: 192.168.1.254<br />
	DNS IP: 192.168.1.254<br />
	Server: 213.138.101.177<br />
	NO DATA<br />
	SENDING: 5 [[0,10,371,-10,0,24055],[0,20,2400],[5,10,368,-9,2,24006],[10,20,2400],[11,10,364,-4,3,23961]]ok</p>
<p>...etc...&nbsp; But I can get the &quot;t19,08,00&quot; response if I enter the time request by hand, as kindly described above.&nbsp; Data are getting to emoncms.org and I can graph these on Dashboard.&nbsp; It&#39;s the NO DATA that is foxing me.</p>
<p>Today I&#39;ve reloaded all the latest relevant sketches I can find and made minimal changes to them, to try and nail the problem.&nbsp; The Nanode changes are:</p>
<p>#define MYNODE 15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
	#define freq RF12_868MHZ&nbsp;&nbsp;&nbsp;&nbsp; // frequency<br />
	#define group 210&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // network group<br />
	- and the apikey, of course.</p>
<p>The NanodeRF node ID in the GLCD code is no doubt another problem that I shall have to attack later, if I get this sorted.&nbsp; I&#39;ll be grateful for any thoughts.</p>
<p>Ian.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-11481"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Fri, 19/04/2013 - 21:49.</div>
    <div class="content">
     <p>That sketch has no code in it to receive and forward the time that comes back from emoncms.</p>
<p>You should have more success with NanodeRF_multinode.</p>
<p>[Edit] Having looked harder at the sketch, it would appear that this is because of memory issues.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-11484"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3620.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="IanL&#039;s picture" title="IanL&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Resolved - EmonGLCD time not received</h3>

    <div class="submitted">Submitted by <a href="../user/3620.html" title="View user profile.">IanL</a> on Sat, 20/04/2013 - 05:49.</div>
    <div class="content">
     <p>Robert: thank you, that had been causing me much headscratching.&nbsp; The time is now set and all is well.</p>
<p>Sorry Trystan, I&#39;m not going to be able to reduce the load on your servers.&nbsp; The lack of available memory appears to be a major frustration in many threads here.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/2176"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-rq6Wk3VFLN8ARBfRmmp3bcVFD8FeKsKl4nYppH0xm2o" value="form-rq6Wk3VFLN8ARBfRmmp3bcVFD8FeKsKl4nYppH0xm2o"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/2176 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:38:39 GMT -->
</html>
