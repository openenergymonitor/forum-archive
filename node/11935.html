<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11935 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:12:05 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>EMONTX V3.4 Extra ADC Pin use? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">EMONTX V3.4 Extra ADC Pin use?</h3>
        <span class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Mon, 04/01/2016 - 23:04</span>
        <div class="content"><p>I have an EMONTX&nbsp;V3.4 that is permanently plugged in via the mains adapter. It&nbsp;is connected to 4 x CT&#39;s and 3 x 1Wire Sensors.</p>
<p>I would like to add an anemometer to the EMONTX that gives out a 0-5V signal proportional to the wind speed, and then piggy back the value onto the RFM69 output of the EMONTX</p>
<p>Looking at the circuit diagram ADC7 is used as a battery monitor which will never be used in my setup, however it seems intimately involved with the USB port. Additionally and perhaps more convenient ADC6 is used to turn the 1Wire Bus off in&nbsp;between readings when working on battery and is available on the terminal block at the back. My 1Wire sensors&nbsp;can be changed onto&nbsp;the 3.3V permanent line so this isn&#39;t used.</p>
<p>Is there any issue with using any of these pins providing I modify the sketch accordingly? Can anyone suggest a better way?</p>
<p>I&#39;ll divide the 5V signal to fit in with the EMONTX working on 3.3V using 2 x 470K resistors as used in the battery monitor circuit</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11839.html" class="topic-previous" title="Go to previous forum topic">‹ Use Socket Interfacer on EmonPi</a>
              <a href="11968.html" class="topic-next" title="Go to next forum topic">AC measurement  ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-37879"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EMONTX V3.4 Extra ADC Pin use?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 04/01/2016 - 23:59.</div>
    <div class="content">
     <p>270 k&Omega; + 470 k&Omega; would match your anemometer to the 3.3 V input range somewhat better. Personally, I'd go for A6 and use the RJ45 connector, as you say this has already got an unswitched 3.3 V on it anyway for your temperature sensors, so you can do everything outboard of the RJ45 and avoid surgery on the emonTx.</p>
<p>After you've looked after the I/O pins, I think all that you've got to watch out for is possible self-heating of the temperature sensors.</p>
<p>And of course you'll need to reconfigure emonHub and emoncms.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37880"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EMONTX V3.4 Extra ADC Pin use?</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Tue, 05/01/2016 - 01:13.</div>
    <div class="content">
     <p>Robert,</p>
<p>thanks for the reply, I will order the anemometer, wire it all up and report back. I don&#39;t expect self heating to be a big issue as sensor one sits in spa water at 37.6 degrees, and Sensors 2 &amp; 3 are under polysytrene insulation around the hot water cylinder, so usually sit somewhere in the 60-70 degree region.&nbsp;My guess is with all of them that the thing I&#39;m measuring will make any self heating barely noticeable if I can see it at all. I&#39;ll keep an eye out though for any changes when I move the power source.</p>
<p>Now you&#39;ve got me wondering if my other sensors connected to a USB adapter plugged into the Pi have any self heating...</p>
<p>Cheers</p>
<p>Kevin</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37883"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EMONTX V3.4 Extra ADC Pin use?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 05/01/2016 - 01:39.</div>
    <div class="content">
     <p>I did some tests on the sensor on an emonGLCD quite some time ago now, at room temperature. I think there's a post somewhere with the results. </p>
<p>Amazing (both my memory and the search!) Here: <a href="2484.html" title="http://openenergymonitor.org/emon/node/2484">http://openenergymonitor.org/emon/node/2484</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37884"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EMONTX V3.4 Extra ADC Pin use?</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Tue, 05/01/2016 - 02:22.</div>
    <div class="content">
     <p>Thanks for the link, very interesting, I may do some experiments with my 2 spare 5V connected sensors which are hanging in the garage awaiting a better use. So far I have only one sensor in air that is permanently powered, and that is a metal type sat under my deck measuring outside temperature. I have suspected it over&nbsp;reads when there isn&#39;t any air movement as one directly above it that is covered in black heatshrink and cable tied to my swimming pool heating pipe often reads lower after dark, suggesting that above the edge of the&nbsp;deck is colder than just&nbsp;below it. It may be that there is some odd thermo syphoning water movement that I don&#39;t know about but as the feed valve from the pool is closed and I have the odd air leak its likely that the pipe slowly drains down when its turned off.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38158"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EMONTX V3.4 Extra ADC Pin use?</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Mon, 11/01/2016 - 21:46.</div>
    <div class="content">
     <p>I&#39;ve bought this anemometer http://www.dfrobot.com/wiki/index.php/Wind_Speed_Sensor_Voltage_Type(0-5V)_SKU:SEN0170 and connected it to the RJ45 Power Pin, with the sensors already being on the 3.3V Power Pin. I&#39;ve also commented out the relevant lines in the sketch that energises the pin. To get a reading I&#39;ve added to the sketch int WIND=analogRead(A6); float ActualWind = WIND * (52747.2 / 480810); emontx.Wind=ActualWind; The maths is a simplified version of: 3.6 x (6 x (((5 / 740) x 470) / 1023)) and gives the result in KMh instead of its standard M/S, and it allows for the voltage divider. To get it into OPENHAB from the MQTT output by the EMONPI version of EMONHUB I added: Number LocalWindSpeed { mqtt=&quot;&lt;[mymosquitto:emonhub/rx/10/values:state:REGEX(.*?,.*?,.*?,.*?,.*?,.*?,.*?,.*?,.*?,.*?,(.*?),.*)]&quot; }</p>
<p>It all seems to work well, thanks again&nbsp;for your help!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11935"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-A7rniaZq3ob3OrCtReygPLX5HsihJmL8B0CAXrEpq_w" value="form-A7rniaZq3ob3OrCtReygPLX5HsihJmL8B0CAXrEpq_w"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
