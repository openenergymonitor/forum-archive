<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/10934 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:43:48 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>V8.6 - 9.x (extended) Development | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">V8.6 - 9.x (extended) Development</h3>
        <span class="submitted">Submitted by <a href="../user/3695.html" title="View user profile.">chaveiro</a> on Fri, 03/07/2015 - 19:43</span>
        <div class="content"><p>Ok i&#39;m lazy to look for info! :)</p>
<p>Seriously, what is the mindset behind lowwrite version, why you need a specific version and how it&#39;s accomplished?</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11069.html" class="topic-previous" title="Go to previous forum topic">‹ emonTxV3_4_3Phase_Voltage V.4 with RFM12B does not compile</a>
              <a href="11071.html" class="topic-next" title="Go to next forum topic">[SOLVED] Data Folders on Shared server? ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-31901"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sat, 04/07/2015 - 10:14.</div>
    <div class="content">
     <p>I think Trystan is by far the best guy to answer this in full, but IMO&nbsp;to answer your Q&#39;s</p>
<blockquote><p><em>&quot;what is the mindset behind lowwrite version?&quot;</em></p>
</blockquote>
<p>To reduce wear and possibility of failure when&nbsp;running on an SDcard.</p>
<blockquote><p>&quot;​<em>why you need a specific version?&quot;</em></p>
</blockquote>
<p>I like to think we don&#39;t, we just need a&nbsp;&quot;low-write&quot; mode of operation, which can be enabled/disabled&nbsp;in the settings.</p>
<blockquote><p><em>&quot;how it&#39;s accomplished?&quot;</em></p>
</blockquote>
<p>The OS is mounted read-only and the data&nbsp;files&nbsp;etc are moved to another partition which is mounted RW without Journaling.</p>
<p>The data being processed by emonCMS is held in RAM and only written to disc&nbsp;every minute&nbsp;in efficient block sizes.</p>
<p>Data can only be appended to the data feeds and not overwritten</p>
<p>All editing of historical data is disabled.</p>
<p>All write intensive processes are removed.</p>
<p>Use of SQL is reduced&nbsp;to settings only</p>
<p>SQL based feeds are not used&nbsp;</p>
<p>Last updated at and last value are not recorded in SQL tables</p>
<p>This is from memory so forgive any omissions/errors but I think I got most of the main items. The &quot;buffered-writing&quot; is managed by a <a href="https://github.com/emoncms/emoncms/tree/low-write/run">&quot;feedwriter&quot;</a> service and you can get more info on the <a href="https://github.com/openenergymonitor/documentation/blob/master/BuildingBlocks/TimeSeries/writeloadinvestigation.md">low-write research here</a>.</p>
<p>&nbsp;</p>
<p>This is all relates directly to &quot;low-write&quot; functionality but doesn&#39;t reflect all of the differences found in the &quot;low-write&quot; version&nbsp;as&nbsp;there is also a lot of new functionality and changes to the input/node modules etc that is specific to the current low-write &quot;version&quot; of emoncms but isn&#39;t &quot;low-write&quot; specific, if that makes sense.</p>
<p>Paul</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31913"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Sat, 04/07/2015 - 20:30.</div>
    <div class="content">
     <p>Also The log files and temp files are moved to&nbsp;a ramdisk further limiting writes to the SD Card. Memory swapfile&nbsp;is disabled too IIRC. as is the last accessed time for read files.&nbsp;The read only file system means there is less likely to be corruption of the OS if there is a power failure.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31915"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3695.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="chaveiro&#039;s picture" title="chaveiro&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3695.html" title="View user profile.">chaveiro</a> on Sat, 04/07/2015 - 20:43.</div>
    <div class="content">
     <p>Write only filesystem is a config of the os.</p>
<p>So lowrite version is a full linux image or just emoncms?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31916"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7997.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sheppy&#039;s picture" title="sheppy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/7997.html" title="View user profile.">sheppy</a> on Sat, 04/07/2015 - 20:46.</div>
    <div class="content">
     <p>I think it&#39;s a separate branch of the main project on GITHUB.</p>
<p>Does anyone know if it&#39;s possible to add in bits of the extended branch to it without breaking the low write part?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31917"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sat, 04/07/2015 - 21:31.</div>
    <div class="content">
     <p>Yes, read-only is the OS, the original &quot;rock-solid gateway&quot; was a forwarding only SDcard image consisting of the OEM gateway (emonhub&#39;s predecessor) installed to IPE-R1, a custom read-only OS based heavily on raspbian,&nbsp;buffering and forwarding data to a remote emoncms, usually emoncms.org.</p>
<p>​The &quot;rock-solid gateway&quot; was very stable and reliable because of the resilience&nbsp;of a read-only file system, but IPE-R1 got out of date and started causing problems when updating and had little or no support.</p>
<p>So emonHub running on a stock Raspbian&nbsp;lightly modded to mount read-only replaced the &quot;rock-solid gateway&quot; and emoncms&nbsp;low-write was included but dormant, on the new SDcard image for those who wished to enable it.</p>
<p>The read-only is more about safeguarding the filesystem&nbsp;against accidental writes and corrupt settings etc but every little helps, it works for low-write too, if&nbsp;it is read only the log and temp file writing is reduced. aside from incidental write reductions I don&#39;t think there is a major need for read only to provide low-write.&nbsp;</p>
<p>The low-write emoncms is indeed a separate&nbsp;branch which is why&nbsp;this thread and other recent discussions are exploring the possibility of &quot;merging&quot; them. And hopefully that will encourage development of both strains of emoncms on a common path&nbsp;where possible, but currently most of the stuff that isn&#39;t in the low-write isn&#39;t there for&nbsp;a reason eg heavy dependence on SQL is probably the most common reason for exclusion.</p>
<p>&quot;Low-write&quot; has to be a total mindset&nbsp;to develop emoncms to run reliably on an SDcard&nbsp;so must work efficiently with the OS and other softwares, so while technically it is specifically the emoncms version, It demands a low-write&nbsp;environment too,</p>
<p>Another side product of the read-only image is it forces us to put ALL the files that must be written to and persisted on a RW partition which could suit easy back-up and restore routines by separating&nbsp;file&nbsp;system and user files.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31921"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3695.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="chaveiro&#039;s picture" title="chaveiro&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3695.html" title="View user profile.">chaveiro</a> on Sun, 05/07/2015 - 13:39.</div>
    <div class="content">
     <p>So i downloaded last github 8.5 and last low-write branches and did a file by file compare.</p>
<p>Last 8.5.2 XT is compatible with 8.5 standard, so the comparison applies to it also.</p>
<p>Here is the comparison and what need to be done, really just 3 file in red must be careful analyzed, orange just a merge and&nbsp; green just copied :</p>
<p><a href="https://docs.google.com/spreadsheets/d/1Pt4W4z3BQM5ipIqvVTtlAEEV13P41ucYsFPnlI2Ff1A/edit?usp=sharing" title="https://docs.google.com/spreadsheets/d/1Pt4W4z3BQM5ipIqvVTtlAEEV13P41ucYsFPnlI2Ff1A/edit?usp=sharing">https://docs.google.com/spreadsheets/d/1Pt4W4z3BQM5ipIqvVTtlAEEV13P41ucY...</a></p>
<p>My conclusions:</p>
<ul>
<li>Low-write is pre-8.5 version, misses timezone fix and many other fixes and neat features like touch support and ui enhancements</li>
<li>Lot of removed stuff that really would not hurt if kept, because they dont do writing, like visualization elements</li>
<li>Does indeed buffered writing to&nbsp;PHPTIMESERIES and PHPFINA only</li>
<li>Redis is not optional because of it caching need to not use mysql besides configuration</li>
<li>Adds view of logs in admin module</li>
</ul>
<p>My propose is to ditch all version of emoncms to date, add the suggested requirements to 8.5.2 xt and make a universal version for all with buffered writing being a configuration flag.</p>
<p>I can help doing the changes but cant test as i dont have redis on my shared server.</p>
<p>Let me hear from who wants to help.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31927"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Sun, 05/07/2015 - 09:06.</div>
    <div class="content">
     <p>Although I have very limited programming skills, I do have a Raspberry Pi with Redis running, and could&nbsp;help with&nbsp;testing.</p>
<p>It would be reassuring however at this stage to get some feedback from Trystan &amp; Glyn, to establish if this fits into their development plan, and&nbsp;gets their support.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31928"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sun, 05/07/2015 - 09:22.</div>
    <div class="content">
     <p>That&#39;s interesting ! and I think everyone would benefit from a single emoncms&nbsp;so I&#39;m happy to help it I can, If I could code PHP I would of probably tried this myself by now but we don&#39;t need another version that&#39;s for sure.</p>
<p>It would seem that aside from a few&nbsp;user settings to set minor preferences, we could really boil this down to 2 main settings &quot;disable_redis&quot; and &quot;disable_sql&quot; to give us 3 options.</p>
<p>&quot;Full&quot; which uses both&nbsp;redis and sql,</p>
<p>&quot;Redis only&quot; AKA &quot;low-write&quot; for which redis&nbsp;is mandatory and SQL (logging) is not an option</p>
<p>&quot;SQL only&quot; for &quot;shared hosting or windows&quot; for which SQL is mandatory and redis is not an option</p>
<p>These 2 flags could allow/prohibit the running of the feedwriter and installation redis as well as control the availability of sql as a data logging engine.</p>
<p>I&#39;m happy to set up a RPi to initially&nbsp;test the XT&nbsp;branch on a Pi, although some write activity tests &amp;&nbsp;comparisons will be needed too as it&#39;s not just about if it works but about minimizing the writes too.</p>
<p>I know Paul Reed is using your XT version currently, installed to a RPi running a HDD (so redis will be active&nbsp;I believe) and he is very active at testing and reporting errors, so all 3 scenarios could be covered (assuming your hosted version ports to windows ok)</p>
<p>It maybe a little premature to say&nbsp;&quot;ditch all emoncms versions&quot; especially as T &amp; G&nbsp;have&nbsp;emoncms.org to manage, but it would be great if we could reach a single unified emoncms, hopefully they&nbsp;will be on board&nbsp;</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31946"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3695.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="chaveiro&#039;s picture" title="chaveiro&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3695.html" title="View user profile.">chaveiro</a> on Sun, 05/07/2015 - 14:04.</div>
    <div class="content">
     <p>Thanks pb66 and Paul you are very helpful.</p>
<p>Paul i agree with you:</p>
<p><strong>Trystan &amp; Glyn can you kindly share your thoughts?</strong></p>
<p>&nbsp;</p>
<p>pb66: I think a single flag $low-write= true/false is really what&#39;s needed, the rest is assured with some code verification routines.</p>
<p>Low-write besides the buffered writing when a input value is received&nbsp; works just like 8.5+ with redis active.<br />
So just need to ensure if low-write is true, redis is mandatory with some code check routine.</p>
<p>On 8.5.2 xt we have the option to disable engines individually via config, A code change to force low-write flag to disable unsupported engines (without erasing files) is just what&#39;s needed.</p>
<p>No change was made in 8.5-to latest xt that could break windows compatibility so it must be working fine.<br />
The low-write daemon that does the buffered writing can be a scheduled task in windows polling at fixed intervals. But there are no windows platforms like raspberry pi with sd cards targeted to emon, right?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31958"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 09/07/2015 - 16:13.</div>
    <div class="content">
     <p>I didn&#39;t suspect the windows port was broken or anything, I was just categorizing&nbsp;windows servers with the shared hosting linux servers as they cannot depend on redis. I&#39;m a&nbsp;little confused as to what you mean by only needing one setting when there are clearly 3 different&nbsp;senario&#39;s,&nbsp;Are you saying redis&nbsp;support in emoncms is determined automatically or that it will be&nbsp;permanently&nbsp;enabled or that it will only come into play with the low-write option?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31976"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3695.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="chaveiro&#039;s picture" title="chaveiro&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3695.html" title="View user profile.">chaveiro</a> on Mon, 06/07/2015 - 11:50.</div>
    <div class="content">
     <p>Yes, just do some checks in code for the correct configuration settings like this:<br />
If low-write mode is set and redis is not set in config, a config error is given back asking to review the config and set redis because it&#39;s required for this mode.<br />
If low-write mode is not set, redis config can be any value.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32088"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 09/07/2015 - 22:30.</div>
    <div class="content">
     <p>Shameless bump!!</p>
<p>I would of thought a single version of emoncms&nbsp;with selectable modes and features would of been in the&nbsp;interest of all concerned, users, devs&nbsp;and support, no ???&nbsp;</p>
<p>With one variant &amp; 3 modes of operation, it would facilitate running a stable (master) and cutting edge (development)&nbsp;versions without complication while providing&nbsp;a consistent and tested route to upgrading.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32098"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Fri, 10/07/2015 - 11:32.</div>
    <div class="content">
     <p>Hello, sorry to miss this thread, thanks Paul for the heads up!</p>
<p>As far as the low-write functionality is concerned, ideally there should not be two separate implementations as lowering the disk write load would be very useful across all platforms for longevity of SD cards, SSD&#39;s and spinning harddrives, certainly it would be great for emoncms.org too.</p>
<p>However the implementation needs more work and there are other differences that are also design decisions in a particular direction for other reasons that mean its not as simple as finding a way to merge them as a large part of it is a question of the direction of travel of emoncms and what we try and support - at least in the core install.</p>
<p>Here&#39;s a list of the main differences between the low-write branch and v8.5 branch:</p>
<table border="1" cellpadding="1" cellspacing="1" style="width: 100%;">
<tbody>
<tr>
<td style="width: 50%;">
<p><strong>Low-write</strong></p>
</td>
<td><strong>v8.5</strong></td>
</tr>
<tr>
<td style="vertical-align: top;">
<p><strong>Input processors</strong></p>
<p>Log to feed<br />
			Wh accumulator<br />
			Publish to MQTT<br />
			x<br />
			+<br />
			Power to kWh<br />
			kWh to power<br />
			x input<br />
			+ input<br />
			/ input<br />
			- input<br />
			Accumulator<br />
			Rate of change<br />
			Signed to unsigned<br />
			Reset to zero<br />
			Total pulse count to pulse increment<br />
			Allow positive<br />
			Allow negative<br />
			+ feed<br />
			- feed<br />
			* feed<br />
			/ feed</p>
</td>
<td>
<p><strong>Input processors</strong></p>
<p>Log to feed<br />
			Wh accumulator<br />
			Publish to MQTT<br />
			x<br />
			+<br />
			Power to kWh<br />
			kWh to Power<br />
			x input<br />
			+ input<br />
			/ input<br />
			- input<br />
			Accumulator<br />
			Rate of change<br />
			Signed to unsigned<br />
			Reset to zero<br />
			Total pulse count to pulse increment<br />
			Allow positive<br />
			Allow negative<br />
			+ feed<br />
			- feed<br />
			* feed<br />
			/ feed</p>
<p><strong>Daily processors:</strong><br />
			Input on-time<br />
			Wh incremements to kWh/d<br />
			kWh to kWh/d (deleted)<br />
			Daily average<br />
			Power gained to Kwh/d (deleted)<br />
			kWh to&nbsp; kWh/d<br />
			Max value<br />
			Min value<br />
			Power to kWh/d</p>
<p><strong>Other</strong><br />
			Phaseshift (deleted)<br />
			Histogram<br />
			Heat flux<br />
			update feed @time</p>
</td>
</tr>
<tr>
<td style="vertical-align: top;">
<p><strong>Feed engines</strong><br />
			PHPFina<br />
			PHPTimeseries</p>
<p>Implements buffered writing using redis (append only)</p>
</td>
<td>
<p><strong>Feed engines</strong><br />
			PHPFina<br />
			PHPTimeSeries<br />
			PHPFiwa<br />
			Histogram (uses mysql)</p>
<p>Writes directly &ndash; no buffered writing.</p>
</td>
</tr>
<tr>
<td style="vertical-align: top;">
<p><strong>Visualisations</strong></p>
<p>Realtime<br />
			rawdata<br />
			bargraph<br />
			graph<br />
			multigraph</p>
</td>
<td>
<p><strong>Visualisations</strong></p>
<p>Realtime<br />
			rawdata<br />
			bargraph<br />
			graph<br />
			multigraph</p>
<p>smoothie<br />
			compare</p>
<p><strong>Visualisations that require ability to update</strong><br />
			edit realtime<br />
			edit daily</p>
<p><strong>Visualisation&#39;s not yet adapted to use accumulating watt-hours for daily data:</strong><br />
			zoom<br />
			stacked<br />
			stackedsolar<br />
			simplezoom<br />
			orderbars</p>
<p><strong>Visualisations that require histogram engine</strong><br />
			threshold<br />
			orderthreshold<br />
			histgraph</p>
</td>
</tr>
<tr>
<td>Redis required &ndash; simplifed code</td>
<td>Redis optional - requires a lot of extra code to handle both cases.</td>
</tr>
</tbody>
</table>
<p>As Paul Burnell mentioned the low write version with the way the buffering is implemented (at present) means that data can only be appended not updated. You also have to wait until the data is written before it becomes available to view on the graphs.</p>
<p>Ideally the implementation would be extended to include the ability to update datapoints and have data request method that can access data across the ram buffer and physical disk seamlessly. That would then allow for longer buffer times maybe up to 5-15mins which would further reduce the write load.</p>
<p><strong>Daily datatypes</strong></p>
<p>Daily datatypes are not necessarily needed as the same result can be achieved with accumulating watt-hour feeds with additional benefits such as timezone flexibility, ability to query at any interval: hourly, monthly etc. Supporting all the different input processors and visualisations for both approaches adds quite a bit of additional work,</p>
<p><strong>Histogram and phpfiwa</strong></p>
<p>It would be great to get histogram functionality back in the low-write branch but the current implementation is not write efficient. A significant improvement could be gained by moving histogram creation to a post-processing implementation, rather than compute the update to the histogram on each new datapoint as its received it could be possible to instead manually run the histogram process when you need to view the histogram data at which point it would build the histogram up from the last point in a batch process writing in larger blocks.</p>
<p>Calculating the average layers for PHPFiwa could also be a post-processing stage rather than repeatedly updating datapoints in each layer as data is received.</p>
<p>If anyone is keen to look at any of these things that would be great! and Id be happy to give input. Im working on a <a href="http://github.com/emoncms/MyHomeEnergyPlanner">retrofit modeling tool for Carbon Coop</a> at the moment so im pausing on core emoncms development for a bit and will be focusing more of my development on the mysolar/myelectric app side of things in the short term.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32101"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Fri, 10/07/2015 - 12:54.</div>
    <div class="content">
     <p>@Trystan, did you see the&nbsp;&nbsp;<a href="10888.html">Node to Feed mapping - idea to save space</a>&nbsp;thread also, here chaveiro&nbsp;suggests a virtual feed concept for v8.5xt which could work very well with the &quot;buffered write&quot; concept. Aside from working towards aligning the variants it could also reduce the need for persisting every feed at input time and eliminate any needless feeds currently persisted purely to provide stepping stones in&nbsp;calculations or a realtime value that has no historical value.</p>
<p>Perhaps we should look at redis alternatives&nbsp;rather than ploughing too much into something that isn&#39;t widely available on shared hosting or&nbsp;<span style="line-height: 20.7999992370605px;">windows compatible, (especially with windows 10 for raspberry pi on the horizon ?)</span></p>
<p><span style="line-height: 20.7999992370605px;">A home brew or better fitting solution might make it easier to implement across all platforms (including RO OS&#39;s) and&nbsp;overcome the delayed graphing (and potentially datapoint editing)&nbsp;in low-write too.</span></p>
<p><span style="line-height: 20.7999992370605px;">Paul</span></p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32102"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Fri, 10/07/2015 - 13:38.</div>
    <div class="content">
     <p>Thanks Paul, I think it may be easier now to install redis on windows but then that doesnt solve the shared hosting issue.</p>
<p>Redis on windows:<br />
<a href="http://stackoverflow.com/questions/6476945/how-do-i-run-redis-on-windows" title="http://stackoverflow.com/questions/6476945/how-do-i-run-redis-on-windows">http://stackoverflow.com/questions/6476945/how-do-i-run-redis-on-windows</a></p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32103"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Fri, 10/07/2015 - 14:09.</div>
    <div class="content">
     <p>Nor<span style="line-height: 20.7999992370605px;">&nbsp;</span><span style="line-height: 20.7999992370605px;">unfortunately,</span><span style="line-height: 1.6;">&nbsp;with the bigger issue of bridging the gap between the most recent&nbsp;datapoints&nbsp;(held in&nbsp;RAM by&nbsp;redis)&nbsp;and the last &quot;buffered-write&quot; (saved as feeds&nbsp;on disc)&nbsp;for seamless graphing, </span>datapoint<span style="line-height: 1.6;">&nbsp;</span><span style="line-height: 1.6;">e</span><span style="line-height: 1.6;">diting and calculations</span><span style="line-height: 1.6;">&nbsp;etc.</span></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32105"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Fri, 10/07/2015 - 16:19.</div>
    <div class="content">
     <p>Led by the table above I&nbsp;just updated my emonPi&nbsp;and still only have 13 of the 22 listed input processors&nbsp;</p>
<p><img alt="" src="../sites/default/files/processes_0.png" style="width: 282px; height: 393px;" /></p>
<p>So I assume they are work in progress and can be implemented quite easily maybe? We seem to be&nbsp;missing</p>
<p>Publish to MQTT&nbsp; &nbsp;(requested in the&nbsp;<a href="10951.html">Publish to MQTT with vlow write image?</a> thread)&nbsp;<br />
kWh to power<br />
Rate of change<br />
Signed to unsigned<br />
Total pulse count to pulse increment<br />
+ feed<br />
- feed<br />
* feed<br />
/ feed</p>
<p>Replacing PHPfiwa average layers with post-processing averaging would be good,&nbsp;removing&nbsp;the need for separate&nbsp;PHPfiwa/na feed engines&nbsp;and providing&nbsp;data to replace all daily totals/min/max/average processes and the&nbsp;resulting feeds&nbsp;with hourly, daily, weekly, monthly and annual calculations on the fly would be a great improvement, more versatile, less writes and&nbsp;accurately based on the latest data (including any subsequent edits to the underlying data). And say goodbye to the timezone issues too (hopefully).</p>
<p>Paul</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32106"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3695.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="chaveiro&#039;s picture" title="chaveiro&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3695.html" title="View user profile.">chaveiro</a> on Sat, 11/07/2015 - 03:19.</div>
    <div class="content">
     <p>Just a note: post-processing averaging is not an option because it would take too long to calculate in real time.<br />
Post processing can only be done on sampled data for the same reason.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32111"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3426.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3426.jpg" alt="Bill Thomson&#039;s picture" title="Bill Thomson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3426.html" title="View user profile.">Bill Thomson</a> on Fri, 10/07/2015 - 21:41.</div>
    <div class="content">
     <p><em>as lowering the disk write load would be very useful across all platforms for longevity of SD cards, SSD&#39;s and spinning harddrives,</em></p>
<p>I can see where a low write-load would extend the life of SD cards, SSDs and other flash memory based storage, but how does it help extend rotating media drive lifetime? I&#39;ve got hard drives that were manufactured over 10 years ago, see regular use, and still work fine.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32114"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Fri, 10/07/2015 - 22:29.</div>
    <div class="content">
     <p>I take you&#39;re point Bill, but the overall aim of the thread is to move to a single version, which would be easier to install/maintain &amp; develop.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32117"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3426.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3426.jpg" alt="Bill Thomson&#039;s picture" title="Bill Thomson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3426.html" title="View user profile.">Bill Thomson</a> on Sat, 11/07/2015 - 06:08.</div>
    <div class="content">
     <p>Hi Paul,</p>
<p>I&#39;m not advocating a separate version for HDDs, just curious as to how a low-write version is supposed to extend HDD life.</p>
<p>A single version would indeed be preferable!</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32125"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3695.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="chaveiro&#039;s picture" title="chaveiro&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3695.html" title="View user profile.">chaveiro</a> on Sat, 11/07/2015 - 20:16.</div>
    <div class="content">
     <p>Been working on 8.6 that will merge low-write option.</p>
<p>Just realized that there are 2 different buffering strategies available :</p>
<p>1 - Buffer the <strong>input </strong>raw data. Available on 8.5 at que_input_controller.php and /scripts/input_queue_processor.php<br />
2 - Buffer the <strong>feed </strong>write data. Available on low_write at feed_model.php and /run/feedwriter.php.</p>
<p>Both use redis for cache.</p>
<p>There is also code in /scripts/phpmqtt_input.php for a mqtt option to input data, but not write buffer oriented.</p>
<p>I think 2 is best because only buffers already processlist processed data, just before writing to the engine.<br />
So we can get lastvalue in cache to show in the UI in realtime.</p>
<p>
But why was implementation 1 made? What was the idea at the time?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32148"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sun, 12/07/2015 - 09:56.</div>
    <div class="content">
     <p>Shame about the &quot;post-processing averaging&quot; but it make sense.</p>
<p>The &quot;que_input_controller.phpand and /scripts/input_queue_processor.php&quot; pre-dates the &quot;low-write&quot; versions I think, combined they are an alternative &quot;input_controller.php&quot; that significantly improves the request handling rate on busy server.&nbsp;</p>
<p>The phpmqtt&nbsp;stuff is relatively recent and may not be write buffered&nbsp;as mqtt is not implemented on emoncms.org yet or maybe the input buffering is no longer used since the servers were updated ?</p>
<p>Method 2 is the low-write stuff.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32161"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Sun, 12/07/2015 - 19:57.</div>
    <div class="content">
     <p>Don&#39;t know if you&#39;ve seen the git&nbsp;readme file for the low write version <a href="https://github.com/emoncms/emoncms/tree/low-write/Modules/input">here</a>, but it gives a little information about que_input_controller.php.</p>
<p>Paul</p>
<p>(Note - thread title changed to reflect subject)</p>
<h1>que_input_controller.php</h1>
<p>You may want to use this controller instead of the default controller in very high post rate, throughput applications.</p>
<p>With this redis based input que post rate from a sequential free running post benchmark went from around 97 req/s up to 138 req/s on 4 core 2.0Ghz 8GB machine.</p>
<p>To use it just switch the controller&#39;s around. Rename que_input_controller.php to input_controller.php</p>
<p>You will also need to use the worker process which works through the queue. Which can be found in the scripts directory in the root emoncms folder.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32245"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5027.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Eric_AMANN&#039;s picture" title="Eric_AMANN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/5027.html" title="View user profile.">Eric_AMANN</a> on Wed, 15/07/2015 - 08:28.</div>
    <div class="content">
     <p>Hi all,</p>
<p>Very interesting discussion.&nbsp; I also agree that a unique version wit flags seems to be the better option.</p>
<p>I&#39;m using emoncms on a linux shared hosting. As it&#39;s not possible to enable redis on that server, I modified process_modell.php to make Wh_accumulator and kWh_to_power&nbsp;work without redis.</p>
<p>Let me know if you&#39;re interested in it.</p>
<p>Eric</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32252"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 15/07/2015 - 10:07.</div>
    <div class="content">
     <p>Yes que input controller does not do any write buffering its just there to seperate the http request stage from the processing and data writing which reduces the http request time freeing up apache instances for the next request as fast as possible. It&#39;s needed on higher post rate systems like emoncms.org.</p>
<p>I think its ok to develop different versions of emoncms for different platforms, the requirements for one might be quite different from another and making one version with code and flags for all options I find makes the code harder to read, Im more likely to make more mistakes etc. There&#39;s interesting information on developing scalable web architecture here <a href="http://aosabook.org/en/distsys.html" title="http://aosabook.org/en/distsys.html">http://aosabook.org/en/distsys.html</a></p>
<p>This is a particularly interesting chapter from our perspective with timeseries data storage being the core component <a href="http://aosabook.org/en/graphite.html" title="http://aosabook.org/en/graphite.html">http://aosabook.org/en/graphite.html</a></p>
<p>But developing for emoncms.org is quite different to the raspberrypi, maintaining for with/without redis, with/without mqtt, windows, shared etc is a lot of options.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32254"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 15/07/2015 - 10:14.</div>
    <div class="content">
     <p>One approach could be to further separate the emoncms modules from the core repository. If we take out the dashboards module and have it installed via git as is done for apps module etc then this would make it easier to use the new developments like your great improvements to the dashboards module in extended chaveiro. Ideally there needs to be a way to modularise the visualisations too and input processing...</p>
<p>ie: If you have a system without the histogram engine it makes sense to not have the historgram visualisations present</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32255"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 15/07/2015 - 10:17.</div>
    <div class="content">
     <p>It would also be convenient if it was possible to replace redis on systems without redis support with a native perhaps php shared memory redis api compatible in memory database. If at this point in index.php where redis is not available it could fall back to an alternative that could be interesting <a href="https://github.com/emoncms/emoncms/blob/v8.5/index.php#L34" title="https://github.com/emoncms/emoncms/blob/v8.5/index.php#L34">https://github.com/emoncms/emoncms/blob/v8.5/index.php#L34</a></p>
<p>That would then only require one set of code in the main modules not one for mysql mode and another for redis mode.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32307"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3695.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="chaveiro&#039;s picture" title="chaveiro&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3695.html" title="View user profile.">chaveiro</a> on Mon, 20/07/2015 - 01:25.</div>
    <div class="content">
     <p>Thanks for all answers.</p>
<blockquote><p><em>&quot;I think its ok to develop different versions of emoncms for different platforms, the requirements for one might be quite different from another and making one version with code and flags for all options I find makes the code harder to read,&quot;</em></p>
</blockquote>
<p>Here i must disagree, its proved already that a non maintained branch will freeze in time and as it is a pain to merge two branches, imagine having to merging more later. I take the opposite aproach, differences are not really that big. If code is correctly organized and good programming patterns are used, it&#39;s easy to read the code. Succinct commenting helps too.</p>
<blockquote><p><em>&quot;Ideally there needs to be a way to modularise the visualisations too and input processing...<br />
ie: If you have a system without the histogram engine it makes sense to not have the historgram visualisations present&quot;</em></p>
</blockquote>
<p>Histogram is a data type, that is tricky, maybe we can take other route with Virtual feeds and post-processing. Needs thinking. Regarding process model later we should think on making it plug in modular, the process is already a module for 6.0. Its really spaghetti code that process_model.php.</p>
<blockquote><p><em>&quot;php shared memory redis api compatible in memory database&quot;</em></p>
</blockquote>
<p>Do you have anything in mind? I added new Mysql Memory engine for 8.6, data is kept in RAM and lost on power off, but first need to make redis buffer work.</p>
<p>&nbsp;</p>
<p>Other thing, about PHPTime series, was removed from 8.5, why? And is it really useful for future emonPI ?</p>
<p>Also clarify indentation of lines 147-149 please:</p>
<p><a href="https://github.com/emoncms/emoncms/blame/low-write/Modules/feed/engine/PHPTimeSeries.php#L147" title="https://github.com/emoncms/emoncms/blame/low-write/Modules/feed/engine/PHPTimeSeries.php#L147">https://github.com/emoncms/emoncms/blame/low-write/Modules/feed/engine/P...</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32410"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7723.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-7723.jpg" alt="daturach&#039;s picture" title="daturach&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/7723.html" title="View user profile.">daturach</a> on Mon, 20/07/2015 - 17:10.</div>
    <div class="content">
     <p>Hi all</p>
<p>Sorry to come back again&nbsp;on&nbsp;that topic but&nbsp;I read the whole thread and&nbsp;I still don&#39;t know if I need to have the&nbsp;Redis&nbsp;server installed on&nbsp;shared hosting linux servers.</p>
<p>Is this option included in &quot;EmonCMS 8.6.0 Alpha 2015-07-20&quot;?</p>
<p>Thanks for your help.</p>
<p>Walter</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32411"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3695.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="chaveiro&#039;s picture" title="chaveiro&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3695.html" title="View user profile.">chaveiro</a> on Mon, 20/07/2015 - 18:47.</div>
    <div class="content">
     <p>Hi, redis is required if using&nbsp; low-write mode on 8.6 Alpha.</p>
<p>On a shared server you dont need low-write mode.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32417"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Mon, 20/07/2015 - 22:04.</div>
    <div class="content">
     <p>Chaveiro, I&#39;ve merged your dashboards module and visualisations changes (touch support etc) from the Extended branch to the v8.5 branch. Unfortunately the github diff tool is still showing many more changes than meld diff viewer is showing locally and the selective merge does not preserve the commit history, I&#39;d like to preserve your authorship record. Do you know of a better way to do it? and do you have any ideas how we might sort the github diff issue?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32430"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Tue, 21/07/2015 - 11:32.</div>
    <div class="content">
     <p>There&#39;s a php shared memory database here <a href="https://github.com/adammbalogh/key-value-store-shared-memory" title="https://github.com/adammbalogh/key-value-store-shared-memory">https://github.com/adammbalogh/key-value-store-shared-memory</a> but I imagine it might be quite a bit of work to replicate the redis api with it, and I dont know enough about php shared memory to know if there would be issues around security of the data on shared servers.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32431"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Tue, 21/07/2015 - 11:35.</div>
    <div class="content">
     <p>&quot;Other thing, about PHPTime series, was removed from 8.5, why? And is it really useful for future emonPI ?&quot; Not sure what your referring to there? PHPTImeSeries is in 8.5.</p>
<p>Looks like the lines should be:</p>
<p>if (file_exists($this-&gt;dir.$filename)) {<br />
&nbsp;&nbsp;&nbsp; clearstatcache($this-&gt;dir.$filename);<br />
&nbsp;&nbsp;&nbsp; $bytesize += filesize($this-&gt;dir.$filename);<br />
}</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32434"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3695.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="chaveiro&#039;s picture" title="chaveiro&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3695.html" title="View user profile.">chaveiro</a> on Tue, 21/07/2015 - 15:06.</div>
    <div class="content">
     <p>Hi trystan,</p>
<p>On 8.5.2 i included all changes from 8.5 latest, no need to merge line by line. You can merge by replacing with 8.5.2 files blindly.</p>
<p>Resolving dificult conflits is time consuming, see <a href="http://www.gitguys.com/topics/merging-with-a-conflict-conflicts-and-resolutions/" title="http://www.gitguys.com/topics/merging-with-a-conflict-conflicts-and-resolutions/">http://www.gitguys.com/topics/merging-with-a-conflict-conflicts-and-reso...</a></p>
<p>Redis is giving excelent perfomance and i&#39;m using zset to search datapoints in buffer, a feature not available on other options, also this kind of php modules are not usualy available on most shared hosting.<br />
Why are other cache solutions being an option ?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32569"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7605.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="craigfryer&#039;s picture" title="craigfryer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/7605.html" title="View user profile.">craigfryer</a> on Thu, 23/07/2015 - 23:37.</div>
    <div class="content">
     <p>I am just wondering if&nbsp;the low write version could be working with the data in the same way, but instead of operating directly on the SD card it stores the current active data in a RAM disk and then dumps the changes every 1 hour or 4 hours to the SD card.</p>
<p>Clearly this would mean a good shut down process is required and on restart would mean loading the existing data into the RAM drive.</p>
<p>In addition to&nbsp;reducing the&nbsp;differences between the versions greatly, it would also allow much easier correction of corrupt data, bulk adding of existing data to a data set and making backups much easier.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32589"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3695.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="chaveiro&#039;s picture" title="chaveiro&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/3695.html" title="View user profile.">chaveiro</a> on Fri, 24/07/2015 - 21:50.</div>
    <div class="content">
     <p>craigfryer: its under development.</p>
<p>trystan: about other buffers, see pipes demo : <a href="http://squirrelshaterobots.com/programming/php/building-a-queue-server-in-php-part-3-accepting-input-from-named-pipes/" title="http://squirrelshaterobots.com/programming/php/building-a-queue-server-in-php-part-3-accepting-input-from-named-pipes/">http://squirrelshaterobots.com/programming/php/building-a-queue-server-i...</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32590"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7605.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="craigfryer&#039;s picture" title="craigfryer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/7605.html" title="View user profile.">craigfryer</a> on Fri, 24/07/2015 - 22:30.</div>
    <div class="content">
     <p>ok, thanks.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32956"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Mon, 03/08/2015 - 11:58.</div>
    <div class="content">
     <p>To enable greater freedom when designing dashboards, it would be nice to be able to switch off or alter the &#39;snap to grid&#39; default size,&nbsp;as a user setting within the &#39;administration&#39; page.</p>
<p>Would that be of benefit to other users?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32964"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8066.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="firefox7518&#039;s picture" title="firefox7518&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: V8.6 - 9.x (extended) Development</h3>

    <div class="submitted">Submitted by <a href="../user/8066.html" title="View user profile.">firefox7518</a> on Mon, 03/08/2015 - 16:26.</div>
    <div class="content">
     <p>I can support that Paul!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/10934"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-UjEIKR3XoVNeByQ_EDo3chN5fDI08Q1btFBqPoGDCsc" value="form-UjEIKR3XoVNeByQ_EDo3chN5fDI08Q1btFBqPoGDCsc"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
