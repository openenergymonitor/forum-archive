<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/10107 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 13:43:59 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Using Apollo Oil Monitor for energy monitoring | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/3.html">Archived: General Discussion</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Using Apollo Oil Monitor for energy monitoring</h3>
        <span class="submitted">Submitted by <a href="../user/7642.html" title="View user profile.">rowan.bradley</a> on Sun, 01/02/2015 - 13:51</span>
        <div class="content"><p>I have just bought a second hand Apollo Ultrasonic Oil Level Monitor, which I would like to hook up to my computer for oil consumption analysis etc.</p>
<p>I have many questions about the Apollo device:<br />
&nbsp;1. What channel of the 433MHz band does it use for communicating between the transmitter and the receiver? As I understand it there are 69 possible channels.<br />
&nbsp;2. I understand that it uses FM, but what else do I need to know to buy to build a compatible receiver? I.e. what is the frequency deviation? What is the bit rate (assuming that it is simply encoding binary data)?<br />
&nbsp;3. What protocol or data format does it use to transmit the data from the transmitter to the receiver?<br />
&nbsp;4. Does it just transmit from the transmitter to the receiver, or ius there any sort of acknowledgement or other data sent in the reverse direction? I.e. is it open loop, or closed loop?<br />
&nbsp;5. What is the accuracy of the sensor?<br />
&nbsp;6. What is the resolution of the sensor?<br />
&nbsp;7. Do all the models of Apollo device have the same accuracy and resolution, or are some more accurate than others?<br />
&nbsp;8. How do I open the case of the receiver without damaging it?</p>
<p>If you know anything about these devices, or know where to find this out, or are interested in a simialr project, please reply.</p>
<p>Thanks - Rowan</p>
  <div class="forum-topic-navigation clear-block">
          <a href="12047.html" class="topic-previous" title="Go to previous forum topic">‹ 3 phase monitoring system neutral fail problem</a>
              <a href="11986.html" class="topic-next" title="Go to next forum topic">Calling all AC theory specialists  ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-27278"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Sun, 01/02/2015 - 15:11.</div>
    <div class="content">
     <p>I suggest that you locate a spec sheet for the unit, or contact the manufacturer.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27279"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7642.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rowan.bradley&#039;s picture" title="rowan.bradley&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by <a href="../user/7642.html" title="View user profile.">rowan.bradley</a> on Sun, 01/02/2015 - 15:56.</div>
    <div class="content">
     <p>I have a spec sheet, for what it&#39;s worth, but it doesn&#39;t give answers to any of the above questions. I have written to the manufacturer, but I doubt they will answer me, because using their sensor in a DIY project is probably not something they would welcome, and would certainly not wish their staff to be taking time answering detailed technical questions. Usually when asked this type of questions, product companies answer &quot;we have no documentation on that, and the guy who designed it left years ago&quot;.</p>
<p>We will see what comes back from the manufacturer! But I suspect&nbsp; have to rely on finding someone who has managed to puzzle this stuff out before me, or do it myself.</p>
<p>Rowan</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27286"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Sun, 01/02/2015 - 19:10.</div>
    <div class="content">
     <p>It can be difficult! I had a similar problem where the company concerned refused to give me <u>any</u> technical information, claiming it to be&nbsp;intellectual property...</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30570"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="fraschizzato&#039;s picture" title="fraschizzato&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by fraschizzato (not verified) on Fri, 22/05/2015 - 05:26.</div>
    <div class="content">
     <p>Any news about that? I&#39;m trying to do a similiar stuff, receiving the Apollo&nbsp;sensor rf signal&nbsp;with an rfm01 and arduino. &nbsp;Actually i&#39;ve found the following information that can be usefull:</p>
<p>- The same electronics (sender, receiver) are used in &#39;The Rocket&nbsp;Sensor&#39; and &quot;Whatchman Sonic&nbsp;&quot; (i&#39;m using the second one), but i cannot retrieve other information</p>
<p>- &nbsp;Modulation used in transmission is FSK (my RFM01 receiver has the same SI4320 rf)</p>
<p>- &nbsp;&quot;pairing&quot; the sensor with the receiver starts a continous data transfer, maybe for sync, and offers a good way for testing communication (i&#39;m using a magnet to put the sensor in &quot;pairing mode)</p>
<p>- each transmission has a duration of 0.140 sec and has 140bit of data (maybe 1000-1200kbps), the first 16 bit&nbsp;(but i&#39;m not shure)&nbsp;&nbsp;are the same in each transmission, so i think is a sort of header, that reduces the &quot;data&quot; bit to 124, probably 31 nibbles.</p>
<p>- transmission&nbsp;frequency&nbsp;I supposed is&nbsp;433.9Mhz (in my case I have two peak at 433.87&nbsp;and 433.93)</p>
<p>- watching radio scheme i&#39;ve seen 18 peak/oscilation&nbsp;for bit value 0 and 86 peak for bit value 1 (probably is not a precise measurements, i&#39;ve used rtl-sdr + audacity for signal view)</p>
<p>I hope that can help us to find a way to get sensor&nbsp;data</p>
<p>P.S.: my receiver is broken due to power faults, opening it is so difficult, it appears to be glued.&nbsp;With a functional one i think it&#39;s possible to read what the receiver pic sends to the Si4320 fsk receiver. By pin configuration I think it uses SPI for communication and connecting an arduino&nbsp;can be a way to grab what pic sends to Si4320, that&#39;s probably all the configuration data (frequency,data rate, mode, etc..), take a&nbsp;look at SI4320 datasheet.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30590"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7642.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rowan.bradley&#039;s picture" title="rowan.bradley&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by <a href="../user/7642.html" title="View user profile.">rowan.bradley</a> on Sat, 23/05/2015 - 16:32.</div>
    <div class="content">
     <p>Thank you very much for your reply. It&#39;s great to find someone who is trying to do the same stuff that I am! I&#39;m afraid that I haven&#39;t made much progress with my project (not as much as you). What you have discovered is certainly useful. Can you please give me full details about how you set up your RFM01 and what mode you used it in, to get those 140 bits of data? I would like to set up the same arrangement and then see if we can puzzle out what those 140 bits mean, and how to decode them into an oil level reading.</p>
<p>Please can you tell me what I need to do to duplicate your results? I guess I need to buy an RFM01, which I see that I can do for GBP 4.48 from Farnell. Have you written some Arduino software to configure the RFM01 correctly and to receive and decode the data? If so, would you be prepared to share this with me? If so, I guess I need to buy an Arduino - which model exactly? My preference would be to use a Raspberry Pi since I happen to have one here waiting for a project :-).</p>
<p>How does the RFM01 need to be set up to work with the Apollo transmitter? Presumably we need to set up:<br />
&nbsp;-&nbsp;the configuration settings (including the frequency band, the bandwidth, the crystal load capacitance etc.)<br />
&nbsp;- the frequency or channel number to use within the 433MHz band.<br />
&nbsp;- the receiver settings (including VDI mode, LNA gain, RSSI detector threshold).<br />
&nbsp;- The AFC settings<br />
&nbsp;- The Data Filter settings<br />
&nbsp;- The Data Rate setting<br />
&nbsp;- The FIFO setting</p>
<p>Presumably these things need to be set up via the SPI bus. How did you set yours up? Did you write any code to do this?</p>
<p>Would you be prepared to send me your 140 bit string that you received from your device? Then I can try to puzzle out what the bits mean. I imagine that there must be some kind of signature in the string, which the receiver uses to ignore 433 MHz signals from devices that are not Apollo oil tank transmitters, and signals from other oil tank transmitters that your neighbour might have on their tank. I imagine the in &quot;pairing&quot; process the receiver learns this signature, and thereafter ignores transmissions that do not have the correct signature.</p>
<p>Have you been able to capture the regular transmissions that the transmitter makes (I guess about once per hour) of the current oil level?</p>
<p>What is&nbsp; &quot;rtl-sdr&quot;, that you refer to using with Audacity to read the data?</p>
<p>I would like to get myself to the same point that you are at as quickly as possible, then we can try to work out the format of the data within the string of bits that we are receiving. I have two Apollo transmitters here, so that should help.</p>
<p>Thanks - Rowan</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30596"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="fraschizzato&#039;s picture" title="fraschizzato&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by fraschizzato (not verified) on Sat, 23/05/2015 - 20:33.</div>
    <div class="content">
     <p>Sorry, actually i haven&#39;t found working RFM01 settings, I&#39;ve retrieved all the previous information by watching the signal waveform. &nbsp;rtl-sdr is a software defined radio based on dvb-t tv usb dongle (the cheapest way for inspecting radio signals), with sdrsharp I can view any signal from 52 to 2200 Mhz, and record it. Opening the recorded signal with audacity shows the waveform of the transmission. &nbsp;Watching the apollo signal it I&#39;ve seen that it is fsk (but I already known that, by SI4320 datasheet), and assuming that high signal frequency is &quot;1&quot; and low &nbsp;&quot;0&quot; i can identify each bit of transmission and count them. I can also view the total duration of the transmission and the single bit duration.&nbsp;</p>
<p>With RFM01 I&#39;ve tried with the more matching settings but without result: band 433, frequency 433.9 (center between 433.83 and 433.97) &nbsp;and directly 433.83 and 433.97, for the other settings I&#39;m trying all the combinations, but it requires a lot of time.</p>
<p>For the RFM01 there are these arduino library <a href="https://myfablab.wordpress.com/2010/06/22/rfm01-and-rfm02-libraries-for-arduino-18-version-0-1/" title="https://myfablab.wordpress.com/2010/06/22/rfm01-and-rfm02-libraries-for-arduino-18-version-0-1/">https://myfablab.wordpress.com/2010/06/22/rfm01-and-rfm02-libraries-for-...</a> (opening the library with notepad++ shows all the method you can use but my preferred one is &quot;trans&quot; that accepts directly the configuration code).&nbsp;</p>
<p>Configuration code can be generated using the silabs tools at <a href="http://www.silabs.com/products/wireless/EZRadio/Pages/Si4320.aspx" title="http://www.silabs.com/products/wireless/EZRadio/Pages/Si4320.aspx">http://www.silabs.com/products/wireless/EZRadio/Pages/Si4320.aspx</a></p>
<p>My next step is trying with an RFM12B or RFM02 (RFM01 is a receiver only, RFM12B is both receiver and transmitter, RFM02 is a transmitter only) because I want to check if there is a frequency offset &nbsp;in my measurements and trying to reproduce a similar signal. The &quot;idea&quot; is to generate a 140bit signal (probably the already retrieved sequence of 0 and 1), adjusting transmission frequency until it comes over the apollo transmission and then compare my transmission with the apollo one and make changes to the settings (step by step) until i get a perfect match between the two transmission. Use that settings in RFM01 and see if i can get some data and then adapt the RFM01 library to 4bit packet (actually is 8bit) or a single 140bit stream... The reason is that i can&#39;t know what&#39;s wrong with my receiver, it simply doesn&#39;t receive nothing, but with a transmission i can see the difference between the two signals and correct the difference..</p>
<p>When I will get data with the RFM01 and arduino I think it will be simple to decode what is transmitted, probably (hoping that the signal is not encrypted) is a simple number. I know that the &nbsp;calculation are made by the receiver unit (dip switch for settings the tank size), so the transmitter sends a value that can be the measured distance or the ping time (looking to the poor transmitter electronics i think is the second one)</p>
<p><i>[Two more copies of this post have been deleted - see "NEW USERS, PLEASE READ - Posts held for moderation"]</i></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30620"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7642.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rowan.bradley&#039;s picture" title="rowan.bradley&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by <a href="../user/7642.html" title="View user profile.">rowan.bradley</a> on Sun, 24/05/2015 - 15:47.</div>
    <div class="content">
     <p>Thanks for your reply.</p>
<p>Thanks for the info about rtl-dsr - a whole area of modern technology that I was unaware of! My thoughts about this were to see if I could see the 433MHz signal on my oscilloscope, but it probably would never have worked, since it is only supposed to have 100MHz bandwidth. Your approach sounds better, if a bit long winded.</p>
<p>I have not tried hard to open up my receiver (which works fine) because I did not want to damage it. As you say, it seems like it is glued together. I suppose that in there there is an SI4320 and a microcomputer of some kind, and I suppose that they communicate via SPI. Might it be possible with a working receiver&nbsp;to monitor the SPI communication and capture the setup commands that the micro must send to the SI4320? That would give a set of settings that could presumably be sent to the RFM01 and would then receive the signals from the Apollo transmitter correctly.</p>
<p>As you say, all the processing to create the tank level seems to be done in the receiver. Like you I am expecting the transmitter to send just a number, which is presumably a count of some clock for the length of time to receive a reflected ultrasonic signal from the surface of the oil. I am hoping that maybe the resolution of this reading is finer than the 1/10 of a tank resolution of the receiver display, which would enable better/faster readings of oil consumption to be calculated.</p>
<p>Maybe I just have to break or hacksaw open my receiver, and see if this appears possible. Then I would need to design something that will monitor and decode the SPI signals without disrupting the operation of the receiver. Does not sound impossible with a little micro of some sort. Maybe it could even be done by monitoring the signals on my scope.</p>
<p>That&#39;s as far as I have got for now. Please let me know if you progress farther!</p>
<p>Thanks - Rowan</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30621"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7642.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rowan.bradley&#039;s picture" title="rowan.bradley&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by <a href="../user/7642.html" title="View user profile.">rowan.bradley</a> on Sun, 24/05/2015 - 17:24.</div>
    <div class="content">
     <p>Another idea: there are not that many channels in the 433MHz band (69 in fact). Could we not simply try them all to find out which one receives the signals from the Apollo transmitter best? A C program could potentially do this automatically with the transmitter in&nbsp;&quot;continuous transmission&quot; mode.</p>
<p>Rowan</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30623"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="fraschizzato&#039;s picture" title="fraschizzato&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by fraschizzato (not verified) on Sun, 24/05/2015 - 18:52.</div>
    <div class="content">
     <p>Unfortunately my receiver is incredibly damaged and I can&#39;t make the spi test, however the SI4320 is connected to a PIC16F630. Referring to the SI4320 datasheet,the connection with PIC are in SPI mode (the SI4320 could work in standalone mode but following the wiring I think this is not the case), and it&#39;s easy to identify MOSI, MISO, SCK and SS (in SI4320 datasheet there is a full connection diagram).</p>
<p>The receiver is glued or soldered, mine was already broken so I&#39;ve used hard manners for opening it. Probably using a little cutter is possible to open it without evident damage.</p>
<p>About che transmission channel I think that is only a small part of the problem, knowing the channel but not the data rate doesn&#39;t produce any result (or bad result, with that approach I have believed that I&#39;ve found the signal but it was from another source..)</p>
<p>A good but very challenging idea (for me) is this: <a href="https://hackaday.io/project/1548-rocket-receiver-teardown " title="https://hackaday.io/project/1548-rocket-receiver-teardown ">https://hackaday.io/project/1548-rocket-receiver-teardown </a></p>
<p>Make a script that tries all the possible RFM01/Si4320 settings combinations, but I think it is more complicated</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36517"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/9043.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-9043.jpg" alt="dwmw2&#039;s picture" title="dwmw2&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by <a href="../user/9043.html" title="View user profile.">dwmw2</a> on Wed, 02/12/2015 - 00:31.</div>
    <div class="content">
     <p>I got a spare receiver and tried to hook it up to sniff the SPI traffic, but unfortunately I was being too impatient &mdash; rather than waiting for a proper SOIC chip probe that would clip on, I was trying to use normal probes. And in the process I blew up both my receiver <strong>and</strong> the Bus Pirate I was trying to do the sniffing with.</p>
<p>Still, the information above should be enough to get us a lot further. If you see peaks at 433.9MHz &plusmn; 30kHz, that implies that the baseband bandwidth <em>(bits i0-2 in the configuration)</em> should be 67kHz, surely?</p>
<p>That&#39;s probably all we need to care about to get started. Stick a magnet on the transmitter to make it stream data constantly instead of only chirping every few minutes. With a simple SI4320 we could monitor the ARSSI output of the chip to see when it&#39;s getting a signal, and we can fine-tune the frequency (and perhaps set up AFC). However, the RFM01 module doesn&#39;t give us an ARSSI connector. Is it actually using a Si4320 on the module, and if so can we still access the ARSSI pin even though it&#39;s not brought out to the external connectors? <em>(I&#39;ve ordered some RFM01 modules but mine haven&#39;t arrived yet.)</em></p>
<p>Otherwise, we&#39;d have to use the digital RSSI &mdash; set the VDI bits <em>(d0-1)</em> to zeroes to enable the DRSSI to be output on the VDI pin, then use that for fine-tuning the receiver. Probably starting at the lowest trigger level <em>(bits r0-r2) </em>and increasing it as we get closer to the optimal settings. Probably set the LNA gain somewhere in the mid range and tweak it only if we need to.</p>
<p>Then we can move on to the data rate. There are tens of possible data rates in the 1000-1200bps range, and it&#39;s probably not impossible to just try them.</p>
<p>I&#39;d stick with the polled mode, where you just clock data out directly whenever the FFIT pin goes high. We can set up the FIFO later; that&#39;s purely a software construct between the receiver and the host, and not really what we need to work out here.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36560"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/9043.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-9043.jpg" alt="dwmw2&#039;s picture" title="dwmw2&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by <a href="../user/9043.html" title="View user profile.">dwmw2</a> on Wed, 02/12/2015 - 00:34.</div>
    <div class="content">
     <p>FWIW I&#39;ve also had a response from Dunraven Systems. They&#39;re not interested in helping:</p>
<blockquote><p>&quot;Unfortunately David the information you ask for we are unable to provide as we do not operate an open protocol - I would suggest that you make contact with our business manager to discuss this further. &quot;</p>
</blockquote>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36631"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/9043.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-9043.jpg" alt="dwmw2&#039;s picture" title="dwmw2&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by <a href="../user/9043.html" title="View user profile.">dwmw2</a> on Thu, 03/12/2015 - 15:43.</div>
    <div class="content">
     <p>Oh, rtl-sdr is a wonderful thing. How did I never find *that* before?</p>
<p>So rtl_power shows peaks at 433867 kHz and 433925 kHz which go away if I stick the transmitter in the microwave. That&#39;s about 60kHz bandwidth, at 433.895MHz.</p>
<p>Capture that with &#39;rtl_fm -f 433895000 -l 140&#39; &mdash; result at <a href="http://david.woodhou.se/watchman.cap">http://david.woodhou.se/watchman.cap</a>.</p>
<p>Import it into Audacity and you can see a nice clean waveform. I&#39;ll see if I can show it here...<img alt="" src="../../../david.woodhou.se/watchman.png" style="width: 100%;" /></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36637"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/9043.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-9043.jpg" alt="dwmw2&#039;s picture" title="dwmw2&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by <a href="../user/9043.html" title="View user profile.">dwmw2</a> on Thu, 03/12/2015 - 17:48.</div>
    <div class="content">
     <p>I think I now see where you got your 140 bits in 0.140 seconds. But I wouldn&#39;t interpret it like that. My first guess would be that it&#39;s a Manchester encoding &mdash; so a 0 bit is indicated by a transition from low to high frequency, while a 1 is indicated by a transition from high to low (or perhaps vice versa).</p>
<p>The start of the frame is indicated by three high half-bits followed by three low half-bits. And the end of frame is marked by repeating the last half-bit two more times.</p>
<p>I count 64 bits of data, in that case. So <em>(decoding by hand, so expect some bit errors) </em>the data in the packet I showed above &mdash; when it eventually makes it past moderation and shows up &mdash; was D73929E27EBFAE7C. Which will contain the unit ID, the current measurement, and also some indication of the battery status. And maybe a CRC or checksum of some kind.</p>
<p>I&#39;ll throw together something to decode them by hand and see if I can make further progress....</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36701"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/9043.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-9043.jpg" alt="dwmw2&#039;s picture" title="dwmw2&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by <a href="../user/9043.html" title="View user profile.">dwmw2</a> on Fri, 04/12/2015 - 13:57.</div>
    <div class="content">
     <p>I&#39;ve been posting updates in the project at <a href="https://hackaday.io/project/1548-rocket-receiver-teardown" title="https://hackaday.io/project/1548-rocket-receiver-teardown">https://hackaday.io/project/1548-rocket-receiver-teardown</a> because they&#39;re not delayed by moderation there. One more update here though...</p>
<p>At <a href="http://david.woodhou.se/watchman-demod.c" title="http://david.woodhou.se/watchman-demod.c">http://david.woodhou.se/watchman-demod.c</a> there is a program which works with rtl-sdr to receive the signals. Looks something like this:</p>
<div>[root@shinybook ~]# rtl_fm -f 433900000 -s 48000 -l 160 -r 24000&nbsp; -E deemp | ./watchman-demod<br />
Found 1 device(s):<br />
&nbsp; 0:&nbsp; Realtek, RTL2838UHIDIR, SN: 00000001</div>
<div>Using device 0: Generic RTL2832U OEM<br />
Found Rafael Micro R820T tuner<br />
Tuner gain set to automatic.<br />
Tuned to 434152000 Hz.<br />
Oversampling input by: 21x.<br />
Oversampling output by: 1x.<br />
Buffer size: 8.13ms<br />
Exact sample rate is: 1008000.009613 Hz<br />
Sampling at 1008000 S/s.<br />
Output at 48000 Hz.<br />
At 2015-12-04 13:50:00:&nbsp; 28 c7 47 8b 80 40 0a&nbsp; (crc ok 76)<br />
&nbsp;&nbsp;&nbsp; Unit ID: 0x28c7478b flags 0x8040 height 10<br />
At 2015-12-04 13:50:01:&nbsp; 28 c7 47 8b 80 40 0d&nbsp; (crc ok f5)<br />
&nbsp;&nbsp;&nbsp; Unit ID: 0x28c7478b flags 0x8040 height 13<br />
At 2015-12-04 13:50:04:&nbsp; 28 c7 47 8b 80 40 0d&nbsp; (crc ok f5)<br />
&nbsp;&nbsp;&nbsp; Unit ID: 0x28c7478b flags 0x8040 height 13<br />
At 2015-12-04 13:50:43:&nbsp; 28 4e 84 b4 61 4c 50&nbsp; (crc ok 30)<br />
&nbsp;&nbsp;&nbsp; Unit ID: 0x284e84b4 flags 0x614c rebinding countdown 0<br />
At 2015-12-04 13:50:44:&nbsp; 28 4e 84 b4 61 4c 51&nbsp; (crc ok 6e)<br />
&nbsp;&nbsp;&nbsp; Unit ID: 0x284e84b4 flags 0x614c rebinding countdown 1<br />
At 2015-12-04 13:50:44:&nbsp; 28 4e 84 b4 61 4c 51&nbsp; (crc ok 6e)<br />
&nbsp;&nbsp;&nbsp; Unit ID: 0x284e84b4 flags 0x614c rebinding countdown 1<br />
At 2015-12-04 13:50:45:&nbsp; 28 4e 84 b4 60 4c 36&nbsp; (crc ok 23)<br />
&nbsp;&nbsp;&nbsp; Unit ID: 0x284e84b4 flags 0x604c height 54<br />
At 2015-12-04 13:50:45:&nbsp; 28 4e 84 b4 60 4c 36&nbsp; (crc ok 23)<br />
&nbsp;&nbsp;&nbsp; Unit ID: 0x284e84b4 flags 0x604c height 54<br />
At 2015-12-04 13:50:46:&nbsp; 28 4e 84 b4 60 4c 36&nbsp; (crc ok 23)<br />
&nbsp;&nbsp;&nbsp; Unit ID: 0x284e84b4 flags 0x604c height 54<br />
At 2015-12-04 13:50:47:&nbsp; 28 4e 84 b4 60 4c 36&nbsp; (crc ok 23)<br />
&nbsp;&nbsp;&nbsp; Unit ID: 0x284e84b4 flags 0x604c height 54</div>
<p>The signal decoding is a terrible hack. I felt less ashamed of it when it needed precise tuning and only worked with one unit at a time; now I&#39;ve made it a little bit more robust it&#39;s just more obvious how bad it is :)&nbsp;</p>
<p>I&#39;d like to throw out my own signal decoder and use something else &mdash; there must be an open source one we can use which will adapt properly and be more robust. But this works OK as a proof of concept.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36812"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/9043.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-9043.jpg" alt="dwmw2&#039;s picture" title="dwmw2&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by <a href="../user/9043.html" title="View user profile.">dwmw2</a> on Mon, 07/12/2015 - 16:44.</div>
    <div class="content">
     <p>I&#39;ve now added support for these devices to rtl_433: <a href="https://github.com/merbanan/rtl_433">https://github.com/merbanan/rtl_433</a></p>
<p>However, although the signal processing is now Not My Fault&trade;, it&#39;s not perfect &mdash; the reception at long range was better when I was using rtl_fm: <a href="https://github.com/merbanan/rtl_433/issues/223">https://github.com/merbanan/rtl_433/issues/223</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36941"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/9043.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-9043.jpg" alt="dwmw2&#039;s picture" title="dwmw2&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by <a href="../user/9043.html" title="View user profile.">dwmw2</a> on Fri, 11/12/2015 - 23:57.</div>
    <div class="content">
     <p>&nbsp;</p>
<p>A quick screen shot using the setup described at <a href="http://www.domoticz.com/wiki/Lua_-_Oil_Tank_Monitor">http://www.domoticz.com/wiki/Lua_-_Oil_Tank_Monitor</a><img alt="" src="../../../david.woodhou.se/oil.png" style="height: 235px; width: 977px;" /></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38490"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/9043.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-9043.jpg" alt="dwmw2&#039;s picture" title="dwmw2&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Apollo Oil Monitor for energy monitoring</h3>

    <div class="submitted">Submitted by <a href="../user/9043.html" title="View user profile.">dwmw2</a> on Tue, 19/01/2016 - 13:20.</div>
    <div class="content">
     <p>The RF signal process is a lot better now, FWIW. Tommy Vestermark has done a lot of work on the FM decoding and level detection, and it&#39;s much more reliable. I&#39;ve been using this &quot;in anger&quot; for a while now, and it&#39;s doing a really good job.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/10107"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-DNbnbzSOnwbIBE13oDJTvS0WP4CIfE_YgTHkWX2Ze44" value="form-DNbnbzSOnwbIBE13oDJTvS0WP4CIfE_YgTHkWX2Ze44"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/10107 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 13:44:01 GMT -->
</html>
