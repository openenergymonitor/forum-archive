<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/6244 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:38:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>RFM12Pi with RFM69CW | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">RFM12Pi with RFM69CW</h3>
        <span class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 05/12/2014 - 14:45</span>
        <div class="content"><p>Limited number of RFM12Pi with RFM69CW are in the shop&nbsp;alongside the standard RFM12Pi for early adopters and devs to test: <a href="http://shop.openenergymonitor.com/rfm69pi-rfm69cw-raspberry-pi-base-station-receiver-board/">http://shop.openenergymonitor.com/rfm69pi-rfm69cw-raspberry-pi-base-station-receiver-board/</a>.</p>
<p>The units come preloaded with Optiboot bootloader and the following compiled sketch: <a href="https://github.com/openenergymonitor/RFM2Pi/blob/master/firmware/RFM69CW_RF_Demo_ATmega328/RFM69CW_RF12_Demo_ATmega328/RFM69CW_RF12_Demo_ATmega328.ino">https://github.com/openenergymonitor/RFM2Pi/blob/master/firmware/RFM69CW_RF_Demo_ATmega328/RFM69CW_RF12_Demo_ATmega328/RFM69CW_RF12_Demo_ATmega328.ino</a></p>
<p>The RFM69CW is backward compatible with RFM12B, the main differences are:</p>
<ul>
<li>RSSI&nbsp;- received signal strength indication value avaialbe&nbsp;</li>
<li>57600 serial baud instead of 9600</li>
<li>default settings of 433Mhz, NodeID 15 and 210 network group&nbsp;</li>
</ul>
<p>The &#39;testing&#39; version of emonHub can handle auto detection of baud rate and posting RSSI value to emoncms:&nbsp;h<a href="https://github.com/emonhub/emonhub/tree/testing">ttps://github.com/emonhub/emonhub/tree/testing</a>. Thanks a lot to Paul who continues to do amazing work developing emonHub.&nbsp;</p>
<p>For development see github issue discussion:&nbsp;<a href="https://github.com/emonhub/emonhub/issues/58">https://github.com/emonhub/emonhub/issues/58</a></p>
  <div class="forum-topic-navigation clear-block">
          <a href="6346.html" class="topic-previous" title="Go to previous forum topic">‹ questions about RFM69Pi</a>
              <a href="6298.html" class="topic-next" title="Go to next forum topic">emonTx V2 newbie - no data [SOLVED] ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-25732"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 09/12/2014 - 20:59.</div>
    <div class="content">
     <p>Thanks for the kind words&nbsp;Glyn!</p>
<p>The latest changes have now been merged into the default &quot;development&quot; branch as they seem quite stable and thoroughly tested.&nbsp;so&nbsp;no need to go to the &quot;testing&quot; branch as that will now be&nbsp;subjected to further experimenting.</p>
<p>The most significant&nbsp;change is for&nbsp;rfm69 and but there are some other less&nbsp;exciting changes since rc1.0</p>
<p>&nbsp; Jee/RFM2Pi serial baud auto selection (currently selects 9600 or 57600 depending on device firmware)<br />
&nbsp; Display RFM2Pi firmware revision and current settings (post vRF12demo.11 firmware only)<br />
&nbsp; Improved log messages<br />
&nbsp; Improved settings qualification<br />
&nbsp; Widened compatibility with other Jee type devices<br />
&nbsp; Reintroduced the float datacode &quot;f&quot;<br />
&nbsp; Option of using pre-timestamped payloads via serial or socket for non-live data input<br />
&nbsp; Cleaner exiting for multi-threading<br />
&nbsp; Plus various other minor improvements</p>
<p>&nbsp;</p>
<p>To get emonhub&nbsp;rc1.1 you can pull the changes in from git, remember&nbsp;use &quot;rpi-rw&quot; first if&nbsp;running read-only.</p>
<blockquote><p>cd ~/emonhub<br />
git checkout development<br />
git pull<br />
sudo service emonhub restart<br />
cd -</p>
</blockquote>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25745"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Wed, 10/12/2014 - 16:04.</div>
    <div class="content">
     <p>The update does not appear to auto select the correct baud rate as suggested above.</p>
<p>I&#39;m using a RFM12B, and following the update above (I was already on the emonhub&nbsp;&#39;development&#39; branch)&nbsp;it appears from the emonhub error log that it has selected 57600 baud, which has caused instability in my system and stopped all feeds being updated.</p>
<p>Any ideas what has gone wrong?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25747"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 10/12/2014 - 16:51.</div>
    <div class="content">
     <p>tut..&nbsp;there&nbsp;always has to be one :-)</p>
<p>Sorry not off-hand no. I&#39;ve been using that part of the code for months now with no issues, It would be a great help if you could post the log so I can see the steps it&#39;s taken.</p>
<p>emonhub&nbsp;tries to communicate with the rfm2pi&nbsp;at each baud and if it doesn&#39;t get&nbsp;a the&nbsp;expected response it moves on to the next baud, so that would suggest it got an acceptable response which is not a surprise if it is then working to some degree. Do you know what firmware you are running on rfm2pi? is it stock or&nbsp;modified?&nbsp;</p>
<p>I have tested with as many devices and&nbsp;firmwares as possible but may need to &quot;tune&quot; the selection process if I&#39;ve missed something.</p>
<p>The auto-selection can easily&nbsp;be overridden by just&nbsp;defining the baud you want in the rfm2pi&nbsp;init_settings eg &quot;com_baud = 9600&quot;, i assume there is no pre-existing baud set in emonhub,conf.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25748"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Wed, 10/12/2014 - 16:58.</div>
    <div class="content">
     <p>I emailed you the log last night Paul to your outlook address, but now pasted below.</p>
<p>The RFM2Pi firmware is stock (preloaded -&nbsp;but was purchased direct from Martin Harizanov - not from OEM shop) and there are no &#39;baud&#39; entries in the emonhub.conf</p>
<p>Paul</p>
<p>2014-12-09 21:25:31,148 INFO Set up reporter &#39;emonCMS&#39; (buffer: memory | size: 1000)<br />
2014-12-09 21:25:31,153 INFO Setting emonCMS url:&nbsp;http://localhost/emoncms<br />
2014-12-09 21:25:31,155 INFO Setting emonCMS apikey: set<br />
2014-12-09 21:25:31,158 INFO Creating EmonHubJeeInterfacer &#39;RFM2Pi&#39;<br />
2014-12-09 21:25:31,163 DEBUG Opening serial port: /dev/ttyAMA0 @ 57600 bits/s<br />
2014-12-09 21:25:35,189 WARNING Device communication error - check settings<br />
2014-12-09 21:25:35,192 INFO Setting RFM2Pi frequency: 868 (8b)<br />
2014-12-09 21:25:36,196 INFO Setting RFM2Pi group: 210 (210g)<br />
2014-12-09 21:25:37,199 INFO Setting RFM2Pi quiet: 1 (1q)<br />
2014-12-09 21:25:38,204 INFO Setting RFM2Pi baseid: 15 (15i)<br />
&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25750"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Wed, 10/12/2014 - 17:20.</div>
    <div class="content">
     <p><em>The auto-selection can easily&nbsp;be overridden by just&nbsp;defining the baud you want in the rfm2pi&nbsp;init_settings eg &quot;com_baud = 9600&quot;</em></p>
<p>Added, and I&#39;m back on 9600 baud with the feeds now updating OK</p>
<p>If you have any ideas why it didnt&nbsp;auto select, let me know, and I&#39;ll try them out.</p>
<p>&nbsp;</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25751"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 10/12/2014 - 18:04.</div>
    <div class="content">
     <p>I have just tried this several times with my rf12&nbsp;rfm2pi&nbsp;and it&#39;s working exactly as expected, so I&#39;m at a bit of a loss as I can&#39;t recreate it, heres my &quot;set-up&quot; part of the log. from there it logs as usual.</p>
<p>2014-12-10 17:28:40,636 INFO EmonHub Pre-Release Development Version (rc1.1)<br />
2014-12-10 17:28:40,639 INFO Opening hub...<br />
2014-12-10 17:28:40,645 INFO Logging level set to DEBUG<br />
2014-12-10 17:28:40,649 INFO Creating EmonHubEmoncmsReporter &#39;emonCMS&#39;<br />
2014-12-10 17:28:40,655 INFO Set up reporter &#39;emonCMS&#39; (buffer: memory | size: 20000)<br />
2014-12-10 17:28:40,661 DEBUG Setting emonCMS interval: 5<br />
2014-12-10 17:28:40,664 INFO Setting emonCMS url: <a href="http://emoncms.org/" title="http://emoncms.org">http://emoncms.org</a><br />
2014-12-10 17:28:40,668 INFO Setting emonCMS apikey: set<br />
2014-12-10 17:28:40,672 INFO Creating EmonHubEmoncmsReporter &#39;emonCMS2&#39;<br />
2014-12-10 17:28:40,678 INFO Set up reporter &#39;emonCMS2&#39; (buffer: memory | size: 20000)<br />
2014-12-10 17:28:40,683 INFO Setting emonCMS2 url: <a href="http://emoncms.org/" title="http://emoncms.org">http://emoncms.org</a><br />
2014-12-10 17:28:40,686 INFO Setting emonCMS2 apikey: set<br />
2014-12-10 17:28:40,690 INFO Creating EmonHubJeeInterfacer &#39;RFM2Pi&#39;<br />
2014-12-10 17:28:40,696 DEBUG Opening serial port: /dev/ttyAMA0 @ 57600 bits/s<br />
2014-12-10 17:28:42,702 DEBUG Opening serial port: /dev/ttyAMA0 @ 9600 bits/s<br />
2014-12-10 17:28:46,712 INFO RFM2Pi device firmware version &amp; configuration: not available<br />
2014-12-10 17:28:46,716 INFO Setting RFM2Pi frequency: 433 (4b)<br />
2014-12-10 17:28:47,720 INFO Setting RFM2Pi group: 210 (210g)<br />
2014-12-10 17:28:48,724 INFO Setting RFM2Pi quiet: 1 (1q)<br />
2014-12-10 17:28:49,729 INFO Setting RFM2Pi baseid: 15 (15i)<br />
2014-12-10 17:28:50,734 DEBUG Setting RFM2Pi interval: 5<br />
2014-12-10 17:28:50,737 INFO Creating EmonHubSocketInterfacer &#39;Socket&#39;<br />
2014-12-10 17:28:50,741 DEBUG Opening socket on port 50011<br />
2014-12-10 17:28:50,767 DEBUG RFM2Pi broadcasting time: 17:28<br />
2014-12-10 17:28:50,772 DEBUG RFM2Pi acknowledged command: &gt; 4b<br />
2014-12-10 17:28:51,223 DEBUG RFM2Pi acknowledged command: &gt; 210g<br />
2014-12-10 17:28:51,671 DEBUG RFM2Pi acknowledged command: &gt; 1q<br />
2014-12-10 17:28:51,897 DEBUG RFM2Pi acknowledged command: &gt; 15i<br />
2014-12-10 17:28:52,364 DEBUG RFM2Pi acknowledged command: &gt; 0s<br />
2014-12-10 17:28:52,590 DEBUG RFM2Pi confirmed sent packet size: &nbsp;-&gt; 4 b</p>
<p>I will continue to look into it and study the RF12Demo sketches, 2 details could help me out, <s>can you confirm what firmware the rfm2pi is running? </s>and if you have minicom or similar could you stop emonhub&nbsp;for a moment and send a &quot;v&quot; to rfm2pi&nbsp;and post the results and also a &quot;?&quot; the responses to these commands are what emonhub is looking for.</p>
<p>Something else just occurred to me, can you confirm if you are auto-starting emonhub&nbsp;from boot or if you have started/restarted emonhub&nbsp;alone using commands ie not rebooted?</p>
<p>Paul</p>
<p>edit - just reread your post above</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25756"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Wed, 10/12/2014 - 19:20.</div>
    <div class="content">
     <p>I did a full reboot after the update, and emonhub normally starts as a service automatically.</p>
<p>Regarding minicom; I&#39;ve installed it, and can see the data arriving in&nbsp;dev/ttyAMA0 but unsure how to send a &quot;v&quot;.... I&#39;ve tried typing,&nbsp;&quot;v&quot; but it just brings up the minicom&nbsp;commands list.</p>
<p>(It&#39;s taken me 5 minutes to find out how to exit from minicom!!! what a awkward piece of software)</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25762"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 10/12/2014 - 21:03.</div>
    <div class="content">
     <p>Since I&#39;m not able to reproduce this, I&#39;m finding it hard to pinpoint what could be happening. My current thoughts are along the lines of either there is a difference in the firmware&#39;s in question which is not complying to emonhubs expectations, which can only really be determined by seeing the serial response to the commands used, or I vaguely recall some months ago when I first put the code together, I experienced some issues with the rf12 rfm2pi&nbsp;at boot up, this was overcome and hasn&#39;t reoccurred&nbsp;in many months, but without experiencing the issue I&#39;m sort of clutching at straws here.</p>
<p>The crux of the issue in the early attempts seemed to be that the rfm2pi was printing many lines of help text at power up,&nbsp;then when&nbsp;emonhub&nbsp;sent out the test command and caught the end of the help text it thought it was in response to it&#39;s test command and accepted the current settings as correct.</p>
<p>If that was to be the issue it would only fault at power up and first use of the rfm2pi, When&nbsp;emonhub is restarted using &quot;sudo&nbsp;service&nbsp;emonhub&nbsp;restart&quot; while the Pi remains powered up and the rfm2pi is already initialized, the auto selection&nbsp;would then work&nbsp;as expected.</p>
<p>If you want to try this you will need to &quot;comment out&quot; the new &quot;com_baud&quot; line before restarting emonhub</p>
<blockquote><p>sudo service emonhub stop</p>
</blockquote>
<p>Then edit the conf file (sometimes it can take several seconds before all the threads are closed as it tries&nbsp;fo finish posting before closing).</p>
<blockquote><p>sudo service emonhub start<br />
tail -f /var/log/emonhub/emonhub.log</p>
</blockquote>
<p>If you cut and paste these 2 lines in together and [enter] it will start emonhub and switch immediately to the log so you don&#39;t miss the start-up lines, if it still didn&#39;t auto-select&nbsp;correctly, exit log [ctrl-c] and uncomment the new line in the conf&nbsp;again. When you save the file it will automatically delete and recreate the&nbsp;interfacer with the set baud, no need to restart emonhub or the Pi,&nbsp;</p>
<p>As you save and exit the conf if you immediately hit the scroll up key(twice probably) to re use the &quot;tail log&quot; line and [enter] you should just be able to catch the&nbsp;interfacer&nbsp;being deleted and recreated in the log.</p>
<p>If it&#39;s not that I&#39;m (currently) lost, if it is that we know what were up against.</p>
<p>Paul</p>
<p>Edit - If you are ok having defined the baud in the conf I can wait to see if Glyn is able to recreate this on a non-live system rather than interfering with your data collection. it&#39;s up to you I do&nbsp;understand if you have it working you may not want to experiment at the cost of lost datapoints.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25770"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Thu, 11/12/2014 - 12:49.</div>
    <div class="content">
     <p>Hi guys,</p>
<p>Good news,&nbsp;I&#39;ve fixed the issue I was having (same as Paul Reed) <a href="https://github.com/emonhub/emonhub/issues/58#issuecomment-66480108" title="https://github.com/emonhub/emonhub/issues/58#issuecomment-66480108">https://github.com/emonhub/emonhub/issues/58#issuecomment-66480108</a>. The issue was I had got confused as to which emohub.conf file I was using, one of the files has a line in it overwriting the baud rate to 57600. Reverting back to the stock SD card image and using the emonhub.conf on the boot partition everything works just perfectly :-)</p>
<p>Emonhub now auto detects&nbsp;RFM12B&nbsp;9600 baud and RFM69CW&nbsp;56700 baud. I tested running emonhub at boot and manually and both on a Pi Model B and Pi Model B+. Every time ot successfully&nbsp;auto detected the baud.&nbsp;</p>
<p>I&#39;m using the emonhub.conf &nbsp;file on the /boot partitionI was posting to a remote emoncms server (not emoncms.org but a test emoncms server we have running here in the lab)&nbsp;with local logging the to Pi disabled (as standard on the ready-to-go) SD card.&nbsp;</p>
<p>I tested with three separate&nbsp;&nbsp;RFM12Pi&#39;s with RFM69CW&nbsp;all running the latest:&nbsp;https://github.com/openenergymonitor/RFM2Pi/tree/master/firmware/RFM69CW_RF_Demo_ATmega328/</p>
<p>And four separate&nbsp;RFM12Pis with RFM12B all running the same code that&#39;s been on the last 1500 PCS of RFM12Pis that we&#39;ve sold, we&#39;ve not changed the code on the RFM12Pi with RFM12B since we first lauched the unit in the shop as far as I can remember:&nbsp;https://github.com/openenergymonitor/RFM2Pi/tree/master/firmware/RF12_Demo_atmega328</p>
<p>@ Paul Reed: if you have a spare SD card could you try flashing a fresh emonSD&nbsp;13-08-14, edit the emohub.conf on the /boot partition and&nbsp;do&nbsp;a git pull and test&nbsp;if the serial baud auto detection is working for you?&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25771"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 11/12/2014 - 13:22.</div>
    <div class="content">
     <p>Thanks Glyn, that&#39;s fantastic news (for emonhub&nbsp;not so much for Paul though), is it possible a rfm2pi&nbsp;supplied by Martin has a different/earlier RF12demo sketch?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25772"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 11/12/2014 - 14:06.</div>
    <div class="content">
     <p>The rfm2pi was the second version (which fits into standard pi cases) and was purchased from Martin around 5th March 2013 (which was before oem was stocking them).<br />
I'll ask Martin if he can recall.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25775"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Thu, 11/12/2014 - 15:06.</div>
    <div class="content">
     <p>Yes very good chance it could have slight differences, I don&#39;t have control over what Martin loaded nor do I have one here to test with.&nbsp;The good news is that you should easily be able to update to our &#39;stock&#39; firmware direct from the Pi by following:&nbsp;<a href="http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2#Upgrading_RFM12Pi_Firmware_Direct_from_the_Pi">http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2#Upgrading_RFM12Pi_Firmware_Direct_from_the_Pi</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25776"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Thu, 11/12/2014 - 17:03.</div>
    <div class="content">
     <p>Guys,</p>
<p>I think the firmware&nbsp;version I shipped these around March 2013 is this one:&nbsp;<a href="https://github.com/mharizanov/RFM2Pi/tree/d570b55221a2aa03da161e2c569cd4b6950a1364/firmware/RF12_Demo_atmega328">https://github.com/mharizanov/RFM2Pi/tree/d570b55221a2aa03da161e2c569cd4b6950a1364/firmware/RF12_Demo_atmega328</a></p>
<p>​</p>
<p>On another subject, I see you plan to use 57600&nbsp;baud on 8Mhz&nbsp;clock, that would by default introduce 3.7% error possibility, check&nbsp;<a href="http://www.wormfood.net/avrbaudcalc.php?postbitrate=57600&amp;postclock=8">http://www.wormfood.net/avrbaudcalc.php?postbitrate=57600&amp;postclock=8</a></p>
<p>This is the reason I used baud&nbsp;38400 for the bootloader on the RFM2Pi. It may seem little, but if you think about it, 4 out of 100 bytes received on the serial may be garbage.. better use 38400 instead of 57600 baud.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25777"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 11/12/2014 - 17:39.</div>
    <div class="content">
     <p>Hi Martin, thanks for the link, I don&#39;t see anything obviously&nbsp;different with that sketch but will look closer at it.</p>
<p>Thanks for the pointers on baud too,I think I have seen 38400 in use on another Jee type device.so may include it in emonhub&#39;s short list anyway.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25781"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 11/12/2014 - 23:36.</div>
    <div class="content">
     <p>I&#39;ve also compared the two sketches and found just two changes, lines 42 &amp; 43 (Stack size &nbsp;increase), other than that they appear to be the same.</p>
<p>I Followed Glyn&#39;s&nbsp;advice above re updating to stock firmware, and after removing&nbsp;&quot;com_baud = 9600&quot; from&nbsp;init_settings, restarted emonhub, and 9600 baud was auto successfully selected.</p>
<p>So in short, I&#39;m not sure what the problem was, but all good now!</p>
<p>Thanks</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25829"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7218.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="emjay&#039;s picture" title="emjay&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/7218.html" title="View user profile.">emjay</a> on Wed, 17/12/2014 - 10:40.</div>
    <div class="content">
     <p><em>@mharizanov,</em></p>
<p>&nbsp;&gt; 4 out of 100 bytes received on the serial may be garbage..</p>
<p>Hmm, not so - this is still an <em>asynch</em> link, each frame reception is independent (within limits) of the previous.</p>
<p>Net effect is that disagreement over clock rate between transmitter and receiver does not&nbsp; accumulate during a block transmission - if the clock error is well below half a bit time by &#39;character&#39; frame end, it&#39;s cool.&nbsp; 3% is within bounds unless driving capacitive loads like very long cables that could induce data dependent skew.</p>
<h6>edited for clarity 17Dec</h6>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25830"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 14/12/2014 - 15:20.</div>
    <div class="content">
     <p>What is a frame in this context, is it a start bit, 8 data bits and a stop bit?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25846"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7218.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="emjay&#039;s picture" title="emjay&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/7218.html" title="View user profile.">emjay</a> on Mon, 15/12/2014 - 08:43.</div>
    <div class="content">
     <p>Yes.&nbsp; Ideally the receiver samples the incoming waveform at the center of each bit cell in the frame. Clock skew will cause the sampling point to drift away from the cell center progressively for each bit cell sample. Provided the skew is less than half a cell width by the end of the frame, it is harmless.</p>
<p>The next &#39;start&#39; bit kicks off the same process again with no error accumulation from the previous frame.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25847"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dBC&#039;s picture" title="dBC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Mon, 15/12/2014 - 10:03.</div>
    <div class="content">
     <p><em>unless driving very long cables</em></p>
<p>And for the purpose of this discussion, you don&#39;t start measuring that length until the signal has been converted from USB to asynchronous serial. &nbsp;On most Arduinos, the serial &quot;cable&quot; is actually PCB traces. &nbsp;If you&#39;re using an external programmer, then it includes some traces on the programmer, the 6-pin header, and then some traces on the target board. &nbsp;Either way, a much nicer environment than metres and metres of serial cable.</p>
<p>As another datapoint, I run a Mega2560 at 8MHz and do all image downloading at 57600 baud. &nbsp;My hex file is about 100K and I&#39;ve downloaded it hundreds of times with no problems at all. &nbsp; It doesn&#39;t work at all at 115200, and I guess the error table linked above explains why... &nbsp;7.8% error there.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25855"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5190.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-5190.jpg" alt="Schism&#039;s picture" title="Schism&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/5190.html" title="View user profile.">Schism</a> on Mon, 15/12/2014 - 20:03.</div>
    <div class="content">
     <p>I&#39;d welcome any help troubleshooting the following issue.</p>
<p>I have two Pi side by side, one with the RFM12 and one with RFM69 which I just had delivered&nbsp;from the oem shop.</p>
<p>compare the following minicom output from the old board:</p>
<pre>
$ minicom -b9600 -D/dev/ttyAMA0
22 25 0 247 1 125 0 0 0 0 0 176 2 109 2 0 0
 -&gt; ack
 7 24 0 5 0 98 0 44 2
 -&gt; ack
 25 91 0 0 0 72 2 27 0
 24 70 0 0 0 240 2 24 0
 20 25 0 71 2 130 0 0 0 0 0 0 0 168 0
 -&gt; ack
 25 91 0 0 0 75 2 27 0
 21 27 0 0 0 41 0 35 0 52 0 92 0 96 0
 -&gt; ack
 24 70 0 0 0 240 2 24 0
 22 25 0 247 1 125 0 0 0 0 0 76 2 89 2 0 0
 -&gt; ack
 25 90 0 0 0 74 2 27 0
 24 70 0 0 0 240 2 24 0
 20 25 0 71 2 130 0 0 0 0 0 0 0 172 0
 -&gt; ack
 25 90 0 0 0 76 2 27 0
 21 27 0 0 0 41 0 35 0 53 0 92 0 96 0
 -&gt; ack
 24 70 0 0 0 240 2 24 0
 22 25 0 244 1 126 0 0 0 0 0 139 2 68 2 0 0
 -&gt; ack
 7 24 0 2 0 105 0 58 2
 -&gt; ack
 25 90 0 0 0 76 2 27 0
 24 70 0 0 0 240 2 24 0

</pre><p>With the following from the second Pi (simultaneous):</p>
<pre>
$ minicom -b57600 -D/dev/ttyAMA0

OK&nbsp;&sup2;          &Ograve;&Ntilde;&Aacute;A2 Ҳ4&nbsp;&deg;&nbsp;&uml;KM&sect;%DH&oslash;OK &micro;&sup2;&nbsp;?????M$&amp;&Ocirc;S  IԊ&Acirc;&Aacute;A0 0 0 0 &plusmn;&middot;&sup2;&nbsp;JK&amp;&brvbar;R&Ocirc;&ograve;
                                                                                           ԍ&shy;5O&Euml;ˠM&curren;&#39;      
ي&nbsp;K&micro;굳&nbsp;        &cent;&Iacute;k 0 ͵&sup3;HN&amp;*&sup2;&Acirc;&ordf;&Ugrave;&Aacute;R 
    &shy;5
       OK 2&acute;           &cent;&Eacute;A24 0 (-60) 
OK 5ɴ&nbsp;M$&amp;)&sup2;&Ecirc;ʂ&Ugrave;&aacute;A2 0 0 ٨KM&brvbar;%D&Ocirc;&ograve;
                                                      ԍ&shy;5OK &sup3;&sup1;&nbsp;&sup2;LH&amp;2&ordf;&ordf;&Acirc;Bj&sup2;&Ecirc;ʂj)]&gt; ack
OK &sup2;&micro;&nbsp;N&amp;$       &ordm;&sup2;&Yacute;݁a (-58) 
OK 24 70&nbsp;&deg;&nbsp;LH&amp;        I&cent;&Aacute;Q-56)&nbsp;OK 5&sup2;&nbsp;M$&amp;&Ocirc;S      IԊ&Aacute;a 0 0 0 0 170 0 (&shy;&acute;&plusmn;J&curren;&Ocirc;&ograve;
                                                                                           ԍ&shy;5OK&nbsp;M$&sect;       ٭&frac34;X&not;&shy;H&oslash;OK 24&nbsp;&middot;&deg;?????H&amp;$&amp;     I&cent;&Acirc;j&sup2;&Ecirc;ʂ*)&yuml;OK&nbsp;&micro;LM$&amp;S&Eacute;&Yacute;@0 0ɠ&deg;HL&uml;&brvbar;S&Acirc;&Eacute;Ɂa 0 (-60) &nbsp;-&frac34;&nbsp;&aacute;&atilde;&euml;     &aacute;
</pre><p>I can sometimes get a sane looking frame (emonHub has managed to pass data to emonCMS for a couple of my nodes), but still... obviously something is seriously amiss!</p>
<p>I&#39;m at a loss, unfortunately. I&#39;ve confirmed that the RFM12 board gives the same output in minicom&nbsp;on either Pi, so the issue is definitely in the way I&#39;m interfacing with the RFM69 board.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25898"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5190.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-5190.jpg" alt="Schism&#039;s picture" title="Schism&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/5190.html" title="View user profile.">Schism</a> on Wed, 17/12/2014 - 09:57.</div>
    <div class="content">
     <p>Glynn, any thoughts on this? I don&#39;t really know how to proceed since using minicom is about as low level as I have any understanding of. I&#39;ve tried a couple of different baud rates, but as you&#39;d expect that doesn&#39;t improve&nbsp;anything...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25899"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7218.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="emjay&#039;s picture" title="emjay&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/7218.html" title="View user profile.">emjay</a> on Wed, 17/12/2014 - 10:34.</div>
    <div class="content">
     <p>Clearly the asynch driver is disturbed by the RFM69CW activity, presumably at interrupt time.</p>
<p>Most individual lines start ok and some data is intact at line end. The (-nn) is the new RSSI indication. Is received buffer length important to minicom?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25902"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Wed, 17/12/2014 - 11:45.</div>
    <div class="content">
     <p>Hi guys,&nbsp;</p>
<p>I think we could be experiencing exactly what Martin mentioned in a post above...thanks a lot for your insight Martin.&nbsp;57600 baud is out of spec for an ATmega328&nbsp;@ 8Mhz.&nbsp;38400 is the max baud should be used. It seems that most of the time we get away with working out of spec,&nbsp;however as you have shown this is not always the case.&nbsp;</p>
<p>I will re-compile the RFM12Pi RFM69CW code today and issue a flashable .hex file.&nbsp;&nbsp;</p>
<p>Paul: Will emonHub recognise&nbsp;38400 baud?&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25910"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Wed, 17/12/2014 - 14:12.</div>
    <div class="content">
     <p>Updated .hex files and sketch on GitHub to use 38400 baud&nbsp;<a href="https://github.com/openenergymonitor/RFM2Pi/tree/master/firmware/RFM69CW_RF_Demo_ATmega328">https://github.com/openenergymonitor/RFM2Pi/tree/master/firmware/RFM69CW_RF_Demo_ATmega328</a></p>
<p>​emonHub does not currently autodetect&nbsp;38400 baud. It must be set in emonHub&nbsp;conf under init_settings of EmonHubJeeInterfacer</p>
<p>com_baud = 38400</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25912"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5190.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-5190.jpg" alt="Schism&#039;s picture" title="Schism&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/5190.html" title="View user profile.">Schism</a> on Wed, 17/12/2014 - 16:07.</div>
    <div class="content">
     <p>OK, sweet. I&#39;ll give this a try when I get home and update.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25919"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Wed, 17/12/2014 - 22:53.</div>
    <div class="content">
     <p>Update: emonhub&nbsp;does now auto detect 38400 baud if your using the latest &#39;testing&#39; branch. Expect merge into &#39;development&#39; soon.&nbsp;https://github.com/emonhub/emonhub/issues/58</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25921"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5190.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-5190.jpg" alt="Schism&#039;s picture" title="Schism&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/5190.html" title="View user profile.">Schism</a> on Wed, 17/12/2014 - 23:01.</div>
    <div class="content">
     <p>OK, cooking on gas!</p>
<pre>
pi@pi-dev ~/RFM2Pi/firmware/RFM69CW_RF_Demo_ATmega328 $ minicom -b38400 -D/dev/ttyAMA0

Welcome to minicom 2.6.1

OPTIONS: I18n 
Compiled on Apr 28 2012, 19:24:31.
Port /dev/ttyAMA0

Press CTRL-A Z for help on special keys


[RF12demo.12] O i15 g210 @ 433 MHz q1

Available commands:
   i     - set node ID (standard node ids are 1..30)
   b      - set MHz band (4 = 433, 8 = 868, 9 = 915)
   o   - change frequency offset within the band (default 1600)
               96..3903 is the range supported by the RFM12B
   g    - set network group (RFM12 only allows 212, 0 = any)
   c      - set collect mode (advanced, normally 0)
  t          - broadcast max-size test packet, request ack
  ..., a - send data packet to node , request ack
  ..., s - send data packet to node , no ack
   q      - set quiet mode (1 = don&#39;t report bad packets)
   x      - set reporting format (0: decimal, 1: hex, 2: hex+ascii)
  123 z      - total power down, needs a reset to start up again
Remote control commands:
  ,,, f     - FS20 command (868 MHz)
  ,, k              - KAKU command (433 MHz)
Current configuration:
 O i15 g210 @ 433 MHz q1
OK 53 27 0 0 0 91 0 82 0 100 0 132 0 135 0 (-51) 
 -&gt; ack
OK 52 25 0 75 2 171 0 0 0 0 0 0 0 177 0 (-42) 
 -&gt; ack
</pre>         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25923"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 17/12/2014 - 23:12.</div>
    <div class="content">
     <p>Whoooohoo!!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25924"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 17/12/2014 - 23:15.</div>
    <div class="content">
     <p>Only problem now is those high node id&#39;s due to the acks. this is the same thing fluppie007&nbsp;saw, I will look at PM&#39;s and see if I can determine what his fix was.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25927"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 17/12/2014 - 23:43.</div>
    <div class="content">
     <blockquote><p><em>Only change I&#39;ve made is to change mySerial.print((int) rf12_hdr); to&nbsp;mySerial.print((int) (rf12_hdr &amp; 0x1F)); to correct the node numbers output to the Pi.</em></p>
</blockquote>
<p>I think this comment may relate to this line but maybe Glyn can shed some light as I&#39;m not entirely sure.</p>
<p><a href="https://github.com/openenergymonitor/RFM2Pi/blob/master/firmware/RFM69CW_RF_Demo_ATmega328/RFM69CW_RF12_Demo_ATmega328/RFM69CW_RF12_Demo_ATmega328.ino#L641">RFM69CW_RF12_Demo_ATmega328.ino#L641</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25935"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5190.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-5190.jpg" alt="Schism&#039;s picture" title="Schism&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/5190.html" title="View user profile.">Schism</a> on Thu, 18/12/2014 - 00:31.</div>
    <div class="content">
     <p>Interesting. I haven&#39;t tried to change the sketch as I&#39;m not quite at the stage of compiling that stuff over ssh on the Pi, but if I manually print those node IDs &amp; 0x1F&nbsp;with a quick perl script&nbsp;then I get the expected values... if someone can explain what that is all about I&#39;d be interested to understand (we&#39;re throwing away the first three bits, right? But why?)</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25937"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 18/12/2014 - 01:57.</div>
    <div class="content">
     <p>If you see&nbsp;<a href="http://jeelabs.net/projects/jeelib/wiki/RF12demo#Eeprom-Layout">http://jeelabs.net/projects/jeelib/wiki/RF12demo#Eeprom-Layout</a></p>
<p>The first 3 bits don&#39;t apply to the node id, that bit I get ok, but I don&#39;t get why they are&nbsp;included if they don&#39;t apply and how they gets&nbsp;<span style="font-size:12.7272720336914px; line-height:18.9090900421143px">affec</span><span style="font-size:12.7272720336914px; line-height:18.9090900421143px">ted</span><span style="font-size:12.7272720336914px; line-height:18.9090900421143px">&nbsp;by using&nbsp;</span>acks<span style="font-size:13px; line-height:1.6">. Maybe someone can enlighten us both.</span></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25945"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 18/12/2014 - 12:32.</div>
    <div class="content">
     <p>Ok, so the eeprom layout threw me, right concept, wrong reference. I have since worked out the rf12_hdr refers to the packet&#39;s header byte and those 3 bits <u>do</u> include&nbsp;the &quot;request ack&quot; bit. In a&nbsp;normal non-targeted broadcast those 3 bits would be 000 but when an ack is requested they are 001, adding 32 to the node id.</p>
<p><a href="http://jeelabs.org/2011/06/10/rf12-broadcasts-and-acks/">http://jeelabs.org/2011/06/10/rf12-broadcasts-and-acks/</a></p>
<p>That explains why acks &quot;cause&quot; the issue so I assume the use of the whole byte for the node id is just an an oversight due to the in frequent use of acks, I have therefore&nbsp;submitted a pull request for the fix.&nbsp;<a href="https://github.com/openenergymonitor/RFM2Pi/pull/1">https://github.com/openenergymonitor/RFM2Pi/pull/1</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25958"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5190.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-5190.jpg" alt="Schism&#039;s picture" title="Schism&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/5190.html" title="View user profile.">Schism</a> on Thu, 18/12/2014 - 15:22.</div>
    <div class="content">
     <p>Aha, right. That makes complete sense - nice one!</p>
<p>If Glyn&nbsp;has time to update the hex etc. on GitHub I&#39;ll confirm that this is resolved. Looking forward to seeing my RSSIs...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25965"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 18/12/2014 - 17:09.</div>
    <div class="content">
     <p>Have you tried emonhub&nbsp;yet? the nodes that are out of range will still be processed by emonhub and should be visible in the logs if loglevel set to debug. Just emonCMS will not accept the data from node id&#39;s&nbsp;over 32.</p>
<p>The non-ack&#39;d&nbsp;nodes should also&nbsp;be making it through to emoncms&nbsp;with the rssi&#39;s.</p>
<p>Out of curiosity,&nbsp;How will the acks&nbsp;work with 2 receivers ?</p>
<p>​</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25967"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Thu, 18/12/2014 - 17:49.</div>
    <div class="content">
     <p>Hex file has been updated! Great work guys, tracking down this bug</p>
<p>&nbsp;</p>
<p><a href="https://github.com/openenergymonitor/RFM2Pi/blob/master/firmware/RFM69CW_RF_Demo_ATmega328/RFM69CW_RF12_Demo_ATmega328.cpp.hex">https://github.com/openenergymonitor/RFM2Pi/blob/master/firmware/RFM69CW_RF_Demo_ATmega328/RFM69CW_RF12_Demo_ATmega328.cpp.hex</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25977"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5190.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-5190.jpg" alt="Schism&#039;s picture" title="Schism&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/5190.html" title="View user profile.">Schism</a> on Thu, 18/12/2014 - 23:01.</div>
    <div class="content">
     <p>OK, I can confirm that I&#39;ve got a fully working parallel solution now - RFM69 and the old board both bringing in the whole set of sensors. Great work guys!</p>
<p>The gas people came this afternoon&nbsp;and replaced my old gas meter with a &quot;smart&quot; one. For my purposes this means I can stop strobing an IR LED to detect the reflective 0-digit and just use a reed switch - it&#39;s all go in my little emon world today!&nbsp;\o/</p>
<p>(On which note, the emonTH did an admirable job of monitoring the gas - it was about 95% accurate which isn&#39;t bad considering the iffy way I was detecting the consumption using optical reflection. The batteries lasted an eternity - many months - even though it is outside, protected by just a slim plastic casing)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25980"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5190.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-5190.jpg" alt="Schism&#039;s picture" title="Schism&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/5190.html" title="View user profile.">Schism</a> on Thu, 18/12/2014 - 23:32.</div>
    <div class="content">
     <p>Regarding the &quot;double ack&quot;, it will just work as you hope, that is, the emonTH&nbsp;broadcasts the data and then waits for confirmation. It doesn&#39;t matter which base station ACK hits it first. What you do afterwards with each base station could be significant though (for instance, you could harmlessly submit temperature from both base stations to one emonCMS feed, but you wouldn&#39;t want to do that with a gas pulse counter!)</p>
<p>In the general case my reliability of the emonTH nodes themselves is excellent. It&#39;s not perfect, for instance my attic / external emonTH&nbsp;crashed out twice this week just after fresh batteries were fitted (but had run seamlessly for months prior to that) but the ack helps I think.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25982"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 19/12/2014 - 00:06.</div>
    <div class="content">
     <p>Great to hear! It&#39;s interesting that you use the emonTH&nbsp;for pulse counting, it was designed for humidity and temperature monitoring, however I also had in mind pulse counting by&nbsp;breaking out the irq port on the terminal block. Would you be able to write a paragraph about your setup pulse counting on emonTH&nbsp;with a photo of your setup I&#39;ll post it up on the oem blog. An update to the emonTH will have a dip switch on board which could be used to switch between pulse counting and temperature and humidity operation. We should smart&nbsp;another thread, so we don&#39;t go off topic!&nbsp;</p>
<p>Big thanks to Paul for help&nbsp;debugging rfm12pi and excellent ongoing emonhub dev&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26054"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12Pi with RFM69CW</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 22/12/2014 - 13:54.</div>
    <div class="content">
     <p>The &quot;38400&quot; baud auto selection is now merged into the main &quot;development&quot; branch and &quot;57600&quot; option has been removed.</p>
<p>This may cause a little hassle for some early adopters of rf69&nbsp;if they do not install the new firmware. But since&nbsp;it&#39;s easy to define &quot;com_baud = 57600&quot; in the conf it&#39;s better&nbsp;removed sooner rather than later.</p>
<p>current version is now rc1.2&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/6244"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-01CyOxyaHirhN89YjxhttZwwYmxNor7JGs6uUxZ2RGQ" value="form-01CyOxyaHirhN89YjxhttZwwYmxNor7JGs6uUxZ2RGQ"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/6244 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:38:54 GMT -->
</html>
