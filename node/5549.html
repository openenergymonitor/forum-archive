<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/5549 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:12:58 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>RFM12PI receiver goes hard down sometimes | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">RFM12PI receiver goes hard down sometimes</h3>
        <span class="submitted">Submitted by <a href="../user/5733.html" title="View user profile.">Andrew Wedmore</a> on Wed, 13/08/2014 - 15:11</span>
        <div class="content"><p>I have got a raspberry pi with emoncms (HD version) and three separate EmonTX transmitters, covering my solar generation, surplus power diverters, and thermal store temperature.</p>
<p>I have been running it for about 3 months now and it has been very successful.</p>
<p>The problem I have is that every few days the RFM12PI wireless receiver goes hard down.</p>
<p>I think that I have isolated the problem to the wireless receiver because I can still use the emoncms web interface when this problem occurs, and I can still input data manually via the json interface.</p>
<p>Also when the problem occurs I lose data from all 3 wireless transmitters simultaneously.</p>
<p>On my rasperry pi, I have tried stopping and restarting the rfm12piphp process but the problem remains.&nbsp; What is more, the problem survives a software reboot of the pi (sudo reboot).&nbsp; However, normal reception resumes immediately if I disconnect the pi&#39;s power supply and plug it in again.</p>
<p>I have repeated the above scenario several times and I am confident that I am reporting the facts correctly.</p>
<p>I have also tried restarting the rfm12piphp process with the log option.&nbsp; The result was that the system created a log file but nothing was written to it.</p>
<p>the attached screenshot shows that the json interface can still recieve data (node 1) but nothing is coming from the wireless transmitters (nodes 8, 9 in the screenshot).</p>
  <div class="forum-topic-navigation clear-block">
          <a href="10865.html" class="topic-previous" title="Go to previous forum topic">‹ Using an Emontx V3.4 as a MK2 PV Router with phase angle control</a>
              <a href="11735.html" class="topic-next" title="Go to next forum topic">Confusion over the different hardware modules ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-23048"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Wed, 13/08/2014 - 22:15.</div>
    <div class="content">
     <p>What version of the RFM12Pi have you got? V1 with attiny or V2 with ATmega328? The V2&nbsp;is tested to be very reliable.&nbsp;</p>
<p>It might be the software on the pi. EmonHub&nbsp;is the current activity mentioned and reliable rfm12pi&nbsp;raspberrypi gateway service&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23055"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5733.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Andrew Wedmore&#039;s picture" title="Andrew Wedmore&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/5733.html" title="View user profile.">Andrew Wedmore</a> on Thu, 14/08/2014 - 08:59.</div>
    <div class="content">
     <p>Thank you for responding.&nbsp; I have looked at the board and along one edge is printed &quot;RFM12Pi V2.5.3&quot; - so I assume that that&#39;s version 2</p>
<p>The reason that I assumed that it wasn&#39;t the software on the pi is that the problem continues after a software reboot of the pi (ssh to the pi command line and issue sudo reboot command) but is immediately fixed if I power off / power on the pi.&nbsp;</p>
<p>I deduce from this that a software reboot of the pi does not actually &quot;reboot&quot; the RFM12Pi whereas a power cycle obviously does.&nbsp;</p>
<p>As far as solving the problem is concerned, my idea is that I think I could write a monitoring program that would detect when the RFM12Pi had stopped receiving, then I would like that program to send a command to the RFM12Pi to reset itself - I have no idea if sending such a command is possible or how I would do it.</p>
<p>I do know that problems are not always where they seem to be and I&#39;m open to any suggestions.&nbsp; The problem occurs randomly.&nbsp; Once the problem occurs it never goes away of its own accord, but once I get the RFM12Pi going again it usually works fine for several days.</p>
<p>I&#39;ve already written some software that monitors the voltage level of my battery bank and feeds the data into emoncms via the json interface.&nbsp; I&#39;m planning to develop this to a point where the pi becomes the command centre for the whole of my off-grid system.&nbsp; That&#39;s why I need to find a way of addressing the reliability of the data collection process.</p>
<p>I attach a screenshot showing a graph of solar generation and battery bank voltage.&nbsp; You can see that the solar power generation data (which comes via the RFM12Pi) suddenly stops at 12:47 (the brown area on the graph) whereas the battery voltage data (which is automatically input using the emoncms json interface, not via the RFM12Pi) carries on (the blue line on the graph).&nbsp; NB this is not zero values, it is an absence of data.</p>
<p>Thanks in advance for any help anyone can give.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23817"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5733.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Andrew Wedmore&#039;s picture" title="Andrew Wedmore&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/5733.html" title="View user profile.">Andrew Wedmore</a> on Mon, 15/09/2014 - 16:19.</div>
    <div class="content">
     <p>Apologies for the long delay, I can only investigate this problem when it occurs, which is totally randomly (as far as I can tell).&nbsp; After several weeks of things working perfectly, the problem has just occurred again, and I have made a little bit more progress in investigating it.&nbsp; Here is the scenario:</p>
<p>1. I notice that emoncms has stopped receiving data from all 3 emontx transmitters simultaneously, while still getting data that a separate process is injecting via the json interface.</p>
<p>2. I connect to the raspberry pi with ssh and reboot it</p>
<blockquote><pre>
$ ssh pi@192.168.10.106
pi@raspberrypi $ sudo reboot</pre></blockquote>
<p>3. The problem has not been fixed.&nbsp; Still no data from any of the emontx while the json service is still fine.</p>
<p>4. I decided to use minicom to try and investigate the rfm12pi interface.</p>
<blockquote><pre>
$ ssh pi@192.168.10.106

pi@raspberrypi $ sudo service rfm12piphp stop
pi@raspberrypi $ minicom -b9600 -D/dev/ttyAMA0</pre></blockquote>
<p>5. Minicom shows just the welcome screen, no sign of any data [Screenshot AfterReboot.png]</p>
<p>6. I physically unplug the pi from its power supply and plug it in again.</p>
<p>7. As soon as the pi reboots, the problem completely fixed.&nbsp;</p>
<p>8. I use minicom again to look at the rfm12piphp interface again (repeat of step 4)</p>
<p>9. This time minicom shows a steady stream of data from the rfm12pi [Screenshot AfterPowerCycle.png]</p>
<p>To my mind, this shows that the problem is not on the raspberry pi, it must be on the rfm12pi expansion board itself.&nbsp;</p>
<p>(This makes it sound like I knew what I was doing.&nbsp; In fact it was all painfully slow, ie all bound up with learning Linux, discovering minicom and how to use it etc, etc)</p>
<p>I infer that rebooting the pi by software command does not reboot the rfm12pi, whereas obviously power cycling the pi does reboot the rfm12pi.&nbsp;</p>
<p>I am interested in anything that can help me get closer to a solution - for example (a) is there something I could do to diagnose the problem more precisely (b) is there some way of sending a command to the rfm12pi to reset itself, or (c) do I need a firmware upgrade to the rfm12pi or something like that?</p>
<p>I&#39;ve also noticed an older thread with what looks like the same problem<br />
	<a href="2947.html" title="http://openenergymonitor.org/emon/node/2947">http://openenergymonitor.org/emon/node/2947</a></p>
<p>, but I&#39;m not able to understand enough of that to know if it&#39;s relevant.</p>
<p>	&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23829"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 16/09/2014 - 11:09.</div>
    <div class="content">
     <p>Your logic seems sound and the issue does indeed appear to be with the RFM2Pi&nbsp;board which, as rule, are extremely reliable, I would recommend updating the firmware on the RFM2Pi&nbsp;as there were some issues with random lock-ups ( for example see&nbsp;<a href="3584.html">http://openenergymonitor.org/emon/node/3584</a>&nbsp;) which have been alleviated&nbsp;with firmware updates.</p>
<p>A guide to updating the firmware directly using the Pi is found in the wiki&nbsp;<a href="http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2">http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2</a></p>
<p>Paul</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23852"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5733.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Andrew Wedmore&#039;s picture" title="Andrew Wedmore&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/5733.html" title="View user profile.">Andrew Wedmore</a> on Tue, 16/09/2014 - 17:34.</div>
    <div class="content">
     <p>Thank you very much for that.&nbsp; I hadn&#39;t seen thread 3584 before, despite searching - it describes my problem exactly.</p>
<p>Looking at <a href="https://github.com/mharizanov/RFM2Pi/tree/master/firmware/RF12_Demo_atmega328" title="https://github.com/mharizanov/RFM2Pi/tree/master/firmware/RF12_Demo_atmega328">https://github.com/mharizanov/RFM2Pi/tree/master/firmware/RF12_Demo_atme...</a> I see that there is a version of RF12_Demo_atmega328.cpp.hex that is dated 10 April 2014.&nbsp; I purchase my rfm12pi on 3 July 2013 so obviously it will have an older version.</p>
<p>I will be big and brave and attempt the firmware upgrade.&nbsp; I plan to do this from the Raspberry pi; the instructions at <a href="http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2#Upgrading_RFM12Pi_Firmware_Direct_from_the_Pi" title="http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2#Upgrading_RFM12Pi_Firmware_Direct_from_the_Pi">http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2#Upgrading_R...</a> seem clear.&nbsp;</p>
<p>However I do have one concern.&nbsp; I see at the same github location that there is also an update for Optiboot328_8mhz_RF12_Demo.hex&nbsp; Would I need to flash that one as well?&nbsp; If so, can I also do that from the raspberry pi?&nbsp; The instructions at <a href="http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2#Flashing_the_Bootloader" title="http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2#Flashing_the_Bootloader">http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2#Flashing_th...</a> don&#39;t really say either way.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23853"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 16/09/2014 - 17:56.</div>
    <div class="content">
     <p>I think you just need the firmware updated that&#39;s all I recall doing to mine.</p>
<p>Hopefully someone will correct me if I&#39;m wrong but I believe&nbsp;you would need an ISP programmer to change the bootloader&nbsp;and it probably&nbsp;hasn&#39;t been modified itself, the updated version is probably&nbsp;just the combined original&nbsp;bootloader and later firmware.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23865"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Wed, 17/09/2014 - 11:56.</div>
    <div class="content">
     <p>No, as Paul correctly said you don&#39;t need to flash the Optiboot. That&#39;s the serial bootloder wich is flashed via ISP in the factory. The serial bootloder enables subsequent firmware updates to be done over serial.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23874"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5733.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Andrew Wedmore&#039;s picture" title="Andrew Wedmore&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/5733.html" title="View user profile.">Andrew Wedmore</a> on Wed, 17/09/2014 - 18:56.</div>
    <div class="content">
     <p>I have had a go but I&#39;m not sure if it worked.&nbsp;&nbsp;</p>
<p>I followed the instructions at <a href="http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2#Upgrading_RFM12Pi_Firmware_Direct_from_the_Pi" title="http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2#Upgrading_RFM12Pi_Firmware_Direct_from_the_Pi">http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2#Upgrading_R...</a></p>
<p>I think that the git pull worked because I got files with new datestamps.</p>
<p>However, when I ran the avrdude command, I got lots of error messages saying</p>
<p>avrdude-original: stk500_getparm(): (a) protocol error, expect=0x14, resp=0x78</p>
<p>which are leading me to think that the firmware upgrade did not work.</p>
<p>Here is the entire output:</p>
<pre>
pi@raspberrypi ~/RFM2Pi/firmware/RF12_Demo_atmega328 $ sudo avrdude -v -c arduino -p ATMEGA328P -P /dev/ttyAMA0 -b 38400 -U flash:w:RF12_Demo_atmega328.cpp.hex 

avrdude-original: Version 5.11.1, compiled on May 23 2012 at 11:08:25
                  Copyright (c) 2000-2005 Brian Dean, <a href="http://www.bdmicro.com/" title="http://www.bdmicro.com/">http://www.bdmicro.com/</a>
                  Copyright (c) 2007-2009 Joerg Wunsch

                  System wide configuration file is &quot;/etc/avrdude.conf&quot;
                  User configuration file is &quot;/root/.avrduderc&quot;
                  User configuration file does not exist or is not a regular file, skipping

                  Using Port                    : /dev/ttyAMA0
                  Using Programmer              : arduino
                  Overriding Baud Rate          : 38400
done with autoreset
                  AVR Part                      : ATMEGA328P
                  Chip Erase delay              : 9000 us
                  PAGEL                         : PD7
                  BS2                           : PC2
                  RESET disposition             : dedicated
                  RETRY pulse                   : SCK
                  serial program mode           : yes
                  parallel program mode         : yes
                  Timeout                       : 200
                  StabDelay                     : 100
                  CmdexeDelay                   : 25
                  SyncLoops                     : 32
                  ByteDelay                     : 0
                  PollIndex                     : 3
                  PollValue                     : 0x53
                  Memory Detail                 :

                                           Block Poll               Page                       Polled
                    Memory Type Mode Delay Size  Indx Paged  Size   Size #Pages MinW  MaxW   ReadBack
                    ----------- ---- ----- ----- ---- ------ ------ ---- ------ ----- ----- ---------
                    eeprom        65    20     4    0 no       1024    4      0  3600  3600 0xff 0xff
                    flash         65     6   128    0 yes     32768  128    256  4500  4500 0xff 0xff
                    lfuse          0     0     0    0 no          1    0      0  4500  4500 0x00 0x00
                    hfuse          0     0     0    0 no          1    0      0  4500  4500 0x00 0x00
                    efuse          0     0     0    0 no          1    0      0  4500  4500 0x00 0x00
                    lock           0     0     0    0 no          1    0      0  4500  4500 0x00 0x00
                    calibration    0     0     0    0 no          1    0      0     0     0 0x00 0x00
                    signature      0     0     0    0 no          3    0      0     0     0 0x00 0x00

                  Programmer Type : Arduino
                  Description     : Arduino

avrdude-original: stk500_getparm(): (a) protocol error, expect=0x14, resp=0x78

avrdude-original: stk500_getparm(): (a) protocol error, expect=0x14, resp=0xfe

avrdude-original: stk500_getparm(): (a) protocol error, expect=0x14, resp=0x00

avrdude-original: stk500_getparm(): (a) protocol error, expect=0x14, resp=0x80
                  Hardware Version: -1225059712
                  Firmware Version: 344576.-1227354920

avrdude-original: stk500_getparm(): (a) protocol error, expect=0x14, resp=0x78

avrdude-original: stk500_getparm(): (a) protocol error, expect=0x14, resp=0x00

avrdude-original: stk500_getparm(): (a) protocol error, expect=0x14, resp=0xf8

avrdude-original: stk500_getparm(): (a) protocol error, expect=0x14, resp=0xf8

avrdude-original: stk500_getparm(): (a) protocol error, expect=0x14, resp=0x78
                  Vtarget         : 0.0 V
                  Varef           : 34456.0 V
                  Oscillator      : 10.698 Hz
                  SCK period      : 3328572456.6 us

avrdude-original: stk500_getparm(): (a) protocol error, expect=0x14, resp=0x1e

avrdude-original: stk500_getparm(): (a) protocol error, expect=0x14, resp=0x78
avrdude-original: stk500_initialize(): (a) protocol error, expect=0x14, resp=0xe0
avrdude-original: initialization failed, rc=-1
                  Double check connections and try again, or use -F to override
                  this check.

avrdude-original: stk500_disable(): protocol error, expect=0x14, resp=0x78</pre><p>I&#39;m pretty sure that rfm12piphp was stopped OK, because there is a gap in my data.</p>
<p>The good news is that I was able to restart rfm12piphp afterwards so at any rate I haven&#39;t damaged it, but I have no idea if the firmware upgrade actually worked.&nbsp;</p>
<p>Thanks once again for all your help.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23882"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 18/09/2014 - 09:28.</div>
    <div class="content">
     <p>No, that doesn&#39;t look right !</p>
<p>It looks good up to&nbsp;&quot;Description&nbsp;&nbsp;&nbsp;&nbsp; : Arduino&quot; but it doesn&#39;t complete reading the device, so will not of worked.</p>
<p>To reduce the chance of damaging anything just try reading the device only and when that has been successful&nbsp;try flashing again. use the same command without &quot; -U flash:w:RF12_Demo_atmega328.cpp.hex &quot; this will just read the device and should give you an output that starts as above but instead of the errors you should get</p>
<blockquote><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Programmer Type : Arduino<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Description&nbsp;&nbsp;&nbsp;&nbsp; : Arduino<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Hardware Version: 3<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Firmware Version: 4.4<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Vtarget&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 0.3 V<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Varef&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 0.3 V<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Oscillator&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 28.800 kHz<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SCK period&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 3.3 us</p>
<p>avrdude-original: AVR device initialized and ready to accept instructions</p>
<p>Reading | ################################################## | 100% 0.00s</p>
<p>avrdude-original: Device signature = 0x1e950f<br />
		avrdude-original: safemode: lfuse reads as 0<br />
		avrdude-original: safemode: hfuse reads as 0<br />
		avrdude-original: safemode: efuse reads as 0</p>
<p>avrdude-original: safemode: lfuse reads as 0<br />
		avrdude-original: safemode: hfuse reads as 0<br />
		avrdude-original: safemode: efuse reads as 0<br />
		avrdude-original: safemode: Fuses OK</p>
<p>&nbsp;</p>
</blockquote>
<p>I found when I did mine it failed a couple of times due to low (or unstable) voltage, when I used a larger power supply it sailed through first time, It may be something completely different in your case but it may be worth trying to improve the power supply, if you have non-essential&nbsp;usb&nbsp;devices unplug them (even wifi dongle if you can) or even use a different SD card so you can unplug the HDD.</p>
<p>Paul</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23903"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5733.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Andrew Wedmore&#039;s picture" title="Andrew Wedmore&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/5733.html" title="View user profile.">Andrew Wedmore</a> on Thu, 18/09/2014 - 16:28.</div>
    <div class="content">
     <p>Success!&nbsp; I proceeded as follows:</p>
<ul>
<li>
		stopped the rfm12piphp service</li>
<li>
		changed to the directory containing the new firmware</li>
<li>
		issued the avrdude command without the &quot; -U flash:w:RF12_Demo_atmega328.cpp.hex &quot; at the end and saw that it output all the information suggested in previous post, down to and including &quot;Fuses OK&quot;</li>
<li>
		issued the avrdude command again, with the &quot; -U flash:w:RF12_Demo_atmega328.cpp.hex &quot; at the end and saw that it proceeded through &quot;reading&quot;, &quot;writing&quot; and &quot;verifying&quot; stages without any error messages.</li>
<li>
		restarted rfm12piphp service and saw that emoncms was receiving data again</li>
</ul>
<p>My plan B had been to boot the pi from another card as an SD-only device (as distinct from the HDD version which I am running) and try it that way, but obviously that wasn&#39;t necessary.</p>
<p>Only time will tell whether the new firmware solves the original problem of the rfm12pi board locking up randomly, but I am of course optimistic.</p>
<p>Also, I was enlightened by Glyn&#39;s comment:</p>
<pre>
the Optiboot ... serial bootloder enables subsequent firmware updates to be done over serial.</pre><p>That clarified something that I had been struggling to understand.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24393"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Wed, 08/10/2014 - 20:01.</div>
    <div class="content">
     <p>I just had it happen for the first time in many months on the latest (as far as I am aware) firmware, looks like a watchdog on the rfm12pi&nbsp;might be a good idea</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24601"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Fri, 17/10/2014 - 08:46.</div>
    <div class="content">
     <p>Happened again so I've swapped radios</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24620"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5733.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Andrew Wedmore&#039;s picture" title="Andrew Wedmore&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/5733.html" title="View user profile.">Andrew Wedmore</a> on Sat, 18/10/2014 - 07:53.</div>
    <div class="content">
     <p>As the original raiser of this thread, I would just like to record that the solution (upgrade the rfm12pi receiver firmware to the latest version) has worked for me.&nbsp; That is to say, it has now been working solidly for a whole month, which was not happening before.</p>
<p>I also have &quot;monit&quot; installed on the rasberry pi, in case the receiver software ever crashes out, but this may just be belt and braces - receiver crashing out was not the problem here.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24655"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Sun, 19/10/2014 - 09:25.</div>
    <div class="content">
     <p>It did for me for many months but recently occurred again, I too used to use monit maybe it&#39;s time to install again but first I&#39;ll see how the radio swap&nbsp;goes. I&#39;m seriously considering a wired solution for more critical systems such as CH control, I&#39;ve already had to turn off acks&nbsp;for most nodes as they appeared to be blocking each other. Maybe the radio spectrum is especially busy in these parts.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24913"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Sat, 01/11/2014 - 14:50.</div>
    <div class="content">
     <p>Happened again yesterday but at least now I can su poweroff then powercycle&nbsp;the RaspberryPi&nbsp;from my mobile thanks to Juice (ssh client for Android) and a web app I built myself.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24921"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Sun, 02/11/2014 - 09:58.</div>
    <div class="content">
     <p>Hi Brain,</p>
<p>Sorry to hear of the issue your having with the RFM12Pi. I am keen to try and&nbsp;track this issue down. Please could you confirm what version of the RFM12Pi you have and what firmware your running. Have you updated to the latest version?&nbsp;&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24944"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Mon, 03/11/2014 - 13:09.</div>
    <div class="content">
     <p>It&#39;s a V2 with the latest firmware plus a small amendment to increase the buffer size as here&nbsp;<a href="https://github.com/mharizanov/RFM2Pi/blob/master/firmware/RF12_Demo_atmega328/RF12_Demo_atmega328.ino" target="_blank">https://github.com/mharizanov/RFM2Pi/blob/master/firmware/RF12_Demo_atmega328/RF12_Demo_atmega328.ino</a>&nbsp;to overcome an issue with packetgen limiting the size of transmissions&nbsp;. I&#39;m not clear whether this has actually been implemented in your latest developement versions.</p>
<p>I have the same firmware on 2 V2s&nbsp;both exhibit the same occasional lock ups. I was thinking that implementing a watchdog in the firmware to reset&nbsp;on lockup would be the way to go.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24945"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Mon, 03/11/2014 - 13:14.</div>
    <div class="content">
     <p>Looks like the embedded link has queued my response for moderation so I&#39;ll repeat my answer. It&#39;s a V2 with the latest firmware I&#39;m aware of. The link was to the firmware version on GitHub that I&#39;m using.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24947"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 03/11/2014 - 14:01.</div>
    <div class="content">
     <p>Patience Bra1n, patience! Anyway, I've promoted you to 'OEM Power User' so you should be OK now.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24951"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Mon, 03/11/2014 - 17:18.</div>
    <div class="content">
     <p>Who Hoo ... Promotion :)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24961"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dBC&#039;s picture" title="dBC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Mon, 03/11/2014 - 23:36.</div>
    <div class="content">
     <p><em>I was thinking that implementing a watchdog in the firmware to reset on lockup would be the way to go</em></p>
<p>You can also use the wdog to help you find out where it&#39;s hanging. &nbsp;The AVR wdog has a nifty &quot;interrupt the first time, and reset the second time&quot; feature. &nbsp;During the ISR for the first firing, you can store away system state (and even the PC off the stack) into non-volatile storage such as EEPROM. &nbsp;The second firing will then reset you, and you just need to add a way to display the system state previously stored away.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27348"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/937.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Bramco&#039;s picture" title="Bramco&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/937.html" title="View user profile.">Bramco</a> on Tue, 03/02/2015 - 13:11.</div>
    <div class="content">
     <p>Not sure if I should be hijacking this thread but I have a similar problem. I&#39;ve had my system running flawlessly for about 18 months, diverting away with Martin&#39;s sketch and transmitting temperatures from my tank.</p>
<p>However occasionally&nbsp;l have had power failures, in one case the power supply to the pi failed, other times it&#39;s been the mains supply and sometimes I&#39;ve shut down the pi with sudo shot down.</p>
<p>Not every time but often enough when I get power back on the pi the radio won&#39;t restart. Doing a bit of checking, what happens is the green led on the rfm12pi flashes once but then doesn&#39;t go into it&#39;s running state of flashing every few seconds.</p>
<p>I&#39;ve been solving this by just restarting again which normally gets things going but just today this seems to have stopped working. Any pointers as to what to try next gratefully received. I have done a search but this post seems to be the nearest to the issues I&#39;m having although I do need to add that I have never had comms fail once the rfm12pi is up and running. My issue is only on startup.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27350"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/937.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Bramco&#039;s picture" title="Bramco&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/937.html" title="View user profile.">Bramco</a> on Tue, 03/02/2015 - 13:20.</div>
    <div class="content">
     <p>Isn&#39;t that just brilliant! Sod&#39;s law at work here.&nbsp;</p>
<p>It&#39;s working again. I had rebooted before writing the post above. Sat down to write the post, then went back to where the pi is installed and hey presto the little led is flashing away fine and I can see the data in my dashboards...</p>
<p>Guess I&#39;ll just have to more patient until the number of retries gets excessive.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30278"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8158.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="SteveM&#039;s picture" title="SteveM&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8158.html" title="View user profile.">SteveM</a> on Tue, 12/05/2015 - 15:07.</div>
    <div class="content">
     <p>Not sure whether to post here or start a new thread.</p>
<p>I am having identical problems but with a RFM69Pi. I can get data for days or weeks, but then it will stop receiving and the pi will need a power cycle to get it working again.</p>
<p>Is there a command to reset the radio which I could try?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30307"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1894.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Ian Eagland&#039;s picture" title="Ian Eagland&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Wed, 13/05/2015 - 16:12.</div>
    <div class="content">
     <p>Hi</p>
<p>Just to add that I have a similar problem as well. I am waiting for it to fail again so I can check if the RFM led is still working. (It&#39;s so small I did not even know it was there until&nbsp;Paul (emonhub) told me. Typical, since I learned&nbsp;about the LED it has not failed!</p>
<p>Regards</p>
<p>Ian&nbsp;&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30344"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 14/05/2015 - 11:38.</div>
    <div class="content">
     <p>Hi Steve - Can you confirm if the led on the rfm69pi&nbsp;is&nbsp;<span style="line-height: 20.7999992370605px;">flashing&nbsp;</span><span style="line-height: 1.6;">intermittently</span><span style="line-height: 1.6;">&nbsp;to signify it is receiving&nbsp;but not passing the data or just dead?</span></p>
<p><span style="line-height: 1.6;">Hi Ian - That&#39;s been quite a while now, fingers crossed a ?</span></p>
<p><span style="line-height: 1.6;">There is no built in command to reset the rfm2pi&nbsp;and I&#39;m not sure it would work if the AVR is getting stuck anyway. It would be good to see a watchdog in the sketch too but I am working on a watchdog in emonhub that if the rfm device doesn&#39;t pass anything for a while emonhub will attempt a communication and if no response is received it will then physically hard reset the AVR using the reset line (used during programming) by pulsing the gpio pin.</span></p>
<p>This will be in the next emonhub (hopefully) but in the meantime I have attached a python script download and install using (rpi-rw&nbsp;1st if using read-only)</p>
<p>&nbsp;</p>
<p>sudo wget -O /usr/bin/reset_rfm2pi&nbsp;http://openenergymonitor.org/emon/sites/default/files/reset_rfm2pi.txt</p>
<p>sudo chmod +x /usr/bin/reset_rfm2pi</p>
<p>​</p>
<p>Then you can reset the rfm2pi&nbsp;any time using&nbsp;the command&nbsp;<strong>sudo&nbsp;reset_rfm2pi. </strong>If you find this works to reset the rfm2pi without restarting emonhub or the Pi then maybe adding the watchdog mentioned above would be the way&nbsp;to go.&nbsp;</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30347"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8158.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="SteveM&#039;s picture" title="SteveM&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8158.html" title="View user profile.">SteveM</a> on Fri, 15/05/2015 - 00:05.</div>
    <div class="content">
     <p>It dropped out again today and I can confirm there is no flashing light.</p>
<p>I will download and install the script and post the results when I get a chance to test it.</p>
<p>&nbsp;</p>
<p>Edit:Woke this morning to find no inputs for 6 hours. Tried the script but it didn&#39;t bring it back to life</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30406"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Fri, 15/05/2015 - 23:03.</div>
    <div class="content">
     <p>Actually you will have to stop the&nbsp;emonhub service before using the script to make the serial port available to reset the rfm2pi and then restart it again afterwards, if you are using the emonSD image you can use emonhub -x to stop and emonhub -s to start again (otherwise sudo service emonhub stop and sudo service emonhub start).&nbsp;</p>
<p>If you can confirm the led flashes periodically and that the reset script works whilst all is ok, then when it faults you can compare responses, eg you should get a longer led flash immediately after resetting&nbsp;the AVR as that is part of the setup. If that happens when testing but isn&#39;t happening when at fault either the serial port or the AVR&nbsp;is locked for some reason. If the longer flash does occur but the reception (periodic flashes) don&#39;t resume then it would point to the AVR resetting as expected but the rfm module is not working.</p>
<p>Does the emonhub.log shed any light? unlikely in this instance but worth checking.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30432"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8158.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="SteveM&#039;s picture" title="SteveM&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8158.html" title="View user profile.">SteveM</a> on Sun, 17/05/2015 - 06:20.</div>
    <div class="content">
     <p>Total contents of emonhub.log any time I have checked it is:</p>
<pre>
2015-05-15 08:01:55,435 INFO EmonHub Pre-Release Development Version (rc1.2)
2015-05-15 08:01:55,438 INFO Opening hub...</pre><p>I&#39;m not seeing the longer flash (or any change in the flashing) while testing but I can see that stopping and starting the service is working</p>
<pre>
2015-05-15 08:01:55,435 INFO EmonHub Pre-Release Development Version (rc1.2)
2015-05-15 08:01:55,438 INFO Opening hub...
2015-05-17 06:11:40,221 INFO EmonHub Pre-Release Development Version (rc1.2)
2015-05-17 06:11:40,224 INFO Opening hub...
</pre><p>I&#39;ll update after trying on a locked system, if and when it happens again.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30434"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sun, 17/05/2015 - 08:40.</div>
    <div class="content">
     <p>If you change the loglevel to DEBUG in emonhub.conf you will see far more info.</p>
<p>Do you see the single longer flash when restarting the rfm2pi? The script is intended to &quot;reset&quot; the rfm2pi&#39;s&nbsp;AVR in a way that should trigger the initial &quot;setup()&quot; routine as if it had just been powered up.</p>
<p>It&#39;s easy to miss the extended&nbsp;led flash at &quot;setup()&quot; as it only happens&nbsp;once and although I say &quot;extended&quot; as it&#39;s longer than the usual flash, it is still quite quick.&nbsp;but it should happen immediately after powering up (or using the reset_script), but restarting emonHub or rebooting the Pi will not &quot;reset&quot; the rfm2pi so no extended flash will be seen.</p>
<p>For the absence of a flash when using the script to have any meaning you will need to confirm that it normally does occur.&nbsp;</p>
<p>Which model Pi are you using is it a B, B+ or 2B ?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30438"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8158.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="SteveM&#039;s picture" title="SteveM&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8158.html" title="View user profile.">SteveM</a> on Sun, 17/05/2015 - 09:05.</div>
    <div class="content">
     <p>I have noticed the longer flash when I power up the pi. I am not getting that when I run the reset script.</p>
<p>I have a model B raspberry pi.</p>
<p>I have set the log to debug level so that I can get more info when it stops</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30441"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sun, 17/05/2015 - 10:54.</div>
    <div class="content">
     <p>It looks like the script isn&#39;t working,&nbsp;I had only previously tested this on a Pi 2B, so to rule out any gpio numbering issues I have just tried it on a Pi B with a rfm69&nbsp;RFM2Pi&nbsp;and it worked as expected. I used just these 3 lines</p>
<p>&nbsp;</p>
<p>sudo wget -O /usr/bin/reset_rfm2pi&nbsp;http://openenergymonitor.org/emon/sites/default/files/reset_rfm2pi.txt</p>
<p>sudo chmod +x /usr/bin/reset_rfm2pi</p>
<p>​sudo&nbsp;reset_rfm2pi</p>
<p>&nbsp;</p>
<p>Do you get any error messages when trying to use the script ?</p>
<p>what response&nbsp;do you get to &quot;&nbsp;ls -la&nbsp;&nbsp;/usr/bin/reset_rfm2pi​ &quot; ?</p>
<p>Are you using Raspbian OS is it up&nbsp;to date?</p>
<p>Does &quot;&nbsp;sudo apt-get install python-rpi.gpio &quot; confirm the gpio module is installed? (latest version?)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30446"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8158.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="SteveM&#039;s picture" title="SteveM&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8158.html" title="View user profile.">SteveM</a> on Sun, 17/05/2015 - 12:43.</div>
    <div class="content">
     <p>I get no errors using the script.</p>
<p>I installed the script by copying and pasting the&nbsp;lines from the post (from the 14th) above straight into a command shell. The OS is installed from the image dated 13/3/15 &amp; updated today. GPIO module is installed and newest version.</p>
<pre>
pi@emonbase ~ $ ls -la /usr/bin/reset_rfm2pi
-rwxr-xr-x 1 root root 406 May 14 11:28 /usr/bin/reset_rfm2pi
</pre><p>​I compared the script in that file to what was posted above and it is exactly the same. To be sure I deleted the file and re-downloaded it using the above steps in case it was corrupted somehow but there was no change.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30453"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sun, 17/05/2015 - 14:36.</div>
    <div class="content">
     <p>Well that&#39;s bizarre!</p>
<p>This should be quite straight forward, it&#39;s nothing new or complex the script just borrows from the &quot;avrdude-rpi&quot; script that&#39;s already tried and tested. You could try adding a print line after the &quot;GPIO.cleanup()&quot; line &nbsp;to at least confirm the script has been run.&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; ...<br />
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<em>GPIO.cleanup()</em><br />
&nbsp; &nbsp; &nbsp; &nbsp; <strong>print (&#39;A reset of the RFM2Pi has been attempted&#39;)</strong><br />
<em>except ........</em></p>
<p>I don&#39;t have a RFM69Pi&nbsp;to test but cannot think of any reason&nbsp;it would be different off-hand. I have tested on Pi B, Pi 2B, RFM2Pi(rfm69) and RFM2Pi(rfm12) on 2 different firmwares. I have tried it with emonHub&nbsp;running and stopped, I have tried it read-only too not sure what else to suggest.</p>
<p>You could also try increasing the reset duration from &quot;sleep(0.12)&quot; to &quot;sleep(1)&quot; as it is not timing&nbsp;critical when not being used for with avrdude for actual&nbsp;programming.</p>
<p>Paul</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30455"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8158.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="SteveM&#039;s picture" title="SteveM&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8158.html" title="View user profile.">SteveM</a> on Sun, 17/05/2015 - 15:40.</div>
    <div class="content">
     <p>I put the print statement in&nbsp;and it comes up on the screen while running the script, so I know the script is running through. I also changed the time delay but still no flash.</p>
<p>I appreciate your help in this.</p>
<p>I can try this on a Pi2B, but not until next weekend. Maybe someone else will see this before then and give it a try.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30517"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8189.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="toberkel&#039;s picture" title="toberkel&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8189.html" title="View user profile.">toberkel</a> on Tue, 19/05/2015 - 20:22.</div>
    <div class="content">
     <p>Hi there,</p>
<p>I have the exact same problem. But I am using a rfm69Pi v3.1, a Pi2 with Raspian and the latest firmware for the Pi2 and rfm69pi.&nbsp;</p>
<p>I just found the reset script mentioned earlier. If my rfm69pi board hangs again, I will try the script... Will the script also work with the Pi2? Just asking because the Pi2 has more GPIOs...</p>
<p>I noticed somthing today. When I power down the Pi and disconnect the board from the GPIOs, the board has it&#39;s old config (group id, node id etc). But when it &quot;hangs&quot; and I power down the Pi, it&#39;s resetted to the defaults... Other node and group ID and the freq is set to 433 Mhz, but I&#39;m using a 868 mhz version...</p>
<p>Regards,<br />
toberkel</p>
<p><i>[A duplicate of this post has been deleted. Please observe the notice on the right "NEW USERS, PLEASE READ - Posts held for moderation" - Moderator (RW)]</i></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30520"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8189.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="toberkel&#039;s picture" title="toberkel&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8189.html" title="View user profile.">toberkel</a> on Tue, 19/05/2015 - 21:49.</div>
    <div class="content">
     <p>How do you manage to powercycle the Pi via ssh when it&#39;s powered off?&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30524"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8158.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="SteveM&#039;s picture" title="SteveM&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8158.html" title="View user profile.">SteveM</a> on Tue, 19/05/2015 - 23:13.</div>
    <div class="content">
     <p>I shut it down via ssh ( sudo poweroff ),&nbsp;and then go and physically turn it off and on again</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30532"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 20/05/2015 - 10:37.</div>
    <div class="content">
     <p>Hi toberkel, would it be possible for you to try the script prior to &quot;hanging&quot;? This would not only give you a insight as to what normally happens to gauge&nbsp;what actually happens when in a fault condition, but&nbsp;may&nbsp;go a long way towards helping fathom out why the script won&#39;t work for SteveM, plus if it&#39;s not working we may be able to correct that before you need it.</p>
<p>You cannot &quot;powercycle&quot; either the Pi or the AVR via SSH as there is no control of the power rails, since &quot;powercycling&quot; the Pi is only needed to interrupt the power to the GPIO&nbsp;to cause the AVR to reset this script is intended to negate the need for &quot;powercycling&quot; and therefore permit remote resets.</p>
<p>The &quot;forgetting&nbsp;the frequency&quot; is an interesting find&nbsp;as that suggests a problem related to&nbsp;the eeprom if it&#39;s the cause but if it&#39;s an effect&nbsp;maybe it&#39;s the frequency that gets&nbsp;changed and the RFM2Pi&nbsp;is not &quot;hanging&quot; but just not seeing any data on the alternative frequency and assumed to be hanging? although the latter I would expect to be resolved by restarting emonhub as correct frequency would be set if the RFM2Pi&nbsp;settings did not match the intended frequency</p>
<p>It would be useful to know if there is any abnormal log entries in emonhub.log, you can&nbsp;set loglevel&nbsp;to DEBUG and be able to locate the last good&nbsp;RFM2Pi&nbsp;packet quite easily if this reoccurs</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30534"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Wed, 20/05/2015 - 11:44.</div>
    <div class="content">
     <p>Hi guys,</p>
<p>We have noticed the same problem with the emonPi, which shares much of the code with the RFM69Pi. It seems to be a JeeLib RFM69CW issue. It&#39;s strange that I have never had my RFM69Pi do the same in many many months of opperation.&nbsp;</p>
<p>It seems the issue is with the RF driver rather than the ATmega328 or emonHub. It seems the RF stopps receiving data from my emonTx and emonTH but the ATmega328 is still doing local sampling on the emonPi and succesfully serial printing on node 5. The RF comes back to life when I change the group to something else then back to group &#39;1&#39; which is what I use in my house.&nbsp;</p>
<p>Here is a minicom serial output showing the ATmega328&nbsp;doing local sampling on group 5 then me brining the RF back to life by changing the group:</p>
<p><img alt="" src="../sites/default/files/Screenshot%2b2015-05-20%2bat%2b09.27.31.png" style="width: 500px; height: 548px;" /></p>
<p>I tried today recompiling pulling in latest changes to JeeLib:&nbsp;<a href="https://github.com/jcw/jeelib/commits/master">https://github.com/jcw/jeelib/commits/master</a></p>
<p>There are various branches to JeeLib, it seems to be a few bugs to do with RFM69CW. Could this be the same issue we are experiencing:&nbsp;<a href="http://xn--http-u76a://jeelabs.net/boards/6/topics/6374">​http://jeelabs.net/boards/6/topics/6374</a></p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30537"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 20/05/2015 - 12:51.</div>
    <div class="content">
     <p>Glyn - When it fails again could you try changing&nbsp;a different setting eg change nodeid and back again? or better still when it next stops without letting emonhub&nbsp;alter anything on reboot (disable RFM2Pi&nbsp;interfacer&nbsp;before reboot) &quot;powercycle&quot; and&nbsp;check to see if it has reverted to group 210.</p>
<p>I wonder if the values retained in&nbsp;the eeprom&nbsp;(or absence of such) are causing an issue when accessed by the code and by changing a setting the eeprom is being overwritten, in&nbsp;toberkel&#39;s case, &quot;powercycling&quot; is reloading the default of&nbsp;433Mhz, the same scenario for SteveM&nbsp;would be successful&nbsp;as he is using all defaults.</p>
<p>Paul​</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30538"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8189.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="toberkel&#039;s picture" title="toberkel&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8189.html" title="View user profile.">toberkel</a> on Wed, 20/05/2015 - 13:01.</div>
    <div class="content">
     <p>Hi Paul,</p>
<p>thanks for your detailed answer... I will execute the script after I returned from work.</p>
<p>When the board "hangs" and I connect via minicom to it, the frequency is till set to 868 mhz and the groud id is also 235 (which I am using).</p>
<p>I will come back to you with the script results...</p>
<p>Regards,<br />
toberkel</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30543"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8189.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="toberkel&#039;s picture" title="toberkel&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8189.html" title="View user profile.">toberkel</a> on Wed, 20/05/2015 - 21:18.</div>
    <div class="content">
     <p>I just executed the script without any error or output... My values still get updated, so I think everything is fine... Hopefully it will work when the Pi "hangs" again too</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30558"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Thu, 21/05/2015 - 09:39.</div>
    <div class="content">
     <p>@paul&nbsp;All EEPROM stuff has been stripped out for the emonPi so this is not the issue</p>
<p><a href="https://github.com/openenergymonitor/emonpi/tree/master/Atmega328/emonPi_RFM69CW_RF12Demo_DiscreteSampling">https://github.com/openenergymonitor/emonpi/tree/master/Atmega328/emonPi_RFM69CW_RF12Demo_DiscreteSampling</a></p>
<p>​I had the same issue again this morning, so using latest JeeLib has not solved anything. I tried restarting emonHub but this did nothing. As before changing the network group then back again brought it back to life. It seems it&#39;s requiring an RF initialize to start working again.&nbsp;&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30689"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8189.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="toberkel&#039;s picture" title="toberkel&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8189.html" title="View user profile.">toberkel</a> on Wed, 27/05/2015 - 14:20.</div>
    <div class="content">
     <p>Hi,</p>
<p>this morning I had a freeze again. The script wasn't working...</p>
<p>I also tried to change the group id and afterwards change it back, but I failed... After typing "210g" the board replied with "config save failed" and the group id still was 235... So I had to powercycle the pi. After login I had to change all the settings from the rfm69pi board... Node id, group id and frequency was set to defaults :-/</p>
<p>Regards,<br />
​toberkel </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30721"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 28/05/2015 - 13:32.</div>
    <div class="content">
     <p><em>&quot;this morning I had a freeze again. The script wasn&#39;t working...&quot; </em>Unfortunatly&nbsp;this doesn&#39;t have much meaning until&nbsp;you confirm&nbsp;whether the script works normally. Do you see a longer LED pulse immediately after using the script?</p>
<p>Looking at the sketch&nbsp;&quot;config save failed&quot; can only be a result of a failed&nbsp;eeprom&nbsp;write, since Glyn is not using the eeprom&nbsp;one can only assume the data being written to the eeprom is the issue as you are clearly experiencing eeprom issues if the settings are &quot;not retained&quot; in which I include erroneous&nbsp;overwriting.</p>
<p>Glyn&nbsp;-&nbsp;I notice (in the rfm69 sketch)&nbsp;the configSilent() returns the node id and a truth test is done on that, is it therefore possible if the node id was lost, null or zero a &quot;successful&quot; eeprom write (with bad data) would be considered a fail due to the 0 node id ? if something along those lines happened it might not&nbsp;be so obvious to spot running&nbsp;the emonpi&nbsp;sketch.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31116"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8189.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="toberkel&#039;s picture" title="toberkel&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8189.html" title="View user profile.">toberkel</a> on Wed, 10/06/2015 - 08:43.</div>
    <div class="content">
     <p>Hi... I just had a freeze again... I found a solution without rebooting or power cycling the pi... If I start minicom and use the &quot;123 z&quot; option, I can reset the board with the script... Afterwards I have to configure it again with the group ID and frequency I&#39;m using... But hey, no reboot needed anymore... Maybe I can build the 123z command into the script or something so I can restart it completely with the script or automatically... Anyone an idea how to send the 123z via the script?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31149"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8189.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="toberkel&#039;s picture" title="toberkel&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8189.html" title="View user profile.">toberkel</a> on Wed, 10/06/2015 - 09:32.</div>
    <div class="content">
     <p>Is it possible to allow me to post without a review? Thats a bit anoying... ;)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31196"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Thu, 11/06/2015 - 13:05.</div>
    <div class="content">
     <p>Hi guys,</p>
<p>I have had success fixing a similar issue I had been experiencing&nbsp;with the emonPi&nbsp;where the RFM69CW would hang. This now seems to have been fixed by latest commits to JeeLib library. I have re-compiled the RFM69Pi&nbsp;firmware using latest JeeLib. I have bumped the RF12_demo version number from 12 to 13 to enable us to tell the difference. If you&#39;re experiencing hanging issues please could you try the new firmware.&nbsp;</p>
<p><a href="https://github.com/openenergymonitor/RFM2Pi/blob/master/firmware/RFM69CW_RF_Demo_ATmega328/V13_RFM69CW_RF12_Demo_ATmega328.cpp.hex">https://github.com/openenergymonitor/RFM2Pi/blob/master/firmware/RFM69CW_RF_Demo_ATmega328/V13_RFM69CW_RF12_Demo_ATmega328.cpp.hex</a></p>
<p>You can update by running the update script pointing&nbsp;to&nbsp;V13_RFM69CW_RF12_Demo_ATmega328.cpp.hex</p>
<p><a href="https://github.com/openenergymonitor/RFM2Pi/blob/master/update-RFM69">https://github.com/openenergymonitor/RFM2Pi/blob/master/update-RFM69</a>​</p>
<p>Please let me know the results.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31197"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8189.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="toberkel&#039;s picture" title="toberkel&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8189.html" title="View user profile.">toberkel</a> on Thu, 11/06/2015 - 13:08.</div>
    <div class="content">
     <p>Hey Glyn,</p>
<p>thanks, I will try this when I&#39;m home! :)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31201"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 11/06/2015 - 14:23.</div>
    <div class="content">
     <p>You could be on to something there Glyn, I never use the hex files, I always compile&nbsp;locally which maybe why I don&#39;t see&nbsp;the same issues since I will of unintentionally&nbsp;always had&nbsp;the latest JeeLib.</p>
<p>So is this hex file the same rfm69&nbsp;&quot;v12&quot; sketch just recompiled with latest JeeLib and&nbsp;no other changes to the sketch?</p>
<p>toberkel - That command shouldn&#39;t &quot;restart&quot; it should put it into a sleep state requiring a powercycle to exit.&nbsp;</p>
<p><a href="https://github.com/openenergymonitor/RFM2Pi/blob/master/firmware/RFM69CW_RF_Demo_ATmega328/RFM69CW_RF12_Demo_ATmega328/RFM69CW_RF12_Demo_ATmega328.ino#L314">https://github.com/openenergymonitor/RFM2Pi/blob/master/firmware/RFM69CW_RF_Demo_ATmega328/RFM69CW_RF12_Demo_ATmega328/RFM69CW_RF12_Demo_ATmega328.ino#L314</a></p>
<p>​or a proper &quot;reset&quot; signal which is what I was trying to do with the&nbsp;script. The Pi has never needed a reboot for this issue it&#39;s just away of powercycling the RFM2Pi without disconnecting it.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31206"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Thu, 11/06/2015 - 16:49.</div>
    <div class="content">
     <p>@pb66</p>
<p>Q. &quot;So is this hex file the same rfm69&nbsp;&quot;v12&quot; sketch just recompiled with latest JeeLib and&nbsp;no other changes to the sketch?&quot;</p>
<p>A. Yes, exactly&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31208"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1894.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Ian Eagland&#039;s picture" title="Ian Eagland&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Thu, 11/06/2015 - 19:22.</div>
    <div class="content">
     <p>Hi</p>
<p>Well its been a long wait but again my test has stopped posting. I can confirm that the led on the rfm had stopped flashing. Unfortunately I cannot investigate restarting because of brain fade.&nbsp;I shut the pi down via ssh (intending to shut down my main server!)</p>
<p>I have restarted the pi and its now posting away again. It &nbsp;worked&nbsp;OK&nbsp;for about 12 weeks before it failed.</p>
<p>Regards</p>
<p>Ina</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31221"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8158.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="SteveM&#039;s picture" title="SteveM&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8158.html" title="View user profile.">SteveM</a> on Fri, 12/06/2015 - 01:00.</div>
    <div class="content">
     <p>I have updated the firmware as indicated above. Note that the reset_rfm12pi&nbsp;script still doesn&#39;t cause the light to flash after this update, but I assume the reason for the update was for stability rather than control.</p>
<p>I&#39;ll post here if I get another hang, this usually has been between 2 - 28 days.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31227"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8189.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="toberkel&#039;s picture" title="toberkel&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8189.html" title="View user profile.">toberkel</a> on Fri, 12/06/2015 - 08:00.</div>
    <div class="content">
     <p>@pb66</p>
<p>Yes, but with my way I don&#39;t need to powercycle the pi... I send the 123z command via minicom and afterwards I execute the mentioned script. Then, when I start minicom again, the board is responding and after I configured the propper&nbsp;settings (frequency, group id) it shows the packets again. So, maybe I can automate this process...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31229"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 12/06/2015 - 08:42.</div>
    <div class="content">
     <p>Thanks a lot for testing so promptly.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31231"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1894.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Ian Eagland&#039;s picture" title="Ian Eagland&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Fri, 12/06/2015 - 08:59.</div>
    <div class="content">
     <p>Hi</p>
<p>I have tried to update firmware as above but get&nbsp;avrdude: command not found.</p>
<p>Is this normally installed in the emonhub or do I need to upgrade software?</p>
<p>Also I have RFM12pi v2.6 pcb with an RFM69&nbsp;sub pcb. Is this new V13 firmware correct for this set up.</p>
<p>Regards</p>
<p>Ian&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31232"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 12/06/2015 - 09:02.</div>
    <div class="content">
     <p>You should be able to install it and auto reset by git cloning running the update script here:&nbsp;<a href="https://github.com/openenergymonitor/avrdude-rpi">https://github.com/openenergymonitor/avrdude-rpi</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31233"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8189.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="toberkel&#039;s picture" title="toberkel&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8189.html" title="View user profile.">toberkel</a> on Fri, 12/06/2015 - 09:03.</div>
    <div class="content">
     <p>Could someone please remove the flag &quot;post needs aproval&quot; for my account? :D</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31241"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8189.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="toberkel&#039;s picture" title="toberkel&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8189.html" title="View user profile.">toberkel</a> on Fri, 12/06/2015 - 15:20.</div>
    <div class="content">
     <p>One of my posts is missing... :-/</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31511"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8158.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="SteveM&#039;s picture" title="SteveM&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/8158.html" title="View user profile.">SteveM</a> on Fri, 19/06/2015 - 13:39.</div>
    <div class="content">
     <p>One week later... Hung again :(</p>
<p>I&#39;ll swap out the Pi with a a Pi 2 over the weekend and see if there is any improvement.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31645"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 23/06/2015 - 21:56.</div>
    <div class="content">
     <p>@toberkel - sorry I&#39;ve missed your posts somehow. If the reset script works to restart the rfm2pi then it is working and can therefore operate anytime, I think the LED activity must differ on some firmwares then. So the rfm2pi&nbsp;board is being reset you are just not aware as we have been expecting a longer LED flash. No need to use 123z or write an additional script.</p>
<p>The fact you need to re input the settings normally held in the eeprom&nbsp;is the key here although we can tell if it&#39;s the cause or the effect but either way they should be present and correct.</p>
<p>@SteveM - I would be very surprised if it made any difference, It seems the LED flash may not be a definite&nbsp;sign that the rfm2pi is being reset.&nbsp;</p>
<p>Paul</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31823"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 01/07/2015 - 15:58.</div>
    <div class="content">
     <p>I think I may have now experienced this. I noticed none of my RFM network inputs had updated on emoncms since 7am yesterday, checked the LED on the emonTx in the garage and that was still flashing as expected, but the rfm2pi&nbsp;(rfm69@433mhz&nbsp;running&nbsp;standard&nbsp;oem&nbsp;rfm69&nbsp;firmware, compiled locally with latest libs not from hex) was not flashing, when I ssh&#39;d in emonhub was still running just no signs of any rfm traffic.</p>
<p>Since I had the reset script&nbsp;still installed from the tests above I tried it (without stopping emonhub) and everything started back up once the rfm2pi&#39;s &quot;option instructions text&quot; had passed.</p>
<p>I cannot confirm if there were any settings lost on the rfm2pi because this one runs the default 15,210,433 settings, but it does mean if emonhub&nbsp;was made to respond to period of no receipts&nbsp;it could initiate the reset (and also resend the settings if needed).</p>
<p>This would side step but not fix the root issue.</p>
<p>It also confirms our suspicions about it being the rfm2pi&nbsp;(either fw,hw or influenced) rather than the Pi or emonhub as I did nothing but momentarily&nbsp;ground the avr&#39;s reset line via the gpio and script.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36463"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/937.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Bramco&#039;s picture" title="Bramco&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/937.html" title="View user profile.">Bramco</a> on Mon, 30/11/2015 - 09:02.</div>
    <div class="content">
     <p>I have had the same issue over the last few weeks. This is on a new hardware setup. Pi2, rfm69pi and a fresh install of V9 rc2 running on HDD as per Paul&#39;s installation manual.</p>
<p>Paul in the other thread you wrote</p>
<p><em>Bramco - The drop-outs maybe the rfm2pi&nbsp;locking out and rebooting the Pi also restarts the rfm2pi, see the latter part of the&nbsp;RFM12PI receiver goes hard down sometimes&nbsp;thread for more info. the test would be to ssh in and reset the rfm2pi by pulsing the reset pin (pin7&nbsp;of the Pi&#39;s gpio).</em></p>
<p><em>The issues here may apply but it would be unusual that no packets get through, these issues normally arise from clashes and/or bit syncing issues, the bit syncing is unlikely unless you have all the temp sensors disconnected (zero values) and although the extra sensitivity of the rfm69&nbsp;may introduce some clashing some data would still get through.</em></p>
<p><em>Paul</em></p>
<p>The next time it happens I will try the reset, I&#39;m assuming this is what&#39;s in your script mentioned above?</p>
<p>And just to be clear, this isn&#39;t about clashes or bit syncing issues, it&#39;s that the rfm69 has stopped. No flashing light. As I mentioned in the other thread I&nbsp;think, I&#39;m pretty sure I haven&#39;t got any Pi power issues, it&#39;s on a 2W power supply with a new USB hub on a separate power supply for the HDD.</p>
<p>Of all the folks that have contributed to this thread with the same issue. Have you sorted this or are you just putting up with it?</p>
<p>Simon</p>
<p>EDIT</p>
<p>PS to the above.</p>
<p>@Glynn&nbsp; &nbsp;- &nbsp;wouldn&#39;t it be sensible to make the flashes on the&nbsp;rfmxxpi&nbsp;boards more discernable. So extend the flash for normal&nbsp;behaviour/rf packet&nbsp;received to say 1 second?&nbsp;and make the&nbsp;flash at setup something different, e.g. three quick flashes. From a lot of contributions it seems that lots of people don&#39;t&nbsp;notice the flashes until it is pointed out to them.</p>
<p>Obviously haven&#39;t looked at the code to&nbsp;see&nbsp;how easy this would be but I think it might help.</p>
<p>Simon&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36527"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/937.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Bramco&#039;s picture" title="Bramco&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/937.html" title="View user profile.">Bramco</a> on Tue, 01/12/2015 - 14:51.</div>
    <div class="content">
     <p>Bump!!</p>
<p>Hi once again. &nbsp;:-)</p>
<p>Anyone from the thread above have a definitive solution to the rfm69pi suddenly stopping? Or do we just have to put up with occasional hard failures like this?</p>
<p>@ Glyn - any thoughts on improving the heartbeat and startup signals on the led? I.e. making them more easily discernable.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36554"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 01/12/2015 - 23:23.</div>
    <div class="content">
     <p>@Bramco - the problem in this thread was establishing a pattern and narrowing the diagnosis. some users have not been able to confirm the reset script even works&nbsp;during normal functioning and&nbsp;It is pretty difficult to establish if something reacts differently when faulty when the expected behavior&nbsp;is not confirmed.</p>
<p>Plus there are several different devices, several different firmwares&nbsp;etc. It would be good to get to the bottom of this but the lack of case data prevents any progress. have you tried the lateset&nbsp;firmware hex? (v13 -&nbsp;same firmware later JeeLib)</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36565"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/937.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Bramco&#039;s picture" title="Bramco&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/937.html" title="View user profile.">Bramco</a> on Wed, 02/12/2015 - 07:58.</div>
    <div class="content">
     <p>Thanks Paul for the summary. I was hoping some of the folks that have been on this thread might have found a solution in the interim but not thought to report it here.&nbsp;</p>
<p>It would be great to rename this thread with a SOLVED prefix &nbsp;:-)</p>
<p>Anyway, I&#39;ll check versions later and report back.</p>
<p>I still think that given quite a few users have seen this and reported it (and there&#39;s probably more out there that just do a reboot and don&#39;t report it) that it would be a good idea to get to the bottom of it or at least incorporate a solution to this in emonhub or somewhere. As you know I&#39;m not Linux fluent, so haven&#39;t a clue really where to start to think about a solution.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36573"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/937.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Bramco&#039;s picture" title="Bramco&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/937.html" title="View user profile.">Bramco</a> on Wed, 02/12/2015 - 13:09.</div>
    <div class="content">
     <p>Hi Paul,</p>
<p>Following the instructions here -&gt;&nbsp;http://wiki.openenergymonitor.org/index.php/RFM69Pi_V3</p>
<p>I get the following from&nbsp;avrdude which seems to be complaining about the user configuration file, i.e. <s>the firmware file.&nbsp;</s>&nbsp;&nbsp;On re-reading it seems to be the config file for avrdude.</p>
<p>Also in your note above you mention V13. Is the base file now V13? or should I be using this file not the base file? See the directory listing below.</p>
<p>Simon</p>
<p>pi@Homepi ~/RFM2Pi/firmware/RFM69CW_RF_Demo_ATmega328 $ ls<br />
Blink.cpp.hex<br />
Optiboot328_8mhz_RFM69CW_RF12_Demo_ATmega328.cpp.hex<br />
RFM12_Demo_ATmega328.cpp.hex<br />
RFM12_Demo_ATmega328.cpp.hex.readme<br />
RFM69CW_RF12_Demo_ATmega328<br />
RFM69CW_RF12_Demo_ATmega328.cpp.hex<br />
V13_RFM69CW_RF12_Demo_ATmega328.cpp.hex<br />
pi@Homepi ~/RFM2Pi/firmware/RFM69CW_RF_Demo_ATmega328 $ avrdude -v -c arduino -p ATMEGA328P -P /dev/ttyAMA0 -b 38400 -U flash:w:RFM69CW_RF12_Demo_ATmega328.cpp.hex</p>
<p>avrdude-original: Version 6.1, compiled on Jul &nbsp;7 2015 at 13:18:47<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Copyright (c) 2000-2005 Brian Dean, <a href="http://www.bdmicro.com/" title="http://www.bdmicro.com/">http://www.bdmicro.com/</a><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Copyright (c) 2007-2014 Joerg Wunsch</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System wide configuration file is &quot;/etc/avrdude.conf&quot;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; User configuration file is &quot;/root/.avrduderc&quot;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; User configuration file does not exist or is not a regular file, skipping</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Using Port &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: /dev/ttyAMA0<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Using Programmer &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: arduino<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Overriding Baud Rate &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: 38400<br />
avrdude-original: Using autoreset DTR on GPIO Pin 7</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36581"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 02/12/2015 - 13:43.</div>
    <div class="content">
     <p>Yes, you can ignore the &quot;user configuration file&quot; messages they are just confirming there is no &quot;per user&quot; conf file found, the system wide conf file is there.</p>
<p>The file you have chosen should work, as far as I recall that is the same sketch as the &quot;V13_&quot;&nbsp;version, only JeeLib&nbsp;was updated between the files being compiled, unless something has changed i think &quot;V13_&quot; should be the one to use, you should aware the V13 prefix was just to distinguish it from the existing compiled file V13 is still v12, perhaps V12a would have been more appropriate.&nbsp;</p>
<p>The output you show seems correct just not completed and/or any error message. Did it exit to the command prompt? Did it take long? Was&nbsp;there any led activity? is the Pi in read/write mode?</p>
<p>Did you try the reset script to confirm the reset pin/gpio connection? You can also test avrdude and the connection without attempting an upload by leaving the -U option off the command&nbsp;line you are using, it should read the AVR fuses and provide a reassuring&nbsp;print out confirming comms.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36589"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/937.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Bramco&#039;s picture" title="Bramco&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/937.html" title="View user profile.">Bramco</a> on Wed, 02/12/2015 - 15:24.</div>
    <div class="content">
     <p>Hi Paul,</p>
<p>avrdude&nbsp;didn&#39;t give any error messages, it simply exited to the command prompt and it was pretty immediate, no led activity and the pi is I&#39;m pretty sure in r/w mode. It&#39;s a Pi2 with rfm69&nbsp;set up following your installation instructions with a USB HDD.</p>
<p>Just tried the reset script which just returns to the command prompt with no output. I&#39;ve tried it with emonhub stopped as well as running - exactly the same behaviour.</p>
<p>How do I confirm the reset pin/gpio connection?</p>
<p>Running avrdude by leaving off the -U option gives me exactly the same output as running it with the -U option. I&#39;m a little concerned that the output indicates it is &#39;Using autoreset DTR on GPIO Pin 7&#39;. From reading the other documentation this refers to pin 4.</p>
<p>Sorry to be so much trouble here but it would be good to get to the bottom of this if there is a problem with the instructions.</p>
<p>PS It might be an idea to add the info about your reset script to the documentation on the rf2pi in the wiki.</p>
<p>Simon</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36652"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/937.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Bramco&#039;s picture" title="Bramco&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/937.html" title="View user profile.">Bramco</a> on Thu, 03/12/2015 - 20:33.</div>
    <div class="content">
     <p>Just an update to link to a solution to the avrdude not doing anything.</p>
<p>See this post by&nbsp;http://openenergymonitor.org/emon/node/11747 by Ingmar Verheij. &nbsp;Basically you need to use an old version of avrdude.</p>
<p>Simon</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36681"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM12PI receiver goes hard down sometimes</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Fri, 04/12/2015 - 00:14.</div>
    <div class="content">
     <p>if you are watching the output from the rfm2pi, either in a serial console or by tailing emonhub.log and use the reset script you should see the setup text to confirm it was reset, I think the reset script would be useful, I will be including it as part of a watchdog function&nbsp;in the next emonhub&nbsp;version, so that if there is no traffic from a rfm2pi for a given time it will be reset automatically, but this wouldn&#39;t &quot;fix&quot;&nbsp;rfm2pi&nbsp;problems, just make them tolerable.</p>
<p>The timing ofthe reset in avrdude&nbsp;6.1 seems to be different and extending it seems to help but I have not found a single timing that works everytime yet, reverting to the previous version just falls back to the tried and tested timing for the reset.</p>
<p>pin 7 and pin 4 are actually different naming conventions for the same physical pin.</p>
<p>Lets us know how you get on.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/5549"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-bdqaejbNd90Gg8Q0VhuQmGvN0KjYbE_tx5LGSLp-oC4" value="form-bdqaejbNd90Gg8Q0VhuQmGvN0KjYbE_tx5LGSLp-oC4"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
