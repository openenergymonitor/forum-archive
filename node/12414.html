<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>What happened to Sunday? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/emon/sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="/emon/modules/node/node.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/defaults.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/system.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/system-menus.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/user/user.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/modules/mollom/mollom.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/forum/forum.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/modules/views/css/views.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/comment/comment.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/themes/emon3/style.css?r" />
<style type="text/css" media="all">@import "/emon/sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="/emon/" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="/emon/">Home</a> » <a href="/emon/forum">Forums</a> » <a href="/emon/forum/5">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">What happened to Sunday?</h3>
        <span class="submitted">Submitted by <a href="/emon/user/9397" title="View user profile.">Xino</a> on Mon, 28/03/2016 - 11:16</span>
        <div class="content"><p>As seen in attached pic, none of my graphs, dashboard or APP, on emoncms.org or local emoncms on the RasPi, shows kWh data for Sunday&nbsp;the 27th March.&nbsp;Only thing different for that feed on that day was DST clock was set at 1AM. Could this be the cause? How can I fix it?</p>
<p>EDIT: I have now also noticed that all my logged feeds have shifted back 1 day.&nbsp;eg, Data logged for 05 Mar&nbsp;now shows up as 04 Mar.</p>
<p>&nbsp;</p>
<p>Thanks in advance.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="/emon/node/12439" class="topic-previous" title="Go to previous forum topic">‹ emonGLCD and formatting what&#039;s presented</a>
              <a href="/emon/node/12428" class="topic-next" title="Go to next forum topic">Emonlib and ADS1115 on nodemcu ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-40690"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: What happened to Sunday?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3" title="View user profile.">TrystanLea</a> on Mon, 28/03/2016 - 20:40.</div>
    <div class="content">
     <p>Hello Xino, I can see the issue with the kWh graph on myelectric. I will look into that. But Im unable to replicate any issues with dashboards, can you show a screenshot and describe the feeds that your using?</p>
<p>Is it the kwh per day data that your seeing that has shifted back 1 day? which visualisations are you seeing this in?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40692"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/9397" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Xino&#039;s picture" title="Xino&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: What happened to Sunday?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/9397" title="View user profile.">Xino</a> on Mon, 28/03/2016 - 21:33.</div>
    <div class="content">
     <p>Hi Trystan,</p>
<p>The shifted data is indeed from all kWh/d feeds. In the attached screenshots, &quot;Shifted1&quot;&nbsp;shows the selected day&nbsp;9 Mar in the graph but the data is for 8 Mar.</p>
<p>In &quot;Shifted2&quot; - Selected 27 Mar but data is of 26 Mar.&nbsp;</p>
<p>My Solar kWh/d feed is also messed up and&nbsp;looks like this:</p>
<p>2016-03-20 00:00:00, 4.4<br />
2016-03-21 00:00:00, 5.2<br />
2016-03-22 00:00:00, 4.6<br />
2016-03-23 00:00:00, 5.7<br />
2016-03-24 00:00:00, 6.4<br />
2016-03-25 00:00:00, 9.7<br />
2016-03-26 00:00:00, 8.9<br />
2016-03-27 00:00:00, 4.3<br />
2016-03-28 01:00:00, 2.3<br />
2016-03-27 00:00:00, 4.3</p>
<p>Thanks for helping.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40701"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: What happened to Sunday?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3" title="View user profile.">TrystanLea</a> on Tue, 29/03/2016 - 00:04.</div>
    <div class="content">
     <p>Hello Xino</p>
<p>I think I&#39;ve made some progress, I was actually working on a solution to use timezones correctly with phpfina cumulative kWh data for the new mysolar app that will include history so I was half way there. MyElectric on emoncms.org should now display the kWh correctly. Its important that the timezone of your browser matches the timezone set on the user profile page. If there is a mis match the present day wont be shown.</p>
<p>I&#39;ve created a branch called myelectric_timezone_fix for the app module with the changes that are running on emoncms.org. This branch needs a new data request function in emoncms which I have commited to the emoncms master branch - this data request function is based on requesting daily/monthly/annual values rather than values spaced by a fixed interval. Meaning that the result is timezone correct.</p>
<p>Attached is a screenshot of the last few days here showing the sunday. I will investigate the other graphs next.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40703"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/9397" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Xino&#039;s picture" title="Xino&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: What happened to Sunday?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/9397" title="View user profile.">Xino</a> on Tue, 29/03/2016 - 07:25.</div>
    <div class="content">
     <p>Great! &nbsp;MyElectric&nbsp;is now OK on my emoncms.org. On the dashboard kWh/d feeds for the graphs nothing was created for today (29 Mar).</p>
<p>So to get this fix on my local emoncms&nbsp;I need to update to the&nbsp;master branch and not the stable, correct?</p>
<p>&nbsp;</p>
<p>Cheers.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40704"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: What happened to Sunday?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3" title="View user profile.">TrystanLea</a> on Tue, 29/03/2016 - 08:08.</div>
    <div class="content">
     <p>Hello Xino, it would probably be better to stay on stable until we do a little more testing on this - otherwise you may be creating more work for yourself than needed. The underlying data for feeds created with the power_to_kwh input processor or wh_accumulator is not affected by this bug in the graph so once fixed your data will show up correctly.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40717"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/9397" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Xino&#039;s picture" title="Xino&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: What happened to Sunday?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/9397" title="View user profile.">Xino</a> on Wed, 30/03/2016 - 08:57.</div>
    <div class="content">
     <p>Hi Trystan, I&#39;ll stay on stable, thanks.</p>
<p>Also,&nbsp;I&nbsp;now have all&nbsp;DAILY PHPTIMESERIES feeds updating&nbsp;at 1AM since DST change. Is this part of the same bug?</p>
<p>For example:&nbsp;Data viewer CSV output:</p>
<p>2016-03-24 00:00:00, 4013.0<br />
2016-03-25 00:00:00, 3691.0<br />
2016-03-26 00:00:00, 4788.0<br />
<strong>2016-03-27 00:00:00, 4545.0<br />
2016-03-28 01:00:00, 5835.0<br />
2016-03-30 01:00:00, 4079.0</strong></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40720"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: What happened to Sunday?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3" title="View user profile.">TrystanLea</a> on Wed, 30/03/2016 - 10:51.</div>
    <div class="content">
     <p>Hello Xino, the daily timeseries bug is different and has been a long running bug with daily data on emoncms.org. All daily feeds created with power_to_kwh<u>d</u><strong> </strong>on emoncms.org reset at midnight UTC.</p>
<p>Im working on moving emoncms.org over to cumulative kWh feeds for calculating daily data as the standard approach on emoncms.org, it will be possible very soon to use a new post processing module Im developing in order to calculate cumulative kWh data from existing power data.</p>
<p>Once complete the next step will be to move to disabling the power_to_kWh/d input process and daily datatype on emoncms.org so that there is one approach that can be better supported.</p>
<p>As long as your power data is still recording ok you will be able to calculate and correct all of your kWh data from this very soon.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40737"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: What happened to Sunday?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3" title="View user profile.">TrystanLea</a> on Wed, 30/03/2016 - 16:52.</div>
    <div class="content">
     <p>I&#39;ve got an initial fix for timezone support in the emoncms bargraph visualisation. Sunday is back :)</p>
<p>There&#39;s a new property in the bargraph options called mode, if you set this to daily when using cumulative kWh data it will use the data request that returns daily data correct for the timezone set on the user profile page. This only works with PHPFina at the moment and is therefore suitable for feeds generated with power_to_kWh and wh_accumulator.</p>
<p><img alt="" src="https://openenergymonitor.org/emon/sites/default/files/timezonefix.png" style="width: 600px; height: 332px;" /></p>
<p>Il do a bit more testing and evaluate whats needed for the other visualisations and then make this available for testing on the emoncms master branch too.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40756"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: What happened to Sunday?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3" title="View user profile.">TrystanLea</a> on Thu, 31/03/2016 - 08:04.</div>
    <div class="content">
     <p>This is now available in the bargraph selector in the dashboard too and the changes have been committed to the master branch as well as being available on emoncms.org (a full page request may be needed to load the new javascript). I will update soon on merging this into stable and similar support in the other visualisations.</p>
<p>This support is still PHPFina engine specific and has been tested on feeds containing cumulative kWh data rather than daily kWh feeds - which will need an additional similar data request method for the phptimeseries feed engine.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40763"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/9397" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Xino&#039;s picture" title="Xino&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: What happened to Sunday?</h3>

    <div class="submitted">Submitted by <a href="/emon/user/9397" title="View user profile.">Xino</a> on Thu, 31/03/2016 - 12:50.</div>
    <div class="content">
     <p>Fantastic work!&nbsp;Sunday is back on dashboard graphs now. Thank You very much Trystan.</p>
<p>Cheers.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="/emon/node/12414"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-gmrdLWsxzjmJvmeW2wg0aopzjogcunsW3qfDVDXLEus" value="form-gmrdLWsxzjmJvmeW2wg0aopzjogcunsW3qfDVDXLEus"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>

</html>
