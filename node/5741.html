<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/5741 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:05:08 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>emonbase not sending data after changing location | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">emonbase not sending data after changing location</h3>
        <span class="submitted">Submitted by <a href="../user/6244.html" title="View user profile.">emicon</a> on Wed, 10/09/2014 - 17:03</span>
        <div class="content"><p>Hello,</p>
<p>i had a system emonTX3 + emonbase&nbsp;(raspberry with RockSolidGateway) sending data to my site with emoncms&nbsp;installed and working perfectly. Now i changed home and the emonbase (connected to internet with ethernet cable) does not send any data to site. I have updated the wpa_supplicant.conf file with the new ssid and psk but this not helped. Maybe i forgot something?</p>
<p>Thanks for the help</p>
<p>Emilio</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="518.html" class="topic-previous" title="Go to previous forum topic">‹ Questions about the CT Code</a>
              <a href="5747.html" class="topic-next" title="Go to next forum topic">OEM config file setup ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-23712"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonbase not sending data after changing location</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 10/09/2014 - 17:45.</div>
    <div class="content">
     <p>If you are connecting via Ethernet cable the&nbsp;wpa_supplicant.conf isn&#39;t used, it&#39;s only used for WiFi.&nbsp;</p>
<p>If you are using a different router (assumed due to new ssid and psk) &nbsp;are any fixed IP addresses the same as before?</p>
<p>When you say &quot;my site&quot; where is that hosted? has the IP address changed?</p>
<p>Paul</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23714"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6244.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6244.jpg" alt="emicon&#039;s picture" title="emicon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonbase not sending data after changing location</h3>

    <div class="submitted">Submitted by <a href="../user/6244.html" title="View user profile.">emicon</a> on Wed, 10/09/2014 - 18:20.</div>
    <div class="content">
     <p>yes i changed router and phone number and his IP address in my new location. But i dont remember i have used my router IP before in my settings. The internet site is hosted on a shared Linux server. I have installed emoncms 2 months ago and it worked fine all time.</p>
<p>Emilio</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23716"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonbase not sending data after changing location</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 10/09/2014 - 18:58.</div>
    <div class="content">
     <p>You could use the <a href="http://emoncms.org/site/docs/raspberrypigateway">troubleshooting section at the end of this guide</a>&nbsp; to check the gateway to see if any data is being forwarded and to where.</p>
<p>Also try manually sending a url from a browser to the server url&nbsp;to check it is accepting data. See&nbsp;<a href="http://emoncms.org/input/api">http://emoncms.org/input/api</a></p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23738"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6244.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6244.jpg" alt="emicon&#039;s picture" title="emicon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonbase not sending data after changing location</h3>

    <div class="submitted">Submitted by <a href="../user/6244.html" title="View user profile.">emicon</a> on Thu, 11/09/2014 - 07:23.</div>
    <div class="content">
     <p>Hello Paul, thanks for your answers :)</p>
<p>i&#39;m used to control oemgateway&#39;s output using a SSH session, now it look something like this:</p>
<p>2014-09-10 10:50:01,194 INFO Sending to mydomain/emoncms<br />
	2014-09-10 10:50:01,517 WARNING Send failure<br />
	2014-09-10 10:50:01,721 DEBUG Server mydomain/emoncms -&gt; send data: [10, 0, 3, 0, 0, 24052, 233], timestamp: 1410342135.12<br />
	2014-09-10 10:50:01,724 DEBUG Data string: &amp;time=1410342135.12&amp;node=10&amp;json={1:0,2:3,3:0,4:0,5:24052,6:233}<br />
	2014-09-10 10:50:01,727 DEBUG URL string: http://mydomain/emoncms/input/post.json?apikey=8b3c8a4c604a532067f4274517e8ea5f&amp;time=1410342135.12&amp;node=10&amp;json={1:0,2:3,3:0,4:0,5:24052,6:233}</p>
<p>When i send the data manually they are received fine and i can see the input and the node on my emoncms, for example using:<br />
	<a href="http://www.mydomain/emoncms/input/post.json?node=1&amp;csv=100,200,300" title="http://www.mydomain/emoncms/input/post.json?node=1&amp;csv=100,200,300">http://www.mydomain/emoncms/input/post.json?node=1&amp;csv=100,200,300</a></p>
<p>In this URL i have the www. string that is not generated by oemgateway. But also putting <a href="http://www.mydomain/" title="www.mydomain">www.mydomain</a> in oemgateway.conf nothing change.</p>
<p>Thanks for your patience.</p>
<p>Emilio</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23741"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonbase not sending data after changing location</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 11/09/2014 - 08:43.</div>
    <div class="content">
     <p>Ok so using ssh&nbsp;means the Pi is network connected.</p>
<p>&quot;WARNING Send failure&quot; means the gateway did not get an &quot;ok&quot; returned for the URL it sent.</p>
<p>With regards to the manual test you did, firstly there is no apikey&nbsp;in the URL you say was successful, so can I assume you were logged in to emoncms at the time? If so can you test while logged out (I normally have 2 different browsers open, chrome i&#39;m logged in and internet explorer I&#39;m not).</p>
<p>You say you had &quot;www.&quot; in your URL but not originally in the gateway, did you have to add that to get it to work? did you or could you, try it without ?</p>
<p>You also state that nothing changed when you added &quot;www.&quot; to oemgateway.conf, can you confirm if mean you still didn&#39;t receive&nbsp;data at emoncms&nbsp;or that the URL string sent by the gateway didn&#39;t change.</p>
<p>A good test is to cut and paste a URL string from the gateway&#39;s log to test from a browser that is not logged into emoncms, just change the node id so that it is clearly obvious if the data appears in emoncms that it was the manual url and not a delayed gateway post. So for example from your log above I would copy &amp; paste the full &quot;DEBUG URL string:&quot; and change the node id to 1 like so</p>
<blockquote><p>http://mydomain/emoncms/input/post.json?apikey=8b3c8a4c604a532067f4274517e8ea5f&amp;time=1410342135.12&amp;node=1&amp;json={1:0,2:3,3:0,4:0,5:24052,6:233}</p>
</blockquote>
<p>If this is then sent from a browser that is not logged in it tests several things in one go.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23743"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6244.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6244.jpg" alt="emicon&#039;s picture" title="emicon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonbase not sending data after changing location</h3>

    <div class="submitted">Submitted by <a href="../user/6244.html" title="View user profile.">emicon</a> on Thu, 11/09/2014 - 09:19.</div>
    <div class="content">
     <p>Hello Paul,</p>
<p>&nbsp;</p>
<p>i have posted that URL from a non logged browser and it generated the correct input (except the time that is 23 hours ago, cause the old timestamp ^^). I can see the 6 keys with values, it seem to work perfectly manually.</p>
<p>I have created now an account on emoncms.org setting new apikey and domain on oemgateway.conf file. I have attached an image of SSH session where we can see that the data received by emonbase&nbsp;never change and the timestamp maybe is wrong. It seems it&#39;s the sender emonTX working wrong. What you think about?</p>
<p>Thanks again</p>
<p>Emilio</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23748"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonbase not sending data after changing location</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 11/09/2014 - 11:09.</div>
    <div class="content">
     <p>The problem has now changed !</p>
<p>The gateway was previously attempting to post the data but not getting the response it expected, the error code in your latest log following your changes shows the gateway has decided the url is not suitable, there is now an error in the configuration or the software that wasn&#39;t previously there or wasn&#39;t effecting the previous URL. &nbsp;</p>
<p>The latest log also shows the data has changed ac voltage has fluctuated&nbsp;slightly and the temp was 23.3 but has changed to 22.7 plus the timestamps refer to 8.45ish this morning not yesterday, so the emontx has worked today.</p>
<p>The manual URL test result tells us that particular URL was good (doesn&#39;t matter about the timestamp at the moment) however, was that URL string cut and pasted from the latest log or did you just post the example I gave you? the intention is a side by side test the gateway tries to send a url&nbsp;and doesn&#39;t get the response it expects, you then post that exact same url&nbsp;(with the node id edited) from a browser (not logged into emoncms) to see what response you get, 2 things you check for are, that the data is in emoncms&nbsp;and just as important is the response in the browser window is it&nbsp;</p>
<blockquote><p>ok</p>
</blockquote>
<p>Just ok on it&#39;s own in lowercase, that is the response the gateway is expecting. with this info we can do other checks to narrow it down but if you change anything and it doesn&#39;t work the test should be done again unless you are absolutely sure the URL has not changed.</p>
<p>If you just set up the emoncms.org as a test I would recommend putting the settings back and continue with your server, if you want the .org acct working then the issue to resolve first is why doesn&#39;t the gateway like the new details?</p>
<p>Have you edited any of the gateway files other than the oemgateway.conf&nbsp;?</p>
<p>I see at the end of the last log you exited the gateway so the previous buffered data will of cleared. Lets start from the beginning. Switch off the emonTx and reboot the Pi, check the log there should be no activity. edit the oemgateway.conf if needed to point to the server you wish to focus on. restart oemgateway with logging enabled and switch on the emontx for a while just to get a few lines of data. switch off the emontx, check the log if you can see &quot;Send ok&quot; fantastic if you see &quot;Send failure&quot; do the cut and paste URL&nbsp;test and report the results, but do not change anything, if neither then we have a different bridge to cross first!</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23839"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6244.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6244.jpg" alt="emicon&#039;s picture" title="emicon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonbase not sending data after changing location</h3>

    <div class="submitted">Submitted by <a href="../user/6244.html" title="View user profile.">emicon</a> on Tue, 16/09/2014 - 13:40.</div>
    <div class="content">
     <p>Hello Paul,</p>
<p>sorry if i waited so long but i was out for a trip.</p>
<p><em>Have you edited any of the gateway files other than the oemgateway.conf ?</em></p>
<p>Not at all.</p>
<p>I did the test as we planned and you can see the results on images i have attached.</p>
<p>The first one show the log and the URL generated by oem_gateway.</p>
<p>The second one show that URL copied and pasted on a not logged browser (with the &#39;ok&#39; answer)</p>
<p>The third is the input page with the data correctly received.</p>
<p>The manual approach seems to work fine.</p>
<p>Thanks for your patience</p>
<p>Emilio</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23849"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonbase not sending data after changing location</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 16/09/2014 - 17:14.</div>
    <div class="content">
     <p>Hi Emilio</p>
<p>The log looks fine except for the URLError, I believe that error is mainly caused by the url not being resolved to a ip (but I could be wrong) That makes me think the sub-domain may be the issue as I know from previous experience what a pain they can be.</p>
<p>Try adding &quot;www.&quot; to the beginning&nbsp;or the url&nbsp;in the conf file or try using an alternative URL that points to the same sub-domain IP.ADD.OF.MAIN/sub-domain/emoncms&nbsp;or <a href="http://www.altervista.org/subdomain" title="www.altervista.org/subdomain">www.altervista.org/subdomain</a>.</p>
<p>It looks like OEMG is doing as expected, leaving the issue to be either in the standard python libraries or in the way the url&nbsp;resolves, maybe if the sub-domain is a redirection of some sort it causes a problem that&#39;s easily handled by a browser.</p>
<p>I&#39;m afraid I won&#39;t be of any help in this area ...</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23851"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonbase not sending data after changing location</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 16/09/2014 - 17:31.</div>
    <div class="content">
     <p>Just an observation - Originally your error was &quot;WARNING Send failure&quot; so that must of been a different URL try that URL&nbsp;again to see if you get the &quot;ok&quot; after copying and pasting it to a browser from the log if it fails.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23861"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6244.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6244.jpg" alt="emicon&#039;s picture" title="emicon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonbase not sending data after changing location</h3>

    <div class="submitted">Submitted by <a href="../user/6244.html" title="View user profile.">emicon</a> on Wed, 17/09/2014 - 08:44.</div>
    <div class="content">
     <p>Goodmorning&nbsp;Paul &nbsp;:)</p>
<p>now i tried to connect the Raspberry via wireless (using an Edimax usb wifi adapter) instead of the ethernet cable,</p>
<p>and i get in my log &quot;Couldn&#39;t send to server, HTTPError: 403&quot;.</p>
<p>The Wikipedia says about: &nbsp;&quot;A web server may return a 403 Forbidden HTTP status code in response to a request from a client for a web page or resource to indicate that the server can be reached and understood the request, but refuses to take any further action. Status code 403 responses are the result of the web server being configured to deny access, for some reason, to the requested resource by the client....&quot;</p>
<p>I think you are right, the subdomain&nbsp;is the problem, maybe i need to contact the server staff. But i wonder why the system worked good for 2 months before when i was in my old house. Before it was a private phone number, now it is a business phone number (i have installed oem_gateway on my office) maybe the problem is there. I will contact the phone provider Vodafone.</p>
<p>You are really nice and helpful, I will never stop to thank you :)</p>
<p>Emilio</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/5741"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-o4Xjbt_uSkwbA2b3Y25R-qQ7B4ZJaIpxg4z8hpbGBfM" value="form-o4Xjbt_uSkwbA2b3Y25R-qQ7B4ZJaIpxg4z8hpbGBfM"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/5741 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:05:08 GMT -->
</html>
