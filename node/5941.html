<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/5941 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 13:44:04 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>DC power?  - Other possibly dumb questions | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/3.html">Archived: General Discussion</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">DC power?  - Other possibly dumb questions</h3>
        <span class="submitted">Submitted by Guest on Thu, 16/10/2014 - 11:54</span>
        <div class="content"><p>I&#39;m in the process of building my own off grid home and aquaponics farm. &nbsp;Generating and storing the electricity ain&#39;t that big of a deal for me. &nbsp;That&#39;s just basic wiring from my PV and turbine into my charge controller. &nbsp;My battery bank is wired up for 24 volt and I&#39;m going from there into a 3000 watt inverter for AC. &nbsp;</p>
<p>	Everything i&#39;ve&nbsp;read throughout the wiki and on this site everything seems to only monitor AC and not DC power generation. &nbsp;Honestly I was hoping to find something simple to almost &quot;plug and play&quot; for monitoring everything. &nbsp;I don&#39;t have the time to solder boards and circuits with every other project I have on my hands at the moment, mostly construction.</p>
<p>Am I just missing out on something? &nbsp;Have I just not been able to find how to monitor the power coming into my battery bank? &nbsp;Can I only monitor what&#39;s coming out of my inverter?</p>
<p>Another thing, I am not tied to the grid what so ever. &nbsp;If I don&#39;t generate the power I need then I just sit in darkness at night until day light arrives or wind starts moving my first turbine. &nbsp;I can live with that for now.</p>
<p>Finally, the information that can be generated with this project can it be shipped via syslog? &nbsp;I happen to use logstash heavily at work and do love what I can do with the data I generate and dump into various JSON objects to do things with elsewhere.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="12017.html" class="topic-previous" title="Go to previous forum topic">‹ Exporting More data</a>
              <a href="12005.html" class="topic-next" title="Go to next forum topic">emonPi Nominated for Best IoT Open Source Project 2015 ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-24592"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DC power?  - Other possibly dumb questions</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 16/10/2014 - 14:54.</div>
    <div class="content">
     <p>People&nbsp;<em>have</em> done and are doing dc measurements: <a href="4022.html">Monitoring power usage on a 24Volt DC battery solar system using Emontx</a>, it&#39;s just that most people are interested in monitoring the grid and PV infeeds. If you are limiting yourself to a &#39;plug and play&#39; solution, then I&#39;m afraid you will have to go down the ac route and monitor your inverter output. But the question I&#39;d ask: Does your inverter give you that information anyway, and can you extract it? If it does have a data output that you can interrogate, then maybe you won&#39;t need to do any electronic construction.<br />
	Assuming that you&#39;ve got your data, either by measuring or asking for it, then if you&#39;re able and willing to write some software, you can export the data in whatever format you want. We do use JSON for emoncms, but it seems that would bypass syslog, which you&#39;re keen to utilise.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24594"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6498.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6498.jpg" alt="sumnerboy&#039;s picture" title="sumnerboy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DC power?  - Other possibly dumb questions</h3>

    <div class="submitted">Submitted by <a href="../user/6498.html" title="View user profile.">sumnerboy</a> on Thu, 16/10/2014 - 19:04.</div>
    <div class="content">
     <p>Re. your question about shipping data to syslog, one option is to use the new MQTT event module to publish values to MQTT topic(s) of your choice and then setup mqttwarn (<a href="https://github.com/jpmens/mqttwarn#syslog" title="https://github.com/jpmens/mqttwarn#syslog">https://github.com/jpmens/mqttwarn#syslog</a>) to monitor those topics and forward the values to syslog. mqttwarn can do transformations and filtering as well as notifications to a huge range of other services.</p>
<p>Likewise, mqttwarn can be used to forward data into EmonCMS&nbsp;(<a href="https://github.com/jpmens/mqttwarn#emoncms" title="https://github.com/jpmens/mqttwarn#emoncms">https://github.com/jpmens/mqttwarn#emoncms</a>). I am using this with a modified emontx sketch which publishs values to MQTT topics rather than send via RF (<a href="5922.html" title="http://openenergymonitor.org/emon/node/5922">http://openenergymonitor.org/emon/node/5922</a>). mqttwarn&nbsp;then transforms the values into payloads suitable for EmonCMS and sends them via HTTP requests.&nbsp;</p>
<p>As you can probably tell I am very interested in MQTT!&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38367"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/9186.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="smilhomme&#039;s picture" title="smilhomme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DC power?  - Other possibly dumb questions</h3>

    <div class="submitted">Submitted by <a href="../user/9186.html" title="View user profile.">smilhomme</a> on Sun, 17/01/2016 - 03:16.</div>
    <div class="content">
     <p>Hi,</p>
<p>I was wondering the same thing about using logstash and the whole ELK stack. Finally got something working...<br />
I use the logstash&nbsp;input plugin http_poller. Maybe there&#39;s a better way. Below is my config. It surely could have improvements but it&#39;s my first shot with all these tools. Would be more than happy to have comments.</p>
<p>I&#39;d prefer Emonpi&nbsp;to&nbsp;send its data to logstash as soon as available but didn&#39;t find how to yet, so I poll every minute which reduce the resolution compared to the 5s refresh.</p>
<pre>
input {
  http_poller {
    urls =&gt; {
      emonPI_ct1 =&gt; &quot;http://192.168.0.89/emoncms/nodes/5/rx/1?id=5&amp;apikey=XXXX&quot;
      emonPI_ct2 =&gt; &quot;http://192.168.0.89/emoncms/nodes/5/rx/2?id=5&amp;apikey=XXXX&quot;
      emonPI_T_out =&gt; &quot;http://192.168.0.89/emoncms/nodes/5/rx/5?id=5&amp;apikey=XXXX&quot;
      emonPI_Vrms =&gt; &quot;http://192.168.0.89/emoncms/nodes/5/rx/4?id=5&amp;apikey=XXXX&quot;
    }
    request_timeout =&gt; 30
    interval =&gt; 60
    codec =&gt; &quot;json&quot;
    # A hash of request metadata info (timing, response headers, etc.) will be sent here
    # metadata_target =&gt; &quot;poll_metadata&quot;
  }
}

filter {
  mutate {
    lowercase =&gt; [ &quot;name&quot; ]
    convert =&gt; { &quot;value&quot; =&gt; &quot;float&quot; }
    add_tag =&gt; [ &quot;emon&quot; ] 
  }
  if [unit] == &quot;W&quot; {
    mutate { 
      rename =&gt; { &quot;value&quot; =&gt; &quot;value_%{name}&quot; }
      add_field =&gt; { &quot;type&quot; =&gt; &quot;power&quot; }
    }
  }
  if [unit] == &quot;C&quot; {
    mutate { 
      rename =&gt; { &quot;value&quot; =&gt; &quot;value_%{name}&quot; }
      add_field =&gt; { &quot;type&quot; =&gt; &quot;temperature&quot; }
    }
  }
  if [unit] == &quot;V&quot; {
    mutate { 
      rename =&gt; { &quot;value&quot; =&gt; &quot;value_vrms&quot; } 
      add_field =&gt; { &quot;type&quot; =&gt; &quot;tension&quot; }
    }
  }
  if [unit] == &quot;%&quot; {
    mutate {
      rename =&gt; { &quot;value&quot; =&gt; &quot;value_%{name}&quot; }
      add_field =&gt; { &quot;type&quot; =&gt; &quot;humidity&quot; }
    }
  }
}

output {
  elasticsearch {
    index =&gt; &quot;emonpi-%{+YYYY.MM.dd}&quot;
  }
}</pre><p>Once in Elasticsearch, I run Kibana for visualization and dashboard.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/5941"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-WqP4gQJ4KtkNkv2r62QNkzwQXCjyzdLqetXffCK_ils" value="form-WqP4gQJ4KtkNkv2r62QNkzwQXCjyzdLqetXffCK_ils"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/5941 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 13:44:07 GMT -->
</html>
