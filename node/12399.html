<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/12399 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 13:10:26 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>EmonTX v3.4 - Can it be powered from the 5v terminal? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">EmonTX v3.4 - Can it be powered from the 5v terminal?</h3>
        <span class="submitted">Submitted by <a href="../user/8797.html" title="View user profile.">M0n0wall</a> on Fri, 25/03/2016 - 14:33</span>
        <div class="content"><p>Hi</p>
<p>I need to piggyback 3x EmonTX v3.4 on top of each other to monitor the whole house.</p>
<p>Can the EmonTX board be powered by applying 5v to the terminals only?</p>
<p>Also</p>
<p>Is it possible to link the boards and only have one antenna?</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11233.html" class="topic-previous" title="Go to previous forum topic">‹ Enecsys Gen 2 Gateway Firmware</a>
              <a href="12401.html" class="topic-next" title="Go to next forum topic">Current (Irms) spike when turning on device or adc adjusting? ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-40604"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX v3.4 - Can it be powered from the 5v terminal?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Fri, 25/03/2016 - 15:17.</div>
    <div class="content">
     <p>The circuit diagram can be found on the Wiki.</p>
<p>You can feed all 3 from a common 5 V supply using either the USB connector or the terminal block.</p>
<p>You cannot connect the&nbsp;3 antennas in parallel, but you could use&nbsp;a 433 MHz mixer if you can get or build one. This is a very specialised area that I know very little about, though Bill Thomson might be able to help. You can communicate between the 3 modules using the one-wire connection and protocol and use one emonTx as the &#39;master&#39; unit, using only the radio in that one. That is much the better way as there is then no possibility of one transmitter jamming&nbsp;another.</p>
<p>I take it you&#39;ve looked at Martin Roberts&#39;s &quot;Full-fat 3-phase monitor&quot;.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40609"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3426.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3426.jpg" alt="Bill Thomson&#039;s picture" title="Bill Thomson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX v3.4 - Can it be powered from the 5v terminal?</h3>

    <div class="submitted">Submitted by <a href="../user/3426.html" title="View user profile.">Bill Thomson</a> on Fri, 25/03/2016 - 20:51.</div>
    <div class="content">
     <p>Hi David,</p>
<p>Connecting three emonTXes to a single antenna isn&#39;t trivial nor inexpensive. To do it properly, i.e. prevent impedance mismatch, and keep the transmitted RF energy away from, and being wasted on, the other two transmitters, you&#39;d need a transmitter combiner, which <em>isn&#39;t</em> cheap. (If you used a receiver combiner, (like the cheap signal splitters often used in TV feedlines) the transmitted energy would be divided <em>three</em> ways making performance worse than that of a transmitter combiner)</p>
<p>Performance would suffer, as a transmitter combiner has an insertion loss of ~3dB, meaning it cuts your transmitted signal strength in half. Not a good thing, as the EmonTX transmitter output is low, (about 3 milliWatts) and transmitted signal strength has a direct impact on <em>usable</em> range. i.e. max distance between your EmonTX and EmonBase.</p>
<p>Note that even with a transmitter combiner, the issue with transmitted packet collisions still exists.</p>
<p>Depending on the distance between your emonTXes and emonBase, as well as the type and number of obstructions between them, if any, you may need nothing more complex than the wire antennas supplied with the units.</p>
<p>Give us an idea of the distance involved, and the number and type of obstructions, if any. Otherwise, any recommendations at this point, would be a &quot;shot in the dark.&quot;</p>
<p>Regards,</p>
<p>Bill</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40635"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8797.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="M0n0wall&#039;s picture" title="M0n0wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX v3.4 - Can it be powered from the 5v terminal?</h3>

    <div class="submitted">Submitted by <a href="../user/8797.html" title="View user profile.">M0n0wall</a> on Sat, 26/03/2016 - 22:05.</div>
    <div class="content">
     <p>Hi Robert &amp; Bill</p>
<p>Thank you for your detailed reply.</p>
<p>Powering the three units by linking the ground and +5v is very handy, that will make it easier to just have one 2amp USB PSU.</p>
<p>Yes I was inspired by Martin&#39;s 3 phase project but the boards he was using were EmonTx v2, by having one antenna would make sense.</p>
<p>The distance between the EmonPi and the EmonTx is only about 5m through 2x ceilings and no solid walls.</p>
<p>Would there be an issue with putting 3x antennas in very close proximity if linking the EmonTx&#39;s isn&#39;t possiable.</p>
<p>Regards</p>
<p>Dave</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40636"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3426.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3426.jpg" alt="Bill Thomson&#039;s picture" title="Bill Thomson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX v3.4 - Can it be powered from the 5v terminal?</h3>

    <div class="submitted">Submitted by <a href="../user/3426.html" title="View user profile.">Bill Thomson</a> on Sat, 26/03/2016 - 23:41.</div>
    <div class="content">
     <p><em>Would there be an issue with putting 3x antennas in very close proximity</em></p>
<p>Keep them a few inches apart, and you shouldn&#39;t have any problems. If you&#39;re using the &quot;rubber duck&quot; antennas, a quick and easy separation-distance gauge would be the length of one antenna.</p>
<p>From your mention of the ceilings, I take it your EmonTXes and EmonPi are on different floors. That being the case, one thing to avoid is positioning the EmonPi directly above the EmonTXes. i.e. you&#39;ll want some horizontal distance between the two as well, to avoid the dead spot that exists directly above the EmonTx antennas. (This assumes the EmonTX antennas are mounted vertically)</p>
<p>One thing to bear in mind: With three transmitters, your system will occasionally experience data loss due to packet collisions. (If two - or all three - of your EmonTXes try to send data to your emonPi at the same time, the data is in effect, garbled, rendering it unusable)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40637"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX v3.4 - Can it be powered from the 5v terminal?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 26/03/2016 - 23:51.</div>
    <div class="content">
     <p>If you go the One-wire route, the emonTx V3 uses the same processor as the V2, so you can use the same technique and most probably the same sketches but with a few changed pin numbers and the one-line change for the radio module.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40638"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dBC&#039;s picture" title="dBC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX v3.4 - Can it be powered from the 5v terminal?</h3>

    <div class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Sun, 27/03/2016 - 08:07.</div>
    <div class="content">
     <p>Are you sure you mean OneWire and not TwoWire (aka TWI, aka I2C, aka SDA/SCL)? &nbsp;OneWire seems a particularly cumbersome way for two or more AVRs to communicate with each other.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40641"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8797.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="M0n0wall&#039;s picture" title="M0n0wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX v3.4 - Can it be powered from the 5v terminal?</h3>

    <div class="submitted">Submitted by <a href="../user/8797.html" title="View user profile.">M0n0wall</a> on Sun, 27/03/2016 - 10:07.</div>
    <div class="content">
     <p>I notice that the I2C port isn&#39;t soldered, presumably its a case of stacking the boards and dropping a pin down the three solder pads linking them all.</p>
<p>@ dBC - Isn&#39;t the SDA/SCL in use by CT4 &amp; DS18B20?</p>
<p>I presume that once thats done its a case of modifying the V3.4 sketch to setup master and slave addresses.</p>
<p>Regards</p>
<p>Dave</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40642"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX v3.4 - Can it be powered from the 5v terminal?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sun, 27/03/2016 - 10:59.</div>
    <div class="content">
     <p>MartinR&#39;s&nbsp;&quot;full-fat 3phase&quot; stack does use TWI (aka I&sup2;C) and on the emonTx v2&nbsp;the SDA/SCL pins are broken out to the 8pin header and not used for anything else so the use of a stackable header&nbsp;works.</p>
<p>The emonTx 3&#39;s use the SDA/SCL (aka ADC4 and ADC5) for CT4 and 1-Wire (DS18B20&#39;s) so without some surgery to the board TWI isn&#39;t easily accomplished, I looked into it before and it is possible but the loss of the 4th CT and the inability to stack, (and even if you could the case couldn&#39;t be used) means 3x&nbsp;emonTx v2&#39;s are&nbsp;a much more flexible option for a 3ph project.</p>
<p>Paul</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40643"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dBC&#039;s picture" title="dBC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX v3.4 - Can it be powered from the 5v terminal?</h3>

    <div class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Sun, 27/03/2016 - 11:03.</div>
    <div class="content">
     <p>The DS18B20 is a Dallas&nbsp;1-Wire&nbsp;device so on an AVR you typically talk to that via bit-banging on a GPIO signal (or you can wire up an external open collector buffer to a UART&nbsp;.... see AVR318)</p>
<p>Once you&#39;re using SDA/SCL then you&#39;re talking TWI (aka I2C) which is quite different (and more appropriate for communicating between two or more AVRs).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40644"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8797.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="M0n0wall&#039;s picture" title="M0n0wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX v3.4 - Can it be powered from the 5v terminal?</h3>

    <div class="submitted">Submitted by <a href="../user/8797.html" title="View user profile.">M0n0wall</a> on Sun, 27/03/2016 - 11:30.</div>
    <div class="content">
     <p>I think TBH my options are to either buy 4x v2 kits and stack them or buy 3x v3.4 and have three antennas on the enclosure.</p>
<p>Its for whole house monitoring so would like to implement diverting at some point, I presume that once you put the diverting sketch in one of the Tx&#39;s you can still pass the CT values of that TX to the EmonPi to avoid having two separate systems?</p>
<p>Regards</p>
<p>Dave</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40645"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX v3.4 - Can it be powered from the 5v terminal?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sun, 27/03/2016 - 12:22.</div>
    <div class="content">
     <p><em>&quot;Once you&#39;re using SDA/SCL then you&#39;re talking TWI (aka I2C) which is quite different (and more appropriate for communicating between two or more AVRs).&quot;</em></p>
<p>I agree and have brought up using TWI on several occasions, I&#39;ve experimented with&nbsp;many&nbsp;avr&#39;s on one&nbsp;bus using a Pi as the master. I wrote a TWI interfacer for emonhub&nbsp;(way&nbsp;before the emon-pi variant)&nbsp;and had really good results. this has the advantage of polling the devices in a controlled manner for their data rather than several devices reporting on their own schedule.&nbsp;&nbsp;&nbsp;</p>
<p>This option to use the Pi as a master is hampered a&nbsp;little&nbsp;on the emonPi by accessibility&nbsp;to the SDA/SCL pins of the GPIO and would need integrating with the the LCD display&#39;s use of&nbsp;TWI.&nbsp;Alternatively the &quot;full-fat 3ph&quot; method uses 1 emonTx as a master and that forwards the data via RF, this means one board will be working a little harder than the others but that shouldn&#39;t be an issue.&nbsp;</p>
<p>Actually Dave - now that dBC has mentioned &quot;bit banging&quot;, I recall that someone has actually used TWI&nbsp;on&nbsp;emonTx v3&#39;s before, by using an external library to bit-bang alternative SDA/SCL pins. You could try searching for that thread.</p>
<p><em>&quot;4x v2 kits and stack them&quot; - </em>This would give you 6 cts on one phase and 3 on each of the others rather than the 4 per phase of 3 emonTx v3&#39;s, (which I expect you were aware of, but thought I&#39;d confirm).</p>
<p>The 3 antennas in/on a box isn&#39;t ideal, but it does&nbsp;work, the biggest potential hurdle is the unsynchronized transmissions possibly blocking each other. If they are all trying to maintain the same interval you could find one blocking another for a prolonged time until one &quot;overtakes&quot; the other.&nbsp; Once the &quot;overtaking&quot; device gets in&nbsp;front, it blocks the previous leader for the same time until it&#39;s clear.</p>
<p>This can easily be managed by introducing a wired trigger from one emonTx v3 to the other 2, to stagger the transmissions to the emonPi.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/12399"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-m4Rgzl9Aws1i6hL3kwb0r7v-TeUiIsc3y5a9nUXTrCc" value="form-m4Rgzl9Aws1i6hL3kwb0r7v-TeUiIsc3y5a9nUXTrCc"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
