<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/10126 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:38:17 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>emontxshield 3-phase no voltage adaptor | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">emontxshield 3-phase no voltage adaptor</h3>
        <span class="submitted">Submitted by <a href="../user/7632.html" title="View user profile.">scrissti</a> on Tue, 03/02/2015 - 22:33</span>
        <div class="content"><p>Hi there,</p>
<p>can you advise me how I should modify the example&nbsp;code from <a href="https://github.com/openenergymonitor/emonTxFirmware/blob/master/emonTxShield/Shield_CT1234_3Phase_Voltage/Shield_CT1234_3Phase_Voltage.ino">https://github.com/openenergymonitor/emonTxFirmware/blob/master/emonTxShield/Shield_CT1234_3Phase_Voltage/Shield_CT1234_3Phase_Voltage.ino&nbsp;</a>in order to use it with UNO on a 3-phase installation if I do not have the 9V adaptor?</p>
<p>Thanks</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="10149.html" class="topic-previous" title="Go to previous forum topic">‹ 17 DS18B20 on a EmonTH</a>
              <a href="10141.html" class="topic-next" title="Go to next forum topic">emonTx V3 node not showing ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-27391"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emontxshield 3-phase no voltage adaptor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 03/02/2015 - 22:47.</div>
    <div class="content">
     <p>You cannot use any ....voltage.ino sketch if you do not have an ac-ac adapter to give you a voltage measurement. You must use the Shield_CT1234 sketch instead. That will give you apparent power only, it will give you reasonably accurate results, limited by how close your actual average voltage is to 230 V. As there is no voltage reference, the relative phases of the current inputs is quite irrelevant.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27406"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7632.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="scrissti&#039;s picture" title="scrissti&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emontxshield 3-phase no voltage adaptor</h3>

    <div class="submitted">Submitted by <a href="../user/7632.html" title="View user profile.">scrissti</a> on Wed, 04/02/2015 - 09:00.</div>
    <div class="content">
     <p>ok. Then my wonder is, for the appliances that use all the 3 phases (380V) can I assume that the total power consumption is aparentPower1 +&nbsp;aparentPower2 +&nbsp;aparentPower3 ?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27412"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emontxshield 3-phase no voltage adaptor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 04/02/2015 - 12:35.</div>
    <div class="content">
     <p>Yes, because your CT does not know whether the current is going through a single-phase load to neutral or through one or more parts of a three-phase load and back through another CT. In each case, if the total power is the same, then the total current must be the same because the system voltage has not changed, even though the part of it that each load sees is different. That's the magic of 3-phase. But you must tell it the correct voltage - 220 V in your case, not the 230 V that is the default value in the sketch ( 380 / &radic;3 = 220).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27495"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7632.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="scrissti&#039;s picture" title="scrissti&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emontxshield 3-phase no voltage adaptor</h3>

    <div class="submitted">Submitted by <a href="../user/7632.html" title="View user profile.">scrissti</a> on Sat, 07/02/2015 - 19:51.</div>
    <div class="content">
     <p>Thanks Robert,</p>
<p>One more thing I&#39;d like to ask, after deployment (<a href="../../../scrissti.smugmug.com/photos/i-QkQmpRS/0/S/i-QkQmpRS-S.jpg">see image</a>) i noticed if I turn all the main switch so absolutely no consumer can work, my arduino&nbsp;says I have 2W on phase 1, 18W on phase 2 and 30W on phase 3. I don&#39;t mind if these&nbsp;numbers are just small noise but I want to make sure this error is not exponentially propagated&nbsp;when I have big consumers like 8KW per each phase.</p>
<p>Let me know if you think the way I deployed the sensor in the linked image can be a problem or I can just substract&nbsp;these values after reading.</p>
<p>Thanks</p>
<p>&nbsp;</p>
<p>Actually I have one more question i can&#39;t get emoncms to add up all 3 phases and show up in the USE TODAY graph only in the POWER NOW I managed.&nbsp;Any hint would be helpful.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27500"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emontxshield 3-phase no voltage adaptor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 07/02/2015 - 20:53.</div>
    <div class="content">
     <p>What you are seeing is noise - there's a thread running now about this. It should be a constant value. I don't have a 3-phase supply so I cannot do proper test, all I can do is be certain that I get the expected 'wrong' answer on my single-phase supply, which I did using a much larger test current (I cannot remember now, it was probably about 30 At - or 1.5 A in a 20-turn coil through the C.T, giving me 'real power' values of approx -3600 W and a p.f. of 0.5) I certainly did not see an error bigger than that which I would expect from the burden resistor tolerance and changes in mains voltage.</p>
<p>It would be better if your CT's were further from each other and from other current-carrying wires, but you have very little space in there. You might get a small amount of interaction between the phases. Even 20 mm of air makes a big difference. See Section 9 of the report on the C.T. (Building Blocks).</p>
<p>To add the powers in emonCMS, you will have three inputs, Power1, Power2 &amp; Power3. You need to use one input as "master" - say Power1, then do '+ input ' to add Power 2 and again for Power 3. Then Log to Feed etc.<br />
If you want to do other things with Power 1 first, do those things, then do ' Reset to ZERO ' then '+ input ' with Power 1 and then add in Power 2 &amp; Power 3.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27533"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7632.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="scrissti&#039;s picture" title="scrissti&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emontxshield 3-phase no voltage adaptor</h3>

    <div class="submitted">Submitted by <a href="../user/7632.html" title="View user profile.">scrissti</a> on Mon, 09/02/2015 - 08:30.</div>
    <div class="content">
     <p>Thanks Robert,</p>
<p>I managed to get hold of a 9v (1A) AC adaptor so i changed the code to the <a href="https://github.com/openenergymonitor/emonTxFirmware/blob/master/emonTxShield/Shield_CT1234_3Phase_Voltage/Shield_CT1234_3Phase_Voltage.ino">3phase_voltage example</a></p>
<p>One weird thing i see is quite a big difference on apparent power versus realPower. See below&nbsp;log for all 3 phases:</p>
<blockquote><p>apparentPower1:realPower1,&nbsp;apparentPower2:realPower2, apparentPower3:realPower3&nbsp;<br />
70.04:-31.38, 183.58:179.90, 102.69:-99.35<br />
655.45:-59.27, 2216.32:77.31, 2432.70:-2153.60<br />
3777.31:1665.84, 5442.96:1826.22, 5416.48:-5363.15<br />
7402.10:3322.86, 7342.28:3604.93, 7301.15:-7387.39<br />
7383.70:3319.69, 7328.77:3587.13, 7282.98:-7368.44<br />
7381.91:3315.99, 7333.04:3597.80, 7292.33:-7368.46<br />
7370.51:3315.21, 7330.30:3586.90, 7283.11:-7368.92<br />
7355.30:3308.99, 7316.45:3564.70, 7279.84:-7355.84<br />
7362.89:3315.46, 7317.85:3576.75, 7282.18:-7367.44<br />
7371.31:3318.57, 7323.41:3573.02, 7292.47:-7368.93<br />
7370.89:3322.30, 7328.93:3578.42, 7291.16:-7377.12<br />
7358.36:3313.10, 7316.95:3567.92, 7281.77:-7358.28<br />
66.48:-33.05, 180.89:177.62, 104.16:-100.43<br />
65.77:-32.03, 183.13:179.86, 103.65:-99.86<br />
63.55:-28.50, 183.46:180.65, 104.27:-100.59<br />
71.79:-30.78, 182.75:179.78, 103.28:-99.64<br />
3831.57:1691.26, 2327.30:2054.95, 2253.90:-2029.70<br />
5780.85:1625.04, 3826.56:1922.55, 5730.77:-5704.99<br />
7378.49:3320.74, 7338.45:3573.06, 7296.29:-7383.00<br />
7370.72:3323.18, 7320.58:3575.61, 7282.11:-7367.94<br />
7370.00:3320.82, 7323.02:3573.55, 7284.22:-7369.88<br />
7372.11:3323.84, 7329.99:3573.18, 7288.80:-7373.12<br />
7366.32:3320.69, 7324.23:3582.58, 7283.71:-7368.99<br />
7382.54:3317.24, 7333.62:3596.34, 7292.53:-7367.72</p>
</blockquote>
<p>It looks like</p>
<p>- realPower3 is just negative of the apparentPower, probably I put the CT sensor the wrong side.</p>
<p>- realPower2 sometimes is same as apparentPower sometimes is only half of it.</p>
<p>- realPower1&nbsp;is either half of the apparentPower, either negative :(</p>
<p>Any idea what it could be wrong?</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27543"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emontxshield 3-phase no voltage adaptor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 09/02/2015 - 14:28.</div>
    <div class="content">
     <p>Now that you have the voltage, the relationship between the voltage sensor and the CTs is important. Read and understand the notes in the comment at the top of the sketch, get the relationship between voltage and the CTs right and then go through the calibration procedure. Unless the timing between voltage and current is correct for all three phases, you will never get good results.</p>
<p>L1 is the phase with the voltage measurement. Get that right first. L2 and L3 follow in that order. Your supply should be labelled to tell you the correct phase rotation. (So if you cannot put your ac adapter on L1, you just move everything around one phase, keeping the sequence the same.)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/10126"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-3XD1oooMAJxVpaxXKXyatZVI61m9UIG3XHvIGiOlfrA" value="form-3XD1oooMAJxVpaxXKXyatZVI61m9UIG3XHvIGiOlfrA"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
