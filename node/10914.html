<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/10914 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:59:10 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>DS18B20 Sensors on EmonTX | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">DS18B20 Sensors on EmonTX</h3>
        <span class="submitted">Submitted by <a href="../user/8271.html" title="View user profile.">Jez Wingfield</a> on Sun, 28/06/2015 - 13:47</span>
        <div class="content"><p>I have just added a new EmonTX to my home EmonPi&nbsp;monitoring network. I am hoping to use the EmonTX&nbsp;with 3x CTs to measure energy consumption in my cylinder cupboard&nbsp;(immersion heater, solar thermal pump, central heating/DHW pump) and 6x DS18B20 on the breakout to measure various temperatures (cylinder, solar thermal flow/return, heating flow/return, DHW return). I have just turned the system on for the first time. The emonTX&nbsp;data&nbsp;are showing&nbsp;up OK on node 10 on my emonPi with the node firmware showing as V1.6. The CT power data looks OK. However, I am getting no data for any of the 6x temp sensors&nbsp;and instead am seeing accumulating data on the pulse channel. I am presuming that I need to do something with the firmware on the emonTX to be able to see the temperature data.</p>
<p>Grateful for any help on this - be aware I have no previous experience in writing or sending sketches&nbsp;- indeed&nbsp;the&nbsp;last programming I did was in Fortran77&nbsp;over 30 years ago. I did get&nbsp;the USB to serial programmer just in case I&nbsp;needed it.</p>
<p>Cheers</p>
<p>Jez</p>
  <div class="forum-topic-navigation clear-block">
          <a href="5877.html" class="topic-previous" title="Go to previous forum topic">‹ Read-only image time issues </a>
              <a href="10791.html" class="topic-next" title="Go to next forum topic">Som questions about the EmonTX/NanodeRF ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-31766"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 Sensors on EmonTX</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 28/06/2015 - 15:12.</div>
    <div class="content">
     <p>What sort of emonTx do you have? Presuming it is a V3.4, the default software should be sending 4 powers, rms voltage, then your 6 temperatures, and finally the pulse count - all as integers, which the default emonHub configuration should be interpreting correctly. So something is not as it should be. </p>
<p>Have you restarted your emonTx after connecting all the sensors?</p>
<p>Do you get anything with just one temperature sensor?</p>
<p>Do you have an external 5 V supply powering it? (The internal supply from the ac adapter may not be able to supply enough current for the RFM69CW at maximum power and 6 temperature sensors.)</p>
<p>The first step will be to see if the emonTx is seeing the sensors. Load up the Arduino IDE (<a href="https://learn.openenergymonitor.org/?redirect=setting-up-the-arduino-environment">instructions</a>) on your computer and using the serial monitor (top right on the IDE window), a USB cable, the programmer and the FTDI port on the EmonTx, see what it says when you reset it.</p>
<p><i>[Psst... I started with Fortran 4.]</i></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31768"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8271.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Jez Wingfield&#039;s picture" title="Jez Wingfield&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 Sensors on EmonTX</h3>

    <div class="submitted">Submitted by <a href="../user/8271.html" title="View user profile.">Jez Wingfield</a> on Sun, 28/06/2015 - 16:17.</div>
    <div class="content">
     <p>Robert</p>
<p>Yes it a brand new EmonTX&nbsp;v3.4.</p>
<p>I have tried restarting with the sensors plugged in but that did not help.</p>
<p>I am using a decent Belkin&nbsp;USB&nbsp;5v&nbsp;DC power&nbsp;supply for the TX with the&nbsp;separate AC supply for the voltage sampling, I have removed&nbsp;jumper 2 on the board.</p>
<p>I have tried a single temperature sensor directly connected to the RJ45 on the&nbsp;EmonTX, i.e. without the breakout&nbsp;(sensor is&nbsp;the one that came with the emonPi)&nbsp;and that worked fine.&nbsp;I have also checked the 6 temperature sensors wired to the breakout by connecting them to the RJ45 port on the EmonPi and they all work OK on the Pi - with very good correlation between the values on the 6sensors at +/- 0.1deg</p>
<p>I will have a go with your suggestion on seeing what the emonTX says via arduino IDE and get back.</p>
<p>My back up plan is to move the emonPi to the cylinder cupboard and use that to get the data for my&nbsp;6 temperature locations&nbsp;and the power for the 2 circulation&nbsp;pumps. I can then use the emonTX&nbsp;at my main&nbsp;distribution board to get the power for the immersion heater plus the solar PV and electric import/export that I am currently getting from the Pi - added benefit is that would give me a spare CT to use for another circuit on the consumer unit.</p>
<p>cheers</p>
<p>Jez</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31769"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 Sensors on EmonTX</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 28/06/2015 - 16:30.</div>
    <div class="content">
     <p>Just be aware that the emonTx 'sniffs' the inputs at start-up and then does not re-scan again - so you must reset if you change the number of sensors - voltage, CTs and temperature.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31770"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8271.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Jez Wingfield&#039;s picture" title="Jez Wingfield&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 Sensors on EmonTX</h3>

    <div class="submitted">Submitted by <a href="../user/8271.html" title="View user profile.">Jez Wingfield</a> on Sun, 28/06/2015 - 16:43.</div>
    <div class="content">
     <p>Tried again by disconnecting everything, reconnecting to the TX and then powering up - didn&#39;t do a reset. And&nbsp;this time the 6 temperatures&nbsp;are all working and being seen by the Pi. Not sure why. Didn&#39;t do anything different from last time - perhaps a loose RJ45 connection?</p>
<p>Jez</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31772"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 Sensors on EmonTX</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 28/06/2015 - 21:57.</div>
    <div class="content">
     <p>It seems as if you had a visitation from the Marcolins. (These are the electrical cousins of Gremlins.)</p>
<p>FWIW, powering up and resetting amount to the same thing as far as the emonTx is concerned - the sketch starts from the beginning and initializes in exactly the same way for each.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31785"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8271.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Jez Wingfield&#039;s picture" title="Jez Wingfield&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 Sensors on EmonTX</h3>

    <div class="submitted">Submitted by <a href="../user/8271.html" title="View user profile.">Jez Wingfield</a> on Mon, 29/06/2015 - 12:52.</div>
    <div class="content">
     <p>Strange indeed - but at least it is working now and I am getting good temperature data from my solar thermal system.</p>
<p>Next question is whether there is any logic to the order of the temperature channel No&#39;s in the TX relative to the position of the sensor on the breakout board. Checking the sensors on my board gives channel numbers T1,T5,T2,T3,T4,T6&nbsp;going clockwise starting from the RJ45 ports. So if the power to the TX is lost or the system reset, will these channel&nbsp;assignments be retained on restart?</p>
<p>Jez</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31791"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DS18B20 Sensors on EmonTX</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 29/06/2015 - 16:40.</div>
    <div class="content">
     <p>I think the order in the breakout is irrelevant. What it depends on (I believe, I'm not sure about this) is the order in which the sensors are discovered by their library, and (again I'm not sure) that depends on the order in which they answer the discovery request.</p>
<p>If you go back to the older sketches, there is a utility sketch that gets the serial number, you then manually plugged that into an array in the main sketch. That way, the identity of each was immutable. </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/10914"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-R9d5LZGAIlmBVhMQEkgSWNp2P_-QoQB2nVgTr7o8icU" value="form-R9d5LZGAIlmBVhMQEkgSWNp2P_-QoQB2nVgTr7o8icU"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/10914 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:59:10 GMT -->
</html>
