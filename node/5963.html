<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/5963 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:11:05 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>getting started with rfm12pi | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">getting started with rfm12pi</h3>
        <span class="submitted">Submitted by <a href="../user/7077.html" title="View user profile.">ariol22</a> on Tue, 21/10/2014 - 14:55</span>
        <div class="content"><p>Hello. Im having difficulties&nbsp;with raspberry pi and rfm12pi.</p>
<p>What i have done so far is:</p>
<p>-setting up arduino. my emonTx&nbsp;works fine. from my&nbsp;arduino serial monitor i see that its working fine. it sends data in the correct CT</p>
<p>-i bought a raspberry pi with a prepared mini memory card,but it turned out to have some problems so i downloaded raspberry pi OS&nbsp;from official website. After a lot of efforts i made it,my raspberry pi GUI was open.</p>
<p>-following open energy monitor tutorial i could install emonhub&nbsp;service in my raspberry pi. Now here starts my headache.</p>
<p>My question is. Is RFM12Pi&nbsp;configured? or do i need to add firmware somehow since i have download a new firmware different from what i was given before?</p>
<p>at the moment when i boot my raspberry pi the emonhub.logs it has only two lines which shows that service is successfuly&nbsp;started. From what i read each signal that raspberry pi catch from rfm12pi&nbsp;module it add an other line. Does this mean my raspberry pi is not using this module at all?</p>
<p>related to my issue i have strictly followed this page</p>
<p>&nbsp;<strong>http://wiki.openenergymonitor.org/index.php?title=RFM12Pi_V2,</strong></p>
<p><strong>​exactly this lines</strong></p>
<p>
$ sudo apt-get update</p>
<p>$ sudo apt-get install arduino</p>
<p>$ sudo apt-get install python-dev&amp;&amp;python-rpi.gpio</p>
<p>$ git clone <a href="https://github.com/mharizanov/avrdude-rpi.git" title="https://github.com/mharizanov/avrdude-rpi.git">https://github.com/mharizanov/avrdude-rpi.git</a></p>
<p>$ cd avrdude-rpi</p>
<p>$ sudo cp autoreset /usr/bin</p>
<p>$ sudo cp avrdude-autoreset /usr/bin</p>
<p>$ sudo mv /usr/bin/avrdude /usr/bin/avrdude-original</p>
<p>$ sudo ln -s /usr/bin/avrdude-autoreset /usr/bin/avrdude</p>
<p>$ cd /home/pi</p>
<p>$ git clone <a href="https://github.com/mharizanov/RFM2Pi.git" title="https://github.com/mharizanov/RFM2Pi.git">https://github.com/mharizanov/RFM2Pi.git</a></p>
<p>$ cd RFM2Pi/firmware/RF12_Demo_atmega328</p>
<p>$ sudo service rfm12piphp stop &nbsp;(THIS IS where my problem start with this tutorial)</p>
<p>$ avrdude -v -c arduino -p ATMEGA328P -P /dev/ttyAMA0 -b 38400 -U&nbsp;flash:w:RF12_Demo_atmega328.cpp.hex $ sudo service rfm12piphp start<br />
&nbsp;</p>
<p>when i write &quot;sudo&nbsp;service&nbsp;rfm12piphp&nbsp;stop&quot; terminal says it does not recognize this service.</p>
<p>&nbsp;</p>
<p>I have all day reading all possible tutorial, what am i doing wrong?</p>
  <div class="forum-topic-navigation clear-block">
          <a href="5974.html" class="topic-previous" title="Go to previous forum topic">‹ Validation error while posting about a Forbidden error !!!</a>
              <a href="5915.html" class="topic-next" title="Go to next forum topic">Inactive inputs ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-24697"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: getting started with rfm12pi</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 21/10/2014 - 15:37.</div>
    <div class="content">
     <p>The RFM2Pi boards do come with pre-installed firmware so you shouldn&#39;t need to update the firmware. The routine is stopping at that point because the &quot;rfm12piphp&quot; service isn&#39;t installed and therefore not running.</p>
<p>The RFM2Pi settings are set by emonHub, you need to be sure that&nbsp;emonHub.conf has the correct frequency and group set for the RFM2Pi, the defaults are 433 and 210, unless&nbsp;you have a 868MHz&nbsp;network or you have changed the group setting in your node sketches.</p>
<p>If you also change emonHub&#39;s loglevel to debug while in the conf file, you will be able to see more of what&#39;s happening behind the scenes in the logs and if you still don&#39;t get any joy post the log messages for some more assistance.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24709"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7077.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ariol22&#039;s picture" title="ariol22&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: getting started with rfm12pi</h3>

    <div class="submitted">Submitted by <a href="../user/7077.html" title="View user profile.">ariol22</a> on Wed, 22/10/2014 - 07:41.</div>
    <div class="content">
     <p>Hello Paul</p>
<p>Thank you so much for your replay. setting my emonhub&#39;s loglevel to debug was something that i had missed. I change loglevel and this is the message on my logfile</p>
<p>
2014-10-22 07:13:51,226 INFO Logging level set to DEBUG<br />
2014-10-22 07:14:16,358 DEBUG SIGINT received.<br />
2014-10-22 07:14:16,370 DEBUG Closing serial port<br />
2014-10-22 07:14:16,372 INFO Exiting hub...<br />
2014-10-22 07:14:18,110 INFO EmonHub Pre-Release Development Version (rc1.0)<br />
2014-10-22 07:14:18,113 INFO Opening hub...<br />
2014-10-22 07:14:18,116 INFO Logging level set to DEBUG<br />
2014-10-22 07:14:18,119 INFO Creating EmonHubEmoncmsReporter &#39;emonCMS&#39;&nbsp;<br />
2014-10-22 07:14:18,124 INFO Set up reporter &#39;emonCMS&#39; (buffer: memory | size: 1000)<br />
2014-10-22 07:14:18,130 INFO Creating EmonHubJeeInterfacer &#39;RFM2Pi&#39;&nbsp;<br />
2014-10-22 07:14:18,133 DEBUG Opening serial port: /dev/ttyAMA0<br />
2014-10-22 07:14:18,137 INFO Opened serial port: /dev/ttyAMA0 9600 bits/s<br />
2014-10-22 07:14:18,140 DEBUG Setting RFM2Pi frequency: 433 (4b)<br />
2014-10-22 07:14:19,144 DEBUG Setting RFM2Pi group: 210 (210g)<br />
2014-10-22 07:14:20,150 DEBUG Setting RFM2Pi baseid: 10 (10i)</p>
<p>By the way my baseid was originaly 19, i changed it to 10. is something wrong with that?</p>
<p>when i start my raspberry pi or restart emonhub service i get this message in my terminal</p>
<p>&nbsp; File &quot;/home/pi/emonhub/src/emonhub.py&quot;, line 336, in &lt;module&gt;<br />
&nbsp; &nbsp; hub.run()<br />
&nbsp; File &quot;/home/pi/emonhub/src/emonhub.py&quot;, line 90, in run<br />
&nbsp; &nbsp; values = I.read()<br />
&nbsp; File &quot;/home/pi/emonhub/src/emonhub_interfacer.py&quot;, line 352, in read<br />
&nbsp; &nbsp; self._rx_buf = self._rx_buf + self._ser.readline()<br />
&nbsp; File &quot;/usr/lib/python2.7/dist-packages/serial/serialposix.py&quot;, line 456, in read<br />
&nbsp; &nbsp; raise SerialException(&#39;device reports readiness to read but returned no data (device disconnected?)&#39;)<br />
serial.serialutil.SerialException: device reports readiness to read but returned no data (device disconnected?)</p>
<p>What about the rfm12piphp service? is it normal that my terminal do not recognize this service?</p>
<p>also in node in emonhub.conf&nbsp;i have</p>
<p>[[10]]</p>
<p>datacodes = L,h,h,h,h,l,l,l,l</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24712"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: getting started with rfm12pi</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 22/10/2014 - 09:27.</div>
    <div class="content">
     <p>The&nbsp;baseid&nbsp;is the&nbsp;nodeid&nbsp;for the base station, normally that is 15, you can change it but it needs to be a&nbsp;nodeid&nbsp;that is specific to the base. Every device (base and nodes) needs it&#39;s own&nbsp;nodeid&nbsp;which in the case of the base is called the&nbsp;baseid. The default for the&nbsp;emonTx&nbsp;is&nbsp;nodeid&nbsp;10 and for the base (emonhub) it&#39;s 15.</p>
<p>Use of the [nodes] section in the emonhub.conf is not mandatory. Only if you use sketches that use anything other than the default of signed integers in their payloads would you need to declare the&nbsp;datacodes&nbsp;used. So if you are using the default&nbsp;emonTx&nbsp;sketch as supplied you do not need an entry in the [nodes] section.</p>
<p>The guide to update the&nbsp;rfm2pi&nbsp;firmware was written some time ago when using the&nbsp;raspberrypi&nbsp;module was the norm. The&nbsp;raspberrypi&nbsp;module included the&nbsp;rfm2piphp&nbsp;service. If you were wanting to upgrade the&nbsp;rfm2pi&nbsp;firmware on a system running&nbsp;emonhub&nbsp;you would replace that line with &quot;sudo&nbsp;service&nbsp;emonhub&nbsp;stop&quot; to stop the&nbsp;emonhub&nbsp;service instead. Basically&nbsp;you need to stop whatever you have accessing the&nbsp;rfm2pi&nbsp;board from running while you do the update.</p>
<p>Although I haven&#39;t previously seen the error message you have there, it points to a problem with the serial connection and appears to have successfully created a connection but cannot use that connection. You&#39;ve said you had some initial problems and followed a guide to set up&nbsp;emonHub, which guide did you follow?</p>
<p>can you confirm these 2 points</p>
<p>1) Does the last line in&nbsp;<strong>/etc/inittab</strong>&nbsp;read (in particular the&nbsp;#&nbsp;should of been added)</p>
<p><strong># T0:23:respawn:/sbin/getty&nbsp;-L&nbsp;ttyAMA0&nbsp;115200&nbsp;vt100</strong></p>
<p>​2) Does the single line in&nbsp;<strong>/boot/cmdline.txt</strong>&nbsp;read</p>
<p><strong>dwc_otg.lpm_enable=0 console=tty1&nbsp;root=/dev/mmcblk0p2&nbsp;rootfstype=ext4&nbsp;elevator=deadline&nbsp;rootwait</strong></p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/5963"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-KQdKvOOd-Sjg9DIjhRzo9fBxsYc09rurmixAXFeoxtw" value="form-KQdKvOOd-Sjg9DIjhRzo9fBxsYc09rurmixAXFeoxtw"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
