<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/1442 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:37:21 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>EmonTX Calibration and RF Transmission | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">EmonTX Calibration and RF Transmission</h3>
        <span class="submitted">Submitted by Guest on Sun, 25/11/2012 - 19:07</span>
        <div class="content"><p>Hi All,</p>
<p>Hoping for some advice/ideas in relation to two issues I am having with my EmonTX.</p>
<p>Firstly, I&#39;m a little green to the arduino, so please forgive in advance any glaring or stupid errors I may have.</p>
<p>&nbsp;</p>
<p>The first issue I have is in relation to the accuracy of the EmonTX CT. Im using the blue SCT CT as supplied, together with a 9va mains transformer with two secondary windings - one going to a rectifier to power my TX and the other going to the TX to measure voltage. I bought it in Maplin. This area of the Emon is working welll, with voltages in comparison to my multimeter within approx 0.1 to 0.5v on the Emon. However the current is not as accurate for me - at low amperages 2-5a, when I calibrate the Emon all is well, however with the same calibration figures the Emon CT reading at higher amperages (i.e. cooker on at 18A) the Emon reads over 1.5-2a out (generally lower). Going back to 2-4A all is well again.</p>
<p>If I then calibrate for say 18A - using this value now and measuring lower currents again in the 2-4A region, I find that the Emon reading is 0.5-1A out. I&#39;m wondering is this a function of the tolerances of my parts - or an inherent feature of the device. Any ideas on how I can improve things. Note Im still using the 15R burden resistor. Would it help matters if I go to an 18R as per the latest design?</p>
<p>&nbsp;</p>
<p>The second issue related to the transmission of the readings. I&#39;m also monitoring some DS sensors and have included these in the RF payload. When I observe the values via the EmonTX serial port, all values look well and seem correct. However once these reach my Nanode board some have negative numbers, and are not at all correct. Looking more closely at the code for the EmonTX I noticed that a portion of the code takes the emon reading (i.e. volts) and multiplies this by 100. I assume this is because the variable for the voltage in the RF payload is set as integer, and this removes issues with decimal points (I could be wrong here!). Base on this, I added lines for all my other values (multiplying my real and apparent power by 1000, my voltage and DS sensor readings by 100) before transmission. Now my nanode values look ok for voltage and temp sensors, but the real and apparent power readings still do not add up. For example, the apparent power, which should be V*I does not actually equate to the V and I values.</p>
<p>I attach here my EmonTX code - if anybody cares to take a look.</p>
<p>Finally, thanks for a fantastic project and resource - it has been very informative (and sometimes head-wrecking!) getting things working, but always in any case been informative and fun.</p>
<p>I look forward to any ideas on my issues - probably self-inflicted.</p>
<p>Thanks in advance.</p>
<p>Ger</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="1436.html" class="topic-previous" title="Go to previous forum topic">‹ changing connectors on effergy ct clamps for use with tx shield</a>
              <a href="1416.html" class="topic-next" title="Go to next forum topic">RESOLVED: Reading the IR port on the Elster AC100 ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-7649"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2221.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-2221.png" alt="alpav&#039;s picture" title="alpav&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX Calibration and RF Transmission</h3>

    <div class="submitted">Submitted by <a href="../user/2221.html" title="View user profile.">alpav</a> on Sun, 25/11/2012 - 19:43.</div>
    <div class="content">
     <p>Hi Ger,</p>
<p>I&#39;m quite new to the project as well, but I am experiencing some similar issues as you (refer to the thread I have opened <a href="1357.html" title="http://openenergymonitor.org/emon/node/1357">http://openenergymonitor.org/emon/node/1357</a>).</p>
<p>I&#39;ve started asking me why the power recorded by my emonGLCD is different from the same power recorded in emoncms (more than 10% of error). Then I realized that I didn&#39;t calibrate my emonTx so I started from there.</p>
<p>I found today the same issue than you regarding the current reading. I have not a wide range of instruments to test it, but I&#39;ve found a very good accuracy in the range of 2-3 A and worse around 7-8 A. Again, I&#39;m in doubt with the voltage as well as I did calibrate under load but I wonder if it was better to do it over no load.</p>
<p>I have noticed negative values on my base as well but, honestly, I didn&#39;t focus on that yet as I want to proceed step-by-step.</p>
<p>Alberto</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7656"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX Calibration and RF Transmission</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 25/11/2012 - 22:33.</div>
    <div class="content">
     <p>Dealing with the current readings first. At very low currents, the voltages developed by the burden resistor are small and swing over only a few counts of the ADC converter. So it is very hard to maintain accuracy. But at 1 A, the reading should be correct to within around 5%. The actual <a href="https://learn.openenergymonitor.org/?redirect=measurement-implications-of-adc-resolution-at-low-current-values">mechanism</a> by which this happens is quite straightforward.&nbsp; Trystan did some wonderful animated pages a few months ago demonstrating how the errors vary <a href="http://vis.openenergymonitor.org/dev/adc/noiseless">here</a>, <a href="http://vis.openenergymonitor.org/dev/adc/noisy">here</a> and <a href="http://vis.openenergymonitor.org/dev/adc/noise.mp4">here</a>, as well as <a href="../emontx/accuracy.html">this</a>.&nbsp;</p>
<p>The RF payload. The values transmitted are indeed integers. So as you correctly deduce, temperature is multiplied by 100, so as to give two decimal places when divided again. The maximum temperature is likely to be less than 327&deg;C, so this fits into a signed integer (-32768 - +32767).&nbsp; But the powers are transmitted as Watts, so there is no need to multiply those, and now that you have, they overflow the integer if greater than 327.67 W - and that is very likely. Voltage is already multiplied by 100, so if you have multiplied by 100 again, you have the same overflow problem again.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/1442"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-7bx2chhztCHbdHByy-JP-qiPBZlH82XQwo51S3cs4Mw" value="form-7bx2chhztCHbdHByy-JP-qiPBZlH82XQwo51S3cs4Mw"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
