<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/5713 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:30:48 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Logging of Kamstrup Multical 601 Heat Meter | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Logging of Kamstrup Multical 601 Heat Meter</h3>
        <span class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Fri, 05/09/2014 - 17:07</span>
        <div class="content"><p>Kamstrup does not give up the data on their meters easy, but some danish&nbsp;blokes have figured it and finally today I got it to work also.</p>
<p>Most of it is hosted on thingiverse but a danish assembly guide is here:&nbsp;http://wiki.hal9k.dk/projects/kamstrup</p>
<p>In there you will also find links to thingiverse&nbsp;that has the 3D printed part and files for both kicad and eagle.</p>
<p>Besides the 3D printed holder you will need:</p>
<p>&nbsp;</p>
<p>1 x IR-receiver, <a href="http://www.el-supply.dk/?Vnr=455.IRR" title="http://www.el-supply.dk/?Vnr=455.IRR">http://www.el-supply.dk/?Vnr=455.IRR</a><br />
1 x IR-sender, <a href="http://www.el-supply.dk/?Vnr=455.IRT" title="http://www.el-supply.dk/?Vnr=455.IRT">http://www.el-supply.dk/?Vnr=455.IRT</a><br />
2 x BC547<br />
1 x BC557<br />
1M&nbsp;resistor<br />
39k resistor<br />
2 x 10k resistor<br />
220 resistor</p>
<p>4 x 6mm round&nbsp;super-magnets, <a href="http://www.supermagnete.de/eng/S-06-06-N" title="http://www.supermagnete.de/eng/S-06-06-N">http://www.supermagnete.de/eng/S-06-06-N</a></p>
<p>&nbsp;</p>
<p>So far i have gotten this sample data out:</p>
<p>&nbsp;</p>
<p>Energy: 102.47<br />
Current Power: 0.00<br />
Temperature t1: 35.45<br />
Temperature t2: 30.84<br />
Temperature diff: 4.61<br />
Flow: 0.00<br />
Volumen 1: 1208.96<br />
Volumen 2: 0.00</p>
<p>&nbsp;</p>
<p>Played with the sketch a few days and its attached... NOTE: Serial output is set to 57600 and not the normal 9600</p>
<p>All values except the pulse an watt numbers from the pulse input are sent at floats to give an easy and precise transfer of data. Remember to set emonhub.conf for this or it will not decode right</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="10849.html" class="topic-previous" title="Go to previous forum topic">‹ Can use one CT simultaneously to measure Volts and Current ?</a>
              <a href="10802.html" class="topic-next" title="Go to next forum topic">EmonTx v2.5 and throughhole kits ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-26169"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Morten Klitgaard&#039;s picture" title="Morten Klitgaard&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Logging of Kamstrup Multical 601 Heat Meter</h3>

    <div class="submitted">Submitted by Morten Klitgaard (not verified) on Sat, 27/12/2014 - 14:35.</div>
    <div class="content">
     <p>Hi boelle</p>
<p>Great news that you have made &quot;contact&quot; with the Kamstrup 601 :-)</p>
<p>I have just joined this forum and are in the beginning of setting my system together so this is very good news for me.&nbsp;I however have the Kamstrup 602 from HOFOR (Copenhagen Heat and water company), do you know whether your setup i working on the Kamstrup 602 also? (my guess is that it does but it would be nice to get confirmation)</p>
<p>Looking forward to hear from you</p>
<p>Br</p>
<p>Morten</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26685"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Logging of Kamstrup Multical 601 Heat Meter</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Mon, 12/01/2015 - 10:21.</div>
    <div class="content">
     <p>try and ask hal9k where i got the ir stuff from:</p>
<p>&nbsp;</p>
<p><a href="http://wiki.hal9k.dk/projects/kamstrup" title="http://wiki.hal9k.dk/projects/kamstrup">http://wiki.hal9k.dk/projects/kamstrup</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27420"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7659.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="M Klitgaard&#039;s picture" title="M Klitgaard&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Logging of Kamstrup Multical 601 Heat Meter</h3>

    <div class="submitted">Submitted by <a href="../user/7659.html" title="View user profile.">M Klitgaard</a> on Wed, 04/02/2015 - 16:51.</div>
    <div class="content">
     <p>Hi boelle</p>
<p>I have now been fiddling with my Kamstrup Multical 602 Heat Meter and has tried to use the setup described by PHK and the <a href="http://wiki.hal9k.dk/projects/kamstrup">http://wiki.hal9k.dk/projects/kamstrup</a> webpage.</p>
<p>My setup is using a Raspberry Pi which has enabled its UART (and disabled output from kernel on UART)</p>
<p>Set is to 1220 Baud 8 bits, Parity None and 2 stop bits as it is stated in the Kamstrup Multical 602 Technical pdf</p>
<p>Currently my code is based on the fine work from PHK (pyKamstrup) and i can detect that i&#39;m transmitting and receiving my own transmit on the receiving part. I have enven gone so far as to mount a Logic Analyser on the UART in order to sniff and see if i&#39;m doing things right and getting something in back from the Meter, and have also mounted a magnet on the meter</p>
<p>Trouble is that i&#39;m not getting anything... :-(</p>
<p>From the Logic analyser I can see that i&#39;m sending</p>
<p>0x80 &nbsp;0x3F[?]&nbsp; 0x10&nbsp; 0x01&nbsp; BREAK 0x3C[&lt;] 0xB2&nbsp; 0x5F[_]&nbsp; 0x0D</p>
<p>and receiving</p>
<p>0x80 &nbsp;0x3F[?]&nbsp; 0x10&nbsp; 0x01&nbsp; BREAK 0x3C[&lt;]0xB2&nbsp; 0x5F[_]&nbsp; 0x0D</p>
<p>So my Rpi is receiving my own Tx.. fair enough... but nothing from the Meter....</p>
<p>So questions are:</p>
<p>&nbsp;</p>
<p>1. Should i not get something like 0x40 data data data?</p>
<p>2. The Technical PDF for Multical states that a magnet has to be in place in order to read the meter, but does not say anything about a time fram from within i must read the meater after mounting the magnet (Multical 21 water meter states this timeframe) do you know anything about this? any experience from Multical 601?</p>
<p>3. You have rewritten the code from PyKamstrup to Arduino, did you cnage anything in the protocol or commands?</p>
<p>&nbsp;</p>
<p>Thanks in advance... getting quite frustrated</p>
<p>&nbsp;</p>
<p>Br</p>
<p>M Klitgaard</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27433"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Logging of Kamstrup Multical 601 Heat Meter</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Thu, 05/02/2015 - 11:59.</div>
    <div class="content">
     <p>3. no i have not... the code was provided from hal9k...&nbsp;</p>
<p>2. nope... i dont have that water meter, my watermeter is an elster meter with a reed switch output, one pulse pr liter. kamstrup water meters are battery powered and you will simply drain the battery to quickly if you read to much from it... as for the 601, it simply works for me</p>
<p>1. not sure since i use the arduino sketch from hal9k</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-27609"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7659.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="M Klitgaard&#039;s picture" title="M Klitgaard&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Logging of Kamstrup Multical 601 Heat Meter</h3>

    <div class="submitted">Submitted by <a href="../user/7659.html" title="View user profile.">M Klitgaard</a> on Wed, 11/02/2015 - 16:21.</div>
    <div class="content">
     <p>Hi boelle</p>
<p>I&#39;m on the brink of quitting! I can&#39;t get the Darrn Kamstrup Multical 602 to give me any answers :-(</p>
<p>I can see that you have debated this with others who also have difficaulties <a href="http://ing.dk/blog/kamstrup-meter-protocol-127052" title="http://ing.dk/blog/kamstrup-meter-protocol-127052">http://ing.dk/blog/kamstrup-meter-protocol-127052</a></p>
<p>I&#39;m at at point where i think i have tried every thing</p>
<p>- I&#39;m using the PHK code from here: <a href="https://github.com/bsdphk/PyKamstrup" title="https://github.com/bsdphk/PyKamstrup">https://github.com/bsdphk/PyKamstrup</a></p>
<p>- I have been looking at your Code and it seems like you and PHK are doing the same thing</p>
<p>- I have tried using either a Windows machine with a USB-UART cable or a Raspberry Pi (UART interface)</p>
<p>- I have made a IR module according to <a href="http://wiki.hal9k.dk/_media/projects/kamstrup/schematic.pdf " title="http://wiki.hal9k.dk/_media/projects/kamstrup/schematic.pdf ">http://wiki.hal9k.dk/_media/projects/kamstrup/schematic.pdf </a></p>
<p>- I have tried to lower the sensitivity of the Receiving Diode</p>
<p>- I have tried to lower the output power of the transmitting diode (as i was thinking that maybe i was saturating the receiver)</p>
<p>- I have tried to mount Neodyn magnets&nbsp;just above and beneath the IR&nbsp;interface at the same time transmitting with IR</p>
<p>- I have tried to transmit with 1200 and 2400 Baud (8bit, Parity None, Stopbit = 2)</p>
<p>- have tried to watch the IR interface with an old mobile phone which can see the IR when ON</p>
<p>- I have monitored the data stream electrically with an Analog discovery device and what i think&nbsp;should be transmittet actually is transmittet&nbsp;</p>
<p>But i just cant get the Unit to gime me any responce!!!&nbsp;:-(</p>
<p>I mean No IR lighting up at all..... :-(</p>
<p>Any idea what i&#39;m doing wrong?</p>
<p>what am i missing?</p>
<p>Could it be that HOFOR/Kamstrup has disabled the IR interface?</p>
<p>I can&#39;t really find any one describing that they have been able to talk to and Multical 602... Lot of info on the web about 601 but nothing about 602 as far as i can see....</p>
<p>Getting really tired.... I really hope that&nbsp;any one&nbsp;can give me i push in the right direction</p>
<p>Maybe a log dump of what you are transmitting and receiving or any other ideas?</p>
<p>Br</p>
<p>M Klitgaard</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31218"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8255.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="goodfidelity&#039;s picture" title="goodfidelity&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Logging of Kamstrup Multical 601 Heat Meter</h3>

    <div class="submitted">Submitted by <a href="../user/8255.html" title="View user profile.">goodfidelity</a> on Thu, 11/06/2015 - 23:51.</div>
    <div class="content">
     <p>Hello guys!</p>
<p>
Regarding the Kamstrup units, Kamstrup themself claim that the IR is only for setting up the units. And that they have communication modules for them. I have tried with some various models and it seems to me that the support over at Kamstrup (Landis&amp;Gyr?) does not know all that is to know about their own products.</p>
<p>However some of the units i have run in to does have a pulse module attached. So i plan on using the pulse output from this module to connect into the energy monitoring system.</p>
<p>Seems to me some of the equipment is sold with various brands, or produced by various producers and relabelled.</p>
<p>I am not sure, this is just my observations from opening about 10 of these units and looking inside, and having contact with their support in Sweden.</p>
<p>&nbsp;</p>
<p>Its very interesting for me to know if these can be monitored from the IR connector, that would save allot of hassle because some of the units had M-bus instead of pulse wich is more difficult to log.</p>
<p>//JK</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31267"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Logging of Kamstrup Multical 601 Heat Meter</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Sat, 13/06/2015 - 13:30.</div>
    <div class="content">
     <p>well all kamstrup meters have the IR interface&nbsp;</p>
<p>&nbsp;</p>
<p>and i dont know why they claim its only for setup, at hal9k,dk they use it to get data out and&nbsp;kildal.dk have done it, the later have now put password on his site for a reason i dont know&nbsp;</p>
<p>i got to the project via thingiverse:&nbsp;http://www.thingiverse.com/thing:264268</p>
<p>&nbsp;</p>
<p>in the comments they point to their wiki:&nbsp;http://wiki.hal9k.dk/projects/kamstrup</p>
<p>&nbsp;</p>
<p>a lot of helpfull stuff there</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31273"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8255.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="goodfidelity&#039;s picture" title="goodfidelity&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Logging of Kamstrup Multical 601 Heat Meter</h3>

    <div class="submitted">Submitted by <a href="../user/8255.html" title="View user profile.">goodfidelity</a> on Sat, 13/06/2015 - 22:37.</div>
    <div class="content">
     <p>I find it very internering that the support Claire the Ir was for setup only, they referred to special modules for</p>
<p>communication. Serial module, plus module or different kinds for different systems.</p>
<p>&nbsp;</p>
<p>its very nice that they can communicate with this IR port. However it&#39;s not very nice that they don&#39;t give the protocols to people who want to use it.</p>
<p>&nbsp;</p>
<p>i will follow this thread to se where it all ends up, one of</p>
<p>my customers have multiple units like this with various modules. Much better if they can get the data out with the Ir.</p>
<p>&nbsp;</p>
<p>//J</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/5713"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-O2nF9VVWEhcPIIDSz6lVfyz7w3rjUu1A-s4ftouyv7o" value="form-O2nF9VVWEhcPIIDSz6lVfyz7w3rjUu1A-s4ftouyv7o"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
