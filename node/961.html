<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/961 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:53:15 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Read only variable | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Read only variable</h3>
        <span class="submitted">Submitted by Guest on Sat, 18/08/2012 - 17:54</span>
        <div class="content"><p>Hi,</p>
<p><span class="hps">How do I</span> <span class="hps">read only the</span> <span class="hps">variable</span> <span class="hps">Irms</span><span>,</span> <span class="hps">and</span> <span class="hps">Vrms</span> <span class="hps">or</span> <span class="hps">realPower</span><span>?</span><br />
<span class="hps">I do not</span> <span class="hps">need to read</span> <span class="hps">all the variables</span> <span class="hps">via serial</span><span>.</span></p>
<p><span>Ailton</span></p>
  <div class="forum-topic-navigation clear-block">
          <a href="964.html" class="topic-previous" title="Go to previous forum topic">‹ emoncms3 error_log</a>
              <a href="836.html" class="topic-next" title="Go to next forum topic">Multigraph in an iframe ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-5802"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Read only variable</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 18/08/2012 - 19:04.</div>
    <div class="content">
     <p>I do not understand your question.</p>
<p>I think you are asking: &quot;How to I choose which variables to send through the serial link to display on the computer?&quot;</p>
<p>Look in the sketch and the file &quot;EmonLib.cpp&quot;, and you will see statements like</p>
<blockquote><p>&nbsp;&nbsp;&nbsp; Serial.print(realPower);<br />
&nbsp;&nbsp;&nbsp; Serial.print(' ');<br />
&nbsp;&nbsp;&nbsp; Serial.print(apparentPower);<br />
&nbsp;&nbsp;&nbsp; Serial.print(' ');<br />
&nbsp;&nbsp;&nbsp; Serial.print(Vrms);<br />
&nbsp;&nbsp;&nbsp; Serial.print(' ');<br />
&nbsp;&nbsp;&nbsp; Serial.print(Irms);<br />
&nbsp;&nbsp;&nbsp; Serial.print(' ');<br />
&nbsp;&nbsp;&nbsp; Serial.print(powerFactor);<br />
&nbsp;&nbsp;&nbsp; Serial.println(' ');</p>
</blockquote>
<p>The first prints the value of realPower, the second prints a space, the third prints the value of apparentPower, etc.<br />
The last prints a space and ends the line (print<strong>ln</strong>( ) ).</p>
<p>If you do not want some of this lines, make them comments:</p>
<blockquote><p>&nbsp;&nbsp;&nbsp; Serial.print(realPower);<br />
&nbsp; //&nbsp; Serial.print(' ');<br />
&nbsp; // &nbsp; Serial.print(apparentPower);<br />
&nbsp;&nbsp;&nbsp; Serial.print(' ');<br />
&nbsp;&nbsp;&nbsp; Serial.print(Vrms);<br />
&nbsp;&nbsp;&nbsp; Serial.print(' ');<br />
&nbsp;&nbsp;&nbsp; Serial.print(Irms);<br />
&nbsp; // &nbsp; Serial.print(' ');<br />
&nbsp; //&nbsp; Serial.print(powerFactor);<br />
&nbsp;&nbsp;&nbsp; Serial.println(' ');</p>
</blockquote>
<p>This will NOT print apparentPower and powerFactor. It WILL print realPower, Vrms and Irms.</p>
<p>&nbsp;</p>
<blockquote></blockquote>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-5806"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ailtonfacanha&#039;s picture" title="ailtonfacanha&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Read only variable</h3>

    <div class="submitted">Submitted by ailtonfacanha (not verified) on Sat, 18/08/2012 - 21:36.</div>
    <div class="content">
     <p>Hi, Robert</p>
<p><span class="hps">Thanks,</span> <span class="hps">Robert</span> <span class="hps">for your explanations</span><span>.</span> <span class="hps">I want to use</span> <span class="hps">the variables</span> <span class="hps">without the</span> <span class="hps">use</span> <span class="hps">emonx.serialprint</span> <span class="hps">()</span><span>;</span></p>
<p><span class="hps">Can you</span> <span class="hps">help me</span><span>?</span></p>
<p><span class="hps">I will not</span> <span class="hps">use them in the</span> <span class="hps">serial monitor</span> <span class="hps">and</span> <span class="hps">want to send</span> <span class="hps">these variables</span> <span class="hps">to</span> <span class="hps">an</span> <span class="hps">LCD</span><span>.</span></p>
<p><span>Ailton</span></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-5810"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Read only variable</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 19/08/2012 - 11:39.</div>
    <div class="content">
     <p>Now I understand. Are you using the RFM12B module?</p>
<p>The r.f. module uses a data packet of type &quot;payloadTX&quot; (or a similar name) to send the data. The contents of &quot;payload&quot; must be the same in both the emonTx and the emonGLCD. The definition is similar to:</p>
<blockquote><p>typedef struct <br />
{ <br />
&nbsp; int powerA, appA;<br />
&nbsp; int powerB, appB;&nbsp; <br />
} PayloadTX;<br />
PayloadTX emontx;&nbsp;&nbsp;</p>
</blockquote>
<p>In this example, there are 4 integer values: powerA, appA, powerB, appB.&nbsp; The particular instance is called &quot;emontx&quot;</p>
<p>The data is written into payload inside loop( ) after it has been calculated:</p>
<blockquote><p>emontx.powerA = emon1.realPower;<br />
emontx.appA = emon1.apparentPower;<br />
&nbsp; [etc]</p>
</blockquote>
<p>At the GLCD end, you need to define exactly the same data structure (but it need not have the same name) and you extract the data in much the same way (only in reverse):</p>
<blockquote><p>consuming = emontx.powerA; &nbsp;<br />
&nbsp; [etc] &nbsp;</p>
</blockquote>
<p>You can of course put whatever data you want into the payload. (The data elements need not have the same names, but they must correspond exactly in order, type and size - example: {int, float, long} is not the same as {long, int, float} and the information will be corrupted).</p>
<p>If you are not using the serial monitor, you can change all those Serial.print( ) statements into comments.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-5811"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ailtonfacanha&#039;s picture" title="ailtonfacanha&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Read only variable</h3>

    <div class="submitted">Submitted by ailtonfacanha (not verified) on Sun, 19/08/2012 - 13:03.</div>
    <div class="content">
     <p>Hi, Robert</p>
<p>Robert -&gt; Are you using the RFM12B module?</p>
<p>Ailton -&gt; <span class="hps">I'm not using</span><span>.</span> <span class="hps">I'll</span> <span class="hps">use a</span> <span class="hps">20x4</span> <span class="hps">LCD</span> <span class="hps">compatible with</span> <span class="hps"><strong>HD44780.</strong></span></p>
<p><span class="hps"><span class="hps">Thanks</span> <span class="hps">for your help!</span></span></p>
<p><span class="hps"><span class="hps">Ailton</span></span></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-5812"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Read only variable</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 19/08/2012 - 14:08.</div>
    <div class="content">
     <p>I based my explanation on the software for the emonTx and emonGLCD. So, if you are not using those, how are you collecting the data, processing it to calculate rms voltage and current, power, etc, and then transmitting it to the LCD?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-5815"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ailtonfacanha&#039;s picture" title="ailtonfacanha&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Read only variable</h3>

    <div class="submitted">Submitted by ailtonfacanha (not verified) on Sun, 19/08/2012 - 20:21.</div>
    <div class="content">
     <p>Hi, Robert</p>
<p><span class="hps">Something like</span> <span class="hps">this: <a href="https://learn.openenergymonitor.org/?redirect=nokia-3310-lcd">http://openenergymonitor.org/emon/buildingblocks/nokia-3310-lcd</a>&nbsp;. <span class="hps">Updated to</span> <span class="hps">Emonlib</span><span>.</span></span></p>
<p><span class="hps"><span><span class="hps"><span class="hps">Thanks</span> <span class="hps">for your help!</span></span></span></span></p>
<p><span class="hps"><span><span class="hps"><span class="hps">Ailton</span></span></span></span></p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-5816"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Read only variable</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 19/08/2012 - 22:43.</div>
    <div class="content">
     <p>If you look at the very last few lines of that sketch, you have the Serial.print(&nbsp; ) statements, then 3 lines to reset the accumulators, then:</p>
<blockquote><p>//Output Real Power to the LCD<br />
itoa((int)(realPower), chvalue,10);<br />
lcd.LCD_3310_clear();<br />
lcd.LCD_3310_write_string_big(15, 1, chvalue, MENU_NORMAL);<br />
lcd.LCD_3310_write_string(65, 3, &quot;W&quot;, MENU_NORMAL);</p>
</blockquote>
<p>itoa((int)(realPower), chvalue,10);&nbsp; converts the integer value to ASCII characters, putting the characters into 'chvalue'</p>
<p>lcd.LCD_3310_write_string_big(15, 1, chvalue, MENU_NORMAL);&nbsp; does what it says - writes to the display.</p>
<p>You will need to look at the other (Nokia?) documentation to see where the characters are written (That's what the &quot;15,1&quot; is), work out how to arrange the display of the 3 values you want and add 2 more sets of lines (itoa....&nbsp;&nbsp; and&nbsp; ...write_string...) to write Vrms and Irms.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/961"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-0dj9gWbh5B_v7UHUq_5JnT-T32fdf4b6KqTjoAWL-ng" value="form-0dj9gWbh5B_v7UHUq_5JnT-T32fdf4b6KqTjoAWL-ng"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
