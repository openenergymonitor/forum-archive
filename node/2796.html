<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>multi-CT (6) MQTT Publisher shield | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/emon/sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="/emon/modules/node/node.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/defaults.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/system.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/system-menus.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/user/user.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/modules/mollom/mollom.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/forum/forum.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/modules/views/css/views.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/comment/comment.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/themes/emon3/style.css?r" />
<style type="text/css" media="all">@import "/emon/sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="/emon/" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="/emon/">Home</a> » <a href="/emon/forum">Forums</a> » <a href="/emon/forum/4">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">multi-CT (6) MQTT Publisher shield</h3>
        <span class="submitted">Submitted by <a href="/emon/user/4305" title="View user profile.">Elwell</a> on Tue, 10/09/2013 - 02:57</span>
        <div class="content"><p>Hi Folks,</p>
<p>Rather than using RF to send the usage telemetry from our (metal) meter box, I&#39;m going to build a multi-CT shield to add to a PoE equipped etherten&nbsp;or Arduino Ethernet (both use the whiznet 5100 chip, so none of the mqtt issues associated with the nanode ENC chipset.</p>
<p>I plan to use all 6 analogue inputs and bring them out for the seedstudio&nbsp;30A&nbsp;CT clamps - the board itself will be V basic, none of the voltage measurement stufff (thats already picked up by other kit such as the UPS (via apcupsd) and the PV inverter (during the daytime))&nbsp;</p>
<p>sketch will basically just loop over all inputs and publish to a broker on the LAN.&nbsp;</p>
<p>I was going to stripboard a version for me, but if there&#39;s sufficient interest I&#39;ll see about producing a &#39;real&#39; PCB and sharing.</p>
<p>&nbsp;</p>
<p>Anyone interested?</p>
<p>&nbsp;</p>
<p>Andrew</p>
  <div class="forum-topic-navigation clear-block">
          <a href="/emon/node/2799" class="topic-previous" title="Go to previous forum topic">‹ current sensor</a>
              <a href="/emon/node/2794" class="topic-next" title="Go to next forum topic">YHDC SCT027H Current Sensor/Transformer ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-15012"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: multi-CT (6) MQTT Publisher shield</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 10/09/2013 - 10:16.</div>
    <div class="content">
     <p>One small caveat: unless you bring the voltage measurement to the same place as the current, you&#39;ll only be able to calculate apparent power. The calculation of real power implies multiplying each voltage and current sample and then averaging. If you send individual samples of voltage and current from different places, you will have big problems with timing delays.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-15015"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/4305" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-4305.png" alt="Elwell&#039;s picture" title="Elwell&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: multi-CT (6) MQTT Publisher shield</h3>

    <div class="submitted">Submitted by <a href="/emon/user/4305" title="View user profile.">Elwell</a> on Tue, 10/09/2013 - 12:03.</div>
    <div class="content">
     <p>Thanks,</p>
<p>&gt;&nbsp;you will have big problems with timing delays.</p>
<p>realistically for a home install, is this going to be that much of an issue? I know my AC voltage is typically in the range 248-258v -- so even with a slow voltage sampling It won&#39;t be out *that* much (will it?)</p>
<p>Even if I&#39;m only calculating apparent power, having 2 channels for the sources (grid and PV) I can still work out the relative usage by the other 4 circuits (ie, where our consumption is going). It may even be possible to &quot;recalibrate&quot; on the fly given the logging direct from the solar inverter -- ie, if that says I&#39;m producing 1000W&nbsp;at the output stage then the CT on that cable in the meter box should be close to 1000W&nbsp;(hopefully!)</p>
<p>My plan for timing is to throw everything into the messsage broker every 6 seconds</p>
<p>&nbsp;</p>
<p>Thanks for the suggestions - anything glaring I&#39;ve missed so far?</p>
<p>&nbsp;</p>
<p>Andrew</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-15019"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: multi-CT (6) MQTT Publisher shield</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Tue, 10/09/2013 - 12:37.</div>
    <div class="content">
     <p>I don&#39;t think you understand the difference between apparent power and real power - you need to do some reading: <a href="http://openenergymonitor.org/emon/buildingblocks/ac-power-introduction" title="http://openenergymonitor.org/emon/buildingblocks/ac-power-introduction">http://openenergymonitor.org/emon/buildingblocks/ac-power-introduction</a></p>
<p>They are only the same for purely resistive loads. Some small loads can have appalling power factors and you may have 20 VA of apparent power and maybe 3 W of real power.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="/emon/node/2796"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-7S_Uq4DuijYSR86S7shMAHqOyun_KZlbIAo6gBwEdRY" value="form-7S_Uq4DuijYSR86S7shMAHqOyun_KZlbIAo6gBwEdRY"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org">https://community.openenergymonitor.org</a></p>
   
</div>

<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
