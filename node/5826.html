<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/5826 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 13:24:05 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Feature Request: Emoncms Event Module - support for MQTT | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/7.html">Archived:  Emoncms Showcase</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Feature Request: Emoncms Event Module - support for MQTT</h3>
        <span class="submitted">Submitted by <a href="../user/3651.html" title="View user profile.">nubble</a> on Thu, 25/09/2014 - 11:55</span>
        <div class="content"><p>Hi,</p>
<p>Im not sure if this is the place or feature requests but here goes anyway:</p>
<p>&nbsp;</p>
<p>Is it possible for the Event module to add MQTT to the list of supported actions. There is an MQTT module as well for getting data into emoncms, but in this case want to use the event module for getting feed data out of emoncms. but the MQTT&nbsp;php&nbsp;files in the MQTT module can be used as starting point for getting the Event module to send MQTT messages.</p>
<p>For someone who knows what they are doing in PHP [and their way around emoncms] this should be so so simple!</p>
<p>&nbsp;</p>
<p>Thanks in advance</p>
<p>Jason</p>
  <div class="forum-topic-navigation clear-block">
          <a href="5892.html" class="topic-previous" title="Go to previous forum topic">‹ My Net Costs dashboard</a>
              <a href="5875.html" class="topic-next" title="Go to next forum topic">My per-circuit dashboard ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-24149"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 25/09/2014 - 14:50.</div>
    <div class="content">
     <p>Are you wanting this feature to transfer feed data from emoncms to node-red?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24151"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3651.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3651.png" alt="nubble&#039;s picture" title="nubble&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/3651.html" title="View user profile.">nubble</a> on Thu, 25/09/2014 - 15:42.</div>
    <div class="content">
     <p>Hi Paul,&nbsp;</p>
<p>I use MQTT as the foundation of my home network where all sensors, and consumers interface to. I use openhab for my home automation sensors and control items. I now use emoncms for my energy items [ as I did the energy analytics before in openhab&nbsp;but didnt want re-invent what has been done in emoncms] and want access to the feeds in emoncms from openhab and distributed arduino sensors with lcds [like emonglcd but it will get its feed data from emoncms]</p>
<p>Heres my architecture:</p>
<p><img alt="" src="../sites/default/files/homeArchitecture.png" style="width: 600px; height: 350px;" /></p>
<p>Thanks</p>
<p>Jason</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24161"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 25/09/2014 - 20:08.</div>
    <div class="content">
     <p>I know that MQTT is on the radar for future OEM development, and will be a welcome addition.</p>
<p>I asked if you were using node-red, because I have just started using a flow to <u>poll data</u> from emoncms, and process it in node-red (courtesy of Martin Harizanov) which seems to work well, and enables me to not only monitor diverted solar power to my immersion heater, but with the intention of switching on the gas boiler depending upon water temperature &amp; weather forecasts etc.</p>
<p>Anyway the node-red flow is pasted below if anyone wants it.</p>
<p>Paul</p>
<p>&nbsp;</p>
<p>[{&quot;id&quot;:&quot;49fd813c.b6028&quot;,&quot;type&quot;:&quot;function&quot;,&quot;name&quot;:&quot;Prepare emonCMS URL&quot;,&quot;func&quot;:&quot;var API=\&quot;emoncms read only API key\&quot;;\nvar feedID=15;\n\nvar URL=\&quot;http://yoururl/emoncms/feed/value.json?apikey=\&quot; + API + \&quot;&amp;id=\&quot; + feedID\n\nmsg.url=URL;\n\nreturn msg;&quot;,&quot;outputs&quot;:1,&quot;x&quot;:275,&quot;y&quot;:390,&quot;z&quot;:&quot;7fc7e6a6.803818&quot;,&quot;wires&quot;:[[&quot;781ffd8f.87e004&quot;]]},{&quot;id&quot;:&quot;781ffd8f.87e004&quot;,&quot;type&quot;:&quot;http request&quot;,&quot;name&quot;:&quot;HTTP request&quot;,&quot;method&quot;:&quot;GET&quot;,&quot;url&quot;:&quot;&quot;,&quot;x&quot;:486,&quot;y&quot;:390,&quot;z&quot;:&quot;7fc7e6a6.803818&quot;,&quot;wires&quot;:[[&quot;bfa7dec1.40582&quot;]]},{&quot;id&quot;:&quot;3160b88d.ce9f48&quot;,&quot;type&quot;:&quot;inject&quot;,&quot;name&quot;:&quot;@21:00&quot;,&quot;topic&quot;:&quot;&quot;,&quot;payload&quot;:&quot;&quot;,&quot;payloadType&quot;:&quot;none&quot;,&quot;repeat&quot;:&quot;&quot;,&quot;crontab&quot;:&quot;00 21 * * *&quot;,&quot;once&quot;:false,&quot;x&quot;:91,&quot;y&quot;:390,&quot;z&quot;:&quot;7fc7e6a6.803818&quot;,&quot;wires&quot;:[[&quot;49fd813c.b6028&quot;]]},{&quot;id&quot;:&quot;76de90dd.89217&quot;,&quot;type&quot;:&quot;pushover&quot;,&quot;title&quot;:&quot;Hot Water Warning&quot;,&quot;name&quot;:&quot;&quot;,&quot;priority&quot;:0,&quot;x&quot;:704,&quot;y&quot;:434,&quot;z&quot;:&quot;7fc7e6a6.803818&quot;,&quot;wires&quot;:[]},{&quot;id&quot;:&quot;a9e222c0.561de&quot;,&quot;type&quot;:&quot;switch&quot;,&quot;name&quot;:&quot;Alert if less than 3kw&quot;,&quot;property&quot;:&quot;payload&quot;,&quot;rules&quot;:[{&quot;t&quot;:&quot;lt&quot;,&quot;v&quot;:3,&quot;v2&quot;:0}],&quot;checkall&quot;:&quot;true&quot;,&quot;outputs&quot;:1,&quot;x&quot;:261,&quot;y&quot;:434,&quot;z&quot;:&quot;7fc7e6a6.803818&quot;,&quot;wires&quot;:[[&quot;2dc69278.d2396e&quot;]]},{&quot;id&quot;:&quot;2dc69278.d2396e&quot;,&quot;type&quot;:&quot;function&quot;,&quot;name&quot;:&quot;Prepare Push Message&quot;,&quot;func&quot;:&quot;var diverted = msg.payload;\n\ndiverted = Math.round(diverted * 100) / 100\n\nmsg.payload = (\&quot;Only \&quot; + diverted + \&quot;kw was diverted to the immersion heater today. Time to switch on the gas boiler!\&quot;);\nreturn msg;&quot;,&quot;outputs&quot;:1,&quot;x&quot;:486,&quot;y&quot;:434,&quot;z&quot;:&quot;7fc7e6a6.803818&quot;,&quot;wires&quot;:[[&quot;76de90dd.89217&quot;]]},{&quot;id&quot;:&quot;7164a6d2.8e9b58&quot;,&quot;type&quot;:&quot;debug&quot;,&quot;name&quot;:&quot;&quot;,&quot;active&quot;:true,&quot;console&quot;:&quot;false&quot;,&quot;complete&quot;:&quot;false&quot;,&quot;x&quot;:795,&quot;y&quot;:390,&quot;z&quot;:&quot;7fc7e6a6.803818&quot;,&quot;wires&quot;:[]},{&quot;id&quot;:&quot;bfa7dec1.40582&quot;,&quot;type&quot;:&quot;json&quot;,&quot;name&quot;:&quot;&quot;,&quot;x&quot;:638,&quot;y&quot;:390,&quot;z&quot;:&quot;7fc7e6a6.803818&quot;,&quot;wires&quot;:[[&quot;a9e222c0.561de&quot;,&quot;7164a6d2.8e9b58&quot;]]}]</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24193"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6498.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6498.jpg" alt="sumnerboy&#039;s picture" title="sumnerboy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/6498.html" title="View user profile.">sumnerboy</a> on Sat, 27/09/2014 - 20:41.</div>
    <div class="content">
     <p>I too would be very interested in this. I use the event module to tweet me when I get over 15kWh generation in a day but ideally I would like it to publish an MQTT topic so that my home automation monitoring script, mqttwarn, can handle it and send out Pushover notifications, tweets etc. </p>
<p>But then nubbles has prompted some further thoughts and I agree it would be great to be able to pull out calculated feed data from emoncms. </p>
<p>I have zero php experience so hopefully someone out there can knock this up without too much trouble?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24197"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Sun, 28/09/2014 - 21:05.</div>
    <div class="content">
     <p>Publishing feed data to MQTT&nbsp;would be a natural progression for emoncms and a further step towards IoT.</p>
<p>Gets my vote.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24209"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Tue, 30/09/2014 - 12:08.</div>
    <div class="content">
     <p>Also think this is a good idea. What would be a good form for the MQTT topic for feed data? It is a matter of having a single topic say called &#39;feeds&#39; and publishing a json into it when any feed is updated, something like:</p>
<p>MQTT topic: feeds</p>
<p>{&quot;id&quot;:1, &quot;time&quot;:UNIXTIMESTAMP, &quot;value&quot;:250.2}<br />
	{&quot;id&quot;:2, &quot;time&quot;:UNIXTIMESTAMP, &quot;value&quot;:25.2}<br />
	{&quot;id&quot;:3, &quot;time&quot;:UNIXTIMESTAMP, &quot;value&quot;:120}</p>
<p>It could be added to the feed_model in the set_timevalue function with a similar check to if ($this-&gt;redis) { in order to check if mqtt is available..</p>
<p>Is there a better way to do this?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24210"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6498.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6498.jpg" alt="sumnerboy&#039;s picture" title="sumnerboy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/6498.html" title="View user profile.">sumnerboy</a> on Tue, 30/09/2014 - 21:14.</div>
    <div class="content">
     <p>I think ideally it would be a configurable base topic, and then EmonCMS would create subtopics using the feed id;</p>
<p>E.g. set base topic to &#39;home/energy/emoncms/feeds&#39;, then assuming I had two feeds I would get values published to;</p>
<p>home/energy/emoncms/feeds/1 &nbsp; &nbsp;250.2</p>
<p>home/energy/emoncms/feeds/2 &nbsp; &nbsp;25.2</p>
<p>And if you wanted the&nbsp;timestamps&nbsp;published then maybe dump them in a subtopic;</p>
<p>home/energy/emoncms/feeds/1/timestamp &nbsp; &nbsp;UNIXTIMESTAMP</p>
<p>home/energy/emoncms/feeds/2/timestamp &nbsp; &nbsp;UNIXTIMESTAMP</p>
<p>That way we can publish raw values, instead of JSON, making it easier for subscribing clients to handle. The timestamp subtopic would in effect just be a &#39;last updated&#39; field.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24215"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Wed, 01/10/2014 - 18:26.</div>
    <div class="content">
     <p>I think Ben&#39;s suggested format would be the easiest to integrate, and if the &#39;configurable base topic&#39; proves extra work, then it could be a preset such as;</p>
<p>emoncms/feed/3</p>
<p>Also, is there any need for the timestamp to be included?</p>
<p>&nbsp;</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24216"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6498.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6498.jpg" alt="sumnerboy&#039;s picture" title="sumnerboy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/6498.html" title="View user profile.">sumnerboy</a> on Wed, 01/10/2014 - 19:18.</div>
    <div class="content">
     <p># Also, is there any need for the timestamp to be included?</p>
<p>I don&#39;t think so no, I believe it is the subscribing clients task to monitor the dttms of events if required.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24238"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3651.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3651.png" alt="nubble&#039;s picture" title="nubble&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/3651.html" title="View user profile.">nubble</a> on Thu, 02/10/2014 - 17:27.</div>
    <div class="content">
     <p>I don&#39;t think that the time stamp will add much value unless someone has an application that uses sequence of events. In my case it&#39;s to integrate to my home automation system which in my case doesn&#39;t need timestamped data.&nbsp;</p>
<p>I have been busy in the event module and have a emoncms build running that includes a mqtt action that published on a defined event trigger. The topic and payload is configurable as suggested by Ben above.&nbsp;</p>
<p>I have used the phpmqtt lib from blue rhino instead of SAM as SAM is no longer supported. I&#39;ve added additional columns to event and event settings tables for the mqtt settings and per event items for mqtt.&nbsp;</p>
<p>I however need some expert help about now with managing the mqtt connection and variable scope within the event code. As it is currently a connection is setup and established for each publish of an mqtt and then closed immediately afterwards. So while it works, it&#39;s unnecessary overhead. So my question is: does the event class in eventmodel.php get instantiated many times or just once? I can&#39;t figure out the calling sequence in emoncms.&nbsp;</p>
<p>I will post some screenshots and other details later on.&nbsp;</p>
<p>Jason</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24239"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4234.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="XaroRSA&#039;s picture" title="XaroRSA&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/4234.html" title="View user profile.">XaroRSA</a> on Thu, 02/10/2014 - 18:01.</div>
    <div class="content">
     <p>If im not mistaken, the event module only runs once per update, since its all php code, meaning the server is called, runs the code, then terminates.</p>
<p>So each time a feed is updated, then the event module is called, so its not a &#39;persistent&#39; model.</p>
<p>I believe you will need JavaScript running on a browser page to get &#39;persistence&#39;.</p>
<p>I might be dead wrong here, so anybody that knows better please correct me.</p>
<p>I have been working on event module too, maybe we should share some code Jason :D</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24242"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6498.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6498.jpg" alt="sumnerboy&#039;s picture" title="sumnerboy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/6498.html" title="View user profile.">sumnerboy</a> on Thu, 02/10/2014 - 18:38.</div>
    <div class="content">
     <p>I know that the Paho MQTT client has a &#39;send single message&#39; API - which creates a connection, sends the message, and tears it down. I am not suggesting you should be using (or even can use) the Paho library, but I think that suggests that there is not a lot of overhead in making a connection to an MQTT broker.</p>
<p>In fact I would suggest what you are doing is just fine. MQTT is supposed to be, by design, extremely low overhead and I presume this includes the connection process.</p>
<p>I know Trystan is looking at an MQTT&nbsp;module for publishing feed values, which will be separate to the event module I believe? In that case it would make more sense for a connection to opened once and continually published to.</p>
<p>Looking forward to getting my hands on what you have done Nubble - great work!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24243"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3651.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3651.png" alt="nubble&#039;s picture" title="nubble&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/3651.html" title="View user profile.">nubble</a> on Thu, 02/10/2014 - 18:42.</div>
    <div class="content">
     <p>Hi,&nbsp;</p>
<p>Thats what I thought, and that is why another strategy is necessary to persist the mqtt connection. Any help would be highly appreciated.</p>
<p>&nbsp;</p>
<p>Here are some screenshots and the detail of the getting mqtt publishing as an action in the event module:</p>
<p>I added 2 columns to the &#39;event_settings&#39; table, called mqttbrokerip and mqttbrokerport. I plan to add another 2 columns for mqttusername and mqttpassword for the authentication</p>
<p><img alt="" src="../sites/default/files/eventsettings.png" style="width: 649px; height: 391px;" /></p>
<p>I also added 2 columns to the &#39;events&#39; table called setmqtttopic and setmqttpayload. Ill ad another later on for the mqttqos</p>
<p><img alt="" src="../sites/default/files/event.png" style="width: 682px; height: 220px;" /></p>
<p>As mentioned I prefered to use phpmqtt from bluerhino&nbsp;[&nbsp;<a href="https://github.com/bluerhinos/phpMQTT">https://github.com/bluerhinos/phpMQTT</a>&nbsp;]as SAM is no longer supported and I found the bluerhino&nbsp;api to be easier to use.</p>
<p>&nbsp;</p>
<p>Below is a screenshot of my test&nbsp;rsmb mqtt&nbsp;broker receiving mqtt publish messages from the event module.&nbsp;</p>
<p>&nbsp;I am more than happy to share code. Ill attach the event module code tomorrow morning CAT.</p>
<p><img alt="" src="../sites/default/files/rsmb.png" style="width: 640px; height: 410px;" /></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24244"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 02/10/2014 - 20:02.</div>
    <div class="content">
     <p><em>&nbsp; &nbsp; &nbsp;&quot;I know Trystan is looking at an MQTT module for publishing feed values, which will be separate to the event module I believe? In that case it would make more sense for a connection to opened once and continually published to.&quot;</em></p>
<p>That&#39;s the approach I was hoping for, so that can use node-red&#39;s much more powerful toolkit to create bespoke events and actions.<br />
	Nice work though Jason.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24247"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4234.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="XaroRSA&#039;s picture" title="XaroRSA&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/4234.html" title="View user profile.">XaroRSA</a> on Thu, 02/10/2014 - 20:17.</div>
    <div class="content">
     <p>Hi Paul, can you share how to use node-red? or how its used?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24254"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 02/10/2014 - 22:15.</div>
    <div class="content">
     <p>See&nbsp;<a href="http://nodered.org/">http://nodered.org/ </a>for a full description, but&nbsp;Node-RED is a graphical tool for wiring together hardware devices, APIs and online services<br />
	It compliments emoncms perfectly!</p>
<p>Paul&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24274"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3651.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3651.png" alt="nubble&#039;s picture" title="nubble&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/3651.html" title="View user profile.">nubble</a> on Sat, 04/10/2014 - 05:52.</div>
    <div class="content">
     <p>As promised, attached is the event module with mqtt&nbsp;support. It now includes authentication and&nbsp;qos on published messages.</p>
<p>Even though I updated the php schema files, you might need to update your event and event_settings tables with:</p>
<p><img alt="" src="../sites/default/files/tableUpdate.png" style="width: 600px; height: 218px;" /></p>
<p>then just unzip to the Module folder and enjoy... :)</p>
<p>I tried to serialise the mqtt objects and persist in that way but to no luck, so the current state is connect-publish-disconnect.&nbsp;</p>
<p>I&#39;m hoping some of the php&nbsp;and emoncms experts can take and develop this further....pls.</p>
<p>Here are screenshots of the current state of the event module:</p>
<p>
	<img alt="" src="../sites/default/files/event_0.png" style="width: 600px; height: 113px;" /></p>
<p><img alt="" src="../sites/default/files/eventSettings-2.png" style="width: 600px; height: 377px;" /></p>
<p>&nbsp;</p>
<p><img alt="" src="../sites/default/files/rsmb_0.png" style="width: 642px; height: 419px;" /></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24276"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3651.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3651.png" alt="nubble&#039;s picture" title="nubble&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/3651.html" title="View user profile.">nubble</a> on Fri, 03/10/2014 - 19:26.</div>
    <div class="content">
     <p>No no...wait.... The topic and payloads are empty from the event module!!</p>
<p>Im&nbsp;looking into it...</p>
<p>Ok, all fixed! Topics and payloads are now present. :)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24277"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Fri, 03/10/2014 - 18:24.</div>
    <div class="content">
     <p>Jason this all looks great, nice work!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24278"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3651.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3651.png" alt="nubble&#039;s picture" title="nubble&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/3651.html" title="View user profile.">nubble</a> on Fri, 03/10/2014 - 19:33.</div>
    <div class="content">
     <p>Thanks Trystan.</p>
<p>I am pretty happy with the event module in its current state as it suits my needs nicely and I can now get my emoncms feed data into openhab [and vice versa via mqttwarn].&nbsp;</p>
<p>I didnt get to persist the mqtt connection, and with my phph skills [or lack thereof considering I never wrote one line of php last week this time] this might take me some time. Im hoping to hand it off to some of the emoncms active developers.</p>
<p>Im keen to hear what your plans are around native support in emoncms for receiving mqtt data and publishing feed data via mqtt.</p>
<p>Jason</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24279"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Fri, 03/10/2014 - 20:16.</div>
    <div class="content">
     <p>Hello Jason, my plans for it are not far developed. I&#39;ve experimented with MQTT but dont know a lot about best practice. Id appreciate any suggestions on the API design, thanks Ben for the suggestions above. It was great to see <a href="https://twitter.com/j_taws/status/515081207730933760">Francesco&#39;s demo </a>of openhab at the Wikihouse last week, keen to see good emoncms, openhab integration. One thought I had while discussing the wikihouse openhab demo was that perhaps emonhub could connect to openhab directly via an mqtt dispatcher, thats probably a topic for another thread.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24281"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6498.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6498.jpg" alt="sumnerboy&#039;s picture" title="sumnerboy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/6498.html" title="View user profile.">sumnerboy</a> on Fri, 03/10/2014 - 20:59.</div>
    <div class="content">
     <p>Great stuff Jason! I will have a go at trying this out today.&nbsp;</p>
<p>Trystan - if this MQTT module was added into core EmonCMS then I think it is possible the existing OEM binding for openHAB would become redundant. I think this is a much better way of extracting data since it would give you access to the processed feed values, as well as inputs if required.</p>
<p>From what I understand the existing binding relies on a script running on your RPi EmonBase that intercepts the raw&nbsp;RF packets and forwards them to openHAB. This is no good for someone like me who is sending readings directly to EmonCMS&nbsp;using&nbsp;JSON&nbsp;HTTP requests via my custom Arduino&nbsp;+ Ethernet + EmonTx shield. I.e. no RPi base node.</p>
<p>I think MQTT&nbsp;from EmonCMS is a much simpler way to interface with&nbsp;openHAB&nbsp;with the added benefit of being able to send calculated/processed feed values, rather than just raw readings.&nbsp;</p>
<p>I am unsure about your comment &#39;connect to openhab directly via an mqtt dispatcher&#39;. MQTT is just a message protocol - in particular a pub/sub protocol. So once EmonCMS has the ability to publish values then any system can subscribe to those topics and consume the data. This would include openHAB, nodered as mentioned by Paul, and any other system with MQTT capabilities.</p>
<p>The beauty of MQTT&nbsp;is that any number of systems can consume the same feed, without the publisher having any idea of what is &#39;listening&#39;. Therefore I don&#39;t think a &#39;direct&#39; connection between EmonCMS and openHAB is what we are after.</p>
<p>Or have I misunderstood you!?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24283"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6498.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6498.jpg" alt="sumnerboy&#039;s picture" title="sumnerboy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/6498.html" title="View user profile.">sumnerboy</a> on Fri, 03/10/2014 - 23:04.</div>
    <div class="content">
     <p>Jason - any reason you are not using the existing &#39;message&#39; column in the event table for the MQTT payload?&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24284"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6498.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6498.jpg" alt="sumnerboy&#039;s picture" title="sumnerboy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/6498.html" title="View user profile.">sumnerboy</a> on Sat, 04/10/2014 - 00:53.</div>
    <div class="content">
     <p>Got it working, note the version Jason posted on here has a few buglettes so if anyone is looking to try this they might want to wait till it is updated. I have emailed Jason with the bugs I found and have it working locally so I am sure it won&#39;t be long till it is up and running. Awesome addition to EmonCMS!!</p>
<p>Here is a screenshot of the notifications I have just setup, so easy and now I get nice alerts (via openHAB) on my phone!</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24286"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3651.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3651.png" alt="nubble&#039;s picture" title="nubble&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/3651.html" title="View user profile.">nubble</a> on Sat, 04/10/2014 - 06:37.</div>
    <div class="content">
     <p>Ben - thanks for the bugfixes on the authentication. I updated the zip file above with your changes.</p>
<p>&lt;brag on&gt; I now have bidirection&nbsp;mqtt messaging between openhab and emoncms. Here is an example of my energy units left on my meter [knwh] where I update the units once I top up in openhab. It sends mqtt to mqttwarn&nbsp;which in turn sends it to emoncms via json. Emoncms does the engine work via input processing and ultimately creates a new feed which via the events module published it via mqtt back to openhab to show the units left.&lt;brag off&gt; :)</p>
<p><img alt="" src="../sites/default/files/ohUnits.png" style="width: 430px; height: 344px;" /></p>
<p>&nbsp;</p>
<p>And with the emoncms feed data able to get out via mqtt, it is possible (if using rsmb broker that supports mqtt-sn) to update emonglcd or similar with emoncms feed data.&nbsp;</p>
<p>&nbsp;</p>
<p>Ben - in hindsight, I should have used the message column as the mqttpayload. this makes sense. I also should have named the variables differently by dropping the set: setmqtttopic, setmqttpayload, setmqttqos.&nbsp;</p>
<p>Trystan - As Ben mentioned, the real beauty about mqtt is the &quot;dynamic routing&quot; between publishers and subscribers and the one to many options that can be done dynamically. So if emoncms publishes to the broker, it shouldnt or isnt bothered with who or how many subscribers consume the data. I also think that a OEM mqtt&nbsp;input interface to emoncms would provide the added flexibility one can get from mqtt. For example, the emontx units [I have the hardware units with a custom firmware combining emonlib,&nbsp;mqtt-sn&nbsp;lib[which I enhanced to get running on arduino] and mote lib[application layer and io&nbsp;definition for mqtt] could publish over RFM12B mqtt-sn messages which could end up in emoncms. The only drawback is each message contains a single variable, whereas currently emontx&nbsp;packs them via structs. This is my setup currently - and debugging is a pleasure as the debugging mqtt client just subscribes to whichever publisher it needs data from.</p>
<p>&nbsp;In terms of defining an API I think it would be best to keep it as configurable as possible - like the emoncms event module above, and leave it for the user to define and afford them added flexibility. Some things if exposed via mqtt might need a syntax definition [for example if the emoncms bus exposes data]. But this is already been done by the brokers like mosquitto and RSMB. OpenHAB [imo] has the most detailed implementation of an MQTT client and its really well documented. they dont define the message structure but leave it to user config, except for the openhab eventbus.</p>
<p><a href="https://github.com/openhab/openhab/wiki/MQTT-Binding">&nbsp;https://github.com/openhab/openhab/wiki/MQTT-Binding</a></p>
<p>Once could define the message syntax to be used in&nbsp;emoncms for mqtt messages, and then develop an openhab&nbsp;emoncms-mqtt binding, which will make the emoncms-openhab setup easier, but this will make it harder for other subscribers to interface to the mqtt feeds from either emoncms or openhab.</p>
<p>Guess its all about finding that sweetspot....</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24287"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3651.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3651.png" alt="nubble&#039;s picture" title="nubble&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/3651.html" title="View user profile.">nubble</a> on Sat, 04/10/2014 - 06:40.</div>
    <div class="content">
     <p>Updated the above zip with the bugfixes</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24303"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6498.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6498.jpg" alt="sumnerboy&#039;s picture" title="sumnerboy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/6498.html" title="View user profile.">sumnerboy</a> on Sun, 05/10/2014 - 09:21.</div>
    <div class="content">
     <p>Hey,</p>
<p>After chatting with Jason I have taken his changes to add MQTT support to the event module and created a pull request so you can check the changes Trystan and merge if you are happy;</p>
<p><a href="https://github.com/emoncms/event/pull/36" title="https://github.com/emoncms/event/pull/36">https://github.com/emoncms/event/pull/36</a></p>
<p>I am running this code locally and it is working fine with authentication.&nbsp;</p>
<p>Anyone else keen to test this take the code from the event-mqtt branch on my github&nbsp;fork;</p>
<p><a href="https://github.com/sumnerboy12/event/tree/event-mqtt" title="https://github.com/sumnerboy12/event/tree/event-mqtt">https://github.com/sumnerboy12/event/tree/event-mqtt</a></p>
<p>Cheers,</p>
<p>Ben</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24304"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6498.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6498.jpg" alt="sumnerboy&#039;s picture" title="sumnerboy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/6498.html" title="View user profile.">sumnerboy</a> on Sun, 05/10/2014 - 09:32.</div>
    <div class="content">
     <p>BTW - dropped the mqttpayload column in event and now use the standard message column. Also renamed the various setmqttxxx columns to just mqttxxx. All included in the pull request.</p>
<p>Great work Jason!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24311"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6498.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6498.jpg" alt="sumnerboy&#039;s picture" title="sumnerboy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/6498.html" title="View user profile.">sumnerboy</a> on Sun, 05/10/2014 - 19:01.</div>
    <div class="content">
     <p>Trystan has merged the pull request so this is now in the main event module for all to play with - thanks again to Jason for doing all the hard work.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24319"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6498.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6498.jpg" alt="sumnerboy&#039;s picture" title="sumnerboy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/6498.html" title="View user profile.">sumnerboy</a> on Mon, 06/10/2014 - 09:03.</div>
    <div class="content">
     <p>Apologies guys, there was a bug in my code. Jason/Nubbles has kindly provided a fix which I have just added to my fork and created a pull request. Hopefully Trystan will merge this soonish as without it you will not be able to add any MQTT events. My bad!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25237"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2125.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-2125.jpg" alt="elyobelyob&#039;s picture" title="elyobelyob&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Feature Request: Emoncms Event Module - support for MQTT</h3>

    <div class="submitted">Submitted by <a href="../user/2125.html" title="View user profile.">elyobelyob</a> on Thu, 20/11/2014 - 11:11.</div>
    <div class="content">
     <p>Hi all, been a while since I&#39;ve been about. Great to see the event module flourishing.</p>
<p>In terms of MQTT, this should be the backbone of OEM. At the moment, I am resetting up my system, following a complete failure of my home server. I&#39;m trying to get up and running on a Raspberry Pi, but with no local data storage. I&#39;m not looking to write anything to this SD card once I&#39;ve completed putting it together.</p>
<p>In terms of storage, I was wondering about using Xively, or something similar. I want to remove the huge amount of storage and overhead that my local OEM was doing before. Am pretty sure I had GB&#39;s of MySQL data previously, which I can&#39;t do with a RPi.&nbsp;</p>
<p>I&#39;ve seen a mqttdev&nbsp;OEM build on Github, where&#39;s that at? Is there anything we can do to help get this solution in place?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/5826"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-__mWTByVHgFxed1TbSiqAikAO1Y70Vl1fmcSUQ6SsqI" value="form-__mWTByVHgFxed1TbSiqAikAO1Y70Vl1fmcSUQ6SsqI"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
