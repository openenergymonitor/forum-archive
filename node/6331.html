<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/6331 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:05:09 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Emoncms local Vs Emoncms.org on the Raspi | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Emoncms local Vs Emoncms.org on the Raspi</h3>
        <span class="submitted">Submitted by <a href="../user/7359.html" title="View user profile.">rmtucker</a> on Sat, 20/12/2014 - 13:12</span>
        <div class="content"><p>Will the raspi image version of emoncms ever catch up to emoncms.org?</p>
<p>I am running the raspi and the local version of emoncms,but also feeding data to emoncms.org.</p>
<p>And the visualisations and feed engines are not as comprehensive on the raspi?</p>
<p>It has taken me a little while but now i have the pi reading a currentcost monitor and feeding the data to local and internet using a perl script,with emonhub turned off.</p>
<p>Maybe time to take an image of the raspi sd card just in case !!!!!!!</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="6347.html" class="topic-previous" title="Go to previous forum topic">‹ New system advice</a>
              <a href="6335.html" class="topic-next" title="Go to next forum topic">MultiGraph is not showing correct data  ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-26012"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms local Vs Emoncms.org on the Raspi</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sat, 20/12/2014 - 14:10.</div>
    <div class="content">
     <p>The &quot;image version&quot; has certain features removed to give it the ability to run &quot;low-write&quot; enough to not damage the SD card.&nbsp;</p>
<p>The emoncms.org is more often than not a couple of releases behind the current release available on git as updates etc get added to git during development and then every so often marked as a new release.</p>
<p>eg we are currently on v8.3.5 on emoncms.org but v8.4.0 on git, so you could update your local emoncms and be ahead of the remote, but you will still be missing some features etc.</p>
<p>To get full functionality locally you could install emoncms to a hdd.</p>
<p>The&nbsp;repo&#39;s&nbsp;<a href="https://github.com/emoncms/emoncms">master branch</a> is the &quot;full fat&quot;&nbsp;emoncms&nbsp;whilst the &quot;low fat&quot;&nbsp;emoncms&nbsp;included in the image is the <a href="https://github.com/emoncms/emoncms/tree/bufferedwrite">bufferedwrite branch</a></p>
<p>it would be interesting to see your perl script, if there was a demand for it we may be able to incorporate&nbsp;something into emonhub down the line.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26016"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7359.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rmtucker&#039;s picture" title="rmtucker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms local Vs Emoncms.org on the Raspi</h3>

    <div class="submitted">Submitted by <a href="../user/7359.html" title="View user profile.">rmtucker</a> on Sun, 21/12/2014 - 13:52.</div>
    <div class="content">
     <p>Paul</p>
<p>The script was originally on the currentcost forum,So i just fettled it to suit my needs.</p>
<p>I also had to install LWP and apt-get install libdevice-serialport-perl to get the serial to usb adaptor working.</p>
<p>The script is only working on one sensor at the moment but is easily modified for more (I just don&#39;t have any????).</p>
<p>Mark</p>
<p>
&nbsp;&nbsp;&nbsp; my $key&nbsp; = &quot;********************************&quot;;<br />
&nbsp;&nbsp;&nbsp; my $key2&nbsp; = &quot;********************************&quot;;<br />
&nbsp;&nbsp;&nbsp; my $PORT = &quot;/dev/ttyUSB0&quot;;<br />
&nbsp;&nbsp;&nbsp; my $Watts = 0;<br />
&nbsp;&nbsp;&nbsp; my $temp = 0;<br />
&nbsp;&nbsp;&nbsp; my $meas = 0;<br />
&nbsp;&nbsp;&nbsp; my $node = 0;<br />
&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp;&nbsp; my $ob = Device::SerialPort-&gt;new($PORT)&nbsp; || die &quot;Can&#39;t open $PORT: $!\n&quot;;<br />
&nbsp;&nbsp;&nbsp; $ob-&gt;baudrate(57600);<br />
&nbsp;&nbsp;&nbsp; $ob-&gt;write_settings;</p>
<p>&nbsp;&nbsp;&nbsp; open(SERIAL, &quot;+&gt;$PORT&quot;);<br />
&nbsp;&nbsp;&nbsp; while (my $line = &lt;SERIAL&gt;) {<br />
&nbsp;&nbsp; # print $line;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($line =~ m!&lt;tmpr&gt;*([\-\d.]+)&lt;/tmpr&gt;&lt;sensor&gt;0&lt;/sensor&gt;.*&lt;ch1&gt;&lt;watts&gt;0*(\d+)&lt;/watts&gt;&lt;/ch1&gt;!) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; my $Watts = $2;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; my $temp = $1;<br />
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print &quot;SUCCESS (Sensor0) $meas,:$Watts, $temp\n&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$meas++;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($meas == 2) { #time to send<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; my $emon_ua = LWP::UserAgent-&gt;new;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; my $emon_url = &quot;http://192.168.2.7/emoncms/input/post.json?apikey=$key\&amp;node=$node\&amp;json={Total_Watts:$Watts,temp:$temp}&quot;;<br />
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print &quot;$emon_url\n&quot;;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; my $emon_response = $emon_ua-&gt;get($emon_url);<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; my $emon_url2 = &quot;http://emoncms.org/input/post.json?apikey=$key2\&amp;node=$node\&amp;json={Total_Watts:$Watts,temp:$temp}&quot;;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; my $emon_response2 = $emon_ua-&gt;get($emon_url2);<br />
#&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; print &quot;emon_url2\n&quot;;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $meas = 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br />
}<br />
}</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26082"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7359.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rmtucker&#039;s picture" title="rmtucker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms local Vs Emoncms.org on the Raspi</h3>

    <div class="submitted">Submitted by <a href="../user/7359.html" title="View user profile.">rmtucker</a> on Tue, 23/12/2014 - 12:54.</div>
    <div class="content">
     <p>Did emoncms go down last night?</p>
<p>The local server on raspi continued fetching data.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/6331"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-HcnRoVhWlCmxxn8trLR8clBe4C-iofPfODER3bYcms4" value="form-HcnRoVhWlCmxxn8trLR8clBe4C-iofPfODER3bYcms4"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/6331 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:05:09 GMT -->
</html>
