<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Pull data from my.currentcost.com or xivley.com into EmonCMS | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/emon/sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="/emon/modules/node/node.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/defaults.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/system.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/system-menus.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/user/user.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/modules/mollom/mollom.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/forum/forum.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/modules/views/css/views.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/comment/comment.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/themes/emon3/style.css?r" />
<style type="text/css" media="all">@import "/emon/sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="/emon/" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="/emon/">Home</a> » <a href="/emon/forum">Forums</a> » <a href="/emon/forum/5">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Pull data from my.currentcost.com or xivley.com into EmonCMS</h3>
        <span class="submitted">Submitted by <a href="/emon/user/8001" title="View user profile.">bert386</a> on Thu, 16/04/2015 - 05:10</span>
        <div class="content"><p>Hello All,</p>
<p>Still fairly new to EmonCMS but keen to know if its possible to get energy usage data from the Current Cost Envir into EmonCMS&nbsp;via the cloud? I know someone did it by hacking the hardware/firmware of a CCEnvir but i was hoping it might be easy enough to knock up a script or plugin to suck the data from xivley or even better currentcost.com into a more customisable&nbsp;EmonCMS dashboard.</p>
<p>Be glad of any assistance&nbsp;:)</p>
<p>&nbsp;</p>
<p>Thanks in advance!</p>
  <div class="forum-topic-navigation clear-block">
          <a href="/emon/node/6016" class="topic-previous" title="Go to previous forum topic">‹ Increase log interval to more than 1hour</a>
              <a href="/emon/node/10503" class="topic-next" title="Go to next forum topic">What is the aim of $max_node_id_limit ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-29639"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Pull data from my.currentcost.com or xivley.com into EmonCMS</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3" title="View user profile.">TrystanLea</a> on Thu, 16/04/2015 - 05:59.</div>
    <div class="content">
     <p>Hello Bert, Im not very familiar with currentcost, but I know xively has a good API, Can you access your data on xively? How much data do you need to transfer? Emoncms&#39;s import functionality is a little limited at the moment, its something that I need to look at</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29641"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/8001" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="bert386&#039;s picture" title="bert386&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Pull data from my.currentcost.com or xivley.com into EmonCMS</h3>

    <div class="submitted">Submitted by <a href="/emon/user/8001" title="View user profile.">bert386</a> on Thu, 16/04/2015 - 06:07.</div>
    <div class="content">
     <p>Thanks Tristan,</p>
<p>Yes Xivleys API allows yuo to read data and write data. See here:</p>
<p><a href="https://personal.xively.com/dev/docs/api/quick_reference/api_resources/" title="https://personal.xively.com/dev/docs/api/quick_reference/api_resources/">https://personal.xively.com/dev/docs/api/quick_reference/api_resources/</a></p>
<p>I think it would be really nice for Emon CMS to be able to pull data from data repositories such as Xivley as it would allow users to manipulate and display data exactly as they wish without limitation.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29846"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/8001" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="bert386&#039;s picture" title="bert386&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Pull data from my.currentcost.com or xivley.com into EmonCMS</h3>

    <div class="submitted">Submitted by <a href="/emon/user/8001" title="View user profile.">bert386</a> on Wed, 22/04/2015 - 01:41.</div>
    <div class="content">
     <p>Nobody else got any clues on this? I thought that one of two ways would be ideal:</p>
<p>Option 1 - a standalone, scheduled perl script that ran on the emoncms server that used a READ json&nbsp;and pulled relevant data from personal.xively.com and then used a WRITE to post the data on emoncms</p>
<p>Option 2 - a plugin for emon cms that allowed you to input your Xivley API key and feed id and assign that to a feed in emoncms</p>
<p>Can anyone point me in the direction of an accomplished emoncms coder that might be interested in deving this for a fee?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29906"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3818" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-3818.png" alt="fversteegen&#039;s picture" title="fversteegen&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Pull data from my.currentcost.com or xivley.com into EmonCMS</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3818" title="View user profile.">fversteegen</a> on Thu, 23/04/2015 - 12:49.</div>
    <div class="content">
     <p>I don&#39;t know how to accomplish this Bert, but I suspect you use a CurrentCost Envir. If you want to have a script to feed data from the Envir to Emoncms, then have a look here: <a href="http://openenergymonitor.org/emon/node/1418" title="http://openenergymonitor.org/emon/node/1418">http://openenergymonitor.org/emon/node/1418</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29957"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/8066" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="firefox7518&#039;s picture" title="firefox7518&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Pull data from my.currentcost.com or xivley.com into EmonCMS</h3>

    <div class="submitted">Submitted by <a href="/emon/user/8066" title="View user profile.">firefox7518</a> on Tue, 28/04/2015 - 00:07.</div>
    <div class="content">
     <p>Hi</p>
<p>I gave up using clouds and other stuff and did it with a tiny bananpi connected via the usb/serial cable to the current cost.</p>
<p>I found a running PERL script here&nbsp;but it has some flaws so I enhanced it and I&#39;m using it for several IAMs at the moment.</p>
<p>I also use this script to send the data to pvoutput.org so that I have the data also there where my PV setup will send the data to. I always have the data on my emoncms installation and pvoutput.org :-)</p>
<p>Here is the script I&#39;ve enhanced:</p>
<blockquote><p>#!/usr/bin/perl -w<br />
# Reads data from a Current Cost device via serial port on a Raspi or bananapi or other linux machine</p>
<p>use strict;<br />
use warnings;<br />
use Device::SerialPort qw( :PARAM :STAT 0.07 );<br />
use LWP::UserAgent;<br />
use Time::Piece;<br />
use Time::Local;</p>
<p>my $emon_ua = LWP::UserAgent-&gt;new;</p>
<p>my $emoncmskey &nbsp;= &quot;place your emoncmskey here&quot;;<br />
my $pvoutpukey = &quot;place your pvoutputkey here&quot;;<br />
my $pvoutputsid = &quot;place your pvoutput sid here&quot;;<br />
my $host = &quot;place the emoncms host adress here&quot;;<br />
my $node = &quot;1&quot;;<br />
my $PORT = &quot;/dev/ttyUSB0&quot;;<br />
my $meas = 0;<br />
my $sumwatts_sensor0 = 0;<br />
my $sumwatts_sensor1 = 0;<br />
my $sumwatts_sensor2 = 0;<br />
my $sumwatts_sensor3 = 0;<br />
my $sumwatts_sensor4 = 0;<br />
my $sumwatts_sensor5 = 0;<br />
my $sumTemp = 0;<br />
my $sensor_count0 = 0;<br />
my $sensor_count1 = 0;<br />
my $sensor_count2 = 0;<br />
my $sensor_count3 = 0;<br />
my $sensor_count4 = 0;<br />
my $sensor_count5 = 0;<br />
my $count_limit = 6;<br />
# my $date = strftime &quot;%Y%m%d&quot;, localtime;<br />
# print $date;</p>
<p>
my $ob = Device::SerialPort-&gt;new($PORT) &nbsp;|| die &quot;Can&#39;t open $PORT: $!\n&quot;;<br />
$ob-&gt;baudrate(57600);<br />
$ob-&gt;write_settings;</p>
<p>open(SERIAL, &quot;+&gt;$PORT&quot;);<br />
while (my $line = &lt;SERIAL&gt;) {<br />
&nbsp;&nbsp; &nbsp;#print $line;<br />
&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp; &nbsp;if ( $line =~ m!&lt;tmpr&gt;*([\-\d.]+)&lt;/tmpr&gt;&lt;sensor&gt;0&lt;/sensor&gt;.*&lt;ch1&gt;&lt;watts&gt;0*(\d+)&lt;/watts&gt;&lt;/ch1&gt;! ) {<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $watts = $2;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $temp = $1;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;SUCCESS (Sensor0) $meas: ... $watts, $temp\n&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$meas++;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sensor_count0++;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sumwatts_sensor0 += $watts;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sumTemp += $temp;<br />
&nbsp;&nbsp; &nbsp;}<br />
&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp; &nbsp;# extra if statements to get watts for IAMs, change the sensorname to reflect this<br />
&nbsp;&nbsp; &nbsp;if ( $line =~ m!&lt;tmpr&gt;*([\-\d.]+)&lt;/tmpr&gt;&lt;sensor&gt;1&lt;/sensor&gt;.*&lt;ch1&gt;&lt;watts&gt;0*(\d+)&lt;/watts&gt;&lt;/ch1&gt;! ) {<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $watts_sensor1 = $2;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;SUCCESS IAM (Sensor1) $meas: ... $watts_sensor1\n&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#$meas++;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sensor_count1++;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sumwatts_sensor1 += $watts_sensor1;<br />
&nbsp;&nbsp; &nbsp;}<br />
&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp; &nbsp;if ( $line =~ m!&lt;tmpr&gt;*([\-\d.]+)&lt;/tmpr&gt;&lt;sensor&gt;2&lt;/sensor&gt;.*&lt;ch1&gt;&lt;watts&gt;0*(\d+)&lt;/watts&gt;&lt;/ch1&gt;! ) {<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $watts_sensor2 = $2;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;SUCCESS IAM (Sensor2) $meas: ... $watts_sensor2\n&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sensor_count2++;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sumwatts_sensor2 += $watts_sensor2;<br />
&nbsp;&nbsp; &nbsp;}<br />
#&nbsp;&nbsp; &nbsp;if ( $line =~ m!&lt;tmpr&gt;*([\-\d.]+)&lt;/tmpr&gt;&lt;sensor&gt;3&lt;/sensor&gt;.*&lt;ch1&gt;&lt;watts&gt;0*(\d+)&lt;/watts&gt;&lt;/ch1&gt;! ) {<br />
#&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $watts_sensor3 = $2;<br />
#&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;SUCCESS IAM (Sensor3) $meas: ... $watts_sensor3\n&quot;;<br />
#&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sensor_count3++;<br />
#&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sumwatts_sensor3 += $watts_sensor3;<br />
#&nbsp;&nbsp; &nbsp;}<br />
&nbsp;&nbsp; &nbsp;if ( $line =~ m!&lt;tmpr&gt;*([\-\d.]+)&lt;/tmpr&gt;&lt;sensor&gt;4&lt;/sensor&gt;.*&lt;ch1&gt;&lt;watts&gt;0*(\d+)&lt;/watts&gt;&lt;/ch1&gt;! ) {<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $watts_sensor4 = $2;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;SUCCESS IAM (Sensor4) $meas: ... $watts_sensor4\n&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sensor_count4++;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sumwatts_sensor4 += $watts_sensor4;<br />
&nbsp;&nbsp; &nbsp;}<br />
&nbsp;&nbsp; &nbsp;if ( $line =~ m!&lt;tmpr&gt;*([\-\d.]+)&lt;/tmpr&gt;&lt;sensor&gt;5&lt;/sensor&gt;.*&lt;ch1&gt;&lt;watts&gt;0*(\d+)&lt;/watts&gt;&lt;/ch1&gt;! ) {<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $watts_sensor5 = $2;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;SUCCESS IAM (Sensor5) $meas: ... $watts_sensor5\n&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sensor_count5++;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sumwatts_sensor5 += $watts_sensor5;<br />
&nbsp;&nbsp; &nbsp;}<br />
&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp; &nbsp;if ( ($meas &gt;= $count_limit) &amp;&amp; ($sensor_count0 &gt; 0) &amp;&amp; ($sensor_count1 &gt; 0) &amp;&amp; ($sensor_count2 &gt; 0) &amp;&amp; ($sensor_count4 &gt; 0) ) {<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $avg_temp = $sumTemp/$sensor_count0;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;AVERAGE temp: $avg_temp\n&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $avg_watts_sensor0 = $sumwatts_sensor0/$sensor_count0;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $avg_watts_sensor1 = $sumwatts_sensor1/$sensor_count1;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $avg_watts_sensor2 = $sumwatts_sensor2/$sensor_count2;<br />
#&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $avg_watts_sensor3 = $sumwatts_sensor3/$sensor_count3;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $avg_watts_sensor4 = $sumwatts_sensor4/$sensor_count4;<br />
#&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $avg_watts_sensor5 = $sumwatts_sensor5/$sensor_count5;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;AVERAGE watt: $avg_watts_sensor0\n&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;AVERAGE watt: $avg_watts_sensor1\n&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;AVERAGE watt: $avg_watts_sensor2\n&quot;;<br />
#&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;AVERAGE watt: $avg_watts_sensor3\n&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;AVERAGE watt: $avg_watts_sensor4\n&quot;;<br />
#&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;AVERAGE watt: $avg_watts_sensor5\n&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;# Additional line for each sensor, note that meas increases 2 times in the cases of 1 additional IAM, so watt readings need to be divided by meascount/sensoramount<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $emon_url = &quot;http://$host/input/post.json?apikey=$emoncmskey\&amp;node=$node\&amp;json={house_power:$avg_watts_sensor0,room_temp:$avg_temp,heatpump_power:$avg_watts_sensor1,buero_power:$avg_watts_sensor2,foodcenter_power:$avg_watts_sensor4}&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;$emon_url\n&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $emon_response = $emon_ua-&gt;get($emon_url);<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $date = localtime-&gt;strftime(&#39;%Y%m%d&#39;);<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;Heute ist $date\n&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $time = localtime-&gt;strftime(&#39;%H:%M&#39;);<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;Jetzt ist $time\n&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;# Line below is because I upload readings to 2 sites in parallel as backup<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $pvoutput_url = &quot;http://pvoutput.org/service/r2/addstatus.jsp?key=$pvoutpukey&amp;sid=$pvoutputsid&amp;d=$date&amp;t=$time&amp;v4=$avg_watts_sensor0&amp;v5=$avg_temp&quot;;<br />
# {power:$avg_watts_sensor0,temp:$avg_temp,sensor1:$avg_watts_sensor1}&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;my $pvoutput_response = $emon_ua-&gt;get($pvoutput_url);<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;print &quot;$pvoutput_url\n&quot;;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;# Do not forget to reset the sum for an additional sensor &nbsp;&nbsp;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$meas = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sumwatts_sensor0 = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sumwatts_sensor1 = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sumwatts_sensor2 = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sumwatts_sensor3 = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sumwatts_sensor4 = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sumwatts_sensor5 = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sumTemp = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sensor_count0 = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sensor_count1 = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sensor_count2 = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sensor_count3 = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sensor_count4 = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;$sensor_count5 = 0;<br />
print &quot;Wait 60s to repeat\n&quot;;<br />
sleep(60);<br />
&nbsp;&nbsp; &nbsp;}</p>
<p>}</p>
</blockquote>
<p>To use it for all sensors you have to add the sensorcount to the following line:</p>
<p>&nbsp;&nbsp;if ( ($meas &gt;= $count_limit) &amp;&amp; ($sensor_count0&nbsp;&gt; 0) &amp;&amp; ($sensor_count1&nbsp;&gt; 0) &amp;&amp; ($sensor_count2&nbsp;&gt; 0) &amp;&amp; ($sensor_count4&nbsp;&gt; 0) ) {</p>
<p>You also have to add the missing sensors to the existing parameters in the link:</p>
<p>&nbsp;my $emon_url = &quot;http://$host/input/post.json?apikey=$emoncmskey\&amp;node=$node\&amp;json={house_power:$avg_watts_sensor0,room_temp:$avg_temp,heatpump_power:$avg_watts_sensor1,buero_power:$avg_watts_sensor2,foodcenter_power:$avg_watts_sensor4}&quot;;</p>
<p>I think you will get it :-)</p>
<p>&nbsp;</p>
<p>It&#39;s working here:&nbsp;http://swiss-solar-log.ch:85/firefox/Hausverbra</p>
<p><i>[Duplicate post deleted. Please read <a href="http://openenergymonitor.org/emon/node/10391">this</a>. Moderator - RW]</i></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29963"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/8001" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="bert386&#039;s picture" title="bert386&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Pull data from my.currentcost.com or xivley.com into EmonCMS</h3>

    <div class="submitted">Submitted by <a href="/emon/user/8001" title="View user profile.">bert386</a> on Mon, 27/04/2015 - 23:53.</div>
    <div class="content">
     <p>@firefox7158&nbsp;</p>
<p>Thanks! that is a solid looking script. Appreciate you sharing it here. I will keep this bookmarked in my list of tools to try if my cloud solution fails to get off the ground!</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="/emon/node/10470"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-Lfeu0Jqxd8DxnLMjURG1G-m8hMVma9ncBAppXQrErwA" value="form-Lfeu0Jqxd8DxnLMjURG1G-m8hMVma9ncBAppXQrErwA"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org">https://community.openenergymonitor.org</a></p>
   
</div>

<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
