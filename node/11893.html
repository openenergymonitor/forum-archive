<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11893 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:56:09 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>git pull overwrites config changes? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">git pull overwrites config changes?</h3>
        <span class="submitted">Submitted by <a href="../user/8942.html" title="View user profile.">jasonnet</a> on Tue, 29/12/2015 - 01:03</span>
        <div class="content"><p>Hi All,</p>
<p>&nbsp;&nbsp;&nbsp; I&#39;m a newbie but making progress here. I have an emonBase purchased in October and numerous emonTx&#39;s and emonTH&#39;s.&nbsp; A week ago some additional emonTH&#39;s and emonTx&#39;s came in.</p>
<p>I recently followed the directions here (<a href="https://guide.openenergymonitor.org/#update">http://openenergymonitor.org/emon/modules/emonpi#update</a>)&nbsp; in order to use the web UI to update firmware in order to support recently purchased extra emonTx&#39;s and emonTH&#39;s.&nbsp; (It&#39;s now not clear to me that that was actually needed, but that&#39;s a tangent for another day.) &nbsp; That ran in to trouble with avrdude according to the logs.&nbsp; Eventually I tracked that down.&nbsp; It is apparently expected that in many cases one edit /home/pi/emonpi/emonpiupdate to comment out a few lines and uncomment other lines.&nbsp;&nbsp; I&#39;ve done that and the update did seem to take.&nbsp; Thanks to all the answers in the forums that helped me figure that out.</p>
<p>Question:</p>
<p>I see that the update scripts run</p>
<pre>
git pull</pre><p>commands.&nbsp;&nbsp; That doesn&#39;t seem compatible with expecting simple&nbsp;config changes like I just made.&nbsp; It seems like it would risk git pull overwriting&nbsp;config changes or having config changes block important git pull updates depending on how one handles this.&nbsp;&nbsp; This would seem to be particularly troublesome when one is requesting the update from the web UI where many of the details of the git pull commands will not be apparent.</p>
<p>What is our recommended way to minimize the config overwrite vs blocked update concern?</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11889.html" class="topic-previous" title="Go to previous forum topic">‹ Clock off by -1305995336 sec :-/</a>
              <a href="4235.html" class="topic-next" title="Go to next forum topic">New emontx v3 - suddenly stopped reporting Vrms ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-37654"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8942.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="jasonnet&#039;s picture" title="jasonnet&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: git pull overwrites config changes?</h3>

    <div class="submitted">Submitted by <a href="../user/8942.html" title="View user profile.">jasonnet</a> on Tue, 29/12/2015 - 23:10.</div>
    <div class="content">
     <p>I think I&#39;ve read that there&#39;s a tentative plan to update this particular part of the code to parse out the emonhub.conf file and then appropriately take the right action.&nbsp;&nbsp; I assume the challenge here is that this code is bash and it&#39;s not particularly easy to parse an emonhub.conf formatted file from bash.</p>
<p>If this is the challenge, I&#39;ll offer to write a script to copy the emonhub.conf script in to a form that is is more easily parsed by bash.&nbsp;&nbsp; Perhaps something like the Java .properties file format?&nbsp; If I were to do this, what language would we want this code to be written in?&nbsp; PHP ?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37656"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: git pull overwrites config changes?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 30/12/2015 - 00:10.</div>
    <div class="content">
     <p>I&#39;m not entirely clear what it is exactly you are proposing, nor am I sure how T&amp;G would prefer&nbsp;to tackle the conf&nbsp;files.</p>
<p>Ideally the git update routine should not overwrite a couple of specific files eg emonhub.conf and settings.php, IMO it&#39;s a dangerous game to start parsing emonhub.conf, that may seem the best way to edit/add entries but it assumes alot. users may already be using settings that clash with the new stuff. If there are any duplicated node ids for example the conf simply will not load, if someone has edited their sketches payloads and an update alters the payload it could corrupt their&nbsp;data.</p>
<p>It is a much better approach to explain the changes and how to add them manually for a controlled manouver&nbsp;or there will need to be alternative documentation on how to determine the issue, fix and correct data for a multitude of possible issues.</p>
<p>The firmware update script should be made to A) know what hardware is connected and B) check what&nbsp;firmware for that device is being used, (this should remove any need for hard-coded&nbsp;options). Both of these can be determined from the emonhub.conf if that data is reliable and not over-written. The update&nbsp;script could&nbsp;also remind&nbsp;the user&nbsp;manual changes are required OR if done in the right manner, the updater should be able to update the emonhub.conf directly if it were a python script rather than bash, this would also make it cross-platform and usable on all nodes with the use of a programmer lead.</p>
<p>The emonhub.conf format is defined by the python &quot;configobj&quot; module, using bash is a quick and dirty fix with limited scope. I have some&nbsp;concerns for 3rd&nbsp;parties editing the emonhub.conf directly as is can cause emonhub&nbsp;to fail. but I am interested in what you had in mind.</p>
<p>Paul</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11893"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-4DN8sCpfiNVF3OO1mq_73byGvPRtitvw9rxzljfXBsE" value="form-4DN8sCpfiNVF3OO1mq_73byGvPRtitvw9rxzljfXBsE"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
