<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/1029 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:35:12 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>RESOLVED - emonGLCD Latest code | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">RESOLVED - emonGLCD Latest code</h3>
        <span class="submitted">Submitted by <a href="../user/905.html" title="View user profile.">robw</a> on Sun, 09/09/2012 - 07:21</span>
        <div class="content"><p>Im using the latest code for the GLCD but seem to be getting weird values</p>
<p>using type 2 solar but the hose values seem to be off.. Like im useing minus power and exporting more than generation.</p>
<p>&nbsp;</p>
<p>&nbsp;<a href="../sites/default/files/IMG_0840.JPG%20(2).jpg" target="_blank"><img src="../sites/default/files/IMG_0840.JPG%20(2).jpg" width="400" height="300" alt="" /></a></p>
<p><a href="../sites/default/files/IMG_0836.JPG%20(2).jpg" target="_blank"><img src="../sites/default/files/IMG_0836.JPG%20(2).jpg" width="400" height="300" alt="" /></a></p>
<p>&nbsp;I think this is the problem but could someone make sure..</p>
<p><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">Line 190&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">cval_use</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">=</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">cval_use</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">+</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">((</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">emontx</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">.</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">power1</span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">-</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">emontx</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">.</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">power2</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">)</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">-</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">cval_use</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">)</span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">*</span><span class="mf" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">0.50</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">;</span></p>
<p>should read</p>
<p><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">Line 190&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">cval_use</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">=</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">cval_use</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">+</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">((</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">emontx</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">.</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">power1</span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">+</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">emontx</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">.</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">power2</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">)</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">-</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">cval_use</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">)</span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">*</span><span class="mf" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">0.50</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">;</span></p>
<p>&nbsp;</p>
<p>Then it looks correct..</p>
<p>Now the LEDs on the top work for green but not for red. So any ides on that one as well...</p>
<p>&nbsp;</p>
<p>PS&nbsp;</p>
<p>If&nbsp;</p>
<p><span class="kt" style="margin: 0px; padding: 0px; border: 0px; color: rgb(68, 85, 136); font-weight: bold; font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">Line 228 int</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">PWRleds</span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">=</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">map</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">(</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">cval_gen</span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">-</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">cval_use</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">,</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="mi" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">0</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">,</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="mi" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">4000</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">,</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="mi" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">0</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">,</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="mi" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">255</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">);</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">     </span><span class="c1" style="margin: 0px; padding: 0px; border: 0px; color: rgb(153, 153, 136); font-style: italic; font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">// Map importing value from 0-4Kw (LED brightness - cval3 is the smoothed grid value - see display above </span></p>
<p>was&nbsp;</p>
<p><span class="kt" style="margin: 0px; padding: 0px; border: 0px; color: rgb(68, 85, 136); font-weight: bold; font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">Line 228 int</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">PWRleds</span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">=</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">map</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">(</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">cval_gen</span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">-</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">cval_use</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">,</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="mi" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">0</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">,</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> maxgen</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">,</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="mi" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">0</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">,</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="mi" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">255</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">);</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">     </span><span class="c1" style="margin: 0px; padding: 0px; border: 0px; color: rgb(153, 153, 136); font-style: italic; font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">// Map importing value from 0-4Kw (LED brightness - cval3 is the smoothed grid value - see display above </span></p>
<p>would that not allow anyone with a pv size less other 4kW &nbsp;to see the full brightness of the LEDs and even work for people with bigger than 4kW (lucky people)</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="916.html" class="topic-previous" title="Go to previous forum topic">‹ RESOLVED - Emon Base - problems uploading to the server</a>
              <a href="1025.html" class="topic-next" title="Go to next forum topic">Battery life / stacking TX&#039;s ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-6109"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/905.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="robw&#039;s picture" title="robw&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/905.html" title="View user profile.">robw</a> on Sun, 09/09/2012 - 08:43.</div>
    <div class="content">
     <p>Right after the above change it does seem to work as expected.&nbsp;<br />
Well the live values anyway.. the &quot;use today&quot; shows &quot;-0.0kW&quot; &nbsp;and the total for the PV is showing 0 but a +0&nbsp;so something is not right..</p>
<p>&nbsp;</p>
<p>also if&nbsp;</p>
<p><span class="k" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">Line 76  const</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="kt" style="margin: 0px; padding: 0px; border: 0px; color: rgb(68, 85, 136); font-weight: bold; font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">int</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">maxgen</span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">=</span><span class="mi" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">3000</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">;</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">              </span><span class="c1" style="margin: 0px; padding: 0px; border: 0px; color: rgb(153, 153, 136); font-style: italic; font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">// peak output of soalr PV system in W - used to calculate when to change cloud icon to a sun</span></p>
<p>to&nbsp;</p>
<p><span class="k" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">Line 76  </span><span class="kt" style="margin: 0px; padding: 0px; border: 0px; color: rgb(68, 85, 136); font-weight: bold; font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">int</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; "> </span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">maxgen</span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">=</span><span class="mi" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">50</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">;</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">                      </span><span class="c1" style="margin: 0px; padding: 0px; border: 0px; color: rgb(153, 153, 136); font-style: italic; font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">// peak output of soalr PV system in W - used to calculate when to change cloud icon to a sun<br />
</span><span class="k" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">Line 195 if (cval_gen&gt;maxgen) maxgen=cval_gen;</span></p>
<p>This should after 1 day of full sun set the max value for the generation.. (would save non savvy users editing code with the option for people to edit if they want,.)</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6111"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/905.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="robw&#039;s picture" title="robw&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/905.html" title="View user profile.">robw</a> on Sun, 09/09/2012 - 09:26.</div>
    <div class="content">
     <p><span style="line-height: 16px; white-space: pre; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; ">Line 228  int PWRleds= map(cval_gen-cval_use, 0, maxgen, 0, 255);     // Map importing value from 0-4Kw (LED brightness - cval3 is the smoothed grid value - see display above</span></p>
<p>Think its because PWRleds goes negitive so&nbsp;</p>
<p><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; line-height: 16px; white-space: pre; ">Line 229  </span><font color="#333333" face="Consolas, Liberation Mono, Courier, monospace"><span style="line-height: 16px; white-space: pre;">PWRleds = constrain(PWRleds, 0, 255); </span></font></p>
<p>Fixes this at 0&nbsp;</p>
<p>if you swap the cval_gen-cval_use to cval_use-cvall_gen the red les work but the green dont..</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6112"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Sun, 09/09/2012 - 14:37.</div>
    <div class="content">
     <p>&nbsp;Hi Rob,&nbsp;</p>
<p>Sorry about the typo, I see you have notice that the '-' should be a '+'! The github sketch has been uodated. I have also updated the LED brightness mapping to use the 'maxgen' variable which is defined at the beginning of the sketch. You should set 'maxgen' to be equal to the peak output of your array in W.&nbsp;</p>
<p>I think I can see you problem. The sketch assumes that the grid import/export feed (emontx.power1) is positive when importing and negative when exporting. Looking at your emoncms feed it looks like you need to flip the orientation of the CT for emontx.power1. You need to be using an AC-AC voltage sample adapter with the emonTx and running the emonTx voltage sketch for the direction of current flow to be detected.&nbsp;</p>
<p>Thanks a lot for bearing with me on this, your feedback is much appreciated. Please let me know how this works and if you have any further improvment sugestions.</p>
<p>Cheers, &nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6113"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/905.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="robw&#039;s picture" title="robw&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/905.html" title="View user profile.">robw</a> on Sun, 09/09/2012 - 15:06.</div>
    <div class="content">
     <p>Thanks Glyn</p>
<p>The emonTx has been in place for quite a few months and was working fine with the old firmware.</p>
<p>I'm sure the CTs are the correct way round as it was al fine before the new code. It seems that the totals are wrong not the live figures..</p>
<p>Iv fliped the CT round as you sugest but now just shows -</p>
<p><a href="../sites/default/files/IMG_0841.JPG%20(2).jpg" target="_blank"><img src="../sites/default/files/IMG_0841.JPG%20(2).jpg" width="400" height="300" alt="" /></a></p>
<p>In this pic above &nbsp;im only useing 54W. But i know im using 700+ currently. The Generation is correct.</p>
<p>&nbsp;</p>
<p><a href="../sites/default/files/IMG_0842.JPG%20(2).jpg" target="_blank"><img src="../sites/default/files/IMG_0842.JPG%20(2).jpg" width="400" height="300" alt="" /></a></p>
<p>This pic is how it was before but the totals are showing as 0 or -0&nbsp;</p>
<p><a href="../sites/default/files/IMG_0843.JPG%20(2).jpg" target="_blank"><img src="../sites/default/files/IMG_0843.JPG%20(2).jpg" width="400" height="300" alt="" /></a></p>
<p>This is using the code from the 27-July-2012 totals updateing (even if the backlight no longer works as the base firmware is too new..)</p>
<p>any ideas?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6114"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/905.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="robw&#039;s picture" title="robw&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/905.html" title="View user profile.">robw</a> on Sun, 09/09/2012 - 16:13.</div>
    <div class="content">
     <p>Right totals now working. (Not sure i trust them... Seem to low..). After loading all of the devices with the latest firmware...</p>
<p>BUT</p>
<p>Red leds not working.. Green work fine red do nothing..</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6117"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="robinsmh&#039;s picture" title="robinsmh&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by robinsmh (not verified) on Mon, 10/09/2012 - 09:00.</div>
    <div class="content">
     <p>On the subject of LEDs and backlight:</p>
<p>On my GLCD, I rewrote the backlight and LED logic somewhat. Maybe other people may like to consider this. The original backlight logic only works if you have a emonBase to provide the clock. Since I don't use an emonBase, I needed to change it anyway.</p>
<p>What I ended up with is basically:</p>
<p>1. Backlight brighness is updated every 200ms (instead of every 10s) and is based purely on the ambient light level. By tweaking the relationship between the light level and backlight brighness, I got it so that the backlight turns off completely in a darkened room - hence no need for a clock to turn it off at night.</p>
<p>2. The LEDs change colour gradually from fully red when importing more than 1 KW, to fully green if exporting more than 1KW. Between these extremes, the colour changes gradually through shades of orange and yellow. The Brighness of the LEDs is adjusted to follow the backlight.</p>
<p>For my purposes, this logic works very nicely and is I think an improvement on the original. If anyone wants to see the source code, please drop me a PM.</p>
<p>Martin</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6119"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Mon, 10/09/2012 - 13:26.</div>
    <div class="content">
     <p>@Martin,</p>
<p>Ah great, I like the idea of the backlight going off when the room is dark, however the time is still needed for resetting the Kwh/d at midnight. Have you got a video demostrating the opperation of your LED's? We have yet to made use of yellow/orange shades of the tri-colour LED's. I thought it might be a bit confusing for non-techi users. As it stands, I think it's quite clear that green means that generation is more than meeting your current consumption needs and red means it's not and your importing power. The brightness of the LED's does change depneding on level of import / generation.&nbsp;</p>
<p>@Rob</p>
<p>That's good news, progress at least. I'm struggling to work out why the Red LED 's arent working. The code controlling them is simply:</p>
<p><span class="k" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; font-weight: bold; ">if</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; "> </span><span class="p" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; ">(</span><span class="n" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; ">cval_gen</span><span class="o" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; font-weight: bold; ">&gt;</span><span class="n" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; ">PV_gen_offset</span><span class="p" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; ">)</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; "> </span><span class="p" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; ">{</span></p>
<pre style="margin-top: 0px; margin-bottom: 0px; padding: 0px; border: 0px; font-size: 11.818181991577148px; font-family: Consolas, 'Liberation Mono', Courier, monospace; color: rgb(51, 51, 51); line-height: 14.545454025268555px; "><div class="line" id="LC239" style="margin: 0px; padding: 0px 0px 0px 10px; border: 0px; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; ">if</span> <span class="p" style="margin: 0px; padding: 0px; border: 0px; ">(</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; ">cval_gen</span> <span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; ">&gt;</span> <span class="n" style="margin: 0px; padding: 0px; border: 0px; ">cval_use</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">)</span> <span class="p" style="margin: 0px; padding: 0px; border: 0px; ">{</span>            <span class="c1" style="margin: 0px; padding: 0px; border: 0px; color: rgb(153, 153, 136); font-style: italic; ">//show green LED when gen&gt;consumption cval are the smooth curve values  </span></div><div class="line" id="LC240" style="margin: 0px; padding: 0px 0px 0px 10px; border: 0px; "><span class="n" style="margin: 0px; padding: 0px; border: 0px; ">analogWrite</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">(</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; ">redLED</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">,</span> <span class="mi" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); ">0</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">);</span></div><div class="line" id="LC241" style="margin: 0px; padding: 0px 0px 0px 10px; border: 0px; "><span class="n" style="margin: 0px; padding: 0px; border: 0px; ">analogWrite</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">(</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; ">greenLED</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">,</span> <span class="n" style="margin: 0px; padding: 0px; border: 0px; ">PWRleds</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">);</span></div><div class="line" id="LC242" style="margin: 0px; padding: 0px 0px 0px 10px; border: 0px; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line" id="LC243" style="margin: 0px; padding: 0px 0px 0px 10px; border: 0px; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="margin: 0px; padding: 0px; border: 0px; ">}</span> <span class="k" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; ">else</span> <span class="p" style="margin: 0px; padding: 0px; border: 0px; ">{</span>                              <span class="c1" style="margin: 0px; padding: 0px; border: 0px; color: rgb(153, 153, 136); font-style: italic; ">//red if consumption&gt;gen</span></div><div class="line" id="LC244" style="margin: 0px; padding: 0px 0px 0px 10px; border: 0px; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="margin: 0px; padding: 0px; border: 0px; ">analogWrite</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">(</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; ">greenLED</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">,</span> <span class="mi" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); ">0</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">);</span></div><div class="line" id="LC245" style="margin: 0px; padding: 0px 0px 0px 10px; border: 0px; "><span class="n" style="margin: 0px; padding: 0px; border: 0px; ">analogWrite</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">(</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; ">redLED</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">,</span> <span class="n" style="margin: 0px; padding: 0px; border: 0px; ">PWRleds</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">);</span></div><div class="line" id="LC246" style="margin: 0px; padding: 0px 0px 0px 10px; border: 0px; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="margin: 0px; padding: 0px; border: 0px; ">}</span></div><div class="line" id="LC247" style="margin: 0px; padding: 0px 0px 0px 10px; border: 0px; ">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="margin: 0px; padding: 0px; border: 0px; ">}</span> <span class="k" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; ">else</span> <span class="p" style="margin: 0px; padding: 0px; border: 0px; ">{</span>                                <span class="c1" style="margin: 0px; padding: 0px; border: 0px; color: rgb(153, 153, 136); font-style: italic; ">//Led's off at night and when solar PV is not generating</span></div><div class="line" id="LC248" style="margin: 0px; padding: 0px 0px 0px 10px; border: 0px; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="margin: 0px; padding: 0px; border: 0px; ">analogWrite</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">(</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; ">redLED</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">,</span> <span class="mi" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); ">0</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">);</span></div><div class="line" id="LC249" style="margin: 0px; padding: 0px 0px 0px 10px; border: 0px; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="n" style="margin: 0px; padding: 0px; border: 0px; ">analogWrite</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">(</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; ">greenLED</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">,</span> <span class="mi" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); ">0</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; ">);</span></div><div class="line" id="LC250" style="margin: 0px; padding: 0px 0px 0px 10px; border: 0px; ">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p" style="margin: 0px; padding: 0px; border: 0px; ">}</span></div></pre><p>So whenever gen&lt;use red LED's should come on with brightness determind by PWRleds. Do you think you could get it to serial print cval_gen, cval_use and PWRleds to see what the problem is. cval is just a smoothing function. cval_gen and cval_use is what is displayed for use and gen on the LCD so we know they should be correct.&nbsp;</p>
<p>I'm sure you have tested this but you could do a digital write high on pin 9 just to check the red LED's are working.&nbsp;</p>
<p>Cheers,&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6121"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="robinsmh&#039;s picture" title="robinsmh&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by robinsmh (not verified) on Mon, 10/09/2012 - 14:33.</div>
    <div class="content">
     <blockquote><p>however the time is still needed for resetting the Kwh/d at midnight.</p>
</blockquote>
<p>I reset the daily totals whenever the PV power becomes non-zero after being zero for at least an hour. This is therefore a kind of 'sunrise detector' in software. The daily totals will not reflect exactly 24 hours, but it's good enough for me.</p>
<p>Sorry - I don't have a video of my LED/backlight logic in operation, nor any particular inclination to create one. I'm happy though&nbsp;to share my source code if anyone wants to look, but it has now diverged in a several areas from the 'standard'.</p>
<p>One slightly wacky feature is that the LED brightness&nbsp;and ambient light sensor interact such as to give positive feedback to the brightness control. This means that is takes several iterations to stabilise to fully-off when I turn off the the lights - you see the backlight and LEDs gradually fade out over a couple of seconds.</p>
<p>Martin</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6126"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/905.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="robw&#039;s picture" title="robw&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/905.html" title="View user profile.">robw</a> on Mon, 10/09/2012 - 18:20.</div>
    <div class="content">
     <p>&nbsp;Glyn</p>
<p>Seems i was right.. Its a negitive number.. before the constrain so gets set to zero by it....</p>
<p>Red leds works fine with the older code....</p>
<p>PWRleds = -65 &nbsp; Before Constrain<br />
PWRleds = 0 &nbsp; &nbsp; &nbsp; After..<br />
cval_gen = 22<br />
cval_use =473</p>
<p>so you can see where i put the print outs..</p>
<pre>
﻿ int LDR = analogRead(LDRpin);                     // Read the LDR Value so we can work out the light level in the room.
    int LDRbacklight = map(LDR, 0, 1023, 50, 250);    // Map the data from the LDR from 0-1023 (Max seen 1000) to var GLCDbrightness min/max
    LDRbacklight = constrain(LDRbacklight, 0, 255);   // Constrain the value to make sure its a PWM value 0-255
    if ((hour &gt; 22) ||  (hour &lt; 5)) glcd.backLight(0); else glcd.backLight(LDRbacklight);  

    int PWRleds= map(cval_gen-cval_use, 0, 1750, 0, 255);     // Map importing value from 0-4Kw (LED brightness - cval3 is the smoothed grid value - see display above 
    Serial.print(&quot;PWRleds = &quot;); 
    Serial.println(PWRleds);
    PWRleds = constrain(PWRleds, 0, 255);             // Constrain the value to make sure its a PWM value 0-255
   Serial.print(&quot;PWRleds = &quot;);
   Serial.println(PWRleds);
   Serial.print(&quot;cval_gen = &quot;);
   Serial.println(cval_gen);
   Serial.print(&quot;cval_use =&quot;);
   Serial.println(cval_use);

   if (cval_gen&gt;0) {
      if (cval_gen &gt; cval_use) {            //show green LED when gen&gt;consumption cval are the smooth curve values  
<span class="Apple-tab-span" style="white-space:pre"> </span>analogWrite(redLED, 0);         
<span class="Apple-tab-span" style="white-space:pre"> </span>analogWrite(greenLED, PWRleds);    

<br /></pre><pre>
Let me know if i can help further.
Rob</pre>         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6127"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/905.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="robw&#039;s picture" title="robw&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/905.html" title="View user profile.">robw</a> on Mon, 10/09/2012 - 18:21.</div>
    <div class="content">
     <p>&nbsp;Robin I would love to have a look that, It would help my battery usage on the Glcd as im using a LiPo pack on it..</p>
<p>Rob</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6128"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Mon, 10/09/2012 - 18:30.</div>
    <div class="content">
     <p>Simple but great idea Martin. I like it,&nbsp;relying on the cycle of the earth to govern time, electronics being governed by the rotation of the earth! Yes, please do post your code. We could make an alternative solar PV example sketch on Github for those who don't use an emonBase based on your code.&nbsp;</p>
<p>Cheers,&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6130"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/905.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="robw&#039;s picture" title="robw&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/905.html" title="View user profile.">robw</a> on Mon, 10/09/2012 - 19:08.</div>
    <div class="content">
     <p>&nbsp;Glyn..&nbsp;</p>
<p>Been having a play around.. with the current code and old code..</p>
<p>But did not get very far as the sun set on me.. Damm this time of year.</p>
<p>As per prev comment it definatly because the value of&nbsp;</p>
<p><span style="background-color: rgb(238, 238, 238); font-size: 14px; line-height: 15.316666603088379px; ">int PWRleds= map(cval_gen-cval_use, 0, 1750, 0, 255);<br />
&nbsp;</span><span style="background-color: rgb(238, 238, 238); font-size: 14px; line-height: 15.316666603088379px; ">&nbsp;</span></p>
<p>Is a negitive.. &nbsp;Wonder if we could dectect this and flip it.?</p>
<p>&nbsp;</p>
<p>Rob.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6134"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Mon, 10/09/2012 - 22:24.</div>
    <div class="content">
     <p>&nbsp;Ah, I think that's it, PWRleds is going negative. Try the latest code from GitHub, I've just added:</p>
<p><span class="kt" style="font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; color: rgb(68, 85, 136); font-weight: bold; ">int</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; "> </span><span class="n" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; ">PWRleds</span><span class="o" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; font-weight: bold; ">=</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; "> </span><span class="n" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; ">map</span><span class="p" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; ">(</span><span class="n" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; ">cval_use</span><span class="o" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; font-weight: bold; ">-</span><span class="n" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; ">cval_gen</span><span class="p" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; ">,</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; "> </span><span class="mi" style="font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); ">0</span><span class="p" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; ">,</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; "> </span><span class="n" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; ">maxgen</span><span class="p" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; ">,</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; "> </span><span class="mi" style="font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); ">0</span><span class="p" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; ">,</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; "> </span><span class="mi" style="font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); ">255</span><span class="p" style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; ">);</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; ">     </span><span class="c1" style="font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; margin: 0px; padding: 0px; border: 0px; color: rgb(153, 153, 136); font-style: italic; ">// Map importing value from (LED brightness - </span><span class="k" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; ">if</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; "> </span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; ">(</span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; ">PWRleds</span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; ">&lt;</span><span class="mi" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; ">0</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; ">)</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; "> </span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; ">PWRleds</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; "> </span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; ">=</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; "> </span><span class="n" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; ">PWRleds</span><span class="o" style="margin: 0px; padding: 0px; border: 0px; font-weight: bold; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; ">*-</span><span class="mi" style="margin: 0px; padding: 0px; border: 0px; color: rgb(0, 153, 153); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; ">1</span><span class="p" style="margin: 0px; padding: 0px; border: 0px; color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; ">;</span><span style="color: rgb(51, 51, 51); font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; ">                    </span><span class="c1" style="margin: 0px; padding: 0px; border: 0px; color: rgb(153, 153, 136); font-style: italic; font-family: Consolas, 'Liberation Mono', Courier, monospace; font-size: 11.818181991577148px; line-height: 14.545454025268555px; white-space: pre; ">// keep it positive </span></p>
<p>Thanks for spotting this. &nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6137"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="robinsmh&#039;s picture" title="robinsmh&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by robinsmh (not verified) on Tue, 11/09/2012 - 08:24.</div>
    <div class="content">
     <p>OK - here's my GLCD&nbsp;code. Differences from the original are:</p>
<p>1. Commented out all references to the RTC and temperature sensor libraries</p>
<p>2. No RF from emonBase</p>
<p>3. Extra fields added to emontx payload to contain immersion heater output level and tank temperature.</p>
<p>4. bottom right quarter of main display has room temperature replaced by tank temperature, plus power and output level.</p>
<p>5. Added hot-water power&nbsp;usage to 7-day usage data.</p>
<p>6. Display page 2 (clock) removed.</p>
<p>7. 7-fay usage data is rolled-over based on a PV&nbsp;sun-rise detector instead of RTC.</p>
<p>8. New backlight and LED logic, as previously described.</p>
<p>&nbsp;</p>
<p>See attached for main sketch code.&nbsp;</p>
<p><span id="1347351591234E" style="display: none;">&nbsp;Ad </span></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6145"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/905.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="robw&#039;s picture" title="robw&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/905.html" title="View user profile.">robw</a> on Tue, 11/09/2012 - 16:24.</div>
    <div class="content">
     <p>&nbsp;Glyn</p>
<p>&nbsp;</p>
<p>Have added the code and the red leds now work as expected.. &nbsp;Nice one..</p>
<p>The totals still go negitive though (should of got a pic when i got home as it said we were -15.7kWh Today (home) This is not possible as we have only generated 6+kWh) but forgot..</p>
<p>See pics below.. for after the code change.</p>
<p><a href="../sites/default/files/photo%201%20(8).jpg"><img src="../sites/default/files/photo%201%20(8).jpg" width="400" height="300" alt="" /></a></p>
<p><a href="../sites/default/files/photo%202%20(6).jpg"><img src="../sites/default/files/photo%202%20(6).jpg" width="400" height="300" alt="" /></a></p>
<p>This is shoing that its negitive with in a few mins of starting up..</p>
<p>Edit.. &nbsp;After a while of being home and the PV power reducing as the sun is setting.. the total is winding back towards a positiv number.. Was almost -1.0kWh and were now at -0.1kWh so its moving.. But i guess its counting the PV output...&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6146"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/885.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="logic&#039;s picture" title="logic&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/885.html" title="View user profile.">logic</a> on Tue, 11/09/2012 - 16:36.</div>
    <div class="content">
     <p>&nbsp;Rob</p>
<p>Ive been running the latest code as from 12.15am and my totals are all looking correct. &nbsp;This is along with the latest emonTx and emonbase sketches (minor alterations but nothing to do with totals etc.).</p>
<p>Your issues may be elsewhere?</p>
<p>Dennis</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6147"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/905.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="robw&#039;s picture" title="robw&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/905.html" title="View user profile.">robw</a> on Tue, 11/09/2012 - 16:58.</div>
    <div class="content">
     <p>Dennis</p>
<p>Do you have a Type 1 system?&nbsp;</p>
<p>Mines a Type 2 and have loaded the latest sketches on all 3 devices now and i still get the wrong totals. The live data is correct.. Eg Exporting / import, Generation and use. So im guessing its a calculation problem with the type 2 system.. Im not sure of the setup of Glyns system so he may not have a way of testing this out..</p>
<p>This was all working fine with the previous sketches (several months) so beleive nothing is wrong with the setup. (could be wrong on this).</p>
<p>Rob</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6148"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/885.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="logic&#039;s picture" title="logic&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/885.html" title="View user profile.">logic</a> on Tue, 11/09/2012 - 22:00.</div>
    <div class="content">
     <p>&nbsp;Yes I do have type 1 - if you'd write it, I never picked it up. &nbsp;Sorry.</p>
<p>Dennis</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6155"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Wed, 12/09/2012 - 15:09.</div>
    <div class="content">
     <p>&nbsp;I think I'ved solved the Kwh/d use going negative for type two solar, it was a missing bracket. Changes have been pushed to github.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6161"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/905.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="robw&#039;s picture" title="robw&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/905.html" title="View user profile.">robw</a> on Wed, 12/09/2012 - 18:40.</div>
    <div class="content">
     <p>Thanks Glyn</p>
<p>Will load the code in a min and report back tomorrow...</p>
<p>&nbsp;</p>
<p>Also on a side note hope it fixes the totals recording wrong.. we supposedly used 17kWh in 4Hrs&nbsp;We don&#39;t use that in 3 days so hope its wrong...</p>
<p><a href="../sites/default/files/photo%20(2)_0.jpg" target="_blank"><img alt="" src="../sites/default/files/photo%20(2)_0.jpg" style="width: 400px; height: 300px; " /></a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6162"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Wed, 12/09/2012 - 20:41.</div>
    <div class="content">
     <p>Yup it should do. I&#39;ve got it running here, it&#39;s working well. I&#39;ve been working from home today so I&#39;ve got round to upgrading my homesetup to the latest version.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6166"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/905.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="robw&#039;s picture" title="robw&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RESOLVED - emonGLCD Latest code</h3>

    <div class="submitted">Submitted by <a href="../user/905.html" title="View user profile.">robw</a> on Thu, 13/09/2012 - 18:23.</div>
    <div class="content">
     <p>Glyn..</p>
<p>Working like a charm.. Thanks for all the hard work...</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/1029"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-ocB9BKQnv42PQOxqoo33VihfB7NuggnpbUna7L_SA_U" value="form-ocB9BKQnv42PQOxqoo33VihfB7NuggnpbUna7L_SA_U"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
