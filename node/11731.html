<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11731 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:13:20 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>EmonPi aditional CT sensor | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">EmonPi aditional CT sensor</h3>
        <span class="submitted">Submitted by <a href="../user/8733.html" title="View user profile.">CidiRome</a> on Wed, 02/12/2015 - 18:28</span>
        <div class="content"><p>Hi.</p>
<p>I&#39;ve seen here (<a href="https://learn.openenergymonitor.org/?redirect=how-to-build-an-arduino-energy-monitor">http://openenergymonitor.org/emon/buildingblocks/how-to-build-an-arduino-energy-monitor</a>) and other places on this forum&nbsp;that it is fairly simple to build the circuitry to hook a&nbsp;CT sensor to the arduino.</p>
<p>There is one thing that is causing me doubts: I see almost everywhere references about&nbsp;the burden resistor of 22Ohm&nbsp;when 3.3V&nbsp;supply voltage is used, but when I analyzed the EmonPi&nbsp;circuitry I can see two 22Ohm in parallel (R17/R22 or&nbsp;R26/R28) that would result in 11Ohm burden.<br />
Can this be some kind of option between two different types of resistors&nbsp;that in the build moment only one is applied?&nbsp;</p>
<p>In this circuit what are the necessary changes to modify the supply voltage from 3.3V&nbsp;to 5V and keep the same calibration values inside the EmonPi Firmware?</p>
<p><img alt="" src="../../../vieirasoft.net/Capture_Emon_CT_Circuit_.png" style="width: 573px; height: 366px;" /></p>
<p>Cheers.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11700.html" class="topic-previous" title="Go to previous forum topic">‹ Plugs with capability to transmit power consumption</a>
              <a href="11112.html" class="topic-next" title="Go to next forum topic">Switchable plugs? ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-36595"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonPi aditional CT sensor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 02/12/2015 - 19:05.</div>
    <div class="content">
     <p>You are right. If you look at the PCB Layout, you will see one is a SMT component and the other is wire-ended. If you look inside your emonPi, you will find the wire-ended component is not fitted.</p>
<p>Calibration is not affected, provided that you use the correct preprocessor directive inside your sketch. Details are in emonLib in the comments.</p>
<p>If you are feeding the top of R27 with 5 V, then very obviously R25 and R27 can no longer be equal, and you must change the value of one so that the voltage at their common junction is as close to 1.65 V (i.e. the mid-point of the 3.3 V ADC input range) as possible. That does not of course affect calibration.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36597"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8733.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-8733.jpg" alt="CidiRome&#039;s picture" title="CidiRome&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonPi aditional CT sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8733.html" title="View user profile.">CidiRome</a> on Wed, 02/12/2015 - 19:35.</div>
    <div class="content">
     <p>Thank you for the clarification.</p>
<p>I don&#39;t have easy access to my EmonPi&nbsp;board&nbsp;side because it is installed under the Raspberry and fixed to the plastic box where I have the material.</p>
<p>Regarding to the changes need for 5V supply I read the information you already gave me</p>
<blockquote><p>Regarding the bias supply for the outboard input, I would use 5 V and keep all the same components except for the resistor in the R27 position, which needs to be adjusted so that the voltage at the junction with (C4) and (R25) is 1.65 V, which gives a value of 954 k&Omega;. That, very inconveniently, is almost exactly mid-way between two E24 preferred values. Using 910 k&Omega;, the voltage is fractionally closer, but 1 M&Omega; is only fractionally worse and probably easier to obtain. You will lose about 1.5% of the range, which is nothing to worry about. Or you could use 910 k&Omega; + 43 k&Omega; in series. If you can get a 953 k&Omega; resistor, that would be ideal, but values in the E48 series can be hard to find and costly.</p>
</blockquote>
<p>You advised me to change the value of R27, but the result is a hard to find resistor value.<br />
I have read else where that we can change R25 and R27 to a good range of values that shell be equal for the 3.3V supply, but maybe we can change both (R25 and R27) to easy to find values&nbsp;as long we have a ratio of 1.65V and&nbsp;3.35V&nbsp;to make the correct voltage divider...</p>
<p>Later I will do some math on this.</p>
<p>Cheers.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36598"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonPi aditional CT sensor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 02/12/2015 - 19:47.</div>
    <div class="content">
     <p>You can use resistors in series or in parallel. There are many ways to 'play the numbers' and it is possible that you will find a combination that comes close, and that is because the resistor values are rounded from their theoretical values, which are 12 or 24 equal steps by ratio per decade.</p>
<p>Look at the picture of the Pi or an emonTx, or an emonTx Shield, for the burden. All do it similarly.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36601"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8733.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-8733.jpg" alt="CidiRome&#039;s picture" title="CidiRome&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonPi aditional CT sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8733.html" title="View user profile.">CidiRome</a> on Wed, 02/12/2015 - 23:17.</div>
    <div class="content">
     <p>Hi.</p>
<p>I think I will change my approach to this situation, the values are not easy to match, the best pair I could find was 787 / 390 and even this not very good.</p>
<p>Then I started to think that if I connect this to the +5V rail (at the RJ45 port)&nbsp;I will certainly get power fluctuations because this output is a direct connection to the USB input while if I get the 3.3V from the EmonPi&nbsp;I can&nbsp;have the same reference voltage&nbsp;for all the CTs and don&#39;t have any trouble with the resistor values. I think a good source may be the&nbsp;ISP1&nbsp;connector that I don&#39;t remember being connected to anything.</p>
<p>Cheers.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11731"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-7lhtVWoKnPdXnY7jaVWDZPE-vXZbNMCe_MqrEI0geWc" value="form-7lhtVWoKnPdXnY7jaVWDZPE-vXZbNMCe_MqrEI0geWc"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
