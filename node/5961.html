<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/5961 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:02:07 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>feed suddenly negative | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/3.html">Archived: General Discussion</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">feed suddenly negative</h3>
        <span class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Tue, 21/10/2014 - 12:46</span>
        <div class="content"><p>So i have almost got things down like i want... only to discover that my kwh feed suddenly turns negative</p>
<p>from the emontx i transfer pulses and watt from the meter.... can it really be the sketch that uses micros to calc watt that is at fault?</p>
<p>&nbsp;</p>
<p>my graphs seems ok...&nbsp;http://energymonitor-dk.dns4e.net/emoncms/boelle/</p>
<p>&nbsp;</p>
<p>but if you look at the inputs and then feeds you will note that kwh which gets it data from watt feed is now negative...(pics attached)</p>
<p>&nbsp;</p>
<p>the feed was ok when i last cleared out the test data...</p>
<p>&nbsp;</p>
<p>non related to emoncms it seems my ISP from time to time updates my router and reboot it... when that happens the pi loose wifi... anyone know of a small script that can check if connection and if not down the connection and establish it gain?&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="5987.html" class="topic-previous" title="Go to previous forum topic">‹ Multiple transmitters</a>
              <a href="5973.html" class="topic-next" title="Go to next forum topic">Monitor for Automotive Lead-Acid Battery uses Arduino ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-24696"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Tue, 21/10/2014 - 14:04.</div>
    <div class="content">
     <p>about the wifi problem this did the trick for me:&nbsp;http://harizanov.com/2013/04/auto-reconnect-wifi-on-raspberry-pi/</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24704"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 21/10/2014 - 21:27.</div>
    <div class="content">
     <p>kWh feed:  I am guessing that it went from a positive value to a negative in one big step, so my first thought is a number - maybe an intermediate step in the process - has overflowed and become negative. What was the last positive value and what was the first negative one? What processing is done on that to get to the feed?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24705"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Tue, 21/10/2014 - 23:17.</div>
    <div class="content">
     <p>yep.. from one positive to a BIG negative in one step</p>
<p>&nbsp;</p>
<p>last value is 80.8 recorded at 14:13:40 and then no values after that.. not even 0... i then slowly go forward and i do not see a datapoint before 14:15:49... the value was now -175477.7</p>
<p>what i do is take the watt number transmitted and log that... i then do the kwh processing on the wattnumber and also log that...</p>
<p>now the same emontx also transmit my hotwater&nbsp;cylinder temp and numbers from my heat meter... the hotwater messurements are also completely gone in that timetimespan...but they return normal as they are direct from input to log without any processing,...</p>
<p>i also checked the watt feed that the kwh builds on and that one is not transmitted either in that timespan...</p>
<p>so i can see the emontx did not transmit in that time... but should that not have caused just 0&#39;s ??&nbsp;</p>
<p>my water emontx that only counts pulses and calc flowrate&nbsp;came through fine in the timeperiod... and they are feed from the same power supply... i feed one with and mini usb and then via 2 short wires i feed the other...</p>
<p>&nbsp;</p>
<p>first datapoint was recored&nbsp;15/10-14 14:37:30</p>
<p>&nbsp;</p>
<p><u><strong>EDIT</strong></u>: both sketches are attached.... just if there was a fault here</p>
<p><u><strong>EDIT2:</strong></u>&nbsp;http://energymonitor-dk.dns4e.net/emoncms/vis/auto?feedid=78 shows the feed...</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24706"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 22/10/2014 - 00:07.</div>
    <div class="content">
     <p>I think this is one for Trystan. I've just taken the step in Watts and divided it by the time difference in hours and it comes close to 2^32 (close enough to raise a suspicion but not close enough to be totally convincing).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24707"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Wed, 22/10/2014 - 00:15.</div>
    <div class="content">
     <p>oki, will keep an eye out...&nbsp;</p>
<p>&nbsp;</p>
<p>but would missing transmission cause this or would the kwh number just stay still until transmission gets back?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24720"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 22/10/2014 - 14:46.</div>
    <div class="content">
     <p>It's not the register value out of the Kamstrup meter then, but the power value in Watts that's being accumulated and turned into kWh in emonCMS that's the problem.</p>
<p>I have not got to grips with the new feed engines, so I can't give you a definitive answer on that. The sensible things to do would be either to assume nothing and interpolate between the last value and the next, or to assume zero, or to assume the last value for all the missing points. None of those would give the answer that you got, so I think the likely explanation is it saw a corrupted number and believed it.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24724"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 22/10/2014 - 15:26.</div>
    <div class="content">
     <p>Although boelle&nbsp;hasn&#39;t shown his processing of that input, the input.png shows no additional processing icons, just &quot;log&quot; and &quot;kwh&quot; so I suspect the power value is just logged to a&nbsp;feed and then logged as kwh&#39;s. which you would expect to be simple enough to spot any&nbsp;anomaly&nbsp;in the power feed that could lead to such a deflection.</p>
<p>Unless the time suddenly jumped back to 1970 for a while. ~570w for minus 35years is ~ -175000Kwh and wouldn&#39;t be noticeable in the power feed as the timestamp was 1970, there would just be a hole in the data, which he says he&nbsp;has.</p>
<p>Is it possible a read-only time issue could of caused this? if rebooted without an internet connection the date could revert to 1970 if using an unmodified SD card image.</p>
<p>What is your&nbsp;software setup on the Pi, Boelle ? Are you using the read-only SD image ? Do you have a permanent&nbsp;internet connection? Do you have any data input&nbsp;for that period ?</p>
<p>Paul</p>
<p>​</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24725"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 22/10/2014 - 15:33.</div>
    <div class="content">
     <p>Somehow I lost a whole decade, that should be ~ 445w&nbsp;for minus 45years :-)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24727"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Wed, 22/10/2014 - 18:24.</div>
    <div class="content">
     <p>this has not to do with the kamstrup meter at all... it just the simple blinker on my electricity meter...</p>
<p>&nbsp;</p>
<p>i&#39;m using the timeseries engine as that allows me to do the intervals i want.</p>
<p>i&#39;m still poking my mind how it can make missing transmits so much negative...&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24728"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Wed, 22/10/2014 - 18:30.</div>
    <div class="content">
     <p>&quot;Although boelle&nbsp;hasn&#39;t shown his processing of that input, the input.png shows no additional processing icons, just &quot;log&quot; and &quot;kwh&quot;&quot;</p>
<p>&nbsp;</p>
<p>thats right... i log the watt number as they come in because i want to graph my load over time</p>
<p>i then choose to process that number as kwh and log it also....&nbsp;</p>
<p>&nbsp;</p>
<p>What is your&nbsp;software setup on the Pi, Boelle: Powered by&nbsp;openenergymonitor.org&nbsp;| vmaster:8.2.8, bufferedwrite:0.0.1</p>
<p>Are you using the read-only SD image ? no, trystan told me the best thing was to use the lowwrite&nbsp;image and if i wanted put data part of that image to a harddrive... since i had a 1TB drive arround i use that as data and the sd only yo boot on, but content wise the harddrive is the same as the sd image</p>
<p>&nbsp;Do you have a permanent&nbsp;internet connection? yes 24&nbsp;mbit&nbsp;down and 12 mbit&nbsp;up</p>
<p>Do you have any data input&nbsp;for that period ? not from that emontx no... but i did get from the other emontx that monitors my water meter, both are power from the same source, one connected to mini usb and then via 2 hookup wires to the other</p>
<p>pic of my processing attached</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24730"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Wed, 22/10/2014 - 19:10.</div>
    <div class="content">
     <p>just wondering here... and i cant remember...</p>
<p>but if i did loose connection (my ISP tends to upgrade and reboot the cable router as they please) and i then reboot the pi to get wifi connection again it would cause it to revert to 1970&#39;s...</p>
<p>now i did put up a script that checks for connection and ping the router... the script runs every 5 mins, if no connection it will recreate it... that at least will reduce my need to reboot the pi if the router drops the connection.</p>
<p>but still it does not explain why it was only one emontx&nbsp;that did not get its transmits through in that timespan... i know that they are both powered... if one is the other is also, no bad soldering here...&nbsp;</p>
<p>if it was only the reboot of the pi it should have been a drop in transmit from everything but in much shorter timespan as the pi only does very little loading from the sd and the rest from the harddrive...</p>
<p>now the negative value is slowly climbing towards 0 again so at least that tells me that its counting right again... and if i could just edit the data i could simply add the initial negative value to all datapoint and come up with somewhat ok data....</p>
<p>problem is that timeseries&nbsp;feeds does not show up in phpmyadmin... just the feednames... the old images a year back did allowed me to edit the data direct in phpmyadmin...</p>
<p>&nbsp;</p>
<p>just thoughts here....&nbsp;</p>
<p>&nbsp;</p>
<p>EDIT: small video of my setup in the utility closet (1 min long)&nbsp;http://youtu.be/o1Am2iLlCh8&nbsp;(uploading right now)</p>
<p>what you dont see in the video is the 3 core cable that feeds through the fusebox&nbsp;then a hole out to the meter that is embedded in the wall on the outside just next to my door. also you dont&nbsp;see the 3 core cable that goes to the top of the hotwater cylinder. (brass pocket installed at factory)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24734"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 22/10/2014 - 20:41.</div>
    <div class="content">
     <p>Can you check your emonhub&nbsp;logfile&nbsp;for any 1970 dates using</p>
<blockquote><p>cat /var/log/emonhub/emonhub.log</p>
</blockquote>
<p>and scroll back looking at the dates down the left.</p>
<p>and also check if you are using a symlinked&nbsp;fake-hwclock file using this command</p>
<blockquote><p>ls -la /etc/fake-hwclock.data</p>
</blockquote>
<p>if it returns &quot;/etc/fake-hwclock.data&quot; ok but it may return something like&nbsp;&quot;/etc/fake-hwclock.data -&gt; /home/pi/data/fake-hwclock.data&quot; and that means you may be vulnerable to the 1970 issue at boot up until a internet connection is established.</p>
<p>if it is this issue it would only need the clock to be out momentarily to register the time calculation in just the kwh log, the other feeds are less sensitive because it would just miss the &quot;1970&quot; time&nbsp;stamped data and look like it dropped one or more packets,&nbsp;but it only takes 1 &quot;1970&quot; timestamp to throw out the kwh log as the time since the last datapoint is used in every calculation.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24735"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Wed, 22/10/2014 - 20:51.</div>
    <div class="content">
     <p>yep--- loads of 1970 dates</p>
<p>&nbsp;</p>
<p>1970-01-01 00:00:35,494 INFO EmonHub Pre-Release Development Version (rc1.0)<br />
1970-01-01 00:00:35,503 INFO Opening hub...<br />
1970-01-01 00:00:38,569 WARNING 1 Discarded RX frame &#39;non-numerical content&#39; : [ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#39;&gt;\x00&#39;, &#39;8b&#39;]<br />
1970-01-01 00:00:39,202 WARNING 4 Discard RX frame &#39;information&#39; : [&#39;&gt;&#39;, &#39;210g&#39;]<br />
1970-01-01 00:00:39,632 WARNING 6 Discard RX frame &#39;information&#39; : [&#39;&gt;&#39;, &#39;15i&#39;]<br />
1970-01-01 00:00:40,534 WARNING Send failure: wanted &#39;ok&#39; but got Can&#39;t connect &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;to redis database, it may be that redis-server is not installed or started see r &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eadme for redis installation<br />
1970-01-01 00:00:41,154 WARNING Send failure: wanted &#39;ok&#39; but got Can&#39;t connect &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;to redis database, it may be that redis-server is not installed or started see r &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eadme for redis installation<br />
1970-01-01 00:00:41,734 WARNING Send failure: wanted &#39;ok&#39; but got Can&#39;t connect &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;to redis database, it may be that redis-server is not installed or started see r &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eadme for redis installation<br />
1970-01-01 00:00:42,315 WARNING Send failure: wanted &#39;ok&#39; but got Can&#39;t connect &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;to redis database, it may be that redis-server is not installed or started see r &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eadme for redis installation</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24736"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Wed, 22/10/2014 - 20:55.</div>
    <div class="content">
     <p>the lines above was the complete screen output</p>
<p>&nbsp;</p>
<p>lrwxrwxrwx 1 root root 31 Aug 13 08:50 /etc/fake-hwclock.data -&gt; /home/pi/data/fake-hwclock.data</p>
<p>&nbsp;</p>
<p>so i guess it was an 1970 issue after all...</p>
<p>2 Q&#39;s</p>
<p>&nbsp;</p>
<p>1. is there anything i can do to prevent this happen to me again?</p>
<p>2. given that i cant access the feed data through phpmyadmin are there other tools i can use to edit the data so i can adjust the negative numbers to positive?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24737"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 22/10/2014 - 21:46.</div>
    <div class="content">
     <p>&nbsp;</p>
<p>Run the following command in &quot;read &amp; write mode&quot; (rpi-rw) to sort the time issue</p>
<p><strong>&nbsp;&nbsp; &nbsp;git clone <a href="https://github.com/emonhub/ntp-backup.git" title="https://github.com/emonhub/ntp-backup.git">https://github.com/emonhub/ntp-backup.git</a> ~/ntp-backup &amp;&amp; ~/ntp-backup/install</strong></p>
<p>&nbsp;</p>
<p>You don&#39;t want to &quot;adjust the negative numbers to positive&quot; as that would be just as inaccurate. you need to remove the 1 minus datapoint or add on an amount equal to the minus amount to balance it.</p>
<p>It&#39;s along shot,&nbsp;but&nbsp;if you can pin&nbsp;point&nbsp;the actual data&nbsp;point that caused the issue sat pm by looking at&nbsp;</p>
<p><a href="http://energymonitor-dk.dns4e.net/emoncms/boelle/vis/auto?feedid=78">http://energymonitor-dk.dns4e.net/emoncms/boelle/vis/auto?feedid=78</a>&nbsp;or clicking on the kwh icon on the input page and zooming in&nbsp;to get the time and date which you can convert to UNIXTIME&nbsp;(UTC)&nbsp;and try using this url</p>
<p><a href="http://emoncms.org/feed/deletedatapoint.json?id=0&amp;feedtime=UNIXTIME">http://energymonitor-dk.dns4e.net/emoncms/boelle/feed/deletedatapoint.json?id=78&amp;feedtime=UNIXTIME</a></p>
<p>​to remove that one&nbsp;datapoint, however I don&#39;t know this will work for sure so be cautious.</p>
<p>(you will need to be logged in for the urls to work or add &quot; &amp;apikey=XXXXETC&nbsp;&quot;)</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24739"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Wed, 22/10/2014 - 21:57.</div>
    <div class="content">
     <p>remember feed 78 is made up on the basis of feed 77.... so all the datapoint from the time it did go negative and forwards are negative... hence my idea of adjusting them... and by adjusting i simple mean add 175477.5 to all datapoints from the drop up to now...&nbsp;</p>
<p>as the datapoints &nbsp;are working towards 0 again would make them positive by the amount i have consumed&nbsp;</p>
<p>but again there are no way to edit datapoints... only delete them...</p>
<p>&nbsp;</p>
<p>all datapoints in my watt log are all positive.... no need to mess with those</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24741"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Wed, 22/10/2014 - 22:02.</div>
    <div class="content">
     <p>a pic on how the feed is going towards 0</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24753"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 23/10/2014 - 07:42.</div>
    <div class="content">
     <p>If you&#39;ve installed ntp-backup that should stop any future occurrences.</p>
<p>Going back and correcting historical data isn&#39;t easy as there&#39;s no current provision for that. It&#39;s not impossible but you need to work out how much effort it&#39;s worth to retain that data, it wasn&#39;t that long ago you reset the feeds.</p>
<p>You can either &quot;just start over&quot; - easy, less desirable option or wait until you find a way to &quot;correct&quot; all the effected data which is still being logged incorrectly. A third option could be to correct the current value on that feed now, so that from here on it is correct and if at a later date you find a way to correct the couple of days effected great, if not it&#39;s not so bad.</p>
<p>You will need to stop emonhub while applying the correction but it should only take a few seconds to complete. you will need to insert a new datapoint with the current unixtime and the new feed value (current feed value + correction)</p>
<p>1 - Stop emonhub using</p>
<blockquote><p>sudo service emonhub stop</p>
</blockquote>
<p>2 -&nbsp;Calculate the NEWVALUE by adding your correction value (175477.5 ?) to the value returned by</p>
<blockquote><p><a href="http://energymonitor-dk.dns4e.net/emoncms/boelle/feed/value.json?id=78" title="http://energymonitor-dk.dns4e.net/emoncms/boelle/feed/value.json?id=78">http://energymonitor-dk.dns4e.net/emoncms/boelle/feed/value.json?id=78</a></p>
</blockquote>
<p>3 -&nbsp;get the current UNIXTIME from <a href="http://www.epochconverter.com/" title="http://www.epochconverter.com/">http://www.epochconverter.com/</a></p>
<p>4 -&nbsp;enter UNIXTIME and NEWVALUE to this url (all one line) to correct the current feed value</p>
<blockquote><p><a href="http://energymonitor-dk.dns4e.net/emoncms/boelle/feed/insert.json?id=78&amp;time=UNIXTIME&amp;value=NEWVALUE">http://energymonitor-dk.dns4e.net/emoncms/boelle/feed/insert.json?id=78&amp;time=UNIXTIME&amp;value=NEWVALUE</a></p>
</blockquote>
<p>5 -&nbsp;start emonhub with</p>
<blockquote><p>sudo service emonhub start</p>
</blockquote>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24768"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Fri, 24/10/2014 - 11:08.</div>
    <div class="content">
     <p>well i might as well reset the kwh feed...</p>
<p>&nbsp;</p>
<p>just a shame that timeseres can not be edited from phpmyadmin :-/</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24770"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Fri, 24/10/2014 - 11:19.</div>
    <div class="content">
     <p>watt and kwh feed cleared of datapoints...</p>
<p>&nbsp;</p>
<p>but for the next update i suggest a fix of some sorts that prevents this from happening again.. i might not benefit from that as i have taken measure&nbsp;against the need to reboot at all if just the wifi drops.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24773"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: feed suddenly negative</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Fri, 24/10/2014 - 11:54.</div>
    <div class="content">
     <p>Hi boelle,</p>
<p>Yes. you will need to delete the feed or &quot;just correct from now&quot; and ignore the incorrect data. The penny has just dropped, as you are using the &quot;buffered write&quot; emoncms you cannot edit or delete past data, that was all disabled to achieve the low write levels required. you can only append data to the feed due to buffering.</p>
<p>The time issue is unfortunate, ntp-backup&nbsp;should fix it and hopefully it will get used in future read-only images too.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/5961"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-CDZaBpF90gMm8LNu1-WvSTcu7_uWFZ5NDX0RVM54EPI" value="form-CDZaBpF90gMm8LNu1-WvSTcu7_uWFZ5NDX0RVM54EPI"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
