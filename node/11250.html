<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11250 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:58:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Mosquitto / EmoncmsNode not running | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Mosquitto / EmoncmsNode not running</h3>
        <span class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Sun, 13/09/2015 - 09:38</span>
        <div class="content"><p>As per the title:</p>
<p>&nbsp;</p>
<p>pi@emonpi /var/lib/mosquitto $ sudo service feedwriter status<br />
Log is turned off<br />
running</p>
<p>&nbsp;</p>
<p>pi@emonpi /var/lib/mosquitto $ sudo service emoncms-nodes-service status<br />
Log is turned off<br />
stopped</p>
<p>starting emoncms-modes-service&nbsp;&amp; then checking:</p>
<p>pi@emonpi /var/lib/mosquitto $ sudo service emoncms-nodes-service start<br />
Log is turned off<br />
Starting emoncms-nodes<br />
pi@emonpi /var/lib/mosquitto $ sudo service emoncms-nodes-service status<br />
Log is turned off<br />
stopped</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>pi@emonpi /var/lib/mosquitto $ sudo service mosquitto status<br />
[FAIL] mosquitto is not running ... failed!<br />
pi@emonpi /var/lib/mosquitto $</p>
<p>&nbsp;</p>
<p>starting mosquitto&nbsp;&nbsp;&amp; then checking:</p>
<p>pi@emonpi /var/lib/mosquitto $ sudo service mosquitto start<br />
[ ok ] Starting Mosquitto message broker: mosquitto.<br />
pi@emonpi /var/lib/mosquitto $ sudo service mosquitto status<br />
[FAIL] mosquitto is not running ... failed!<br />
pi@emonpi /var/lib/mosquitto $</p>
<p>&nbsp;</p>
<p>I had, on the same raspi also openhab&nbsp;instance (and it was working)&nbsp;but in order to avoid interferences I removed it from init.d startup sequence.</p>
<p>So the emonpi should be running without whatsoever interference</p>
<p>Any help is welcome</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11309.html" class="topic-previous" title="Go to previous forum topic">‹ Sct013-005 , unexpected results</a>
              <a href="11304.html" class="topic-next" title="Go to next forum topic">Error after upgrading from PHP 5.3 to PHP 5.5 (also Apache 2.2 to 2.4) ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-34104"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Sun, 13/09/2015 - 09:41.</div>
    <div class="content">
     <p>Additionally, but I guess it is simply a consequence, I have no power reading on the emonpi&nbsp;lcd display.</p>
<p>Is there a log to be checked for mosquitto startup</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34105"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Sun, 13/09/2015 - 09:52.</div>
    <div class="content">
     <p>
2015-09-13 11:49:42,226 INFO MQTT Connecting to MQTT Server 2015-09-13 11:49:42,239 INFO MQTT Could not connect...</p>
<p>2015-09-13 11:49:43,136 DEBUG RFM2Pi 48 NEW FRAME : OK 5 29 5 112 1 141 6 117 96 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 (-0) 2015-09-13 11:49:43,139 DEBUG RFM2Pi 48 Timestamp : 1442137783.14 2015-09-13 11:49:43,140 DEBUG RFM2Pi 48 From Node : 5</p>
<p>2015-09-13 11:49:43,141 DEBUG RFM2Pi 48 Values : [1309, 368, 1677, 246.93, 0, 0, 0, 0, 0, 0, 0] 2015-09-13 11:49:43,142 DEBUG RFM2Pi 48 adding frame to buffer =&gt; [1442137783, 5, 1309, 368, 1677, 246.93, 0, 0, 0, 0, 0, 0, 0] 2015-09-13 11:49:43,143 DEBUG RFM2Pi 48 Sent to channel&#39; : ToEmonCMS 2015-09-13 11:49:43,341 INFO MQTT Connecting to MQTT Server</p>
<p>2015-09-13 11:49:43,360 INFO MQTT Could not connect...</p>
<p>2015-09-13 11:49:44,477 INFO MQTT Connecting to MQTT Server 2015-09-13 11:49:44,479 INFO MQTT Could not connect... 2015-09-13 11:49:45,594 INFO MQTT Connecting to MQTT Server</p>
<p>2015-09-13 11:49:45,597 INFO MQTT Could not connect...</p>
<p>2015-09-13 11:49:46,699 INFO MQTT Connecting to MQTT Server</p>
<p>2015-09-13 11:49:46,702 INFO MQTT Could not connect...</p>
<p>2015-09-13 11:49:47,804 INFO MQTT Connecting to MQTT Server</p>
<p>2015-09-13 11:49:47,807 INFO MQTT Could not connect... 2015-09-13 11:49:48,196 DEBUG RFM2Pi 49 NEW FRAME : OK 5 11 5 98 1 109 6 22 97 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 (-0)<br />
...</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34108"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Sun, 13/09/2015 - 10:20.</div>
    <div class="content">
     <p>Just checked that mosquitto.pid was there in /var/run hence init.d ran it.</p>
<p>changed it&#39;s name&nbsp;</p>
<p>restarted the service using sudo service restart mosquitto.</p>
<p>pi@emonpi /var/run $ sudo service mosquitto start<br />
[ ok ] Starting Mosquitto message broker: mosquitto.<br />
pi@emonpi /var/run $ sudo service mosquitto status<br />
[FAIL] mosquitto is not running ... failed!</p>
<p>&nbsp;</p>
<p>new mosquitto.pid was however written in /var/run</p>
<p>so I suppose either it starts &amp; dies or the pid file is written before server launch (doh)</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34127"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Sun, 13/09/2015 - 22:25.</div>
    <div class="content">
     <p>I checked everything I could imagine.... help!</p>
<p>I see the values are read from the clamps (I can see W values in the log) but due to MQTT not working there&#39;s no pub/sub - transmission</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34145"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Mon, 14/09/2015 - 21:12.</div>
    <div class="content">
     <p>Up for help.<br />
Please</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34147"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 14/09/2015 - 21:54.</div>
    <div class="content">
     <p>Is there any more info in emoncms.log ? it looks like &quot;emoncms-nodes-service&quot; isn&#39;t runnig either.</p>
<p>Have you looked in /var/log/syslog&nbsp;or /var/log/messages or any of the other log files?</p>
<p>rather than trawling back through the logs open a few ssh windows and &quot;tail -f&quot; the log&nbsp;files&nbsp;and watch them while you try and start mosquitto and/or emoncms-nodes-service in another window.</p>
<p>When did it work last? and what have you done to the image since then?</p>
<p>Were you using a stock image prior to installing openHab? was it up to date?</p>
<p>Have you changed any mosquitto&nbsp;settings? firewall settings?&nbsp;</p>
<p>It&#39;s not a straight forward or common problem so any relevant&nbsp;info would help us help you. You need to retrace your steps since it was working as there is a reasonable chance it is something you have done rather than an organic issue.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34148"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 14/09/2015 - 21:59.</div>
    <div class="content">
     <p>Also, in /etc/mosquitto/mosquitto.conf you could set &quot;log_dest&nbsp;syslog&quot; (currently &quot;none&quot;) and &quot;log_mode debug&quot; to output some logging via /var/log/syslog. don&#39;t try to set other locations as that will introduce more starting errors due to permission issues and the RO filesystem. However this may not be fruitful as the broker needs to run long enough to log something.</p>
<p>Paul&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34172"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Tue, 15/09/2015 - 19:52.</div>
    <div class="content">
     <p>Hi Paul thanks for answering first of all</p>
<p>Is there any more info in emoncms.log ? it looks like &quot;emoncms-nodes-service&quot; isn&#39;t runnig either.</p>
<p>I confirm that &nbsp;emoncms-nodes-service is not running either.</p>
<p>&nbsp;</p>
<p>Have you looked in /var/log/syslog&nbsp;or /var/log/messages or any of the other lof files?</p>
<p>&gt;&gt;Yes.</p>
<p>rather than trawling back through the logs open a few ssh windows and &quot;tail -f&quot; the log&nbsp;files&nbsp;and watch them while you try and start mosquitto and/or emoncms-nodes-service in another window.</p>
<p>&gt;&gt;Good idea. syslog and message? I will start from there</p>
<p>When did it work last? and what have you done to the image since then?</p>
<p>&gt;&gt;Before a reboot one night. Since then the image was not touched anyway really due to the problem.</p>
<p>Were you using a stock image prior to installing openHab? was it up to date?</p>
<p>&gt;&gt;Yes just added samba, dnsclient and openhab.&nbsp;and Yes it was uptodate</p>
<p>Have you changed any mosquitto&nbsp;settings? firewall settings?&nbsp;</p>
<p>&gt;&gt;No for mosquitto.</p>
<p>&gt;&gt;Yes for the FW: opened ports for Samba</p>
<p>It&#39;s not a straight forward or common problem so any relevant&nbsp;info would help us help you. You need to retrace your steps since it was working as there is a reasonable chance it is something you have done rather than an organic issue.</p>
<p>&gt;&gt; Yes I understand that and am trying to trace things. It was working since a while with openhab and samba enabled.&nbsp;</p>
<p>If I cannot trace the cause I will buy a separate PI2 for openhab&nbsp;:-(. I hope that just putting the stock image on the SD and rebooting will fix the issue (I bought from the kickstarter launch and the sd was included in the bundle)</p>
<p>&nbsp;</p>
<p>TX again</p>
<p>&nbsp;</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34173"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Tue, 15/09/2015 - 20:02.</div>
    <div class="content">
     <p>While I issue&nbsp;</p>
<p>pi@emonpi ~ $ sudo service emoncms-nodes-service restart<br />
Log is turned off<br />
Restarting emoncms-nodes (nodes_mqtt_process.php was not running...)<br />
pi@emonpi ~ $ sudo service emoncms-nodes-service status<br />
Log is turned off<br />
stopped</p>
<p>&nbsp;</p>
<p>this is emoncms.log tail</p>
<p>2015-9-15 22:00:18 FEEDWRITER INFO PHPFina bytes written: 0<br />
2015-9-15 22:01:06 MQTT INFO Starting emoncms mqtt nodes process<br />
2015-9-15 22:01:18 FEEDWRITER INFO PHPTimeSeries bytes written: 0<br />
2015-9-15 22:01:18 FEEDWRITER INFO PHPFina bytes written: 0<br />
2015-9-15 22:02:18 FEEDWRITER INFO PHPTimeSeries bytes written: 0<br />
2015-9-15 22:02:18 FEEDWRITER INFO PHPFina bytes written: 0</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34174"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Tue, 15/09/2015 - 20:03.</div>
    <div class="content">
     <p>Well... i bought an extra pi2</p>
<p>Better not mixing stuff.</p>
<p>Will simply the img put on the sd reset the emonpi?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34194"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 16/09/2015 - 13:40.</div>
    <div class="content">
     <p>I would of at&nbsp;least&nbsp;tried with a fresh image and adding the extra stuff again before buying another Pi, it may not be a compatibility issue, maybe something wasn&#39;t quite right that a re-install would fix, they should be able to run together.</p>
<p>Perhaps if we were using the latest v3.1.1&nbsp;standard instead of the old v3.1 it would help, or even an up&nbsp;to date broker.&nbsp;the apt-get installed&nbsp;mosquitto&nbsp;broker for Raspbian wheezy&nbsp;is v0.15-2 (released&nbsp;feb 2012 !!) latest for jessie is&nbsp;v1.3.4-2.(~ Aug 15) in&nbsp;a rapidly evolving tech 3 1/2 years is a long time.</p>
<p>Come on Raspbian..... Sort it out !!!!</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34203"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1894.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Ian Eagland&#039;s picture" title="Ian Eagland&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Wed, 16/09/2015 - 16:15.</div>
    <div class="content">
     <p>Latest mosquitto&nbsp;here:-</p>
<p><a href="http://mosquitto.org/2013/01/mosquitto-debian-repository" title="http://mosquitto.org/2013/01/mosquitto-debian-repository">http://mosquitto.org/2013/01/mosquitto-debian-repository</a></p>
<p>Pretty sure I installed from there with no problem.</p>
<p>Regards</p>
<p>Ian</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34211"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 16/09/2015 - 17:10.</div>
    <div class="content">
     <p>Hi Ian,</p>
<p>Yes that method will work (now). Previously it would&nbsp;only give you v3.1&nbsp;because the &quot;wheezy&quot; package was behind so to get v3.1.1 we had to use a method&nbsp;that downloaded the latest &quot;jessie&quot; version,&nbsp;but now that method doesn&#39;t work since the mqtt websockets&nbsp;now demand a dependency that is not&nbsp;compatible with &quot;wheezy&quot; and &quot;jessie&quot; isn&#39;t release stable on Raspbian&nbsp;yet despite being &quot;current&quot; on most other debian&nbsp;platforms for some months now.</p>
<p>But yes <em>currently&nbsp;</em>the best way to get up&nbsp;to date mosquitto on wheezy is via the mosquitto repo as the&nbsp;wheezy version has been brought up&nbsp;to speed.</p>
<p>It would be nice if we were all using the same version though and that is unlikely to happen until Raspbian&nbsp;get the &quot;jessie&quot; version of Raspbian sorted.</p>
<p>Paul</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34217"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Wed, 16/09/2015 - 21:45.</div>
    <div class="content">
     <p>Unfortunately ... time is a tyran. If I had a little more time I would have gone the way of the fresh reinstall and adding openhab etc on top.</p>
<p>I am pretty sure it is something stupid may be due to an unproper shutdown or more probably froma stupid thing done by me at late hour....</p>
<p>but I can work at this things just after work at night + in the long run I prefer to have the two stuffs separated so I went down the easy way...</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34218"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Wed, 16/09/2015 - 21:55.</div>
    <div class="content">
     <p>Infact&nbsp;I am sure OpenHab and EmonPi can run along without trouble.</p>
<p>They ran for one month.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34503"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Sat, 26/09/2015 - 07:52.</div>
    <div class="content">
     <p>I finally have time to unmount the emonpi from it&#39;s location.</p>
<p>Q: is there no way to reset to factory defaults (fresh cleam image) without opening the case?</p>
<p>I mean via telnet .</p>
<p>Just realized (after unmounting&nbsp;doh) that I need to access the microsd&nbsp;inside (doh doh) and I miss a special screwdriver (doh doh doh)</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34508"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Sat, 26/09/2015 - 11:36.</div>
    <div class="content">
     <p>ok unmounted and putting on latest</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34528"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Sun, 27/09/2015 - 08:46.</div>
    <div class="content">
     <p>I am still having some trouble :-(</p>
<p>namely I do not have any feeds written.</p>
<p>If I check the status of feedwriter&nbsp;it is stating that it is stopped.</p>
<p>pi@emonpi ~ $ sudo service feedwriter status<br />
Log is turned off<br />
stopped</p>
<p>&nbsp;</p>
<p>If i restart it:</p>
<p>pi@emonpi ~ $ sudo service feedwriter start<br />
Log is turned off<br />
Starting RPI<br />
pi@emonpi ~ $ sudo service feedwriter status<br />
Log is turned off<br />
stopped</p>
<p>&nbsp;</p>
<p>It does not restart!</p>
<p>Now this was after a clean install and not changing anything at all (just the timezone and log to emoncms server)</p>
<p>&nbsp;</p>
<p>What is wrong??? getting mad.</p>
<p>Love OpenSource&nbsp;and open platforms but sometimes I regret it.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34560"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Mon, 28/09/2015 - 10:59.</div>
    <div class="content">
     <p>Hello&nbsp;</p>
<p>I bump the trhread u p since I have done a brand new installation I suppose it should work :-(</p>
<p>My feedwriter&nbsp;process is still not working</p>
<p>&nbsp;</p>
<p>pi@emonpi ~ $ sudo service feedwriter start<br />
Log is turned off<br />
Starting RPI<br />
pi@emonpi ~ $ sudo service feedwriter status<br />
Log is turned off<br />
stopped</p>
<p>Can someone of the team advice ?</p>
<p>&nbsp;</p>
<p>TY in advance</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34561"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 28/09/2015 - 12:03.</div>
    <div class="content">
     <p>I&#39;m not overly familiar with that code but you could do a couple of checks like what does typing</p>
<p><strong>ps -ef&nbsp;| grep feedwriter</strong></p>
<p>​at the command&nbsp;line give you?</p>
<p>Will the feedwriter script run manually from the command line?&nbsp;(may need sudo) using</p>
<p><strong>php /var/www/emoncms/scripts/feedwriter.php</strong></p>
<p>What exactly is your &quot;fresh&quot; &quot;brand new&quot; &quot;clean&quot; installation? if it is a pre-built image, which one? are you following a guide? if self-built what versions have you installed?</p>
<p>Paul</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34565"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Mon, 28/09/2015 - 20:48.</div>
    <div class="content">
     <p>no process running:</p>
<p>pi@emonpi ~ $ ps -ef | grep feedwriter<br />
pi &nbsp; &nbsp; &nbsp; &nbsp;2288 &nbsp;2056 &nbsp;0 22:39 pts/0 &nbsp; &nbsp;00:00:00 grep --color=auto feedwriter</p>
<p>​</p>
<p>pi@emonpi ~ $ sudo php /var/www/emoncms/scripts/feedwriter.php<br />
Could not open input file: /var/www/emoncms/scripts/feedwriter.php</p>
<p>&nbsp;</p>
<p>!!</p>
<p>ls gives:</p>
<p>pi@emonpi /var/www/emoncms $ ls<br />
COPYRIGHT.txt &nbsp;default.settings.php &nbsp;index.php &nbsp;LICENSE.txt &nbsp;logconfig.xml &nbsp;process_settings.php &nbsp;route.php &nbsp;scripts &nbsp; &nbsp; &nbsp; Theme<br />
core.php &nbsp; &nbsp; &nbsp; docs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Lib &nbsp; &nbsp; &nbsp; &nbsp;locale.php &nbsp; Modules &nbsp; &nbsp; &nbsp; &nbsp;readme.md &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; run &nbsp; &nbsp; &nbsp; &nbsp;settings.php</p>
<p>&nbsp;</p>
<p>no php script!</p>
<p>&nbsp;</p>
<p>I installed the image called&nbsp;emonSD-17Jun2015&nbsp;on the SD that shipped with EmonPi.</p>
<p>I am surprised. because I have been really careful with shutdowns (always holding the button) so no abrupt endings...</p>
<p>What do you suggest?</p>
<p>&nbsp;</p>
<p>Thank for your help once again</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34566"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Mon, 28/09/2015 - 20:49.</div>
    <div class="content">
     <p>I hope not rewriting the sd as I would need to unmount the whole stuff again :-(</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34567"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 28/09/2015 - 21:05.</div>
    <div class="content">
     <p><em>&quot;pi@emonpi /var/www/emoncms $ ls<br />
COPYRIGHT.txt &nbsp;default.settings.php &nbsp;index.php &nbsp;LICENSE.txt &nbsp;logconfig.xml &nbsp;process_settings.php &nbsp;route.php &nbsp;scripts &nbsp; &nbsp; &nbsp; Theme<br />
core.php &nbsp; &nbsp; &nbsp; docs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Lib &nbsp; &nbsp; &nbsp; &nbsp;locale.php &nbsp; Modules &nbsp; &nbsp; &nbsp; &nbsp;readme.md &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; run &nbsp; &nbsp; &nbsp; &nbsp;settings.php</em></p>
<p>&nbsp;</p>
<p><em>no php script!&quot;</em></p>
<p>No but there was a &quot;scripts&quot; folder which&nbsp;is where I <em>had</em>&nbsp;expected it to be, however I just checked the repo for the emoncms&nbsp;included in that image and it should be in&nbsp;/var/www/emoncms/<strong>run </strong>for v8.5 low-write</p>
<p>so try <strong>sudo php&nbsp;/var/www/emoncms/run/feedwriter.php&nbsp;</strong>at the command line</p>
<p>and/or <strong>ls -la&nbsp;/var/www/emoncms/run&nbsp;</strong>to check it&#39;s permissions etc</p>
<p>Paul</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34568"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Mon, 28/09/2015 - 21:30.</div>
    <div class="content">
     <p>I haven&#39;t explored emonpi, but have found a bug with the feedwriter&nbsp;init&nbsp;file (as used in v9 and borrowed from emonpi) as follows;</p>
<p>Feedwriter&nbsp;does not restart on a reboot, because both feedwriter and mysql are given the same start priority - S03 in /etc/rc*.d and as feedwriter (alphabetically) comes before mysql, feedwriter starts first, resulting in the error;</p>
<pre>
2015-09-28 17:33:24.481|ERROR|feedwriter.php|Can&#39;t connect to database:Can&#39;t connect to local
 MySQL server through socket &#39;/var/run/mysqld/mysqld.sock&#39; (2)</pre><p>...which stops feedwriter starting.</p>
<p>To rectify this issue, add &#39;mysql&#39; to the dependency of the feedwriter init&nbsp;file, which<a href="https://github.com/Paul-Reed/emoncms/commit/59d910f04c85d47c71e43481be1e46f1c36c497d"> you can see on this git patch</a>, which will be offered for merge shortly.</p>
<p>The status of feedwriter can be checked by;</p>
<pre>
sudo&nbsp;service feedwriter status</pre><p>Paul</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34569"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6165.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Dvbit&#039;s picture" title="Dvbit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Mosquitto / EmoncmsNode not running</h3>

    <div class="submitted">Submitted by <a href="../user/6165.html" title="View user profile.">Dvbit</a> on Mon, 28/09/2015 - 21:50.</div>
    <div class="content">
     <p>Ok feedwriter&nbsp;is there in the scrips folder.</p>
<p>and... yep!</p>
<p>changing the script as in the patch did the trick!</p>
<p>feedwriter is now running</p>
<p>by the way visualizations (that did not work) are now working too</p>
<p>great</p>
<p>Thanks to all.</p>
<p>I suggest merging the change updating the img asap</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11250"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-3ti7KxKptv8Y_6-_laGAX6VJ3iJAwPR2zSG2pDXgAi0" value="form-3ti7KxKptv8Y_6-_laGAX6VJ3iJAwPR2zSG2pDXgAi0"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/11250 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:58:41 GMT -->
</html>
