<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/2863 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:21:26 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Newbie needs answers to some simple questions on PV Diverter  | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/3.html">Archived: General Discussion</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Newbie needs answers to some simple questions on PV Diverter </h3>
        <span class="submitted">Submitted by <a href="../user/4308.html" title="View user profile.">alandlaney</a> on Fri, 20/09/2013 - 19:51</span>
        <div class="content"><p>Hi everyone,<br />
	I&#39;m new to this site so please bear with me while I ramble on- there will be some serious but simple questions at the end.<br />
	My PV array is nominally 4kW wired as per Type 1<br />
	I am using a Eco-Eye PV system for monitoring purposes. I had this before I came across this site. It is ok for monitoring &amp; data purposes, was quickly set up &amp; worked straight away out of the box.<br />
	However like most people I want to start using all the electricity I generate &amp; not export it to the grid.<br />
	Hence I am now looking to build a mk2 solar diverter. I am currently assembling a emonTx shield - I have been messing around with arduinos for the last couple of months so have a couple lying about so it seems appropriate to use the shield. I wish to produce a diverter which will control both a local &amp; remote load.<br />
	Obviously a lot of development &amp; improvement has gone on over the last months &amp; years resulting in many different versions of software &amp; sketches.<br />
	For someone joining the forum at this stage, the vast number of threads (discussing various versions of anti-flicker &amp; interrupt based sketches for instance) is somewhat bewildering- some of these have up to&nbsp;217 replies!!. I am slowly getting to understand more &amp; more but would just like to clarify a few simple points:-</p>
<p>1) Do I need a voltage measurement - says on main solar PV page that this is not required for Type 1 installation - however most of the systems used for solar PV diverters seem to have one. I believe the voltage measurement is used within the sketch for calculation purposes.<br />
	2) I only need 2 current sensor inputs so can I leave off the other 2 sockets &amp; associated resistors etc. from the emonTx shield?<br />
	3) As I am using emon Tx shield it says I need to modify sketch slightly to accommodate &quot;The different input configuration&quot; - where do I find these corrections ? - there only seems to be one version of each sketch published - s<br />
	3) there seem to have been many different updates &amp; improvements in the software&nbsp; over the last few months. I presume the latest suitable for my needs is Mk2i_PV_Router_rev5b.ino<br />
	4) How do I get hold of the triac pcb&#39;s / kits? I have tried to pm Richmc a couple of times but had no reply.&nbsp; Is he away at present?<br />
	5) Instead of a local &amp; remote load could I just have 2 remote loads? My nearest &quot; local&quot;&nbsp; load is a long way away from the emonTx &amp; fuse board, can I just link it using rfm12B like the remote load?<br />
	6) Is it possible to control multiple loads yet?</p>
<p>Thanks for taking the time to answer these simple questions, they will clarify a few matters for me.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="2880.html" class="topic-previous" title="Go to previous forum topic">‹ Small Photovoltiac + Rpi Science Experiment</a>
              <a href="2825.html" class="topic-next" title="Go to next forum topic">Help putting together electricity monitoring/billing system ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-15323"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Newbie needs answers to some simple questions on PV Diverter </h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Fri, 20/09/2013 - 20:39.</div>
    <div class="content">
     <p>1. Yes, voltage measurement is necessary to know the direction of power flow, because the power is measured at the grid connection where the direction reverses. See <a href="https://learn.openenergymonitor.org/?redirect=ac-power-introduction">here</a>. Type 1 measures the current where the power flow direction is known (actually not true, it gives wrong answers because the inverter consumes a small amount of power when idle!)</p>
<p>2. Yes, they are redundant. But maybe not in the future, but it should be easy enough to add them later if required.</p>
<p>3.1. It&#39;s a simple matter of the designation of the various inputs. On the Shield, the voltage input is AI 0 and the c.t&#39;s are AI 1-4 in order. So all you need to change are the values for voltageSensorPin and&nbsp;currentSensorPin. But depending on whether and how many LEDs you have, you might have to change those as well!</p>
<p>3.2. As far as I know, all the versions do the same basic job, both Robin&#39;s (calypso_rae) and MartinR&#39;s. Robin&#39;s though have the remote load already included.</p>
<p>4. The last we heard, Richmc was poorly and in hospital, but hoping to fulfil orders when he&#39;s sufficiently recovered. It&#39;s possible, but not so neat, to build the controller without his kit. You can use the standard Shield and AC Adapter for the controller itself. Alternatively (and I appreciate you&#39;ve already bought an emonTx Shield), for the remote load switches you could use the emonTx itself with a strip-board sub-assembly for the opto-trigger and triac.</p>
<p>5. I don&#39;t see why not (though Robin may well chip in with his thoughts).</p>
<p>6. In principle, again I don&#39;t see why not, but deciding your control algorithm and trimming it to operate within the various constraints could be trickier as the number of loads increases.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-15325"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Newbie needs answers to some simple questions on PV Diverter </h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Fri, 20/09/2013 - 21:32.</div>
    <div class="content">
     <p>Hi Alan, delighted to hear you&#39;re intending to build a Mk2 Router.&nbsp; All versions of the code will run on the same hardware so you may be best to start with a simple one such as <strong>Mk2_PV_Router_mini_3.ino</strong>.&nbsp; It will heat your water just as well as any of the more complex later versions, and will be much easier to understand.&nbsp; Looking quickly through your list:</p>
<p>1. Yes, you will indeed need to measure AC voltage, it&#39;s right at the core of the Mk2 Diverter&#39;s logic.</p>
<p>2. You will only need to populate one of the current sensors.&nbsp; Any of them will do, you can then amend the pin allocation in the sketch to match.&nbsp; On the emonTx, AIO1 corresponds with CT3.&nbsp; On the emonTx Shield, I believe that AIO 1 is CT1.&nbsp; But do please check in the OEM documentation for the Shield which I&#39;ve never used.</p>
<p>3. All of my Mk2 sketches are intended for an Arduino, but they run just as well on an emonTx.&nbsp; When using the Shield, the only lines that you may need to change are for the pin allocations for the voltage and current sensor.&nbsp; But only one character on each line, so no worries!</p>
<p>4.&nbsp; The last we heard of Rich was that he was unwell, we wish him a speedy return.&nbsp; To build a basic Mk2 rig, you shouldn&#39;t need his front-end PCB because all the necessary circuits are on the shield.&nbsp; Instructions for making the output stage using stripboard are available in Section 8 of the online guide.&nbsp; Triacs and triggers etc are readily available from Spiratronix.&nbsp; If you&#39;d like a working strip-board version with triac etc, send me a PM, I have a few spare here.&nbsp; If you were to become my first <a href="2857.html">heatsink</a> customer, I&#39;ll throw in an output stage for free!</p>
<p>5.&nbsp; The rev5 version of Mk2i can control any number of loads, I just happen to have configured one of them to operate via an RF link.&nbsp; Operating two loads via RJ45 cable or similar is no problem; operating two loads independantly via RF would take a bit more thought.&nbsp; If required, it should be easy enough to include a loadNumber field in the RF payload.&nbsp; Each message could then be processed by the intended load .&nbsp; Then there would be no need to change any of the Node Id fields etc.</p>
<p>6. rev5 has always been able to control multiple loads, the only limitation is the number of pins on the processor.&nbsp; This logic can be seen working in my&nbsp; <a href="1757.html">FlickerDemoMultiload_2</a> sketch</p>
<p>Hope this helps.</p>
<p>PS.&nbsp; At risk of repetition, do please make use of the basic tools at the top of my Summary Page.&nbsp;&nbsp; Running <strong>MinMaxAndRangeChecker.ino</strong> and <strong>RawSamplesTool_4ss_2.ino</strong> will confirm the state of your new hardware in just a few minutes.&nbsp; If all is not well, you save a lot of time/effort by fixing any basic problems at this early stage.&nbsp; Posted results from these tools should be relatively straightforward to diagnose.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-15326"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Newbie needs answers to some simple questions on PV Diverter </h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Fri, 20/09/2013 - 21:33.</div>
    <div class="content">
     <p>Cheers Robert, you obviously type faster than me :)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-15438"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4308.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="alandlaney&#039;s picture" title="alandlaney&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Newbie needs answers to some simple questions on PV Diverter </h3>

    <div class="submitted">Submitted by <a href="../user/4308.html" title="View user profile.">alandlaney</a> on Fri, 27/09/2013 - 09:02.</div>
    <div class="content">
     <p>Thanks for your help Robin &amp; Robert.</p>
<p>just a couple of questions arising from your answers.</p>
<p>2) &quot;You will only need to populate one of the current sensors&quot; - does this mean I only need one current sensor?</p>
<p>Both type 1 &amp; 2 show two current sensors.</p>
<p>Where is this sensor placed? Is it between utility meter &amp; &nbsp;junction box?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-15442"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Newbie needs answers to some simple questions on PV Diverter </h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Fri, 27/09/2013 - 09:59.</div>
    <div class="content">
     <p>But you&#39;re not making a monitor! You need 2 c.t&#39;s when you want to know separately the imported power, the generated power and the consumed power (or energies of course). You have your other system for that. If you are only controlling the dump load, then you need only one c.t. that measures the nett power flow in the connection to your supply, so the c.t. goes on the supply side of the point where the PV feeds in. On the main meter tail is probably the convenient place.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-15448"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Newbie needs answers to some simple questions on PV Diverter </h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Fri, 27/09/2013 - 14:11.</div>
    <div class="content">
     <p>Agreed.&nbsp; A Mk2 diverter needs one voltage sensor, and one CT which needs to go next to your supply meter.&nbsp; During periods of surplus power, the Mk2&#39;s logic can then stay one step ahead of your meter so that no surplus power is lost, nor are you charged for any diverted energy.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-15460"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4308.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="alandlaney&#039;s picture" title="alandlaney&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Newbie needs answers to some simple questions on PV Diverter </h3>

    <div class="submitted">Submitted by <a href="../user/4308.html" title="View user profile.">alandlaney</a> on Sat, 28/09/2013 - 09:47.</div>
    <div class="content">
     <p>Are we measuring current on live or neutral line?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-15462"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Newbie needs answers to some simple questions on PV Diverter </h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 28/09/2013 - 11:46.</div>
    <div class="content">
     <p>The names of the conductors are LINE and NEUTRAL, both are &quot;live&quot; when connected to the supply. Please yourself which you use; if they are not carrying the same current, there is something seriously wrong with your installation. You might get slightly more voltage pickup ( = unwanted interference) onto the analogue input with the c.t. on the line, so if there&#39;s a choice the neutral might give less inaccuracies at very low or no currents. Normally, I wouldn&#39;t expect you to be able to find any difference.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/2863"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-cBEVDFTTq1MP3k-831IiEXIOhfmkEmBvUFBxXUlzG_U" value="form-cBEVDFTTq1MP3k-831IiEXIOhfmkEmBvUFBxXUlzG_U"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
