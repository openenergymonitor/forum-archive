<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>EmonTx v3 set up problems [solved] | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/emon/sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="/emon/modules/node/node.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/defaults.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/system.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/system-menus.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/user/user.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/modules/mollom/mollom.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/forum/forum.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/modules/views/css/views.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/comment/comment.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/themes/emon3/style.css?r" />
<style type="text/css" media="all">@import "/emon/sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="/emon/" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="/emon/">Home</a> » <a href="/emon/forum">Forums</a> » <a href="/emon/forum/6">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">EmonTx v3 set up problems [solved]</h3>
        <span class="submitted">Submitted by <a href="/emon/user/3862" title="View user profile.">GJPickard</a> on Sat, 21/12/2013 - 14:50</span>
        <div class="content"><p>I have finally gotten around to putting together&nbsp;my emonTx V3&nbsp;(RFM12B&nbsp;@ 433, one CT sensor, one&nbsp;DS18B20 and using the AC-AC adapter).</p>
<p>Putting it together was nice and straightforward, my problems have started when trying to get it up and running. &nbsp;I can download the latest firmware to the emonTx via a usb/FTDI&nbsp;cable but nothing seems to happen apart from the LED staying on. I have the CT sensor plugged in (have tried ports 1 - 3) (I spotted the post about needing it plugged in).</p>
<p>I would class myself as I skilled &quot;cut and paste&quot;r but a long way off from being able to code from scratch.</p>
<p>I just cannot seem to get any debug info from the sketch - how do I set the debug flag to &quot;1&quot; so I can force the debug info just in case the emonTx is having issues in spotting my generic FTDI cable?</p>
<p>I have downloaded a blink example and also a DS18B20 test sketch and both seem to be working fine and feeding inf to the Arduino IDE&nbsp;serieal&nbsp;window so the core Rfu238 looks to be OK.</p>
<p>I have also tried a couple of the other emonTx sketch examples and they seem to run OK (at last I get some serial window info) but I do not seem to get any transmissions.</p>
<p>I am pretty sure that I have the group/node set up OK (on the default&nbsp;group 210 and have tried a few node IDs).</p>
<p>I currently have 2 of Martin Harizanov&#39;s&nbsp;Funky 2s sending temperature data to a Raspberry Pi (RFM12pi v2) which is running the V6&nbsp;SD card image.</p>
<p>I am now a bit stuck and am starting think the RFM12 might have an issue:</p>
<p>1. &nbsp;Is there a simple emonTx transmit sketch&nbsp;I can download to see if I can get something broadcasting?</p>
<p>2. &nbsp;Is there a test I can do to see if the RFM12 is the issue?</p>
<p>Thanks in advance</p>
<p>Gary P</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="/emon/node/1371" class="topic-previous" title="Go to previous forum topic">‹ Arduino energy monitor: strange output values</a>
              <a href="/emon/node/3401" class="topic-next" title="Go to next forum topic"> input processing for Euro currency KWh + KWh/d ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-16944"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTx v3 set up problems [solved]</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sat, 21/12/2013 - 15:45.</div>
    <div class="content">
     <p>Did your emonTx V3 work &quot;out of the box&quot;? It should have had the standard &quot;discreteSampling&quot; sketch loaded.</p>
<p>As you&#39;ve obviously overwritten that, it&#39;s not a lot of help now. The easy way to force the serial output on is to insert a line immediately after &quot;if (Serial) debug = 1; else debug=0;&quot;</p>
<p class="rteindent1">debug = 1;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16949"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3862" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="GJPickard&#039;s picture" title="GJPickard&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTx v3 set up problems [solved]</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3862" title="View user profile.">GJPickard</a> on Sat, 21/12/2013 - 20:21.</div>
    <div class="content">
     <p>Robert</p>
<p>Thank you for the quick reply.</p>
<p>I was just getting the solid LED out of the box, hence the update of the firmware.</p>
<p>I have added in the &quot;debug=1;&quot; but still nothing came up in the serial monitor.&nbsp; I have tried a couple of resets just in case that kicks it in to action. Again, still just the solid red led.</p>
<p>Is there a simple sketch kicking round just to trigger the radio?</p>
<p>Many thanks</p>
<p>Gary</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16953"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/924" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTx v3 set up problems [solved]</h3>

    <div class="submitted">Submitted by <a href="/emon/user/924" title="View user profile.">Robert Wall</a> on Sat, 21/12/2013 - 23:09.</div>
    <div class="content">
     <p>Not that I know of. The V3 has only just been released, so you&#39;re in the vanguard. It&#39;s time to learn some programming!</p>
<p>Start by making a copy of the sketch you&#39;re using which I think is &quot;emonTxV3_RFM12B_DiscreteSampling.ino&quot;, then let&#39;s first prove that it is the radio that&#39;s holding everything up. You need to take out these lines / sections (doing it this way because I know that the radio can fail to complete its set up and there it hangs):</p>
<p class="rteindent1">rf12_initialize(nodeID, freq, networkGroup);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // initialize RFM12B<br />
	&nbsp;&nbsp; for (int i=0; i&lt;10; i++)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Send RFM12B test sequence (for factory testing)<br />
	&nbsp;&nbsp; {<br />
	&nbsp;&nbsp;&nbsp;&nbsp; emontx.power1=i;<br />
	&nbsp;&nbsp;&nbsp;&nbsp; rf12_sendNow(0, &amp;emontx, sizeof emontx);<br />
	&nbsp;&nbsp;&nbsp;&nbsp; delay(100);<br />
	&nbsp;&nbsp; }<br />
	&nbsp; rf12_sendWait(2);<br />
	&nbsp; emontx.power1=0;<br />
	&nbsp; rf12_sleep(RF12_SLEEP);</p>
<p>and down near the bottom:</p>
<p class="rteindent1">send_rf_data();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // *SEND RF DATA* - see emontx_lib</p>
<p>If it now puts the LED on for 10 s then flashes it 10 times, we know it stuck somewhere inside that first piece of code you took out, and it should now print to the serial port that the RF is 433 MHz etc - it&#39;s lying! And then it should carry on working normally except of course nothing will come over the radio link.</p>
<p>If that&#39;s the case (and it&#39;s a brand new V3 from the shop) then email the shop and let them know. (Is your RF&micro; on headers or soldered in?) It might be worth checking the soldering on the RFM12 module first - with a powerful magnifying lens look for bad joints and whiskers of solder. N.B. There&#39;s one connection not soldered - you can just see it on the picture on this page: <a href="http://openenergymonitor.org/emon/modules/emonTxV3" title="http://openenergymonitor.org/emon/modules/emonTxV3">http://openenergymonitor.org/emon/modules/emonTxV3</a>.</p>
<p>Why I&#39;m pretty sure it&#39;s in there: Look for lines like &quot;digitalWrite(LEDpin,HIGH);&quot;&nbsp; That puts the LED on, &quot;LOW&quot; puts it off. The Led is turned on immediately before that block of code, and if it sticks in there, the LED never goes off. If that code isn&#39;t there it delays for 10 s here: &quot;Sleepy::loseSomeTime(10000)&quot; (that&#39;s 10,000 mS) then it turns the LED off. Then a bit further down it does a loop 10 times and the LED is on for 200 ms and off for 300 ms.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16960"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/10" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTx v3 set up problems [solved]</h3>

    <div class="submitted">Submitted by <a href="/emon/user/10" title="View user profile.">glyn.hudson</a> on Sun, 22/12/2013 - 11:25.</div>
    <div class="content">
     <p>I will send you a replacement RFu328 + RFM12B to see if this fixes the issue. Please post result on the thread.</p>
<p>Cheers, &nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16967"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3862" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="GJPickard&#039;s picture" title="GJPickard&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTx v3 set up problems [solved]</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3862" title="View user profile.">GJPickard</a> on Sun, 22/12/2013 - 14:05.</div>
    <div class="content">
     <p>Glynn</p>
<p>Thank you, you don&#39;t get customer service like this many places - will let you know as soon as I can.&nbsp; Did you want the current want sent back so you can have a look at it?</p>
<p>By the way, the emonTH standard sketch was a great help in cobbling together a moteino based&nbsp; temperature monitor using a DHT11 for the moment.&nbsp; The comments were a great help in working out the bits I needed to tweak to use the standard Jeelib library.&nbsp; I have added a copy in case anyone else might find this useful.&nbsp; I also knocked together a quick barebones sketch for the Tx to check the temp sensor when I was troubleshooting.</p>
<p>Have a great Christmas</p>
<p>Gary</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-17016"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3862" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="GJPickard&#039;s picture" title="GJPickard&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTx v3 set up problems [solved]</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3862" title="View user profile.">GJPickard</a> on Wed, 25/12/2013 - 20:53.</div>
    <div class="content">
     <p>Glynn</p>
<p>Brilliant customer service - the replacement Rfu module arrived yesterday and have just managed to give it a go and it is working flawlessly - now to get some feeds sorted out.</p>
<p>I had a go at touching up the soldering on the original RFM12B connections but no luck - I suspect the RFM12B is defective.</p>
<p>Once again, some great customer service.</p>
<p>Gary</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="/emon/node/3385"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-lsXY79DSh_AhEPSvghPvjGenaACbMjO4eAEMPVtvWBg" value="form-lsXY79DSh_AhEPSvghPvjGenaACbMjO4eAEMPVtvWBg"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org">https://community.openenergymonitor.org</a></p>
   
</div>

<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
