<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/12411 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:47:38 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>emoncms.log Time incorrect | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">emoncms.log Time incorrect</h3>
        <span class="submitted">Submitted by <a href="../user/3623.html" title="View user profile.">manicmoddin</a> on Sun, 27/03/2016 - 19:33</span>
        <div class="content"><p>Hi All.</p>
<p>I have been chasing dow a tricky bug and think i have finally reached the solution, however after looking through the emoncms.log file this morning after the backup script ran, I see that the times are not 1 hour behind.</p>
<p>I am using a home Linux PC to log all of the data on and the I have got my backup script appending a line into the emoncms.log file when it does things so that I can investigate.</p>
<p>I am guessing that the cause of this is now we have entered BST, so the php script will need updating, but where do I begin?</p>
<p>Jimmy</p>
  <div class="forum-topic-navigation clear-block">
          <a href="3611.html" class="topic-previous" title="Go to previous forum topic">‹ Is there a way to bypass username and password logon for emoncms on RPi?</a>
              <a href="12388.html" class="topic-next" title="Go to next forum topic">New &#039;Graph&#039; Data Viewer - SORTED ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-40665"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.log Time incorrect</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Sun, 27/03/2016 - 20:37.</div>
    <div class="content">
     <p>Hello Jimmy, you should not need to edit any scripts to deal with BST. Could it be time settings related on your computer?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40675"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3623.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="manicmoddin&#039;s picture" title="manicmoddin&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.log Time incorrect</h3>

    <div class="submitted">Submitted by <a href="../user/3623.html" title="View user profile.">manicmoddin</a> on Mon, 28/03/2016 - 13:56.</div>
    <div class="content">
     <p>Hi,</p>
<p>I thought that as well, However please see the attached homeserv.txt</p>
<p>I have broken the document into logical sections.</p>
<p>First is me running the timezone configurer and its output (Europe / London)</p>
<p>Then the emoncms.log<br />
Before writing anything to it with the new timezone.</p>
<p>Note the 06:18:44.005 Disconnect, then the INFO after that at 7:18<br />
Then the restart of the MQTT_INput script again at 6:18</p>
<p>The next section is me just writing to the emoncms with the php page, so I restarted the MQTT_INPUT service<br />
This still prints the time in UTC</p>
<p>The dbBackup appends the emoncms.log directly from bash, (echo &quot;Some Text&quot; | tee -a /var/log/emoncms.log /var/log/dbBackup.log)</p>
<p>Its not the end of the world, today was the first day that the backup script worked as it should, so I&#39;m very happy about that as I have 5GB of feed data and the mysqldump method is a nightmare on everything, 30+ min downtime to backup on a morning. Using percona Xtrabackup I have &lt;30 seconds of missed feeds, If I move that to 2-3AM It wont be anything to worry about at all.</p>
<p>&nbsp;</p>
<p>Oh and incase it matters the system details are</p>
<pre>
Server Information

Emoncms Version 9.4 | 2016.03.15

Server OS Linux 3.13.0-79-generic

Host homeserv homeserv.localdomain (127.0.1.1)

Date 2016-03-28 14:54:45 BST

Uptime 14:54:46 up 9 days, 15 min, 3 users, load average: 1.02, 0.90, 0.97

HTTP Server Apache/2.4.7 (Ubuntu) HTTP/1.1 CGI/1.1 80

Database Version MySQL 5.5.47-0ubuntu0.14.04.1

Host localhost (127.0.0.1)

Date 2016-03-28 14:54:45 (UTC 01:00&zwnj;​)

Stats Uptime: 782709 Threads: 3 Questions: 8136554 Slow queries: 0 Opens: 380 

Flush tables: 21 Open tables: 33 Queries per second avg: 10.395

MQTT Version n/a

Host localhost:1883 (127.0.0.1)

PHP Version 5.5.9-1ubuntu4.14 (Zend Version 2.5.0)

Modules Core   date   ereg   libxml   openssl   pcre   zlib   bcmath   bz2   calendar   ctype   dba   dom   hash   fileinfo   filter   ftp   gettext   SPL   iconv   mbstring   session   posix   Reflection   standard   shmop   SimpleXML   soap   sockets   Phar   exif   sysvmsg   sysvsem   sysvshm   tokenizer   wddx   xml   xmlreader   xmlwriter   zip   apache2handler   PDO   curl   gd   json   mosquitto   mysql   mysqli   pdo_mysql   readline   redis   mhash   Zend OPcache  </pre>         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40676"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3623.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="manicmoddin&#039;s picture" title="manicmoddin&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.log Time incorrect</h3>

    <div class="submitted">Submitted by <a href="../user/3623.html" title="View user profile.">manicmoddin</a> on Mon, 28/03/2016 - 14:11.</div>
    <div class="content">
     <p>Interestingly though, creating a php page with the following code</p>
<p>&nbsp;</p>
<pre>
&lt;?php

echo date(&quot;H:m:s&quot;);

?&gt;</pre><p>
and running it with</p>
<pre>
php date.php</pre><p>returns the correct time: 15:03:16</p>
<p>&nbsp;</p>
<p>Hmmm... What generates the date timmestamp for emoncms.log?</p>
<p>&nbsp;</p>
<p>Jimmy</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40677"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3623.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="manicmoddin&#039;s picture" title="manicmoddin&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.log Time incorrect</h3>

    <div class="submitted">Submitted by <a href="../user/3623.html" title="View user profile.">manicmoddin</a> on Mon, 28/03/2016 - 14:21.</div>
    <div class="content">
     <p>Ok I found it, its in Lib/EmonLogger.php Line 69</p>
<pre>
$now = DateTime::createFromFormat(&#39;U&#39;, (int)$now); // Only use UTC for logs</pre><p>Its hard written into the logging script,</p>
<p>I&#39;ll adapt my backup script to match...</p>
<p>&nbsp;</p>
<p>Jimmy</p>
<pre>
&nbsp;</pre>         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/12411"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-0fgfmgSFwtC9S--EOjaL0dxYx5dgUWrI_9M-titB2Ng" value="form-0fgfmgSFwtC9S--EOjaL0dxYx5dgUWrI_9M-titB2Ng"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
