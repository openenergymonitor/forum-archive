<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/6370 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:46:47 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Automated Test Framework for Unit, integration and system test? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Automated Test Framework for Unit, integration and system test?</h3>
        <span class="submitted">Submitted by <a href="../user/7416.html" title="View user profile.">andreasm_dk</a> on Sat, 27/12/2014 - 19:01</span>
        <div class="content"><p>Hi,</p>
<p>I need to do a unit test for the EmonLib&nbsp;C++ class.</p>
<p>I was thinking about the Boost framework, but I would like to hear what experiences there is out there with various test automation frameworks in relation to the OEM project and EmonLib in particular.</p>
<p>I am new to the OEM Project however I did stumble on a defect.</p>
<p><a href="https://github.com/openenergymonitor/EmonLib/issues/11" title="https://github.com/openenergymonitor/EmonLib/issues/11">https://github.com/openenergymonitor/EmonLib/issues/11</a></p>
<p>I prefer to make test cases, when defects are found. Both for the broken functionality, but also for the functionality to be preserved after the codechanged.</p>
<p>I can&#39;t seem to find any automated test for the OEM project.</p>
<p>&nbsp;</p>
<p>looking forward to your input.</p>
<p>&nbsp;</p>
<p>Andreas Markussen</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="6334.html" class="topic-previous" title="Go to previous forum topic">‹ Hosting linux problem</a>
              <a href="6350.html" class="topic-next" title="Go to next forum topic">kWh feeds corrupted after Raspberry Pi reboot - prevention ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-26182"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Automated Test Framework for Unit, integration and system test?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 27/12/2014 - 19:48.</div>
    <div class="content">
     <p>Are you sure that the code of which you complain is incorrect? Both values being compared are of type "unsigned long", therefore the difference will be of type unsigned long, which by definition cannot be negative. It will overflow, but it cannot be negative. For the comparison, timeout will be promoted to unsigned long (and it should never be set as a negative value anyway, because that makes no sense, so I agree with you that it should be of type unsigned int). But as far as I can see, it will handle the rollover correctly.</p>
<p>Perhaps you can tell me where my logic has gone wrong.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26183"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Automated Test Framework for Unit, integration and system test?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 27/12/2014 - 21:01.</div>
    <div class="content">
     <p>By way of <i>illustration</i> (not proof) the attached sketch gives this output:</p>
<pre style="margin-left: 5ex">
millis() overflow test
OpenEnergyMonitor.org

j= 0, mytime = FFFFFFF8, (clock()-start) = 0, st = 0
j= 1, mytime = FFFFFFF9, (clock()-start) = 1, st = 0
j= 2, mytime = FFFFFFFA, (clock()-start) = 2, st = 0
j= 3, mytime = FFFFFFFB, (clock()-start) = 3, st = 0
j= 4, mytime = FFFFFFFC, (clock()-start) = 4, st = 0
j= 5, mytime = FFFFFFFD, (clock()-start) = 5, st = 0
j= 6, mytime = FFFFFFFE, (clock()-start) = 6, st = 0
j= 7, mytime = FFFFFFFF, (clock()-start) = 7, st = 0
j= 8, mytime = 0, (clock()-start) = 8, st = 0
j= 9, mytime = 1, (clock()-start) = 9, st = 0
j= 10, mytime = 2, (clock()-start) = 10, st = 0
j= 11, mytime = 3, (clock()-start) = 11, st = 1
j= 12, mytime = 4, (clock()-start) = 12, st = 1
j= 13, mytime = 5, (clock()-start) = 13, st = 1
j= 14, mytime = 6, (clock()-start) = 14, st = 1
j= 15, mytime = 7, (clock()-start) = 15, st = 1

Done</pre><p>I had no wish to wait 50 days, I think clock( ) is equivalent to millis( ) for the present purpose - it does&nbsp;return&nbsp;the same type.</p>
<p>You can clearly see the time (mytime) overflowing yet the difference, (millis() - start) &nbsp;is still&nbsp;handled correctly, and the boolean is set in the correct place.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26184"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7416.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="andreasm_dk&#039;s picture" title="andreasm_dk&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Automated Test Framework for Unit, integration and system test?</h3>

    <div class="submitted">Submitted by <a href="../user/7416.html" title="View user profile.">andreasm_dk</a> on Sat, 27/12/2014 - 23:51.</div>
    <div class="content">
     <p>My post had a purpose to discuss the Test Framework, and I would still&nbsp;like this.</p>
<h2>Choice of test framework</h2>
<p>I will continue with Boost, until somebody pitch in. (Please do! )</p>
<p>The fact that Robert and I, are both doing various analysis, just shows the value for a test framework.&nbsp;</p>
<h2>Comment on Robers input on <a href="https://github.com/openenergymonitor/EmonLib/issues/11">Issue 11</a></h2>
<p>However I also need to reply to Roberts input. I haven&#39;t done the test case, however I have done the math, in an Excel Sheet.</p>
<p>Lets assume that the wrap happens at 100, and the time is 95, and the timeout is 6. So in this case, it should time out after 6 iterations.&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" style="" width="681">
<colgroup>
		<col span="2" style="width:48pt" width="64" /><br />
		<col style="mso-width-source:userset;mso-width-alt:2633;width:54pt" width="72" /><br />
		<col span="3" style="width:48pt" width="64" /><br />
		<col style="mso-width-source:userset;mso-width-alt:10569;width:217pt" width="289" /><br />
	</colgroup>
<tbody>
<tr height="20" style="height:15.0pt">
<td class="xl66" style="width:48pt" width="64">Limit</td>
<td class="xl66" style="border-left:none;width:54pt" width="72">Start time</td>
<td class="xl66" style="border-left:none;width:48pt" width="64">Time Out</td>
<td style="width:48pt" width="64">&nbsp;</td>
<td style="width:48pt" width="64">&nbsp;</td>
<td style="width:217pt" width="289">&nbsp;</td>
</tr>
<tr height="20" style="height:15.0pt">
<td align="right" class="xl65" style="border-top:none">99</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">95</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">6</td>
<td colspan="3" style="mso-ignore:colspan">&nbsp;</td>
</tr>
<tr height="20" style="height:15.0pt">
<td class="xl66" style="border-top:none">millis</td>
<td class="xl66" style="border-top:none;border-left:none">start</td>
<td class="xl66" style="border-top:none;border-left:none">timeout</td>
<td class="xl66" style="border-left:none">Diff</td>
<td class="xl66" style="border-left:none">Return</td>
<td class="xl66" style="border-left:none">Comment</td>
</tr>
<tr height="20" style="height:15.0pt">
<td align="right" class="xl65" style="border-top:none">97</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">95</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">6</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">2</td>
<td align="center" class="xl65" style="border-top:none;border-left:none">FALSE</td>
<td class="xl65" style="border-top:none;border-left:none">All fine</td>
</tr>
<tr height="20" style="height:15.0pt">
<td align="right" class="xl65" style="border-top:none">98</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">95</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">6</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">3</td>
<td align="center" class="xl65" style="border-top:none;border-left:none">FALSE</td>
<td class="xl65" style="border-top:none;border-left:none">All fine</td>
</tr>
<tr height="20" style="height:15.0pt">
<td align="right" class="xl65" style="border-top:none">99</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">95</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">6</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">4</td>
<td align="center" class="xl65" style="border-top:none;border-left:none">FALSE</td>
<td class="xl65" style="border-top:none;border-left:none">Diff 4, two more rounds</td>
</tr>
<tr height="20" style="height:15.0pt">
<td align="right" class="xl65" style="border-top:none">1</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">95</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">6</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">-94</td>
<td align="center" class="xl65" style="border-top:none;border-left:none">FALSE</td>
<td class="xl65" style="border-top:none;border-left:none">Ups! Wrap?</td>
</tr>
<tr height="20" style="height:15.0pt">
<td align="right" class="xl65" style="border-top:none">2</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">95</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">6</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">-93</td>
<td align="center" class="xl65" style="border-top:none;border-left:none">FALSE</td>
<td class="xl65" style="border-top:none;border-left:none">Wrapped, however should have timed out.</td>
</tr>
<tr height="20" style="height:15.0pt">
<td align="right" class="xl65" style="border-top:none">3</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">95</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">6</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">-92</td>
<td align="center" class="xl65" style="border-top:none;border-left:none">FALSE</td>
<td class="xl65" style="border-top:none;border-left:none">This will never&nbsp;</td>
</tr>
<tr height="20" style="height:15.0pt">
<td align="right" class="xl65" style="border-top:none">4</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">95</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">6</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">-91</td>
<td align="center" class="xl65" style="border-top:none;border-left:none">FALSE</td>
<td class="xl65" style="border-top:none;border-left:none">&nbsp;</td>
</tr>
<tr height="20" style="height:15.0pt">
<td align="right" class="xl65" style="border-top:none">5</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">95</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">6</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">-90</td>
<td align="center" class="xl65" style="border-top:none;border-left:none">FALSE</td>
<td class="xl65" style="border-top:none;border-left:none">&nbsp;</td>
</tr>
<tr height="20" style="height:15.0pt">
<td align="right" class="xl65" style="border-top:none">6</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">95</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">6</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">-89</td>
<td align="center" class="xl65" style="border-top:none;border-left:none">FALSE</td>
<td class="xl65" style="border-top:none;border-left:none">&nbsp;</td>
</tr>
<tr height="20" style="height:15.0pt">
<td align="right" class="xl65" style="border-top:none">7</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">95</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">6</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">-88</td>
<td align="center" class="xl65" style="border-top:none;border-left:none">FALSE</td>
<td class="xl65" style="border-top:none;border-left:none">&nbsp;</td>
</tr>
<tr height="20" style="height:15.0pt">
<td align="right" class="xl65" style="border-top:none">8</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">95</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">6</td>
<td align="right" class="xl65" style="border-top:none;border-left:none">-87</td>
<td align="center" class="xl65" style="border-top:none;border-left:none">FALSE</td>
<td class="xl65" style="border-top:none;border-left:none">&nbsp;</td>
</tr>
<!--[if supportMisalignedColumns]--><!--[if supportMisalignedColumns]--><tr height="0" style="display:none">
<td style="width:48pt" width="64">&nbsp;</td>
<td style="width:54pt" width="72">&nbsp;</td>
<td style="width:48pt" width="64">&nbsp;</td>
<td style="width:48pt" width="64">&nbsp;</td>
<td style="width:48pt" width="64">&nbsp;</td>
<td style="width:217pt" width="289">&nbsp;</td>
</tr>
<!--[endif]--><!--[endif]--></tbody>
</table>
<p>However we should continue the discussion of Issue 11, on Issue 11.&nbsp;</p>
<p>So what do you suggest, for automatically showing if an assumption is true or false.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26187"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dBC&#039;s picture" title="dBC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Automated Test Framework for Unit, integration and system test?</h3>

    <div class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Sun, 28/12/2014 - 07:29.</div>
    <div class="content">
     <p>C guarantees the desired result in this case. &nbsp;When an unsigned integer subtraction underflows, it will effectively add 0x100000000 to the result,&nbsp;assuming 32-bit (which in practice means just ignore the underflow and do nothing). &nbsp;</p>
<p>Undetected underflow has been the cause of plenty of buffer overrun vulnerabilities for network coders, but in this case, the guaranteed behaviour is exactly what the coder is expecting.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26190"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Automated Test Framework for Unit, integration and system test?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 28/12/2014 - 11:17.</div>
    <div class="content">
     <p>andreasm_dk: </p>
<p>What makes you think that Excel obeys the same rules as C &amp; C++? Clearly you have not read the language specification, of that I am quite certain. Here is a reference if you need it: "The C Programming Language", Second Edition, Kernighan &amp; Ritchie, Prentice Hall, ISBN 0-13-110362-8, Appendix A6.5 (page 198). And as far as I am aware, those rules are unchanged since 1988 and have been inherited by C++. [Edit:] The C++ November 2014 draft standard is the same (Section 5.10, page 89).<br />
And I think a review of binary arithmetic and how overflow and underflow is handled (as dBC points out) might not come amiss, either.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/6370"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-DJQoEyKBRYSOjQtSsybKQq2V0_fy1I2UfVXP0KVmCKI" value="form-DJQoEyKBRYSOjQtSsybKQq2V0_fy1I2UfVXP0KVmCKI"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
