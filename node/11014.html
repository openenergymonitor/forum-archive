<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11014 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:30:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Connecting emonTx via serial | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Connecting emonTx via serial</h3>
        <span class="submitted">Submitted by <a href="../user/8417.html" title="View user profile.">baldockery</a> on Tue, 21/07/2015 - 04:00</span>
        <div class="content"><p>Can anyone confirm if the default sketch for emonTx_V3.4 (the one that ships with the fully assembled unit from the Shop) writes to the serial port output (labeled UART&nbsp;Programming Header on the PCB)? I read somewhere that it writes there by default as well as to the RF out.</p>
<p>I am trying to do the serial connection to a Raspberry Pi running the latest emonPi/emonBase image.&nbsp;To get the serial connection working would I only need to connect Tx&lt; --&gt;GPIO10&nbsp; &nbsp;and GND&lt;--&gt;GND?</p>
<p>Thanks,</p>
<p>Brandon</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11034.html" class="topic-previous" title="Go to previous forum topic">‹ need help in building basic setup.</a>
              <a href="11020.html" class="topic-next" title="Go to next forum topic">Emonpi Radio going down ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-32423"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Connecting emonTx via serial</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 21/07/2015 - 07:24.</div>
    <div class="content">
     <p>If a serial connection is detected, it writes whatever is in the "Serial.print" statements. (Check the source on Github.) It starts with "emonTx V3.4 Discrete Sampling V3.4" etc and some test &amp; diagnostic data, then for each sample, powers and temperatures separated by spaces.</p>
<p>The pin labelled as "Tx" on the EmonTx V3.4 is the pin that connects to Tx on the programmer - it is actually connected to the Rx pin on the processor (see the schematic). Could that be your problem?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32425"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Connecting emonTx via serial</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 21/07/2015 - 10:05.</div>
    <div class="content">
     <p>Hi Brandon,</p>
<p>The&nbsp;3 main elements to using a serial-direct interface are,</p>
<p>1) The &#39;sender&#39; must provide the data as&nbsp;space separated values with a leading node id, As far as I&#39;m aware all but the &quot;serial-direct&quot; versions of the emonTx sketches send debug information to the serial port in a non specific human readable form, this output &nbsp;is&nbsp;difficult to parse so not catered for in emonHub,&nbsp;</p>
<p>So the quick answer to your question re the default sketch is ,Yes it does output serial but not in a form that can be used as an input to emonhub or emoncms</p>
<p>2) The physical connection, as Robert points out the Rx pin of the emonTx should be connected to the GPIO pin 10.</p>
<p>3) emonHub needs to be configured to receive&nbsp;the packet from serial, the existing &quot;default&quot; rfm2pi&nbsp;EmonHubJeeInterfacer&nbsp;can be configured to do the job but it is heavily biased towards the rfm2pi&nbsp;(and other Jee based devices)&nbsp;in the way it works and handles data/settings etc so you should be looking at changing the &quot;Type&quot; of interfacer to a EmonHubSerialInterfacer&nbsp;and remove the rfm settings (freq, group &amp; baseid)</p>
<p>The data passed via a &quot;serial-direct&quot; method is normally real values and this is the default setting for the EmonHubSerialInterfacer where as the EmonHubJeeInterfacer is configured to decode the typedef struct&#39;s defined in the sketch and passed via the rfm2pi as byte values.</p>
<p>There are several threads on this topic and it is quite easy to do and tried and tested on all but the &quot;latest emonPi/emonBase image&quot;, this&nbsp;is unchartered waters, it <em>should</em> work but there may be differences using the emon-pi variant of emonhub and you will probably need to explicitly define the node in [nodes]&nbsp;for it show up in the new&nbsp;emoncms&nbsp;node page.</p>
<p>Firstly you should move the link wire from tx to rx then&nbsp;try using minicom&nbsp;to view the serial output from the emonTx, this will test the connection and provide a means to view the raw serial input to see what you have and test what you do.</p>
<p>Then you need to change the sketch, there are some you can use or you can &quot;roll your own&quot;, once you are confidently recieving&nbsp;a properly formatted stream of packets in minicom&nbsp;you can experiment with&nbsp;emonhub if it doesn&#39;t work first time.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32456"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8417.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="baldockery&#039;s picture" title="baldockery&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Connecting emonTx via serial</h3>

    <div class="submitted">Submitted by <a href="../user/8417.html" title="View user profile.">baldockery</a> on Wed, 22/07/2015 - 00:00.</div>
    <div class="content">
     <p>I noticed that on my emonTx&nbsp;PCB the labels for Rx and Tx are reversed from the wiki schematic. Anyone know which will be correct?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-32475"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Connecting emonTx via serial</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 22/07/2015 - 20:04.</div>
    <div class="content">
     <p>Which version of the PCB do you have? The V3.2 Oct 2013 version has the connector labelled conventionally, i.e. Tx is the line that data is transmitted on. The V3.4 Oct 2014 version has the connector labelled as the programmer is, i.e. the pin labelled Rx is the line that connects to Rx on the programmer and is the line that the programmer receives the data on.</p>
<p>I've added an explanatory note to the Wiki.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11014"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-80BcaRoTvtAFpvEEnhXgE2CWmUjxMG3KLxltlkO3nkE" value="form-80BcaRoTvtAFpvEEnhXgE2CWmUjxMG3KLxltlkO3nkE"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
