<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11518 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:50:08 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Can&#039;t connect to local MySQL server through socket &#039;/var/run/mysqld/mysqld.sock&#039; (2) [SOLVED] | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Can&#039;t connect to local MySQL server through socket &#039;/var/run/mysqld/mysqld.sock&#039; (2) [SOLVED]</h3>
        <span class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Tue, 03/11/2015 - 16:11</span>
        <div class="content"><p>Hi</p>
<p>Subject says it all. Local emoncms&nbsp;running on PI. Has been working for several years without any issues. I recently ran a routine system software&nbsp;upgrade on the Pi. Went to login and got the following message:-</p>
<p>Can&#39;t connect to database, please verify credentials/configuration in settings.php<br />
Error message:&nbsp;Can&#39;t connect to local MySQL server through socket &#39;/var/run/mysqld/mysqld.sock&#39; (2)</p>
<p>I had a backup off settings.php so I installed that but I still have the problem so I guess it is mysql&nbsp;related rather that emoncms. Can any one give me a clue as to how to solve this problem?</p>
<p>Regards</p>
<p>Ian</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11559.html" class="topic-previous" title="Go to previous forum topic">‹ Wheezy or Jessie</a>
              <a href="11473.html" class="topic-next" title="Go to next forum topic">V9.0 RC2 Daylight saving time bug ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-35621"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3426.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3426.jpg" alt="Bill Thomson&#039;s picture" title="Bill Thomson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) [SOLVED]</h3>

    <div class="submitted">Submitted by <a href="../user/3426.html" title="View user profile.">Bill Thomson</a> on Wed, 04/11/2015 - 01:26.</div>
    <div class="content">
     <p>Hi Ian,</p>
<p>Have you verified that MySQL is running?</p>
<p>The command:<strong> sudo service mysql status</strong> will tell you.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35626"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1894.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Ian Eagland&#039;s picture" title="Ian Eagland&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) [SOLVED]</h3>

    <div class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Wed, 04/11/2015 - 10:57.</div>
    <div class="content">
     <p>Hi Bill</p>
<p>pi@StudioPiServer ~ $ sudo service mysql status<br />
[info] MySQL is stopped..<br />
pi@StudioPiServer ~ $</p>
<p>So mySQL is stopped</p>
<p>I tried to start it and just got the following.</p>
<p>pi@StudioPiServer ~ $ &nbsp;sudo service mysql start<br />
[FAIL] Starting MySQL database server: mysqld . . . . . . . . . . . . . . failed &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;!</p>
<p>I have found a mysql log file but it has no entries!</p>
<p>Any help appreciated.</p>
<p>Regards</p>
<p>&nbsp;</p>
<p>Ian</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35628"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3426.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3426.jpg" alt="Bill Thomson&#039;s picture" title="Bill Thomson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) [SOLVED]</h3>

    <div class="submitted">Submitted by <a href="../user/3426.html" title="View user profile.">Bill Thomson</a> on Wed, 04/11/2015 - 11:43.</div>
    <div class="content">
     <p>What OS are you running?</p>
<p>Do you get any other error text on the screen when you try to start mysql manually?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35630"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1894.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Ian Eagland&#039;s picture" title="Ian Eagland&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) [SOLVED]</h3>

    <div class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Wed, 04/11/2015 - 12:21.</div>
    <div class="content">
     <p>Hi Bill</p>
<p>Running on a Pi wheezy. No other error messages.</p>
<p>I found a&nbsp;StudioPiServer.err file with these lines:-</p>
<p>151104 11:42:36 &nbsp;InnoDB: Operating system error number 13 in a file operation.<br />
InnoDB: The error means mysqld does not have the access rights to<br />
InnoDB: the directory.<br />
InnoDB: File name ./ibdata1</p>
<p>​I am guessing I have messed up file permissions some how but I don&#39;t know how.</p>
<p>Question is how to restore them. I know the mysql password for emoncms&nbsp;but cannot remember the mysql root&nbsp;password I used. I wrote it down originally but that was 2 years ago!</p>
<p>Regards</p>
<p>Ian</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35633"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) [SOLVED]</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 04/11/2015 - 12:46.</div>
    <div class="content">
     <p>I know it's a case of stable door and all that - I keep all my passwords in a password safe (KeePassX in my case).</p>
<p>How to reset it: <a href="http://dev.mysql.com/doc/refman/5.7/en/resetting-permissions.html" title="http://dev.mysql.com/doc/refman/5.7/en/resetting-permissions.html">http://dev.mysql.com/doc/refman/5.7/en/resetting-permissions.html</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35635"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3426.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3426.jpg" alt="Bill Thomson&#039;s picture" title="Bill Thomson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) [SOLVED]</h3>

    <div class="submitted">Submitted by <a href="../user/3426.html" title="View user profile.">Bill Thomson</a> on Wed, 04/11/2015 - 13:49.</div>
    <div class="content">
     <p>Here&#39;s the steps to reset the root password:</p>
<p>Since your MySQL server is not running, start with step 2.</p>
<ol>
<li>/etc/init.d/mysql stop</li>
<li>mysqld_safe --skip-grant-tables &amp;</li>
<li>mysql -u root</li>
<li>use mysql;</li>
<li>update user set password=PASSWORD(&quot;NEW-ROOT-PASSWORD&quot;) where User=&#39;root&#39;;</li>
<li>flush privileges;</li>
<li>quit</li>
</ol>
<p>Done, reboot.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35701"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1894.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Ian Eagland&#039;s picture" title="Ian Eagland&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) [SOLVED]</h3>

    <div class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Fri, 06/11/2015 - 09:43.</div>
    <div class="content">
     <p>Hi</p>
<p>Still struggling with this. Password reset did not work. I am certain the issue is related to file ownership. I have been reading about ownership and groups and the fog is beginning to clear. For emoncms&nbsp;who should own the mysql files and which group should they be in?</p>
<p>I have found the emoncms mysql&nbsp;and data files&nbsp;and backed them up onto a PC on the network.</p>
<p>Can you install a new emoncms and then overwrite the default&nbsp;files with the backup files therefore effectively&nbsp;cloning the old setup? The Pi I am using has been a learning tool for me and has had many applications installed over the years. I am thinking a clean install of wheezy plus the latest emoncms version may not be a bad idea.</p>
<p><em><strong>Robert</strong></em></p>
<p>KeyPass&nbsp;installed and all critical internet passwords changed. Thanks for the tip.</p>
<p>Regards</p>
<p>Ian</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35704"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) [SOLVED]</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Fri, 06/11/2015 - 10:59.</div>
    <div class="content">
     <p>I think mySQL will need to be running before you can reset the password etc,&nbsp;</p>
<p>Is there enough room for mySQL to function following the updates? The most common cause of any mySQL issues on a Pi is lack of space, on a stock Raspbian&nbsp;that&#39;s usually due to the filesystem&nbsp;size being fully used unless running a A or&nbsp;orig&nbsp;256mb&nbsp;B then it could be RAM.&nbsp;&nbsp;</p>
<p>Is the filesystem read-only? If so the disc space is less important as disc-swapping isn&#39;t used and the in-memory stuff is held in RAM, so the RAM is very easily maxed out and only the 1Gb Pi will definitely&nbsp;handle a full emoncms. mysql, mqtt, apache server build with plenty to spare, a 512mb&nbsp;Pi&nbsp;will&nbsp;also manage it even if some jiggery pokery is needed to free up RAM.</p>
<p>does either &quot;df&nbsp;-h&quot; or &quot;free&quot; reveal anything?&nbsp;</p>
<p>Is there anything enlightening in the syslog? in particular&nbsp;for mysqld at boot up.</p>
<p>Also if read-only have you tried using&nbsp;&quot;rpi-rw&quot; before manually starting the mysqld&nbsp;service in case there is something it needs to write following the updated and reboot?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35706"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1894.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Ian Eagland&#039;s picture" title="Ian Eagland&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) [SOLVED]</h3>

    <div class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Fri, 06/11/2015 - 12:05.</div>
    <div class="content">
     <p>Hi Paul</p>
<p>Hard disk so space should not be a problem.</p>
<p>pi@StudioPiServer ~ $ df -h<br />
df: `/squashfs&#39;: No such file or directory<br />
Filesystem &nbsp; &nbsp; &nbsp;Size &nbsp;Used Avail Use% Mounted on<br />
rootfs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;459G &nbsp;3.6G &nbsp;432G &nbsp; 1% /<br />
dev &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 115M &nbsp; &nbsp; 0 &nbsp;115M &nbsp; 0% /dev<br />
/dev/sda1 &nbsp; &nbsp; &nbsp; 459G &nbsp;3.6G &nbsp;432G &nbsp; 1% /mnt<br />
none &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;459G &nbsp;3.6G &nbsp;432G &nbsp; 1% /<br />
tmpfs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;47M &nbsp;236K &nbsp; 47M &nbsp; 1% /run<br />
tmpfs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5.0M &nbsp; &nbsp; 0 &nbsp;5.0M &nbsp; 0% /run/lock<br />
tmpfs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;93M &nbsp; &nbsp; 0 &nbsp; 93M &nbsp; 0% /run/shm<br />
pi@StudioPiServer ~ $</p>
<p>&nbsp;</p>
<p>The bit in syslog that makes me think file ownership is the problem is:-</p>
<p>Nov &nbsp;4 10:31:55 StudioPiServer mysqld: InnoDB: The error means mysqld does not have the access rights to<br />
Nov &nbsp;4 10:31:55 StudioPiServer mysqld: InnoDB: the directory.<br />
Nov &nbsp;4 10:31:55 StudioPiServer mysqld: InnoDB: File name ./ibdata1<br />
Nov &nbsp;4 10:31:55 StudioPiServer mysqld: InnoDB: File operation call: &#39;open&#39;.<br />
Nov &nbsp;4 10:31:55 StudioPiServer mysqld: InnoDB: Cannot continue operation.</p>
<p>Regards</p>
<p>Ian</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35708"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) [SOLVED]</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Fri, 06/11/2015 - 12:19.</div>
    <div class="content">
     <p><em>Can you install a new emoncms and then overwrite the default&nbsp;files with the backup files therefore effectively&nbsp;cloning the old setup?</em></p>
<p>I&#39;ve just done exactly that on a fresh OS on another Pi.&nbsp;</p>
<p>The MYSQL is perhaps a little tricky, but all I did was follow the emoncms installation instructions, including creating the emoncms mysql database, and once the new system is&nbsp;installed and everything is&nbsp;running OK, stop emonhub&nbsp;&amp;&nbsp;open up your db&nbsp;in phpmyadmin using your new mysql &#39;root&#39; password.</p>
<p>In phpmyadmin&nbsp;delete the existing emoncms database and create a new database called &#39;emoncms&#39; then import your old mysql&nbsp;backup into it.(presumably it is a .sql backup file?)</p>
<p>The data folders are straight forward, just copy them to the default locations /var/lib (deleting the existing ones first) and then set their permissions</p>
<pre>
sudo chown&nbsp;-R&nbsp;www-data:root /var/lib/{phpfiwa,phpfina,phptimeseries}</pre><p>(notice the -R in above, as you need to change the permissions of the folder contents too)</p>
<p>It probably reads more complicated than it really is!</p>
<p>Don&#39;t forget to check your db settings in settings.php, and also your write API key within emonhub.conf<br />
There will be other things to do, especially if your changing from v8.5 to v9.x, but those are the main steps.</p>
<p>Paul</p>
<p>&nbsp;</p>
<p>
&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35717"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1894.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Ian Eagland&#039;s picture" title="Ian Eagland&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) [SOLVED]</h3>

    <div class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Fri, 06/11/2015 - 17:25.</div>
    <div class="content">
     <p>Hi</p>
<p>Before I did anything else&nbsp;I removed and purged mysql&nbsp;and then reinstalled. I am pleased to say every thing seems to be back to normal. I have also learnt a fair bit more about mysql!</p>
<p>Thanks for all the help and advice.</p>
<p>Regards</p>
<p>Ian</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35741"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) [SOLVED]</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Sun, 08/11/2015 - 20:57.</div>
    <div class="content">
     <p>Ian, just reading back through this thread, how are you backing up your mysql&nbsp;database? are you just&nbsp;copying the mysql&nbsp;directories from your SD card?</p>
<p>If so, you may find MYSQL restoration more effective if you export your database as a backup, which you can then easily import if things go wrong.</p>
<p>I use a small script to backup my database (attached).<br />
To use&nbsp;it;</p>
<ul>
<li>Create the backup directory $&nbsp;mkdir&nbsp;~/mysql_backup</li>
<li>Rename the attached script&nbsp;to mysql_backup.sh &amp; add your database password</li>
<li>copy the script&nbsp;to ~/msql_backup/</li>
<li>Make it executable - $&nbsp;chmod +x ~/mysql_backup/mysql_backup.sh</li>
<li>Run the file manually or by using Cron; $&nbsp;~/mysql_backup/./mysql_backup_emoncms.sh</li>
</ul>
<p>..and it will backup your emoncms database to&nbsp;~/mysql_backup/<br />
You could change the script/backup locations to whatever you wish, maybe a removable&nbsp;memory stick for safe storage.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35754"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1894.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Ian Eagland&#039;s picture" title="Ian Eagland&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) [SOLVED]</h3>

    <div class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Mon, 09/11/2015 - 12:20.</div>
    <div class="content">
     <p>Hi Paul</p>
<p>Thanks very much.</p>
<p>I actually use tarsnap&nbsp;for backup but I now&nbsp;realise&nbsp;dumping the file first would be a good idea.</p>
<p>I tried your script and got the following error:-</p>
<p>~/mysql_backup/./mysql_backup.sh<br />
-bash: /home/pi/mysql_backup/./mysql_backup.sh: /bin/sh^M: bad interpreter: No such file or directory<br />
pi@StudioPiServer ~ $</p>
<p>Also tried the command direct and also got an error:-</p>
<p>&nbsp;mysqldump -u emoncms -pxxxxxxxxxx&nbsp;emoncms &gt; &nbsp;/home/pi/mysql_backup/emoncms_backup.sql<br />
mysqldump: Got error: 1045: Access denied for user &#39;emoncms&#39;@&#39;localhost&#39; (using password: YES) when trying to connect<br />
pi@StudioPiServer ~ $</p>
<p>Regards</p>
<p>Ian</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35756"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3426.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3426.jpg" alt="Bill Thomson&#039;s picture" title="Bill Thomson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) [SOLVED]</h3>

    <div class="submitted">Submitted by <a href="../user/3426.html" title="View user profile.">Bill Thomson</a> on Mon, 09/11/2015 - 14:40.</div>
    <div class="content">
     <p>Hi Ian,</p>
<p><em>-bash: /home/pi/mysql_backup/./mysql_backup.sh: /bin/sh^M: bad interpreter: No such file or directory</em></p>
<p>To fix the first error, change the <em><strong>sh</strong></em> in Paul&#39;s script to <em><strong>bash</strong></em>&nbsp; i.e. change it to <strong>#!/bin/bash</strong></p>
<p>&nbsp;</p>
<p><em>1045: Access denied for user &#39;emoncms&#39;@&#39;localhost&#39; (using password: YES) when trying to</em></p>
<p>Regarding the second error, be sure you&#39;re using the <em>MySQL</em> <em>root</em> <em>user&#39;s</em> pasword.</p>
<p>To run the mysqldump command manually, as the <em>MySQL root user</em>, your command line should look like this:</p>
<p>mysqldump -u root -pyour_mysql_root_pw&nbsp; &gt; &nbsp;/home/pi/mysql_backup/emoncms_backup.sql</p>
<p>Note: no space between -p and your password. e.g. -pMySQL</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35757"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1894.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Ian Eagland&#039;s picture" title="Ian Eagland&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) [SOLVED]</h3>

    <div class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Mon, 09/11/2015 - 15:04.</div>
    <div class="content">
     <p>Hi Bill</p>
<p>Thanks. Now working. I had already fixed the second problem by using the password for the emoncms&nbsp;database.</p>
<p>Regards</p>
<p>Ian</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35773"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) [SOLVED]</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Mon, 09/11/2015 - 21:56.</div>
    <div class="content">
     <p>Sorry Ian, just&nbsp;realised&nbsp;that I&#39;d made a mistake when hastily posting&nbsp;the script above. Before posting it, I added a comment in the script to remind users to add their password to the script. However I preceded the comment with &#39;//&#39; instead of &#39;#&#39; to denote a comment, stopping the script from running!!!</p>
<p>I&#39;ve just attached the amended script above which should work as is, I&#39;ve just tried it on another Pi and it now works fine, running through sh and not bash.</p>
<p>It&#39;s been running on my Pi for the past 6 months and backs up my database daily at 3am.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11518"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-AKaXtWTBQCgUubwYasoA1cfdZqgvvIHUxHjeXvibmw0" value="form-AKaXtWTBQCgUubwYasoA1cfdZqgvvIHUxHjeXvibmw0"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
