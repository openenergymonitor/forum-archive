<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/10013 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:47:08 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Cannot delete inputs. Where are they stored? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Cannot delete inputs. Where are they stored?</h3>
        <span class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Sat, 17/01/2015 - 10:09</span>
        <div class="content"><p>Hi</p>
<p>Running a local pi server version 8.4.0. This has been running for months without trouble. About a week ago I looked at inputs and noticed that I had some inactive inputs from an emontx that I had disconnected some time ago. I tried to delete the inputs and they did indeed disappear&nbsp;only to spring back after about a minute. I did not think any more about it as it did not appear to effect performance. I also noticed I had a few separate input entries for rt_fail which I did delete.&nbsp;</p>
<p>Yesterday I noticed nothing was updating on my dashboards so I looked at inputs again. The first thing I noticed was that it took minutes to access the server and further minutes to access the input page. Every thing was very unresponsive. When I finally got the input page up I found a huge number of rt_fail entries. I shut off my 2 nanodeRF base stations and started to try and delete the rt_fail entries but the system in so slow it would take hours to delete them. I can ssh into the PI.&nbsp;&nbsp;Can I access the database holding the inputs&nbsp;and delete them there?</p>
<p>I don&#39;t know if they are the cause of the problem but clearly something is not right and deleting all the inactive inputs seems the best place to start.</p>
<p>I have all the data backed up and it has also occurred to me that a fresh start with a clean emoncms&nbsp;might the quickest&nbsp;way to get running again. What would be the best way to achieve this?</p>
<p>Regards</p>
<p>Ian</p>
  <div class="forum-topic-navigation clear-block">
          <a href="6409.html" class="topic-previous" title="Go to previous forum topic">‹ Convert from timestore</a>
              <a href="6387.html" class="topic-next" title="Go to next forum topic">Wrong values after upload ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-26810"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Cannot delete inputs. Where are they stored?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sat, 17/01/2015 - 11:59.</div>
    <div class="content">
     <p>Hi Ian,</p>
<p>Is it definitely&nbsp;rt_fail? or could it be rf_fail? There are quite a few discussions about rf_fail on the forum, (coincidentally they seem to predominantly be when using a&nbsp;NanodeRF).</p>
<p>How is the file&nbsp;system for space on the Pi? a common cause for running&nbsp;excruciatingly slow is when the disk is full, what &quot;percentage full&quot; do you see with <strong>df -h</strong>?</p>
<p>Usually when a input reappears after deletion it is because of redis try running&nbsp;<strong>sudo redis-cli FLUSHALL </strong>after deleting,</p>
<p>Paul</p>
<p>Edit - There is also an api function to remove unused inputs but I haven&#39;t tried it myself see&nbsp;<a href="6315.html#comment-26070">http://openenergymonitor.org/emon/node/6315#comment-26070</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26814"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1894.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Ian Eagland&#039;s picture" title="Ian Eagland&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Cannot delete inputs. Where are they stored?</h3>

    <div class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Sat, 17/01/2015 - 15:01.</div>
    <div class="content">
     <p>Hi Paul</p>
<p>Many thanks as ever for your response. Your dead right, I misread the name, it&nbsp;is rf_fail, That&#39;s why I could not find any references on the forum!</p>
<p>I am on a hard drive so I don&#39;t think space is a problem.</p>
<p>pi@EmoncmsMaster ~ $ df -h<br />
Filesystem &nbsp; &nbsp; &nbsp;Size &nbsp;Used Avail Use% Mounted on<br />
rootfs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;172G &nbsp;7.7G &nbsp;156G &nbsp; 5% /<br />
/dev/root &nbsp; &nbsp; &nbsp; 172G &nbsp;7.7G &nbsp;156G &nbsp; 5% /<br />
devtmpfs &nbsp; &nbsp; &nbsp; &nbsp;239M &nbsp; &nbsp; 0 &nbsp;239M &nbsp; 0% /dev<br />
tmpfs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;49M &nbsp;1.3M &nbsp; 48M &nbsp; 3% /run<br />
tmpfs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5.0M &nbsp; &nbsp; 0 &nbsp;5.0M &nbsp; 0% /run/lock<br />
tmpfs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;97M &nbsp; &nbsp; 0 &nbsp; 97M &nbsp; 0% /run/shm<br />
/dev/mmcblk0p1 &nbsp; 59M &nbsp;9.7M &nbsp; 50M &nbsp;17% /boot<br />
pi@EmoncmsMaster ~ $</p>
<p>sudo redis-cli FLUSHALL&nbsp;had an&nbsp;interesting effect. It removed most of the inactive input entries I had deleted some weeks ago that kept reappearing. Unfortunately there are a great many rf_fail entries and it takes minutes for the web page to update&nbsp;(I even get chrome timeouts) so it will take hours to delete them individually unless the server starts to respond more quickly. Something is slowing it down. I just remembered a short while ago I installed&nbsp;Apache_log4php</p>
<p>​Would looking at that give any clues? Or could the log be causing the problem. I only installed it because the server admin reported it not installed so I thought it might be useful at some time.</p>
<p>Regards</p>
<p>Ian</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26818"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Cannot delete inputs. Where are they stored?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sat, 17/01/2015 - 18:17.</div>
    <div class="content">
     <p>You seem to have plenty space (only using 5%) sometimes if you don&#39;t use resize2fs&nbsp;you can&#39;t use the hdd space outside the partition, but thats not the case here.</p>
<p>What about if you were to stop the server (apache service) and use mySQL&nbsp;to cleanse the inputs and use redis-cli FLUSHALL&nbsp;before restarting? or maybe use phpmyadmin&nbsp;or does that run slow too?</p>
<p>I&#39;m not really&nbsp;sure about&nbsp;log4php but it&#39;s definitely worth looking in any logfiles you can eg apache. does the Pi run slow using commands over ssh or is it just via the web based server?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26837"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1894.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Ian Eagland&#039;s picture" title="Ian Eagland&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Cannot delete inputs. Where are they stored?</h3>

    <div class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Sun, 18/01/2015 - 12:52.</div>
    <div class="content">
     <p>Hi Paul</p>
<p>The Pi runs slow via the web based server so phpmyadmin&nbsp;is&nbsp;very slow but it does appear to stack delete commands so I have initiated a batch and will leave it an hour or so to see what happens. Over ssh I don&#39;t think it is any slower than it was before this trouble started. I will probably have to stop the server and learn the mysql delete command to clear the unwanted inputs.</p>
<p>I am beginning to wonder if the multiple rf_fail inputs&nbsp;are a result of the problem rather than the cause. I reinstated one of the NanodeRF base stations last night and the inputs are updating. However these are now appearing as multiple inputs. Screenshot attached.</p>
<p>Interestingly I have no new rf_fail inputs only the large number of inactive ones.</p>
<p>Edit</p>
<p>One thing that has changed recently is that I am running a new Pi with RFM12pi&nbsp;and emonhub&nbsp;posting to emoncms.org. It is the same frequency but a different networking group. Could this cause intereference?</p>
<p>&nbsp;</p>
<p>Ian</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26844"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Cannot delete inputs. Where are they stored?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sun, 18/01/2015 - 15:56.</div>
    <div class="content">
     <p>Interesting, I have seen this on emoncms.org but not a local install. See&nbsp;<a href="6185.html">http://openenergymonitor.org/emon/node/6185</a></p>
<p>I would of thought you are experiencing a server side issue as if the issue was interference from another network or any other unwanted source of data it would only&nbsp;create a new unique node/input if&nbsp;there wasn&#39;t a pre-existing node/input for it to post to, the fact that the input numbers are duplicated suggests a server issue.</p>
<p>Whereabouts are you seeing the rf_fail errors reported?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26856"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1894.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Ian Eagland&#039;s picture" title="Ian Eagland&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Cannot delete inputs. Where are they stored?</h3>

    <div class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Mon, 19/01/2015 - 13:07.</div>
    <div class="content">
     <p>Hi Paul</p>
<p>The rf_fail errors all show in the inputs page on the server.</p>
<p>I am beginning to think it would be quicker to do a rebuild from scratch. I am 99% certain it is a server problem. I have checked the 2 NanodeRFs&nbsp;and they both seem to be working correctly. I have all my&nbsp;historic data on a backup PC. There would only be a benefit to continue looking for the cause if others had reported the problem but that does not seem to be the&nbsp;case.</p>
<p>EDIT</p>
<p>I just found out how to display the inputs in mysql with this result-</p>
<p>| 8190 | &nbsp; &nbsp; &nbsp;1 | rf_fail | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp;| NULL &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | NULL | &nbsp;NULL | &nbsp; &nbsp; &nbsp;0 |<br />
+------+--------+---------+-------------+--------+------------------------------+------+-------+--------+<br />
7927 rows in set (0.02 sec)</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Ian</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26857"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Cannot delete inputs. Where are they stored?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 19/01/2015 - 13:40.</div>
    <div class="content">
     <p>Wow! 8000 inputs, I can see how some of them might be surplus to requirement :-)</p>
<p>Personally, I&#39;m a big fan of rebuilding, although that&#39;s&nbsp;probably&nbsp;as&nbsp;I usually end up trying so&nbsp;many&nbsp;things determined&nbsp;to get to the root of the issue,&nbsp;I feel it&#39;s safer to rebuild a fresh install using what I&#39;ve learnt rather than continue with a fixed but heavily &quot;played with&quot; install. In this instance since the throttled speed is preventing any progress,&nbsp;I think I would of run out of patience and rebuilt already.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26863"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1894.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Ian Eagland&#039;s picture" title="Ian Eagland&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Cannot delete inputs. Where are they stored?</h3>

    <div class="submitted">Submitted by <a href="../user/1894.html" title="View user profile.">Ian Eagland</a> on Mon, 19/01/2015 - 17:59.</div>
    <div class="content">
     <p>Hi Paul</p>
<p>Just to complete this thread I have started a full install to an external hard disk from scratch. Every thing seems to have gone OK. I had no error messages on install. I had a little trouble finding the apache config file&nbsp;but got over it.</p>
<p>Now I can&#39;t register as in this thread:-</p>
<p><a href="3440.html" title="http://openenergymonitor.org/emon/node/3440">http://openenergymonitor.org/emon/node/3440</a></p>
<p>Ian</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/10013"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-K6abnaz52cCrfjXy2penQDl1WoxhV-8t2yldPgEcLdc" value="form-K6abnaz52cCrfjXy2penQDl1WoxhV-8t2yldPgEcLdc"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/10013 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:47:09 GMT -->
</html>
