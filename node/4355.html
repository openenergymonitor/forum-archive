<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/4355 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:20:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Multi zone heating scheduler development | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Multi zone heating scheduler development</h3>
        <span class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 26/03/2014 - 11:57</span>
        <div class="content"><p>Im working here today with Richard Hatfield (<a href="../user/5074.html">hatfieldr</a>) on a multizone heating scheduler module for emoncms. Richard has come up to North Wales to work on it with me. We are documenting our progress on a system build page here:</p>
<p><a href="4354.html">Heating controller with multi zone scheduling</a> and the module is up on github here <a href="https://github.com/emoncms/scheduler">https://github.com/emoncms/scheduler</a></p>
<p>Here&#39;s a screenshot of the scheduler interface so far, its designed to be used on a phone:</p>
<p><img alt="" src="../sites/default/files/scheduler_interface_01.png" style="width: 250px; height: 431px;" /></p>
<p>It works in conjunction with the packetgen module which then transmitts the zone states and set point temperatures to zone controllers which are emontx v2&#39;s with a jeenode output plug connected to relay&#39;s.</p>
<p>This is what we&#39;re working on for the rest of the day:</p>
<ul>
<li>
		Ensure that first heating period in a day cannot end later than the start of the second heating period.</li>
<li>
		Switch from defining time in hours and minutes to decimal time (ie hours:2, minutes:30 to time: 2.5), simpler to make time comparison.</li>
<li>
		Implement boost functionality: +1h, +2h</li>
<li>
		Implement changeable temperature targets.</li>
<li>
		Add set able off temperature</li>
<li>
		Configure how room temperatures are included in the interface for each zone.</li>
</ul>
  <div class="forum-topic-navigation clear-block">
          <a href="5231.html" class="topic-previous" title="Go to previous forum topic">‹ Power to kwh/day extended to kwhd_plus and kwhd_minus</a>
              <a href="5200.html" class="topic-next" title="Go to next forum topic">Feed from gridtie inverter ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-19840"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5190.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-5190.jpg" alt="Schism&#039;s picture" title="Schism&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multi zone heating scheduler development</h3>

    <div class="submitted">Submitted by <a href="../user/5190.html" title="View user profile.">Schism</a> on Wed, 26/03/2014 - 12:22.</div>
    <div class="content">
     <p>Looks good... I&#39;m definitely interested in progressing my house to individual room heat control in future :)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19844"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1741.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1741.jpg" alt="ukmoose&#039;s picture" title="ukmoose&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multi zone heating scheduler development</h3>

    <div class="submitted">Submitted by <a href="../user/1741.html" title="View user profile.">ukmoose</a> on Wed, 26/03/2014 - 13:35.</div>
    <div class="content">
     <p>Looks good but from a UX perspective, can&#39;t think of a situation where I&#39;d want to display different days for different zones on the same screen. &nbsp;So might be better moving that to outside the individual zones.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19853"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multi zone heating scheduler development</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 26/03/2014 - 18:59.</div>
    <div class="content">
     <p>We&#39;ve removed the day buttons from the left, they are now on the top, good progress on it today, most of the work on functionality rather than interface design, there&#39;s some initial notes on how to get the scheduler module running in the build guide page: <a href="4354.html">Heating controller with multi zone scheduling</a></p>
<p>Here&#39;s how its looking like at the moment:</p>
<p><img alt="" src="../sites/default/files/scheduler.jpg" style="width: 250px; height: 523px;" /></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21475"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6146.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="maglo18&#039;s picture" title="maglo18&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multi zone heating scheduler development</h3>

    <div class="submitted">Submitted by <a href="../user/6146.html" title="View user profile.">maglo18</a> on Tue, 20/05/2014 - 09:26.</div>
    <div class="content">
     <p>What I doing wrong?</p>
<p>root@NAS:/var/www/emoncms# php /var/www/emoncms/Modules/scheduler/scheduler_run.php<br />
	PHP Notice:&nbsp; Use of undefined constant _ENABLE_PASSWORD_RESET_ - assumed &#39;_ENABLE_PASSWORD_RESET_&#39; in /var/www/emoncms/settings.php on line 51<br />
	PHP Fatal error:&nbsp; Call to a member function fetch_array() on a non-object in /var/www/emoncms/Modules/scheduler/scheduler_model.php on line 51</p>
<p>Fatal error: Call to a member function fetch_array() on a non-object in /var/www/emoncms/Modules/scheduler/scheduler_model.php on line 51</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21476"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multi zone heating scheduler development</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 20/05/2014 - 09:47.</div>
    <div class="content">
     <p>If you use &quot;&nbsp; _ENABLE_PASSWORD_RESET_ &quot;&nbsp; in the search box that has been discussed a couple of times.</p>
<blockquote><p>$enable_password_reset should be set to false if you don&#39;t want it and true if you do. _DISABLE_PASSWORD_RESET_ is associated with the deb installer.</p>
</blockquote>
<p>So &quot;&nbsp;in /var/www/emoncms/settings.php on line 51&nbsp;&quot; change</p>
<p><strong>$enable_password_reset = _ENABLE_PASSWORD_RESET_;</strong></p>
<p>to either&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>$enable_password_reset = false</strong>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; or&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>$enable_password_reset = true;</strong></p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21478"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/937.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Bramco&#039;s picture" title="Bramco&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multi zone heating scheduler development</h3>

    <div class="submitted">Submitted by <a href="../user/937.html" title="View user profile.">Bramco</a> on Tue, 20/05/2014 - 10:30.</div>
    <div class="content">
     <p>Hi,</p>
<p>Very interesting - I&#39;ve also been thinking about how to control my heating more effectively.</p>
<p>We have a 210 litre thermal store which is heated by solar thermal, PV diversion and a gas boiler, so summers the boiler doesn&#39;t fire, spring and autumn it only fires occasionally&nbsp;and winters it is the main source of heat with the solar thermal and PV diversion adding what is available.</p>
<p>Like most houses in the UK our CH system is managed through TRVs on each of the radiators or through wireless thermostats on the zone which has underfloor heating, so my requirements would only be to turn on/off the pumps for the two separate zones (radiators in the old part of the house and underfloor in the new part) and let the thermostats on the radiators and in the rooms do their job.</p>
<p>I was planning to use packetgen to send commands to my emonTX&nbsp;which is currently monitoring temperatures on my thermal store and doing the PV diversion. &nbsp;</p>
<p>Also I was planning to use a one wire controller to manage turning the pumps on and off. Has any one had any experience with one of these&nbsp;<a href="http://www.axiris.eu/en/index.php/one-wire/1-wire-relay-card">http://www.axiris.eu/en/index.php/one-wire/1-wire-relay-card</a>. It would seem to be a simple enough exercise to use one of the spare pins on the emonTX to manage this device.</p>
<p>As well as the obvious timing logic, like turning on and off at set times each day, I also need to add some additional logic for example if it&#39;s only 15 minutes to the off time, don&#39;t bother firing the boiler again. So it would be good if there could be some logic in the system you are developing that could suppress an instruction to a zone to heat if another temperature is at a set point or if as above there is only a short time before the end of the cycle.</p>
<p>I&#39;m also planning on replacing the logic for controlling the firing of the boiler to supplement the thermal store, so some fairly simple logic that would allow for the tank to run a lot cooler unless there was a call for central heating, so it would be great if there was a way of triggering some other s/w from what you are developing.</p>
<p>Keep up thee great work, I&#39;ll try to take a look at the documentation later.</p>
<p>Simon</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21480"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6146.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="maglo18&#039;s picture" title="maglo18&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multi zone heating scheduler development</h3>

    <div class="submitted">Submitted by <a href="../user/6146.html" title="View user profile.">maglo18</a> on Tue, 20/05/2014 - 10:49.</div>
    <div class="content">
     <p>I have only half success.</p>
<p>root@NAS:/var/www/emoncms# php /var/www/emoncms/Modules/scheduler/scheduler_run.php<br />
	PHP Fatal error:&nbsp; Call to a member function fetch_array() on a non-object in /var/www/emoncms/Modules/scheduler/scheduler_model.php on line 51</p>
<p>Fatal error: Call to a member function fetch_array() on a non-object in /var/www/emoncms/Modules/scheduler/scheduler_model.php on line 51</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21482"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multi zone heating scheduler development</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 20/05/2014 - 11:21.</div>
    <div class="content">
     <p>After installing the scheduler module did you run &quot;Admin&quot; -&gt; &quot;Check&amp;Update&quot; in emonCMS&nbsp;via your browser?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21483"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6146.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="maglo18&#039;s picture" title="maglo18&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multi zone heating scheduler development</h3>

    <div class="submitted">Submitted by <a href="../user/6146.html" title="View user profile.">maglo18</a> on Tue, 20/05/2014 - 13:40.</div>
    <div class="content">
     <p>Thanks. Now is working.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21484"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6146.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="maglo18&#039;s picture" title="maglo18&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multi zone heating scheduler development</h3>

    <div class="submitted">Submitted by <a href="../user/6146.html" title="View user profile.">maglo18</a> on Tue, 20/05/2014 - 14:25.</div>
    <div class="content">
     <p>Thank You. Now is working.</p>
<p>How to add on dashboard push&nbsp;button? I want to on/off really&nbsp;in my house. Maybe &nbsp;someone have better idea how to control&nbsp;relay from emoncms?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-21614"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Multi zone heating scheduler development</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Tue, 27/05/2014 - 13:31.</div>
    <div class="content">
     <p>Dashboard push buttons that set the control variables in packetgen are a feature that needs to be added. If anyone would like to have a go at implementing this, the push button that sets a feed may be a good place to start, it would involve changing line 41 to the packetgen api rather than the feed api</p>
<p><a href="../../../github.com/emoncms/emoncms/blob/master/Modules/dashboard/Views/js/widgets/button/button_render.html#L41" title="https://github.com/emoncms/emoncms/blob/master/Modules/dashboard/Views/js/widgets/button/button_render.js#L41">https://github.com/emoncms/emoncms/blob/master/Modules/dashboard/Views/j...</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/4355"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-a1YJSI7CGckgGwEo2kcZUg-kxE2K2kd2SG38vLuZhDQ" value="form-a1YJSI7CGckgGwEo2kcZUg-kxE2K2kd2SG38vLuZhDQ"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
