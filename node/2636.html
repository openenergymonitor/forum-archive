<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/2636 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:21:23 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Using Jeenode and RPI- How to setup minimum base-station and simple RF-remote such as send variable voltage | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/3.html">Archived: General Discussion</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Using Jeenode and RPI- How to setup minimum base-station and simple RF-remote such as send variable voltage</h3>
        <span class="submitted">Submitted by Guest on Mon, 29/07/2013 - 11:08</span>
        <div class="content"><p>To continue with this post I have changed the Transmitting and Receiving firmware</p>
<p>The aim is still to setup a water monitoring system using 2 x&nbsp;<strong>JeeNodes</strong> and Raspberry Pi</p>
<p>Can anyone recommend the best way to get a minimum working system in emoncms with Jeenodes.</p>
<p>For instance I have the RPI&nbsp;running ok with the standard image and can login and run emoncms.</p>
<p>I need a remote reader Jeenode at the water meter sending to a Jeenode connected to the RPI.</p>
<p>I have tried the following:</p>
<p><u><strong>&nbsp;Water-meter&nbsp;Jeenode</strong></u></p>
<p>&nbsp; &nbsp; &nbsp; using g_transmittingData.ino . group 210, node 10</p>
<p><u><strong>RPI with Jeenode&nbsp;</strong></u></p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;using a_FixedPackets.ino group 210, node 15,</p>
<p>&nbsp;</p>
<p>emoncms seems to be seeing some input it shows &quot;ok&quot; when I test inputs, but feeds don&#39;t show on graphs.</p>
<p>&nbsp;</p>
<p>If I can get this to work hopefully I can then look at more advanced implementations.&nbsp;</p>
<p>&nbsp;</p>
<p>Basicall how can I get the readings from the&nbsp;Jeenodes&nbsp;to show on a emoncms graph.?</p>
<p>Thanks</p>
  <div class="forum-topic-navigation clear-block">
          <a href="2641.html" class="topic-previous" title="Go to previous forum topic">‹ Project photovoltaic hybrid</a>
              <a href="2607.html" class="topic-next" title="Go to next forum topic">Calibrating AC-AC Voltage ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-13930"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="gyrolen&#039;s picture" title="gyrolen&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Jeenode and RPI- How to setup minimum base-station and simple RF-remote such as send variable voltage</h3>

    <div class="submitted">Submitted by gyrolen (not verified) on Tue, 30/07/2013 - 00:10.</div>
    <div class="content">
     <p>Have changed firmware but still no success.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13934"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Jeenode and RPI- How to setup minimum base-station and simple RF-remote such as send variable voltage</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 30/07/2013 - 11:11.</div>
    <div class="content">
     <p>What is the format of the data that you are sending? The Input API help in emoncms gives the formats that are acceptable. If you do not include your API read&amp;write key, emoncms will not accept the data.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13940"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="gyrolen&#039;s picture" title="gyrolen&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Jeenode and RPI- How to setup minimum base-station and simple RF-remote such as send variable voltage</h3>

    <div class="submitted">Submitted by gyrolen (not verified) on Tue, 30/07/2013 - 13:17.</div>
    <div class="content">
     <p>Thanks for replying Robert.</p>
<p>I don&#39;t understand enough to properly answer your question, but if I give you more info maybe you will be able to direct me.</p>
<p>Because I already have 2x&nbsp;JeeNodes&nbsp; , which have an on-board RFM12B&nbsp; I would like to use them rather than make a emonTx or LCD board, and I have a RPI with the emoncms image downloaded and running.</p>
<p>One JN is connected to the water-meter reading the reed-switch the other&nbsp;JN is connected to the RPI as ttyUSB0.</p>
<p>The data only needs to be one byte which are the counts of the reed-switch closings for 1 minute and sent via RF to the RPI.</p>
<p>Questions:</p>
<p>What Sketches do I need to put into the water-meter JN and the RPI JN.?</p>
<p>&nbsp; &nbsp; &nbsp;For instance maybe for a trial I could use the test2.ino sketch from JeLabs&nbsp;in the water-meter which captures one bye of reading from the digital.input port and sends a packet via RF.</p>
<p>&nbsp; &nbsp; &nbsp;The RPI Sketch maybe I could be the RF12Demo.ino from Jeelabs which reads the RF&nbsp;packet and prints to the terminal.</p>
<p>Would this be enough for to do a basic set up so that my localhost/emoncms&nbsp;could show some readings.</p>
<p>Do I need to add the API key to every byte of data sent from the water-meter.?</p>
<p>Any suggestions welcomed.</p>
<p>Len</p>
<p>&nbsp; &nbsp; &nbsp;&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13942"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Jeenode and RPI- How to setup minimum base-station and simple RF-remote such as send variable voltage</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 30/07/2013 - 13:53.</div>
    <div class="content">
     <p>I can&#39;t identify for certain the Jeelabs sketch you are referring to.&nbsp; As far as I can tell, you have a sketch that is detecting the switch operating and is generating a message - a single byte in your case - and outputting that via the RFM12B. You need to send a longer message than that which emonCMS can validate and interpret.</p>
<p>The easiest way to interface to emoncms is to send it a message in the format it understands. That is what I was referring to. Log in to emoncms and go to <a href="http://emoncms.org/input/api" title="http://emoncms.org/input/api">http://emoncms.org/input/api</a>. and right at the top of the page are examples that you can type in your web browser.</p>
<p>If you look at one of the NanodeRF or OKG Base sketches, you can see how that string is built up. For example:</p>
<p class="rteindent1">str.reset();<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.print(basedir); str.print(&quot;/input/post.json?&quot;);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.print(&quot;apikey=&quot;); str.print(apikey);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.print(&quot;&amp;node=&quot;);&nbsp; str.print(node_id);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.print(&quot;&amp;csv=&quot;);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (byte i=0; i&lt;n; i+=2)<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int num = ((unsigned char)rf12_data[i+1] &lt;&lt; 8 | (unsigned char)rf12_data[i]);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (i) str.print(&quot;,&quot;);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.print(num);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.print(&quot;\0&quot;);&nbsp; //&nbsp; End of json string</p>
<p>:You need to do something like that, using your own APIKEY of course.</p>
<p>Your RPi is of course already running emonCMS, so it should all work instantly once you send it the data it is expecting.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13943"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3657.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3657.jpg" alt="Mattia Rossi&#039;s picture" title="Mattia Rossi&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Jeenode and RPI- How to setup minimum base-station and simple RF-remote such as send variable voltage</h3>

    <div class="submitted">Submitted by <a href="../user/3657.html" title="View user profile.">Mattia Rossi</a> on Tue, 30/07/2013 - 13:56.</div>
    <div class="content">
     <p>Hi Len,</p>
<p>you are almost there ... communication between a node (be it an emontx/jeenode/arduino/external program) to emoncms happens through either an API (Application Programming Interface) or using a php script that retrieves the data and uses the emoncms framewrok to store it.</p>
<p>This means that in order to have some data stored in emoncms you have to:</p>
<ul>
<li>
		Collect the data from a sensor (as I said, jeenode, emontx, gpio input on the pi), in your case you are using a jeenode&nbsp;with a sensor attached. I guess the sketch you loaded into the jeenode does that</li>
<li>
		Transmit the data to emoncms. In order to do this in your case you will need to:</p>
<ul>
<li>
				receive the data with your second jeenode</li>
<li>
				have a script that monitors the serial port on which the jeenode communicates and forward that data to emoncms&nbsp;either through a direct script (an example of which is the rfm12php&nbsp;script in /emoncms/Modules/raspberry ) or through an http GET call the format of which is decribed in the API (&nbsp;/emoncms/input/api).</li>
</ul>
</li>
</ul>
<p>If you feel like experimenting with a direct script you should have a look at the&nbsp;rfm12php&nbsp;script about including the emoncms framework and reading from the serial (not easy if you are not into software development)</p>
<p>If you feel like you just need to read the data, store it in emoncms&nbsp;and forget about the bad experience in programming :) then a good starting point could be this post&nbsp;http://openenergymonitor.org/emon/node/1418</p>
<p>where another user added the functionality to store data from a serial device.</p>
<p>&nbsp;</p>
<p>#!/usr/bin/perl -w</p>
<p># Reads data from a Current Cost device via serial port.</p>
<p>use strict;<br />
	use Device::SerialPort qw( :PARAM :STAT 0.07 );<br />
	use LWP::UserAgent;</p>
<p>my $key = &quot;your_emoncms api key_here&quot;;</p>
<p>my $PORT = &quot;/dev/ttyUSB0&quot;;<br />
	my $meas = 0;<br />
	my $sumW = 0;<br />
	my $sumT = 0;<br />
	my $watts;<br />
	my $temp;<br />
	my $wget;</p>
<p>my $ob = Device::SerialPort-&gt;new($PORT)&nbsp; || die &quot;Can&#39;t open $PORT: $!\n&quot;;<br />
	$ob-&gt;baudrate(57600);<br />
	$ob-&gt;write_settings;</p>
<p>open(SERIAL, &quot;+&gt;$PORT&quot;);<br />
	while (my $line = &lt;SERIAL&gt;) {<br />
	&nbsp;&nbsp;&nbsp; if ($line =~ m!&lt;tmpr&gt; *([\-\d.]+)&lt;/tmpr&gt;.*&lt;ch1&gt;&lt;watts&gt;0*(\d+)&lt;/watts&gt;&lt;/ch1&gt;!) {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; my $watts = $2;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; my $temp = $1;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #print &quot;SUCCESS $meas: ... $watts, $temp\n&quot;;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $meas++;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sumW += $watts;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sumT += $temp;<br />
	&nbsp;&nbsp;&nbsp; }<br />
	&nbsp;&nbsp;&nbsp; if ($meas == 10) { #time to send<br />
	&nbsp;&nbsp;&nbsp;&nbsp; $watts = $sumW/10;<br />
	&nbsp;&nbsp;&nbsp;&nbsp; $temp = $sumT/10;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #print &quot;AVERAGE: ... $watts, $temp\n&quot;;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; my $emon_ua = LWP::UserAgent-&gt;new;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; my $emon_url = &quot;http://localhost/emoncms3/api/post?apikey=$key\&amp;json={power:$watts,temp:$temp}&quot;;<br />
	my $emon_response = $emon_ua-&gt;get($emon_url);</p>
<p>if ($emon_response-&gt;is_error) {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; die $emon_response-&gt;status_line;<br />
	}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
	}<br />
	}</p>
<p>&nbsp;</p>
<p>You will have to change the script to suit you serial parameters, the link to your emoncms instance and the decoding of the serial communication</p>
<p>&nbsp;</p>
<p>If you fell like this is still too much for your programming skills try and post the output from the serial port and I&#39;ll see if we can hack something together ...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13982"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="gyrolen&#039;s picture" title="gyrolen&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Jeenode and RPI- How to setup minimum base-station and simple RF-remote such as send variable voltage</h3>

    <div class="submitted">Submitted by gyrolen (not verified) on Thu, 01/08/2013 - 13:21.</div>
    <div class="content">
     <p>Is the API stuff required if I only want to run the emoncms server on my RPi only. ?</p>
<p>I don&#39;t particularly need to send it to emoncms.org , yet.</p>
<p>For a test run just a connection between the watermeter and the localhost&nbsp;RPi&nbsp;is fine.</p>
<p>I have tried the following setup water-meter -&gt; RPi&nbsp;, but can&#39;t get any active inputs going on the localhost-emoncms</p>
<p><strong>A Sketch for the RPi&nbsp;base-station from the NanodeRf b_MultiNode.</strong></p>
<p><em>#include &lt;JeeLib.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //https://github.com/jcw/jeelib</em></p>
<p><em>void setup ()<br />
	{<br />
	&nbsp; Serial.begin(9600);<br />
	&nbsp; Serial.println(&quot;RPi Server&quot;);<br />
	&nbsp; rf12_initialize(15, RF12_868MHZ, 100);<br />
	}</em></p>
<p><em>void loop ()<br />
	{<br />
	&nbsp; if (rf12_recvDone() &amp;&amp; rf12_crc == 0 &amp;&amp; (rf12_hdr &amp; RF12_HDR_CTL) == 0)<br />
	&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
	&nbsp;&nbsp;&nbsp; int node_id = (rf12_hdr &amp; 0x1F);<br />
	&nbsp;&nbsp;&nbsp;<br />
	&nbsp;&nbsp;&nbsp; // Get the packet length (number of integers sent is n/2)<br />
	&nbsp;&nbsp;&nbsp; byte n = rf12_len;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
	&nbsp;&nbsp;&nbsp; Serial.print(&quot;Node: &quot;);<br />
	&nbsp;&nbsp;&nbsp; Serial.print(node_id);</em></p>
<p><em>&nbsp;&nbsp;&nbsp; Serial.print(&quot; data: &quot;);<br />
	&nbsp;&nbsp;&nbsp;<br />
	&nbsp;&nbsp;&nbsp; // Go throught the packet 2 bytes at a time<br />
	&nbsp;&nbsp;&nbsp; for (byte i=0; i&lt;n; i+=2)<br />
	&nbsp;&nbsp;&nbsp; {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Create an integer from each block of two bytes (using bitwise math)<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int num = ((unsigned char)rf12_data[i+1] &lt;&lt; 8 | (unsigned char)rf12_data[i]);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Print the output as CSV<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (i) Serial.print(&quot;,&quot;);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.print(num);<br />
	&nbsp;&nbsp;&nbsp; }<br />
	&nbsp;&nbsp;&nbsp; Serial.println();<br />
	&nbsp; }<br />
	}</em></p>
<p><strong>A Sketch for the water-meter adapted from JCW&#39;s&nbsp;Housemon&nbsp;test2&nbsp;</strong></p>
<p><em>#include &lt;JeeLib.h&gt;<br />
	#include &lt;Ports.h&gt; // needed to aviod Linker error</em></p>
<p><em>typedef struct { int counts,battery;} PayloadTX;</em></p>
<p><em>PayloadTX watermeter;</em></p>
<p><em>void setup () {</em></p>
<p><em>&nbsp;</em><em>Serial.begin(9600);</em></p>
<p><em>&nbsp; Serial.println(&quot;Water-meter&quot;);</em></p>
<p><em>&nbsp;&nbsp;rf12_initialize(10, RF12_868MHZ, 100);</em><br />
	<em>}</em></p>
<p><em>void loop () {<br />
	&nbsp; watermeter.counts = analogRead(0); // simulate watermeter count<br />
	&nbsp; watermeter.battery =map(analogRead(6),0,1023,0,660);// not active yet<br />
	&nbsp;&nbsp; int i = 0; while (!rf12_canSend() &amp;&amp; i&lt;10) {rf12_recvDone(); i++;}<br />
	&nbsp;&nbsp; rf12_sendStart (0, &amp;watermeter, sizeof watermeter);</em><br />
	<em>}</em></p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13983"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="gyrolen&#039;s picture" title="gyrolen&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Jeenode and RPI- How to setup minimum base-station and simple RF-remote such as send variable voltage</h3>

    <div class="submitted">Submitted by gyrolen (not verified) on Thu, 01/08/2013 - 13:30.</div>
    <div class="content">
     <p>Hi, thanks for your reply.I have also sent a reply to Robert Wall, in this string. Some of &nbsp;it may apply to your suggestions.</p>
<p>If it is applicable,I don&#39;t know how to send Perl commands, do I need to download a Perl interpreter.</p>
<p>Please notice I don&#39;t particularly need to send to emoncms.org , the localhost RPi will do for a test.</p>
<p>Len</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13988"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3657.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3657.jpg" alt="Mattia Rossi&#039;s picture" title="Mattia Rossi&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Jeenode and RPI- How to setup minimum base-station and simple RF-remote such as send variable voltage</h3>

    <div class="submitted">Submitted by <a href="../user/3657.html" title="View user profile.">Mattia Rossi</a> on Thu, 01/08/2013 - 21:11.</div>
    <div class="content">
     <p>Hi Len, don&#39;t take it the wrong way please, but I think you would be better off just ordering a rfm12pi module and using the standard raspberry module...the feel is that you want to accomplish something that is way over your actual experience with linux and programming.</p>
<p>It is not simply a matter of uploading a sketch and running a shell command, you need to understand the process you need to apply on order to move data from a node to the cms, and as I stated the api &#39;stuff&#39; is actually the easiest of the two ways&nbsp;you can use to send data to emoncms&nbsp;(be it your local instance or the main emoncms server).</p>
<p>The sketch you are using on the receiver writes data to the serial port, emoncms&nbsp;listens for data on a network socket, hence you need another layer that retrieves the data from the serial port and forwards it to emoncms. It cannot get simpler than that, other than using the rfm12pi hardware for which this intermediate layer has already been written/tested.</p>
<p>Regards</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13996"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Jeenode and RPI- How to setup minimum base-station and simple RF-remote such as send variable voltage</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 01/08/2013 - 23:03.</div>
    <div class="content">
     <p>Len, I don&#39;t understand. Didn&#39;t you say you were already running a local RPi with emoncms on it? and running OK?</p>
<p>In that case all you need to do is expand the string your JeeNode sends to something like</p>
<p class="rteindent1">&quot;/emoncms/input/post.json?apikey=yourbiglongapikeyhexnumber&amp;node=10&amp;csv=123&quot;</p>
<p>Then your intermediate JeeNode just has to forward that byte-for-byte. (Unless of course you want to send just the value from JeeNode1 to JeeNode2, in which case JeeNode2 must assemble the message and send it.)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13999"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3657.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3657.jpg" alt="Mattia Rossi&#039;s picture" title="Mattia Rossi&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Jeenode and RPI- How to setup minimum base-station and simple RF-remote such as send variable voltage</h3>

    <div class="submitted">Submitted by <a href="../user/3657.html" title="View user profile.">Mattia Rossi</a> on Fri, 02/08/2013 - 04:17.</div>
    <div class="content">
     <p>Robert,</p>
<p>I think the problem is that the receiving jeenode&nbsp;communicates through serial with the pi, and won&#39;t be able to directly post the data to emoncms but only to the serial (actually the receiving sketch Len posted&nbsp;is already doing that and forwarding to the serial the data in csv format). He needs a script that reads fromthe serial and posts to emoncms&nbsp;like the one I posted that needs to be adapted to the csv format. If I have time later today I&#39;ll try and modify it together with instructions about how to run it.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-14014"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Jeenode and RPI- How to setup minimum base-station and simple RF-remote such as send variable voltage</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Fri, 02/08/2013 - 13:42.</div>
    <div class="content">
     <p>Ah, I&#39;d missed the bit where Len is using the second Jeenode as the RF receiver for the Pi. :-(</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-14015"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3657.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3657.jpg" alt="Mattia Rossi&#039;s picture" title="Mattia Rossi&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Using Jeenode and RPI- How to setup minimum base-station and simple RF-remote such as send variable voltage</h3>

    <div class="submitted">Submitted by <a href="../user/3657.html" title="View user profile.">Mattia Rossi</a> on Fri, 02/08/2013 - 14:37.</div>
    <div class="content">
     <p>Well, it compensates for understanding a google translation from portuguese in another thread and correctly debugging the code at the first try :)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/2636"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-QYe5CjdPITVTe5V7gLar5-aTDY2wv8scA5BHTUZw5Lw" value="form-QYe5CjdPITVTe5V7gLar5-aTDY2wv8scA5BHTUZw5Lw"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
