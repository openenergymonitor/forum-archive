<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11212 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:49:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Demand Side Management of Electricity Consumption | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Demand Side Management of Electricity Consumption</h3>
        <span class="submitted">Submitted by <a href="../user/8674.html" title="View user profile.">andrewhg</a> on Sat, 05/09/2015 - 11:37</span>
        <div class="content"><p>My goal is to contribute in my own small way to &nbsp;&quot;Demand Side Management&quot; of the national energy grid as a way to make renewable technology more viable, without large scale implementation of energy storage. I also want to maximise self consumption&nbsp;of Solar Photo Voltaic Electricity when I eventually get panels in 1 or 2 years.&nbsp;</p>
<p>Initially, an immersion hot water cylinder will be used to modulate my electricity demand, in the future, I would also like to control other loads via RF power sockets etc.&nbsp;</p>
<p>In New Zealand we have an Electricity Retailer who&nbsp;charge spot prices for electricity. Therefore I plan to use openenergymonitor hardware and software to build a system that can monitor the price/availability of electricity on the national electricity grid and vary my demand accordingly.&nbsp;</p>
<p>So far I have purchased the following hardware from the site:&nbsp;</p>
<p>1 x Programmer - USB to serial UART<br />
1 x AC-AC Power Supply Adapter - AC voltage sensor (UK Plug)<br />
1 x emonTx Arduino Shield SMT&nbsp;<br />
(Frequency: 433Mhz (Worldwide), Arduino Shield Headers: Standard Headers)<br />
1 x emonBase - Raspberry Pi based web-connected base-station&nbsp;<br />
(RaspberryPi RF add-on: RFM69Pi - 433Mhz, Raspberry Pi: Raspberry Pi 2, Pre-build SD Card: Pre-Loaded microSD Card, Enclosure: Raspberry Pi Case - Clear)</p>
<p>Additional hardware I will require will be:</p>
<ul>
<li>SCT - 013 -015&nbsp;for monitoring the hot water cylinder.&nbsp;</li>
<li>SCT - 013 -000 for the mains line.&nbsp;</li>
<li>SCT - 013 -015 when I get solar panels.&nbsp;</li>
<li>USB power supplies.</li>
<li>&nbsp;SSR output stage - thinking about Crydom&nbsp;D2425</li>
<li>&nbsp;Arduino&nbsp;Uno.</li>
<li>Suitable temperature sensors. &nbsp;</li>
</ul>
<p>I have very little experience with arduino and no experience with RaspberryPi. I have a good general understanding of web Development and have built some basic PHP applications.&nbsp;&nbsp;I am reading the forum a lot and trying to figure out how this system will work. I will be able to further my knowledge when I have the hardware in my hands and start&nbsp;to put it together.&nbsp;</p>
<p>&nbsp;Here is what I have so far.&nbsp;</p>
<ol>
<li>I will install the&nbsp;<strong>EmonTx Arduino Shield</strong>&nbsp;near my switchboard with a CT on the Mains incoming line and the line to the hot water cylinder. I will fit three temperature sensors to the hot water cylinder at the top middle and bottom.&nbsp;</li>
<li>The <strong>Raspberry Pi web-connected base-station</strong>&nbsp;will scrape the spot price off the electricity retailers website at regular intervals and send this data<span style="line-height: 16.6399993896484px;">&nbsp;data to the&nbsp;</span><strong style="line-height: 16.6399993896484px;">EmonTX&nbsp;Arduino&nbsp;Shield</strong><span style="line-height: 16.6399993896484px;">&nbsp;wirelessly.</span></li>
<li>If certain criteria are met then the <strong>EmonTx Arduino Shield </strong>will turn on the 3kw hot water cylinder via a SSR. When the price of electricity is below a certain threshold value then the SSR will turn on and draw 3kw. When the temperature of the water at the top of the tank is below a certain threshold value then the SSR will turn on so we have enough water for a shower. However if the price of electricity is exorbitant then the cylinder will not turn on regardless of the temperature of the hot water cylinder.&nbsp;</li>
<li>When I eventually get Photovoltaic Solar Electricity Panels, the&nbsp;<strong>EmonTx Arduino Shield</strong>&nbsp;will be used as a PV router to ensure self consumption of generated electricity because the buy back rate in New Zealand is so low.(About 7c in summer and 10c in winter) It is also possible that this company may start to&nbsp;<strong>pay&nbsp;</strong>for solar at spot prices. In this case the HWC would turn off and electricity sold back to the grid when prices are favorable.&nbsp;</li>
<li>I would also eventually like to control other loads in my house. With the use of an RF power socket, it should be possible to control certain loads to ensure that self consumption of PV generation is maintained. For example, my freezer could be connected to a RF socket. It should also have temperature sensors fitted. If Solar generation dips to a point where energy is being imported, then the freezer is turned off, provided that it&#39;s internal temperature is within limits.&nbsp;https://www.youtube.com/watch?v=Z7qUXEw24E4</li>
</ol>
<p>If anyone is willing to provide some feedback on whether or not I am on the right track that would be great.&nbsp;</p>
<p><strong>Questions:&nbsp;</strong></p>
<ol>
<li>What specific method would <strong>you</strong> use to scrape the spot price of the electricity retailers website.I am more interested in the code required on the Rpi. I don&#39;t think I would have too much trouble building a scraper in php, but I don&#39;t know how to automatically run that php and make it available to the base station code.&nbsp;</li>
<li>How does the <strong>Raspberry Pi web-connected base-station</strong>&nbsp;send this information to&nbsp;the&nbsp;<strong>EmonTx Arduino Shield.&nbsp;</strong></li>
<li>Where specifically on the EmonTx&nbsp; should the code that controls the hot water cylinder be inserted?</li>
<li>How can the GUI on the&nbsp;<strong>Raspberry Pi web-connected base-station&nbsp;</strong>be modified so I have an input field to enter the &quot;thresholds&quot; which the&nbsp;<strong>EmonTx&nbsp;Arduino&nbsp;Shield&nbsp;</strong>responds to. For example, I might want to go on the GUI and set the minimum temperature at the top of the hot water cylinder to 40deg. Or if I am going away for a week then set the HWC to turn off completely and then turn it back on&nbsp;before I get home. Will these thresholds be sent to the&nbsp;<strong>EmonTx&nbsp;Arduino&nbsp;Shield&nbsp;</strong>at the same rate as the spot price, or will this only be sent when it is modified and stored locally on eeprom?&nbsp;</li>
<li>Are there any hardware considerations I need to make now so the system can be adapted to be used as a PV proportional router in the future when i get Solar Voltaic Electricity Panels?</li>
<li>Does it make sense to choose the CT&#39;s the way that I have? Or is it better to just buy SCT - 013 -000 and then attach suitable burden resistors. Are the burden resistors the SMT ones you can see on the <strong>EmonTx Arduino Shield&nbsp;</strong>on the shop page? Do they just get de-soldered if you have a voltage output CT?</li>
</ol>
<p><strong>Edits:</strong></p>
<p><strong>6/9/2015&nbsp;</strong>Changed &quot;EmonTx&quot; to &quot;EmonTx&nbsp;Arduino Shield&quot;. Changed &quot;SolarPv&quot; to Solar Photovoltaic Electricity Panels to make it clear that I am not talking about solar hot water panels.&nbsp;</p>
<p>Added a bunch of quesitons.&nbsp;</p>
<p>Updated my proposed setup.&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11208.html" class="topic-previous" title="Go to previous forum topic">‹ I need to monitor voltage, current and power factor</a>
              <a href="11214.html" class="topic-next" title="Go to next forum topic">EmonCMS: Fatal error in user_model.php on line 581  ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-33882"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Demand Side Management of Electricity Consumption</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 05/09/2015 - 14:24.</div>
    <div class="content">
     <p>That [before you edited it] all sounds reasonable to me. </p>
<p>I suspect you'll need two completely different sets of rules depending on where your energy is coming from, so do a search through here for stratification. You might find that you want to add a pump to circulate the hot water within the tank when the energy is from PV, and/or you might want to add temperature sensors at selected levels down the tank so that you know how much hot water there is in the tank when you're paying for the energy.</p>
<p>Our normal assumption is that the information flow is from the Arduino to the Base to the Web, yours is exactly the opposite but as the RFM69 radio modules are both transmitter and receiver (though half-duplex working only), that should be OK. </p>
<p>[Note: to avoid confusion, please don't refer to the Shield as an "emonTx" - that's a different beast that has it's own processor, which the EmonTx Shield doesn't have.]</p>
<p>You also might want to (and reading between the lines you have already) read up about the PV diverter. Given some local generation, that will mop up surplus power in a controlled fashion. How effective that is depends significantly on the properties of your supplier's energy meter and what your import and export tariffs are.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-33904"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8674.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="andrewhg&#039;s picture" title="andrewhg&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Demand Side Management of Electricity Consumption</h3>

    <div class="submitted">Submitted by <a href="../user/8674.html" title="View user profile.">andrewhg</a> on Sun, 06/09/2015 - 00:59.</div>
    <div class="content">
     <blockquote><p><em>&quot;You might find that you want to add a pump to circulate the hot water within the tank when the energy is from PV&quot;</em></p>
</blockquote>
<p>I am not sure why a pump would be required. The heating element is at the bottom of the tank. Stratification is actually a good thing because&nbsp;the hot water rises to the top of the tank to be used which means the whole tank does not have to be heated in order to have a comfortable shower. However, if I do have access to a good price, or the sun is shining and I have lots of Excess PV generation then the whole tank can easily be heated to full temperature because the heating element is at the bottom.&nbsp;</p>
<blockquote><p>&quot;Our normal assumption is that the information flow is from the Arduino to the Base to the Web, yours is exactly the opposite but as the RFM69 radio modules are both transmitter and receiver (though half-duplex working only), that should be OK.&quot;</p>
</blockquote>
<p>I don&#39;t understand the comment about &quot;half-duplexing&quot;, but I am sure that it will become clear to me once I have the hardware and I can start experimenting.&nbsp;</p>
<blockquote><p>&quot;You also might want to (and reading between the lines you have already) read up about the PV diverter. Given some local generation, that will mop up surplus power in a controlled fashion. How effective that is depends significantly on the properties of your supplier&#39;s energy meter and what your import and export tariffs are.&quot;</p>
</blockquote>
<p>Yes, PV diversion was my first goal but then this company started up which is going to be selling power at spot prices. This potentially means that solar won&#39;t be economically viable for a few more years because a&nbsp;micro-controller can be used to demand power at prices that are cheaper than solar panels are able to provide. I will eventually get solar panels even if the economics does not make complete sense because it is the right thing to do.&nbsp;</p>
<p>I recently got a quote for a 3kw solar array which would provide power at 18c per kWh for the next 15 years.&nbsp;</p>
<p>This electricity companies prices at night can be as low as 13c kWh. Based on their information, the price is less than 18c/kWh about 37 percent of the time or 8 hours per day.&nbsp;To raise my HWC from 20deg to 60 deg would require 10.2kWh of electricity plus 2kWh for standing losses. So I would need 4 hours of electricity per day below 18c kWh to be cheaper than solar panels.&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-33907"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3426.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3426.jpg" alt="Bill Thomson&#039;s picture" title="Bill Thomson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Demand Side Management of Electricity Consumption</h3>

    <div class="submitted">Submitted by <a href="../user/3426.html" title="View user profile.">Bill Thomson</a> on Sun, 06/09/2015 - 03:39.</div>
    <div class="content">
     <p><em>I don&#39;t understand the comment about &quot;half-duplexing&quot;, but I am sure that it will become clear to me once I have the hardware and I can start experimenting.&nbsp;</em></p>
<p>A familiar example of half-duplex operation is the two-way voice radio. i.e. user A must stop transmitting and give user B the go-ahead to transmit before user B can transmit and be heard by user A. (and vice-versa) In short, only one user can transmit at a time.</p>
<p>The ordinary telephone is a common example of full-duplex operation. Both parties can transmit and receive at the same time.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-33908"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8674.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="andrewhg&#039;s picture" title="andrewhg&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Demand Side Management of Electricity Consumption</h3>

    <div class="submitted">Submitted by <a href="../user/8674.html" title="View user profile.">andrewhg</a> on Sun, 06/09/2015 - 03:58.</div>
    <div class="content">
     <blockquote><p>&quot;A familiar example of half-duplex operation is the two-way voice radio. i.e. user A must stop transmitting and give user B the go-ahead to transmit before user B can transmit and be heard by user A. (and vice-versa) In short, only one user can transmit at a time.</p>
<p>The ordinary telephone is a common example of full-duplex operation. Both parties can transmit and receive at the same time.&quot;</p>
</blockquote>
<p>Ah ok, that&#39;s simple enough. What implications does this have for sending data from the <strong>Base Station</strong> to the&nbsp;<strong>EmonTx Arduino Shield?&nbsp;</strong>How do they manage their two way communication?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-33913"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Demand Side Management of Electricity Consumption</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 06/09/2015 - 12:09.</div>
    <div class="content">
     <p><i>"How do they manage their two way communication?"</i><br />
Simply, you can't have both ends trying to transmit at the same time. If you know the shield transmits every 20 s (say), a good way would be to wait for that, then transmit in the opposite direction. It's up to you to define a workable protocol.</p>
<p><i>"Stratification is actually a good thing"</i><br />
That's been questioned here in the past. Hence "Might...want to...". You can search and read the arguments if you wish.</p>
<p>I would put as much intelligence in the Pi as possible, and leave the Arduino to concentrate on switching, so every 2 mins (say) you update the Arduino with a "heat/don't heat the water" command, and leave it to get on with it. It means you might pay or lose out on 119.98 seconds' worth, though I wouldn't want to issue the command on every mains cycle or even every second. It depends of course on how often and when the prices are published.<br />
(If you're going to transmit a lot and often, you need to check the local regulations for that RF band. Here, I think you're allowed to transmit for 1% of the time.)</p>
<p>Q2 &amp; 3.<br />
You need to study the sketch for that. An example of a sketch that both receives and transmits is one of the GLCD ones.</p>
<p>Q5.<br />
Basically, as long as it's built as a PV Router, you just turn the output hard on or hard off until such time as you go proportional. It's pretty much like the thread: "switching fixed load on when surplus pv passes programmed amount." was asking.</p>
<p>Q6.<br />
Maybe not. When you buy the "voltage output" sort, they have an internal burden resistor instead of zener diodes for protection. As I understand it, that's the only difference. So if you envisage a need for flexibility in the future, I'd get 3 proper current transformers and change the burden resistor on the Shield - that way you can scale it for whatever current you want (within the CT's limits of accuracy of course). Yes, the burden is the big SMT one behind the connector (and <b>do</b> make sure you assemble the connectors on the 'wrong' side as per the photos) and yes, you unsolder and remove the SMT one and there are holes for a wire-ended component instead (not as well as).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11212"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-HfeR69MoDiCQeaJg9XuQla63h6N4QGQ87WbS66_DHgE" value="form-HfeR69MoDiCQeaJg9XuQla63h6N4QGQ87WbS66_DHgE"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
