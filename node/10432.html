<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/10432 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:32:05 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>JeeNode v6 - Send Data to Raspi emonbase | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">JeeNode v6 - Send Data to Raspi emonbase</h3>
        <span class="submitted">Submitted by <a href="../user/7946.html" title="View user profile.">MueThoS</a> on Fri, 03/04/2015 - 10:50</span>
        <div class="content"><p>Hello there,</p>
<p>i have a question and i hope you understand me in my english.</p>
<p>I have a JeeNode v6 with RFM12B on board.&nbsp;Some Years ago i have transmit some data over it. But its a long Time ago.&nbsp;Now i want to transmit Data to the Raspi where emonbase is running.&nbsp;But i have tryed&nbsp;so many versions of code but nothing is shown on emonbase input side.</p>
<p>Have someone a running code for JeeNode&nbsp;v6 that only send data.&nbsp;The data can be static, the point is to understand the transmit.&nbsp;Collecting data from RoamBoard or something like this can i try to code myself.</p>
<p>Only sending and in best case set the board in sleep&nbsp;mode and wake up every 10 seconds is my problem.</p>
<p>I hope i explain my problem.</p>
<p>Greets</p>
<p>Thorsten</p>
  <div class="forum-topic-navigation clear-block">
          <a href="10438.html" class="topic-previous" title="Go to previous forum topic">‹ emonTH slow adjusting humidity</a>
              <a href="10436.html" class="topic-next" title="Go to next forum topic">EmonTH Hardware consideration ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-29363"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: JeeNode v6 - Send Data to Raspi emonbase</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Fri, 03/04/2015 - 16:46.</div>
    <div class="content">
     <p>As I understand it, a JeeNode uses the same basic parts that the emonTx uses - an Atmel ATMega328P processor and a RFM12B radio module.</p>
<p>Therefore, I think you need to approach your problem this way: </p>
<p>Find your old Jeenode sketch. That will have all the correct pin numbers, which you will need to know.</p>
<p>Look at an emonTx sketch. I suggest the simplest one that uses the RFM12B: <a href="https://github.com/openenergymonitor/RFM12B_Simple/blob/master/Tx_SimpleRFM12B_demo/Tx_SimpleRFM12B_demo.ino" title="https://github.com/openenergymonitor/RFM12B_Simple/blob/master/Tx_SimpleRFM12B_demo/Tx_SimpleRFM12B_demo.ino">https://github.com/openenergymonitor/RFM12B_Simple/blob/master/Tx_Simple...</a></p>
<p>This is a demonstration and all it does is send a packet of numbers every 2 s. Either copy from Tx_SimpleRFM12B_demo.ino the parts that make up the message into your sketch, or copy the hardware parts from your old JeeNode sketch into the Tx_SimpleRFM12B_demo.ino sketch. I think it is only the LED output in the Tx_SimpleRFM12B_demo.ino sketch, that you will need to remove, because the JeeNode has no LED.<br />
You will need a copy of JeeLib - instructions to get that are here: <a href="https://learn.openenergymonitor.org/?redirect=installing-arduino-libraries" title="http://openenergymonitor.org/emon/buildingblocks/installing-arduino-libraries">http://openenergymonitor.org/emon/buildingblocks/installing-arduino-libr...</a></p>
<p>If you can get that working, then look at the emonTx V3 sketches or the emonTH sketches to see how to put the board to sleep between readings. You might find this useful: <a href="http://jeelabs.net/projects/cafe/wiki/POF_03_-_Wireless_light_sensor" title="http://jeelabs.net/projects/cafe/wiki/POF_03_-_Wireless_light_sensor">http://jeelabs.net/projects/cafe/wiki/POF_03_-_Wireless_light_sensor</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29419"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7946.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MueThoS&#039;s picture" title="MueThoS&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: JeeNode v6 - Send Data to Raspi emonbase</h3>

    <div class="submitted">Submitted by <a href="../user/7946.html" title="View user profile.">MueThoS</a> on Mon, 06/04/2015 - 08:22.</div>
    <div class="content">
     <p>Hello,<br />
first thanks for the tips!</p>
<p>I have tried a lot and this is my result:</p>
<p>i have one jeenode as sniffer and one as tx.</p>
<p>At the sniffer i can see the tx. I have seen that the Nodes where at the wrong config.<br />
With the RF12_config i have correct the config. Now i am on 210 433.<br />
With some test i have seen the Data on my EmonHub.<br />
​Now i have to find out how to measure&nbsp;something.</p>
<p>&nbsp;</p>
<p>But i have a second Problem. I dont know is this the right location to ask this. Its a question about electric.<br />
I know a lot about electrics but this is me a mystery:</p>
<p>our stove runs for three phases! Phase two and three are ok. When the oven is off, there is no Electricity. However, the consumption is displayed with -30 Watt on phase one. Although the stove is off.<br />
I have another fuse where - is displayed. it is also on phase one but another fuse. I do not know what it is there because it is not labeled.<br />
But negative values?</p>
<p>This is a mystery. Have someone a idea?</p>
<p>Greets</p>
<p>MueThoS</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29422"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7780.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-7780.jpg" alt="mpruessmeier&#039;s picture" title="mpruessmeier&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: JeeNode v6 - Send Data to Raspi emonbase</h3>

    <div class="submitted">Submitted by <a href="../user/7780.html" title="View user profile.">mpruessmeier</a> on Mon, 06/04/2015 - 08:54.</div>
    <div class="content">
     <p>HI Thorsten,</p>
<p>try to turn the inductor 180&deg;. if you go the wrong direction through a inductor you get negative values.</p>
<p>Greetings Marc</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29425"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7946.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MueThoS&#039;s picture" title="MueThoS&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: JeeNode v6 - Send Data to Raspi emonbase</h3>

    <div class="submitted">Submitted by <a href="../user/7946.html" title="View user profile.">MueThoS</a> on Mon, 06/04/2015 - 11:02.</div>
    <div class="content">
     <p>Hi Marc,</p>
<p>I had also made first.<br />
However, the decisive is right by load.<br />
the Inductor is therefore right side up.</p>
<p>The problem must lie on the stove</p>
<p>Greetings Thorsten</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29427"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: JeeNode v6 - Send Data to Raspi emonbase</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 06/04/2015 - 11:48.</div>
    <div class="content">
     <p>What sketch are you running?</p>
<p>If you are using a single phase sketch and measuring 3 phases you can expect each to report a different value for the same fixed load as 2 CT&#39;s will be sampled out of phase.</p>
<p>With a single AC adapter you can measure 3 phases to a lesser accuracy by offsetting the measurement timing on the other 2 phases.</p>
<p>If using a 3 phase sketch try moving&nbsp;each&nbsp;ct to the next phase to create a comparison depending on whether the &quot;faulty&quot; reading moves with the CT/jeenode&nbsp;or remains on the same phase of the stove will help diagnose.</p>
<p>Or if using a single phase sketch put all 3 CT&#39;s on one wire to confirm&nbsp;they all report the same.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29428"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: JeeNode v6 - Send Data to Raspi emonbase</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 06/04/2015 - 12:53.</div>
    <div class="content">
     <p>To expand on Paul's answer:<br />
The 3-phase sketch works by recording the voltage of Phase 1, then "replaying" it 120&deg; later to calculate the power for phase 2, and again 120&deg; later than that for phase 3. You must have the order of the phases correct; that is, CT1 must be on the phase that has the voltage monitor, CT2 must the on the next phase and CT3 must be on the last phase. In the diagram here: <a href="https://learn.openenergymonitor.org/?redirect=3-phase-power" title="http://openenergymonitor.org/emon/buildingblocks/3-phase-power">http://openenergymonitor.org/emon/buildingblocks/3-phase-power</a> Phase 1 is red, Phase 2 is yellow, Phase 3 is blue.</p>
<p>This is not the most accurate method, the limitations are all listed in the comments in the sketch. You must calibrate it according to the instructions in the sketch.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29429"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7946.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MueThoS&#039;s picture" title="MueThoS&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: JeeNode v6 - Send Data to Raspi emonbase</h3>

    <div class="submitted">Submitted by <a href="../user/7946.html" title="View user profile.">MueThoS</a> on Mon, 06/04/2015 - 13:02.</div>
    <div class="content">
     <p>There was the standart&nbsp;sketch on the emonTX. So i think the single phase.</p>
<p>Now i have uploaded the 3 phase sketch.<br />
And i connect the uart-bridge. This is &nbsp;the debug result:</p>
<blockquote><p>
Voltage: 258.49<br />
&nbsp;Current 1: 0.52 Power 1: -56.35 VA 1: 135.02 PF 1: -0.42<br />
&nbsp;Current 2: 0.24 Power 2: -3.97 VA 2: 62.76 PF 2: -0.06<br />
&nbsp;Current 3: 0.76 Power 3: -157.43 VA 3: 195.20 PF 3: -0.81</p>
<p>Voltage: 258.87<br />
&nbsp;Current 1: 0.52 Power 1: -55.22 VA 1: 134.61 PF 1: -0.41<br />
&nbsp;Current 2: 0.25 Power 2: -5.99 VA 2: 63.62 PF 2: -0.09<br />
&nbsp;Current 3: 0.74 Power 3: ovf VA 3: 192.70 PF 3: ovf</p>
<p>Voltage: 258.66<br />
&nbsp;Current 1: 0.51 Power 1: -57.00 VA 1: 133.06 PF 1: -0.43<br />
&nbsp;Current 2: 0.25 Power 2: -5.23 VA 2: 64.31 PF 2: -0.08<br />
&nbsp;Current 3: 0.73 Power 3: -152.81 VA 3: 189.57 PF 3: -0.81</p>
<p>Voltage: 258.55<br />
&nbsp;Current 1: 0.52 Power 1: -55.41 VA 1: 133.73 PF 1: -0.41<br />
&nbsp;Current 2: 0.25 Power 2: -20.62 VA 2: 65.53 PF 2: -0.31<br />
&nbsp;Current 3: 0.74 Power 3: ovf VA 3: 190.20 PF 3: ovf</p>
</blockquote>
<p>It looks horrible 8-)</p>
<p>edit:</p>
<p>i connect the ac-adapter to phase 1 and the order from the ct&#39;s is right.<br />
before the ac-adapter was on phase 3.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29430"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: JeeNode v6 - Send Data to Raspi emonbase</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 06/04/2015 - 13:39.</div>
    <div class="content">
     <p>To see whether those numbers are sensible, you must tell us what your input circuit is:</p>
<p>What voltage does your JeeNode run at?<br />
Which current transformer are you using, and what burden resistor?<br />
Which voltage adapter are you using, and what values do you have for the voltage divider?</p>
<p>What is the power that you are expecting to measure?</p>
<p>Remember that using an emonTx with the standard 100 A current transformer and burden, you cannot expect an accurate measurement of current below about 2 A  (2% of the maximum reading).  Less than that, the ADC resolution and noise will make the reading increasingly unreliable. The standard YHDC SCT-013-000 current transformer itself is only specified at better than 3% accuracy at greater than 10 A.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29433"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7946.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MueThoS&#039;s picture" title="MueThoS&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: JeeNode v6 - Send Data to Raspi emonbase</h3>

    <div class="submitted">Submitted by <a href="../user/7946.html" title="View user profile.">MueThoS</a> on Mon, 06/04/2015 - 14:31.</div>
    <div class="content">
     <p>Not that you misunderstand me.<br />
The currents I measure with&nbsp;the emonTX with 100A CTs.<br />
The JeeNodes I want to use it later for other things.</p>
<p>The inaccuracy is not the problem for me.<br />
Only negative should not be.<br />
I have now written the 3-phase sketch.<br />
and I turned the CTs.<br />
The first looks pretty good.<br />
I still need to test whether that is decisive according to Elictricity.</p>
<p>In the 3-phase Sketch the temperature measurement is missing, but that&#39;s not so bad first.<br />
I observe now first the measurement of power</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29434"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: JeeNode v6 - Send Data to Raspi emonbase</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 06/04/2015 - 15:09.</div>
    <div class="content">
     <p>To begin, you wanted to know how to make a JeeNode work with a Raspberry Pi. Now I understand that you have both emonTx and JeeNodes.<br />
You are correct, there is no temperature measurement in the 3-phase sketch, but you can add that very easily, after the 3-phase power has been calculated and before you send the data.</p>
<p>When you calculate apparent power (VA), you cannot know the direction of power flow, so the answer is always positive. When you calculate real power, you can know which way the power is flowing because you know the phase of the current compared to the voltage. We say imported power is positive and exported power is negative. To reverse the sign of power, you must change the relative phase of the current and voltage, and the easy way to do that is to reverse the CT on the wire, as mpruessmeier wrote.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/10432"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-2USCpyZfPwhKCUNcrT4_2YpkaTIOG0-zkrAnI9wjy1k" value="form-2USCpyZfPwhKCUNcrT4_2YpkaTIOG0-zkrAnI9wjy1k"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
