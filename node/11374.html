<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11374 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:54:38 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>emonpi not logging | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">emonpi not logging</h3>
        <span class="submitted">Submitted by <a href="../user/8760.html" title="View user profile.">wattsupdoc</a> on Mon, 12/10/2015 - 16:40</span>
        <div class="content"><p>EmonPi shows data from sensors, cannot log locally.</p>
<p>Recently received emonpi, set it up per video guides.</p>
<p>Using one CT and AC-AC wave monitor.</p>
<p>Nodes screen shows all nodes inactive but data values correct and CT values change correctly as load changes.</p>
<p>Created Feeds but cannot see any logging occurring.</p>
<p>Been monitoring for 48 hours.&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11409.html" class="topic-previous" title="Go to previous forum topic">‹ Multi graph timeline not moving forward</a>
              <a href="10163.html" class="topic-next" title="Go to next forum topic">OLD: Raspberry Pi 2 pre-built SD card image (emonSD-13-03-15.img) BETA ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-34881"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonpi not logging</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 12/10/2015 - 19:49.</div>
    <div class="content">
     <p>Was it connected to the internet at boot up? if you go to the emonhub page and check the log what time and date do you see for the log entries? any mention of 1970?</p>
<p>It would be helpful if you could post some emonhub.log and possibly some emoncms.log for us to see what is happening.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34883"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8760.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="wattsupdoc&#039;s picture" title="wattsupdoc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonpi not logging</h3>

    <div class="submitted">Submitted by <a href="../user/8760.html" title="View user profile.">wattsupdoc</a> on Mon, 12/10/2015 - 20:38.</div>
    <div class="content">
     <p>Thanks Paul,&nbsp;</p>
<p>Below last few lines of emoncms.los and emonhub.log after refreshing each several times.</p>
<p>I note dates are&nbsp;2015/6/17 and time is incorrect. I set time offset to UTC-8 at initial turn on and acct setup.</p>
<p>It must be that emonpi needs to get time and date from network time/date server?&nbsp;</p>
<p>I was hoping to use it for local logging at my well pump which is too distant&nbsp;from house router to get wifi and be on home network or web.</p>
<p>emoncms.log</p>
<p>2015-6-17 14:54:46 MQTT INFO Reloading config</p>
<p>2015-6-17 14:54:48 MQTT INFO Received mqtt message: emonhub/rx/5/values 335,0,335,247.44,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:54:52 MQTT INFO Reloading config</p>
<p>2015-6-17 14:54:53 MQTT INFO Received mqtt message: emonhub/rx/5/values 334,0,334,247.46,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:54:58 MQTT INFO Reloading config</p>
<p>2015-6-17 14:55:03 MQTT INFO Received mqtt message: emonhub/rx/5/values 333,0,333,246.89,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:55:04 MQTT INFO Reloading config</p>
<p>emonhub.log</p>
<p>2015-6-17 14:51:48 MQTT INFO Received mqtt message: emonhub/rx/5/values 335,0,335,247.86,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:51:52 MQTT INFO Reloading config</p>
<p>2015-6-17 14:51:53 MQTT INFO Received mqtt message: emonhub/rx/5/values 332,0,332,247.81,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:51:58 MQTT INFO Reloading config</p>
<p>2015-6-17 14:52:03 MQTT INFO Received mqtt message: emonhub/rx/5/values 339,0,339,247.51,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:52:04 MQTT INFO Reloading config</p>
<p>2015-6-17 14:52:08 MQTT INFO Received mqtt message: emonhub/rx/5/values 338,0,338,246.65,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:52:10 MQTT INFO Reloading config</p>
<p>2015-6-17 14:52:16 MQTT INFO Reloading config</p>
<p>2015-6-17 14:52:18 MQTT INFO Received mqtt message: emonhub/rx/5/values 333,0,333,247.02,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:52:22 MQTT INFO Reloading config</p>
<p>2015-6-17 14:52:23 MQTT INFO Received mqtt message: emonhub/rx/5/values 338,0,338,247.73,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:52:28 MQTT INFO Reloading config</p>
<p>2015-6-17 14:52:33 MQTT INFO Received mqtt message: emonhub/rx/5/values 334,0,334,247.62,0,0,0,0,0,0,0​</p>
<p>Regards,&nbsp;</p>
<p>Tim</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34884"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8760.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="wattsupdoc&#039;s picture" title="wattsupdoc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonpi not logging</h3>

    <div class="submitted">Submitted by <a href="../user/8760.html" title="View user profile.">wattsupdoc</a> on Mon, 12/10/2015 - 22:08.</div>
    <div class="content">
     <p>Thanks Paul,&nbsp;</p>
<p>It was not connected directly&nbsp;to internet at boot up.</p>
<p>emonpi was connected&nbsp;to my pc with ethernet cable, the pc was on home wifi network and pc&nbsp;was connected to internet over wifi.&nbsp;</p>
<p>Below are logs requested after refreshing each several times, I note the date and time are incorrect.&nbsp;</p>
<p>Does emonpi need to get date/time from an internet time/date server at initial boot up?</p>
<p>I was going to log power and time directly at my well pump which is too distant from router to get wifi signal.&nbsp;</p>
<p>emonhub.log</p>
<p>2015-6-17 14:51:48 MQTT INFO Received mqtt message: emonhub/rx/5/values 335,0,335,247.86,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:51:52 MQTT INFO Reloading config</p>
<p>2015-6-17 14:51:53 MQTT INFO Received mqtt message: emonhub/rx/5/values 332,0,332,247.81,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:51:58 MQTT INFO Reloading config</p>
<p>2015-6-17 14:52:03 MQTT INFO Received mqtt message: emonhub/rx/5/values 339,0,339,247.51,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:52:04 MQTT INFO Reloading config</p>
<p>2015-6-17 14:52:08 MQTT INFO Received mqtt message: emonhub/rx/5/values 338,0,338,246.65,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:52:10 MQTT INFO Reloading config</p>
<p>2015-6-17 14:52:16 MQTT INFO Reloading config</p>
<p>2015-6-17 14:52:18 MQTT INFO Received mqtt message: emonhub/rx/5/values 333,0,333,247.02,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:52:22 MQTT INFO Reloading config</p>
<p>2015-6-17 14:52:23 MQTT INFO Received mqtt message: emonhub/rx/5/values 338,0,338,247.73,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:52:28 MQTT INFO Reloading config</p>
<p>2015-6-17 14:52:33 MQTT INFO Received mqtt message: emonhub/rx/5/values 334,0,334,247.62,0,0,0,0,0,0,0</p>
<p>emoncms.log</p>
<p>2015-6-17 14:54:46 MQTT INFO Reloading config</p>
<p>2015-6-17 14:54:48 MQTT INFO Received mqtt message: emonhub/rx/5/values 335,0,335,247.44,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:54:52 MQTT INFO Reloading config</p>
<p>2015-6-17 14:54:53 MQTT INFO Received mqtt message: emonhub/rx/5/values 334,0,334,247.46,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:54:58 MQTT INFO Reloading config</p>
<p>2015-6-17 14:55:03 MQTT INFO Received mqtt message: emonhub/rx/5/values 333,0,333,246.89,0,0,0,0,0,0,0</p>
<p>2015-6-17 14:55:04 MQTT INFO Reloading config</p>
<p>​If this posts twice, I apologize, may have made mistake on first reply.&nbsp;</p>
<p>Regards,&nbsp;</p>
<p>Tim</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34889"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonpi not logging</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 12/10/2015 - 23:50.</div>
    <div class="content">
     <p>The Pi has no real time keeping hardware so the Raspbian OS has way of using the last known time and counting from there, this is relatively accurate if the Pi is running 24/7 and will only become inaccurate if there is downtime as it cannot time/count when shut down and/or any ungraceful shutdowns before saving ie if it last saved the current time 0.5hrs ago and it crashes, on reboot it will revert to the last saved time and be 0.5hrs &quot;slow&quot; or &quot;behind&quot; (plus any downtime).</p>
<p>This backing up of the time is effectively disabled by running raspbian&nbsp;read-only, therefore the time you see will be the time the image was written and it will remain at that time and date each time you reboot until the Pi has an internet connection at the same as being in read and write mode. This doesn&#39;t cause an issue in the majority of cases that have a permanent internet&nbsp;connection but needs a slight mod to accommodate the read-only OS. (You can read more on this in the&nbsp;<br />
<a href="5877.html">Read-only image time issues&nbsp;</a>thread should you wish to)</p>
<p>I would recommend installing &quot;<a href="https://github.com/emonhub/ntp-backup.git">ntp-back-up</a>&quot; which will allow the OS&#39;s time keeping software to work as intended and the current time will be saved once per hour and at a controlled shutdown, depending on stability and your power supply this has the potential of being accurate to within seconds per year, and it will also allow the Pi to correct itself if an internet connection is detected at any time,&nbsp;</p>
<p>This last point maybe of interest if you have a &quot;hotspot&quot; providing mobile phone&nbsp;<span style="line-height: 20.8px;">and</span><span style="line-height: 20.8px;">&nbsp;the emonPi has&nbsp;</span><span style="line-height: 20.8px;">a&nbsp;</span>wifi dongle&nbsp;<span style="line-height: 1.6;">as anytime you visit the site you can enable the hotspot while you are there and the emonPi&nbsp;will update its time keeping automatically.</span></p>
<p><span style="line-height: 1.6;">You could alternatively&nbsp;fit an RTC which has been documented (by Glyn&nbsp;I believe) but I cannot recall if it will still fit in the emonPi case off-hand,&nbsp;</span></p>
<p><span style="line-height: 1.6;">Having said all that I cannot be sure it is the cause of this issue as in theory it doesn&#39;t know it&#39;s not the right time as both emoncms and emonhub are using the same time (albeit wrong), the issue is more likely to show up when emonhub and emoncms are on different machines.</span></p>
<p><span style="line-height: 1.6;">To eliminate this as a possible try rebooting with a (direct?) internet connection and recheck the time and see if that kick starts the logging.</span></p>
<p><span style="line-height: 1.6;">Paul</span></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34951"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8760.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="wattsupdoc&#039;s picture" title="wattsupdoc&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonpi not logging</h3>

    <div class="submitted">Submitted by <a href="../user/8760.html" title="View user profile.">wattsupdoc</a> on Thu, 15/10/2015 - 15:07.</div>
    <div class="content">
     <p>Thanks for info. EmonPi works correct with direct wired internet connection.</p>
<p>I installed an outdoor client server wifi connected to home network and wired to emonpi.&nbsp;</p>
<p>Now logging fine at location needed and I can monitor remotely on network.</p>
<p>May look into rtc and/or ntp-backup later, but I think the remote client server suits best right now.</p>
<p>Again, thanks for all info and help.</p>
<p>Regads,&nbsp;</p>
<p>Tim</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34970"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonpi not logging</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 15/10/2015 - 23:31.</div>
    <div class="content">
     <p>Glad you got it sorted, BUT unless the &quot;saved time&quot; is updated the issue is only gone for as long as the Pi can boot with a active network connection, eg a power disruption where the Pi recoveres before your router has established a connection will result in the last recorded time (image creation?) being used and if it is too far in the past an active internet connection coming online will not correct it so it will be faulty until the pi is rebooted again.</p>
<p>The Raspbian&nbsp;OS has the fake-hwclock&nbsp;to prevent these problems but the &quot;read-only&quot; breaks it, the ntp-backup only allows the original OS stuff to do its thing as intended, nothing more. If running read-only you should have the ntp-backup installed. ntp-backup is a&nbsp;bit like the insurance policy you wish you had taken out <em>beforehand</em>,</p>
<p>Paul</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11374"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form--SYVzYjGYgdRR9mRPC4Z-sQMY7R_1wRCaTxiJfCYdrc" value="form--SYVzYjGYgdRR9mRPC4Z-sQMY7R_1wRCaTxiJfCYdrc"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
