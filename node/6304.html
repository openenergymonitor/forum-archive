<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/6304 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:30:44 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>DHT 22 sensor and emonTX v3 | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">DHT 22 sensor and emonTX v3</h3>
        <span class="submitted">Submitted by <a href="../user/6952.html" title="View user profile.">bond79</a> on Tue, 16/12/2014 - 14:45</span>
        <div class="content"><p>I am trying to find out how I can connect a DHT22, together with DS18B20 sensors on an emonTX V3.</p>
<p>I have the emonTX v3 working ok with a 3-Phase sketch and up to 4 DS18B20 and I was wondering if I could also connect a DHT22 and maybe free up an&nbsp;emonTH, I have close by for humidity measurements.</p>
<p>I found this example sketch, that supports 2 DS18B20 and 2 DHT22, but I couldn&#39;t find more info about this sketch on the forums, if it is a stock emonTX V3 and for the wiring of the sensors.</p>
<p><a href="https://github.com/openenergymonitor/emonTxFirmware/blob/master/emonTxV3/noRF/MVHRMonitor/MVHRMonitor.ino" title="https://github.com/openenergymonitor/emonTxFirmware/blob/master/emonTxV3/noRF/MVHRMonitor/MVHRMonitor.ino">https://github.com/openenergymonitor/emonTxFirmware/blob/master/emonTxV3...</a></p>
<p>From I can understand with my limited knowledge of arduino programming and electronics, the first DHT22 data pin is connected to pin 19 of the screw terminal (that normally is used for 5V of the DS18B20).The second uses pin 2, that is normally not used. The DS18B20 use pin 5, that is the same they use normally.</p>
<p>What I am missing is where to connect the 5V pin of DHT22 and where the 5V of the DS18B20?</p>
<p>I am not interested much for two DHT22, one would be enough for me, if anyone could help.</p>
<p>Thank you</p>
  <div class="forum-topic-navigation clear-block">
          <a href="10882.html" class="topic-previous" title="Go to previous forum topic">‹ Incorrect temperature from emonTH</a>
              <a href="10846.html" class="topic-next" title="Go to next forum topic">eMonTX Arduino Shield: Problem getting started ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-31167"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6192.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6192.jpg" alt="Patricio Duenas&#039;s picture" title="Patricio Duenas&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DHT 22 sensor and emonTX v3</h3>

    <div class="submitted">Submitted by <a href="../user/6192.html" title="View user profile.">Patricio Duenas</a> on Wed, 10/06/2015 - 16:15.</div>
    <div class="content">
     <p>Hi bond79. I am also trying to add a DHT22 to a EmonTx v3 configuration, were you able to figure out the pin for the DHT22&nbsp;data bus?</p>
<p>&nbsp;</p>
<p>Regards</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31202"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6192.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6192.jpg" alt="Patricio Duenas&#039;s picture" title="Patricio Duenas&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DHT 22 sensor and emonTX v3</h3>

    <div class="submitted">Submitted by <a href="../user/6192.html" title="View user profile.">Patricio Duenas</a> on Thu, 11/06/2015 - 15:11.</div>
    <div class="content">
     <p>Hi Bond</p>
<p>I figured out how to do it and it works. Please let me lnow if you want me to post what I did</p>
<p>&nbsp;</p>
<p>Regards,</p>
<p>&nbsp;</p>
<p>Patricio</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31205"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DHT 22 sensor and emonTX v3</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 11/06/2015 - 16:18.</div>
    <div class="content">
     <p>It&#39;s always better to share if you don&#39;t mind, future users will find this thread if they are trying to connect a DHT22&nbsp;to emonTx v3 and use the search box, the open end won&#39;t help them much :-)</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31274"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8255.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="goodfidelity&#039;s picture" title="goodfidelity&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DHT 22 sensor and emonTX v3</h3>

    <div class="submitted">Submitted by <a href="../user/8255.html" title="View user profile.">goodfidelity</a> on Sat, 13/06/2015 - 22:41.</div>
    <div class="content">
     <p>I would really want to know!</p>
<p>&nbsp;</p>
<p>is it possible to use multiple units or only one? How did it affect power usage?</p>
<p>&nbsp;</p>
<p>//J</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31283"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DHT 22 sensor and emonTX v3</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 14/06/2015 - 16:25.</div>
    <div class="content">
     <p>According to the DHT22 data sheet, each device does <u>NOT</u> have, and is therefore not addressable by, an unique ID, so I think you can have only one DHT22 on the data bus.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31306"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7665.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-7665.jpg" alt="TimSmall&#039;s picture" title="TimSmall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DHT 22 sensor and emonTX v3</h3>

    <div class="submitted">Submitted by <a href="../user/7665.html" title="View user profile.">TimSmall</a> on Mon, 15/06/2015 - 16:12.</div>
    <div class="content">
     <p>You&#39;ll need to put each one on separate pins. &nbsp;You may be able to get away with just one additional pin per extra DHT22 (if not you&#39;ll need 2). &nbsp;You could re-purpose&nbsp;some of the existing pins if you alter the code...</p>
<p><a href="http://wiki.openenergymonitor.org/index.php?title=EmonTx_V3.4#Port_Map" title="http://wiki.openenergymonitor.org/index.php?title=EmonTx_V3.4#Port_Map">http://wiki.openenergymonitor.org/index.php?title=EmonTx_V3.4#Port_Map</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31378"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8255.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="goodfidelity&#039;s picture" title="goodfidelity&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DHT 22 sensor and emonTX v3</h3>

    <div class="submitted">Submitted by <a href="../user/8255.html" title="View user profile.">goodfidelity</a> on Tue, 16/06/2015 - 22:14.</div>
    <div class="content">
     <p>Ok, thanks!</p>
<p>I just want to run 5 sensors on one emonTX v3, but maybe that will limit my options to the dallas?</p>
<p>In order to measure the efficiency of the heat exchanger it would be nice to know RH as well, because temperature will not tell enough about the amount of energy in the air.</p>
<p>Som heat exchangers in ventilation systems recirculate&nbsp;humidity and heat, others only heat. So using the proper sensor will give more information to calculate this correctly.</p>
<p>Anyone has an idea how to do this? 5 sensors will be needed, or actually just 4 humidity sensors and one temperature sensor.</p>
<p>Thanks!</p>
<p>//J</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31398"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7665.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-7665.jpg" alt="TimSmall&#039;s picture" title="TimSmall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DHT 22 sensor and emonTX v3</h3>

    <div class="submitted">Submitted by <a href="../user/7665.html" title="View user profile.">TimSmall</a> on Wed, 17/06/2015 - 08:44.</div>
    <div class="content">
     <p>Looking at the emonTX&nbsp;description link I sent, you could do this with the emonTX by changing the software, and using spare pins, or re-purposing existing pins. &nbsp;Which ones you use would depend on what else you want to do with the emonTX (e.g. Do you want to do current monitoring too? &nbsp;If so, how man circuits?&nbsp;Do you need the radio?).</p>
<p>I use Sensirion SHT21 temperature sensors instead of the DHT22s, as I expect them to have better long term stability / accuracy.</p>
<p>Each SHT21 has a temperature and a humidity sensor built-in. &nbsp;You&#39;d need 5 pins for this I think (possibly 8, if it&#39;s not possible to share the clock signal between all the sensors).</p>
<p>If a project which I&#39;ve been looking at goes ahead (not yet 100%), then I&#39;ll probably be adding two SHT21 sensors to a single emonTH&nbsp;in the next month or so.</p>
<p>Looking at the emonTX link I sent, on the emonTX 3.4, you could use (for example) digital 4 and 7 (which aren&#39;t used - assuming they&#39;re easy to get at on the board), and also 8 and 9 (if you don&#39;t mind not having the dip-switches working), not having any 1wire&nbsp;sensors&nbsp;would free up D5, and D19. &nbsp;If you don&#39;t want the pulse counter then D3 is available, and there&#39;s also D20 taken out to the RJ45.</p>
<p>You&#39;d need to solder to get at some of these tho&#39;, so if you&#39;re not comfortable with that, it&#39;s probably a no-go.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31427"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DHT 22 sensor and emonTX v3</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 17/06/2015 - 11:55.</div>
    <div class="content">
     <p>The old emonTx V2 looks to be what you want, but only the PCB is available, full kits disappeared from the shop a while ago. (But it is slightly more noise-prone than the V3.)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31436"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8255.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="goodfidelity&#039;s picture" title="goodfidelity&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DHT 22 sensor and emonTX v3</h3>

    <div class="submitted">Submitted by <a href="../user/8255.html" title="View user profile.">goodfidelity</a> on Wed, 17/06/2015 - 12:39.</div>
    <div class="content">
     <p>Thanksfor replies!</p>
<p>&nbsp;</p>
<p>To clarify my special needs the minimum i need is 3CTs, ac-ac and 4 DHT and 1 Dallas.</p>
<p>Total is 9 inputs.&nbsp;</p>
<p>This specific application is for ventilation systems.</p>
<p>However this can be minimized to on optical pulse reader, or transistor pulse reader, and 4DHT&nbsp;+ 1 Dallas. It might be better to use a standard energy meter with pulse output and just hook it up. However it is not non-invasive but it reduces the amount of inputs to six and still measures the same things, maybe even more accurately so.</p>
<p>Energymeter is to measure energy usage from fans, heating battery and cooling battery.Temperature and humidity&nbsp;sensors are to control the temperatures in shafts and calculate the heat recycling.</p>
<p>//J</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31614"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6192.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6192.jpg" alt="Patricio Duenas&#039;s picture" title="Patricio Duenas&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DHT 22 sensor and emonTX v3</h3>

    <div class="submitted">Submitted by <a href="../user/6192.html" title="View user profile.">Patricio Duenas</a> on Mon, 22/06/2015 - 17:36.</div>
    <div class="content">
     <p>Hi Sorry for my very late response&nbsp;</p>
<p>You can only use one DHT22, connected to Pin 4 in the EmonTx&nbsp;block terminal, plus 5v and GND (pin 1 and 3 ). That means you are using digital Pin 2 (in order to declare it correctly in the code).</p>
<p>I used the DHT library, found here:&nbsp;https://github.com/adafruit/DHT-sensor-library&nbsp;where you need to define the Pin and the DHT type&nbsp;</p>
<p>#include &lt;DHT.h&gt;<br />
#define DHTPIN 2<br />
#define DHTTYPE DHT22</p>
<p>​Add the variables to the structure:&nbsp;</p>
<p>typedef struct { int power1, power2, power3, power4, Vrms, temp, tempExt, humidityExt; } PayloadTX; &nbsp; &nbsp;</p>
<p>Although the library expects a float value, I declared the variables as int. Maybe you can tinker with this, I didn&#39;t mind loosing the decimal information but I don&#39;t know if this will affect negative values (it doesn&#39;t get below 19&ordm; C here)</p>
<p>Initialize in the setup<br />
&nbsp; dht.begin();</p>
<p>&nbsp;</p>
<p>Read from the sensor in the loop<br />
&nbsp; emontx.humidityExt = dht.readHumidity();<br />
&nbsp; // Read temperature as Celsius<br />
&nbsp; emontx.tempExt = dht.readTemperature();</p>
<p>&nbsp;</p>
<p>That is pretty much it. I hope this helps!</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31622"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8255.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="goodfidelity&#039;s picture" title="goodfidelity&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: DHT 22 sensor and emonTX v3</h3>

    <div class="submitted">Submitted by <a href="../user/8255.html" title="View user profile.">goodfidelity</a> on Mon, 22/06/2015 - 21:23.</div>
    <div class="content">
     <p>Thank you Patricio!</p>
<p>&nbsp;</p>
<p>I am not all that experienced with the programmin yet, still working on setting up the system and figuring out what i should monitor and how.</p>
<p>Its sad that the DHT22 does not go many on one I/O because the application i have in mind is more demanding.</p>
<p>I am sure that somehow i will get my head around this, thanks =)</p>
<p>&nbsp;</p>
<p>//J</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/6304"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-60kDX7LQHq_5jMCUraK1Tsz14Zz_IG30L_0c4kp6bGE" value="form-60kDX7LQHq_5jMCUraK1Tsz14Zz_IG30L_0c4kp6bGE"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
