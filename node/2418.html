<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/2418 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:54:01 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>RFM2PiPHP service and RFM12Pi board | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">RFM2PiPHP service and RFM12Pi board</h3>
        <span class="submitted">Submitted by Guest on Wed, 29/05/2013 - 21:53</span>
        <div class="content"><p>Greetings. I have a problem with EmonCMS v5 on a Raspberry Pi with the RFM12Pi board (v1). The RFM2PiPHP service is running and the Raspberry Pi page in EmonCMS displays service is running; however, when I enter the correct frequency band, network group and node ID, the settings are not written to the RFM12Pi board. If I enter the data manually using Minicom, then the RFM12Pi board starts receiving data. If the Raspberry Pi is rebooted, then the RFM12Pi board loses its settings and no data is once again received. I have noted posting <a href="2355.html" title="http://openenergymonitor.org/emon/node/2355">http://openenergymonitor.org/emon/node/2355</a>, however, entering &#39;h&#39; when using Minicom shows a list of commands that &lt;does not&gt; include the 123x command option, which locks the settings within the RFM12Pi board so that it may survive reboot/power-off. How does one resolve the issue of the EmonCMS not writing the settings to the RFM12Pi board, nor the setting surviving reboot/power-off given that I can&#39;t locking the settings?</p>
<p>David</p>
  <div class="forum-topic-navigation clear-block">
          <a href="2355.html" class="topic-previous" title="Go to previous forum topic">‹ Emoncms: data loggins halts on raspberry</a>
              <a href="2425.html" class="topic-next" title="Go to next forum topic">Old version help? ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-12457"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM2PiPHP service and RFM12Pi board</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Thu, 30/05/2013 - 06:07.</div>
    <div class="content">
     <p>David,</p>
<p>you probably have the old firmware, the one before the locking was implemented. Are you comfortable with re-programming an Attiny84? Nathan Chantrell has pretty good instructions on doing that with an Arduino (in case you don&#39;t own an ISP programmer)&nbsp;http://nathan.chantrell.net/20120225/an-attiny-based-wireless-temperature-sensor/</p>
<p>There is a pre-compiled .hex file on github with the firmware&nbsp;</p>
<p><a href="https://github.com/mharizanov/RFM2Pi/tree/master/firmware/Pre_compiled_ATtiny84_RF12_Demo_hex" title="https://github.com/mharizanov/RFM2Pi/tree/master/firmware/Pre_compiled_ATtiny84_RF12_Demo_hex">https://github.com/mharizanov/RFM2Pi/tree/master/firmware/Pre_compiled_A...</a></p>
<p>If you feel that is too hard to do, you can return the Attiny84 to whoever you purchased the board from (I believe Trystan/Glyn won&#39;t mind if you got the board from the openenergy shop) for a replacement.</p>
<p>The v2&nbsp;of the board allows pretty easy firmware upload without the need of programmer, just fyi</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12461"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM2PiPHP service and RFM12Pi board</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Thu, 30/05/2013 - 08:56.</div>
    <div class="content">
     <p>Just in case it wouldn&#39;t be clear, Martin is advising you to update to latest firmware version but I&#39;m pretty sure it should work with yours, anyway, shouldn&#39;t it, Martin ?</p>
<p>I don&#39;t know what&#39;s wrong, perhaps can you try to debug that adding print statements in the php script.</p>
<p>When logged in to emoncms, enter this in your URL bar :</p>
<pre>
<span class="s">http://your_path/emoncms/raspberrypi/get.json</span></pre><p><span class="s">to check correct settings are entered in database.</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12491"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="blusolar&#039;s picture" title="blusolar&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM2PiPHP service and RFM12Pi board</h3>

    <div class="submitted">Submitted by blusolar (not verified) on Fri, 31/05/2013 - 21:00.</div>
    <div class="content">
     <p>Thank you Martin for your response.</p>
<p>I shall look into either trying to use an emontx with Nathan Chantrell&#39;s instructions, or buy an ISP programmer, to update the firmware. The problem that I am having seems directly related to EmonCMS v5, as the RFM12Pi board worked fine in the Raspberry Pi with EmonCMS v4 (prior to the SDCard dying). Whilst locking in the data on the RFM12Pi board is a work-around; it will be nice if EmonCMS were to actually tell it that information on boot-up; unless I am missing something here.</p>
<p>David</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12493"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="blusolar&#039;s picture" title="blusolar&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM2PiPHP service and RFM12Pi board</h3>

    <div class="submitted">Submitted by blusolar (not verified) on Fri, 31/05/2013 - 21:37.</div>
    <div class="content">
     <p>Thank you J&eacute;r&ocirc;me and mharizanov for your responses.</p>
<p>I embarrassingly have to report that it was due to finger trouble on my part. I had entered 211 instead of 221 as the network group and, despite checking it several times, it took a few more observations for me to notice.</p>
<p>I finally spotted it whilst working through my initial response to J&eacute;r&ocirc;me&#39;s posting, and after replying to mharizanov. suggestions (which I may still take up, though later as I can now concentrate on restoring the rest of the EmonCMS v5 to that in my previous v4 system; then make an image of the SDCard and put in place a better data back-up regime.</p>
<p>Please accept my apologies for the posting of a false error report.</p>
<p>David</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12542"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: RFM2PiPHP service and RFM12Pi board</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Mon, 03/06/2013 - 07:25.</div>
    <div class="content">
     <blockquote><p>Whilst locking in the data on the RFM12Pi board is a work-around; it will be nice if EmonCMS were to actually tell it that information on boot-up; unless I am missing something here.</p>
</blockquote>
<p>If you&#39;re suggesting that the locking order (123) should be sent on startup after radio setup, there is an objection : the emoncms GUI allows for radio setup anytime. I admit that I can&#39;t think of real life use cases where you would need to reconfigure on a regular basis, but since this is offered by the GUI, it needs to be addressed, so we don&#39;t want the settings locked.</p>
<p>We could think of workarounds :</p>
<p>- Send 123 before and after changing a config item ? But what if on of the 123 commands is garbled ? We&#39;re in a stuck state where we lock when we want to unlock, etc. Unless we parse the help message to see in which state we&#39;re in.</p>
<p>- Add a workaroud button to send the 123 command manually ? Why not, a bit ugly but why not ? Then we may want to add a status led widget telling whether the config is locked. This means parsing the answer to the help message.</p>
<p>If think the unsaid position here may be &quot;since the bug is gone in new HW rev, why bother ? Owners of older HW could use minicom as a workaround. Besides, as far as we know, this only affects people using the send time for <span style="display: none;">send time </span>emonGLCD feature.&quot;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/2418"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-dxYkyLqyorF2KP8uyA94kjldaNi8JGxz6F_3N5igsOw" value="form-dxYkyLqyorF2KP8uyA94kjldaNi8JGxz6F_3N5igsOw"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
