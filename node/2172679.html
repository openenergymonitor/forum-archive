<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/217?page=1 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:18:55 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Solar Power Manager | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
          <span class="submitted"></span>
      <div class="taxonomy"></div>
      <div class="content"><p>&nbsp;I have used the 2 channel non invasive sketch, to build a device which monitors how much power is being used in the home, and how much &nbsp;power is being generated by the solar panels. If I am generating more than I am currently using, then the excess power is diverted to an immersion heater - to heat domestic hot water. This is a better option than it flowing back to the grid for which I don't get paid (solar renta roof).</p>
<p>This was a steep learning curve as I have never worked with a microprocessor before, but great fun and a great sense of acheivement when it actually works!</p>
<p><img alt="PCB" width="600" height="401" src="http://error404.000webhost.com/?" /></p>
<p>The first version was built on a Arduino Uno board, with the input components mounted on veroboard, but then I decided to build it as a standalone, with everything on one board.<br />
The LCD is reclaimed from an old alarm keypad, and I had a USB panel socket laying about so I used that for the 4 CT input connections. (did I mention that I am a Yorkshireman...)</p>
<p>As the peak solar &nbsp;power generation is 3.5kw, I used a shunt resistor to range up to 5kw, but fitted clamping &nbsp;diodes (Glyn's idea - see forum) to ensure that the mains usage did not exceed 5kw and damage the Atmega chip.</p>
<p><img alt="fitted in box" width="600" height="439" src="http://error404.000webhost.com/?" /><br />
&nbsp;</p>
<p>With a bit of sawing and hacking, managed to fit the PCB into a Maplins project box.</p>
<p><img alt="power readings" width="600" height="386" src="http://error404.000webhost.com/?" /></p>
<p>Here you can see the power results, which if less than 1kw displays in watts, otherwise kw's.</p>
<p>The tiny LED is multi function and indicates;</p>
<p>1) flashing every 4 seconds - indicates that the unit is functioning, but not enough solar power to activate either relay.<br />
2) steady but lit 25% - indicates that 500w is being unused, and activates relay 1, with a diode in series to limit the load to 500w (yes it does work, I've done the sums on the leccy meter!)<br />
3) steady but lit brightly - indicates that in excess of 1kw is being unused, switches off relay 1 and activates relay 2 which delivers a full kw (which is the rating of the immersion heater).</p>
<p>The button is a menu navigator, and switches between displays (copied from another project).</p>
<p><img alt="kwh" width="600" height="399" src="http://error404.000webhost.com/?" /><br />
&nbsp;</p>
<p>This display shows how much power is generated within a 24hr period, before resetting back to zero at midnight. There is no external timing here, just a simple millis() counter which resets every 24hrs. On startup, the counter resets after 12hrs for one occassion ( so if it's powered up at midday, it will &nbsp;reset at midnight and every midnight thereafter.</p>
<p><img width="600" height="399" alt="" src="http://error404.000webhost.com/?" /></p>
<p>This display shows voltage and power factor, which of course is needed for calibration purposes.<br />
To calibrate it, I took the readings from the LCD, removed the chip and wrote the new sketch via a Arduino Uno board, before replacing it in the standalone.</p>
<p>The sketch is posted <a href="http://bit.ly/p0QhTE">here</a>&nbsp;, please feel free to make any suggestions or create a new version of the paste in pastebin., and although a new guy to Arduino's/programming, if I can help, please email me at (the last word in bold in this post) <strong>@gmail.com</strong></p>
<p>Sketch has also been uploaded to OpenEnergyMonitor. Download it <a href="../sites/default/files/SolarEnergyMonitor.html">here</a></p>
<h2>...UPDATE 7th Sept</h2>
<p>Following Glyn's advice (in comments below) I have built a Nanode, and have connected both units via their Rx/Tx serial bus, and use a simple Serial.print statement in the above device, to be decoded in the Nanode by the CmdMessenger library.</p>
<p>Data is then <a href="http://bit.ly/nADmAo">uploaded to Pachube</a> every 20seconds by the Nanode, provided that the data values have changed.</p>
<p>&nbsp;</p>
<p>Many thanks to Trystan &amp; Glyn</p>
<p><strong>yorkshirepudn</strong></p>
<p>Please post any comments and questions about the Solar PV Manager system to the <a href="../forum.html">forums</a></p>
<p>&nbsp;</p>
</div>
    
    
      </div>
<div id="comments">
  <a id="comment-2427"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dmty&#039;s picture" title="dmty&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar Power Manager</h3>

    <div class="submitted">Submitted by dmty (not verified) on Thu, 08/12/2011 - 20:01.</div>
    <div class="content">
     <p>Hi,</p>
<p>I've just come across this project and I am puzzled by the apparent power reduction by use of a series diode.</p>
<p>It's my under standing that a series diode produces pulses of half sine wave every 20ms (50Hz).</p>
<p>Analysing the wave it has a DC element, fundimental, 2nd Harmonic, etc.</p>
<p>A lot meters assume the wave is sinusoidal and do not register the DC element.</p>
<p>My main claim to infamy is to blow up a AVO 8 meter trying to measure the ripple on a 100v DC supply.</p>
<p>Much to my bosses displeasure.</p>
<p>If you can please explain how the power is disipated.</p>
<p>Regards DMTY</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-2429"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar Power Manager</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 08/12/2011 - 21:06.</div>
    <div class="content">
     <p>&nbsp;When applied to a linear resistive load, such as an immersion heater, 'real power' is a product of the voltage and current throughout every part of the cycle, positive or negative, it matters not.<br />
P = V x I</p>
<p>But if we remove part of that cycle by using a Triac, diode or other similar device, we in effect reduce the 'duty cycle', and in the case of a series diode, reduce the 'duty cycle' to 50%, and accordingly the power flow by 50%.<br />
This is a form of &nbsp;Pulse Width Modulation (PWM) and is used &nbsp;in light dimmers and other similar power controllers.</p>
<p>The power loss is extremely low, because when the half cycle is blocked, then practically no current flows, and when the half cycle is conducting there is just a small voltage drop (typically 0.6V) across the diode, which leads to high efficiency.</p>
<p>You may get a better understanding if you google PWM and look at the theory in more detail.<br />
&nbsp;</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-2455"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dmty&#039;s picture" title="dmty&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar Power Manager</h3>

    <div class="submitted">Submitted by dmty (not verified) on Mon, 12/12/2011 - 20:02.</div>
    <div class="content">
     <p>Hi p,</p>
<p>Thanks for coming back so quick.</p>
<p>Read up a bit on PWM, didn't understand it all.</p>
<p>So I dusted off my old college books &amp; found the coeffs. for a half wave.</p>
<p>Calculated that there is drop in RMS power of 0.57.</p>
<p>To back this up I put a ltr of water in the kettle, switched on the power for two minutes&nbsp; &amp; measured the rise in temp.</p>
<p>Repeated the above with a diode in series.&nbsp; </p>
<p>Results gave a reduction in RMS power of 0.56.</p>
<p>I should have done this in the first place, saving your time,</p>
<p>Thanks&nbsp; DMTY</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
</div></div><a id="comment-2080"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Jon&#039;s picture" title="Jon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar Power Manager</h3>

    <div class="submitted">Submitted by Jon (not verified) on Thu, 08/09/2011 - 13:54.</div>
    <div class="content">
     <p>Have just stumbled across this site as I've been hoping to do exactly the same thing. Have just had a solar PV system installed and want to use the surplus electricity (when available) to heat my water cylinder via the immersion heater.<br />
Unfortunately, Lots of the detail above is lost on me, - I could follow instructions but  wouldn't really understand enough to have confidence. I'm happy with installing CE home automation products, and software / networking etc. but not doing my own electronics work.</p>
<p>Do ready made products exist which will do what your system does? I've been looking at something called lightwaveRF which might allow me to buy a power monitor, a web interface, and a remote controlled socket which I thought I might be able to combine to sort this out, the only problem being my concern about the inability to know which way the power flow is going.</p>
<p>If ready made systems aren't available is it likely that you would be able to start producing kits for sale that end users (or their friendly electrician neighbours) would be able to install?</p>
<p>Thanks for your time,</p>
<p>Jon.</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-2081"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar Power Manager</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 08/09/2011 - 18:25.</div>
    <div class="content">
     <p>&nbsp;<a href="http://www.coolpowerproducts.com/uk/emma.html">Coolpower</a> manufacture a unit which does this, but I beleive that it's quite expensive and probably more suited to large premises/solar arrays to become more cost effective.&nbsp;However, I am aware of a number of companies who are developing cheaper alternatives, but so far have not hit the marketplace.</p>
<p>I don't sell ready made units, I just made this one purely as a interesting project just for myself. However, believe me, it wasn't that hard, as there are many people (including myself) who will help if you got stuck, and &nbsp;I would gladly share any code I have too.</p>
<p>Arduino's cost about &nbsp;&pound;22 ready built and just plug into your computer to programme, I'm sure that if you tried one, your confidence would be inspired.</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-2084"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Jon&#039;s picture" title="Jon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar Power Manager</h3>

    <div class="submitted">Submitted by Jon (not verified) on Fri, 09/09/2011 - 09:43.</div>
    <div class="content">
     <p>Thanks.</p>
<p>The EMMA product looks like it's designed to do what you've done &amp; what I want to do. With no pricing on the UK suppliers website, it might be expensive! I'm sure there will be larger demand for this sort of product with Solar PV really starting to take off and people realising that they're giving back free energy that could be used.</p>
<p>I might have a play around with an Arduino just for the fun of it and see where I get to. My soldering / electronics skills aren't up to much though, and there's some terms I don't understand which makes it tricky (What's C/T or CT that's referred to below? - I'm sure it's obvious once you know!).</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-2085"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="eof&#039;s picture" title="eof&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar Power Manager</h3>

    <div class="submitted">Submitted by eof (not verified) on Fri, 09/09/2011 - 09:47.</div>
    <div class="content">
     <p>About &pound;1500 I&nbsp;believe!</p>
<p>C/T = CT = current transformer = the thing you clamp around the meter tail etc.</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-2086"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Jon&#039;s picture" title="Jon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar Power Manager</h3>

    <div class="submitted">Submitted by Jon (not verified) on Fri, 09/09/2011 - 10:08.</div>
    <div class="content">
     <p>Ah!<br />
Had just found out what it was by looking at some other projects and seeing some pictures, but still didn't know that it was "Current Transformer".<br />
Thanks.</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
</div></div></div></div><a id="comment-2041"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="eof&#039;s picture" title="eof&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar Power Manager</h3>

    <div class="submitted">Submitted by eof (not verified) on Sun, 28/08/2011 - 20:38.</div>
    <div class="content">
     <p>I've wasted most of today thinking about immersion heater control.&nbsp; Differences in my situation are as follows:</p>
<p>- I don't have access to a wire carrying house current only (as I explained in a <a href="217.html#comment-2016">&quot;guest&quot; posting</a> to this thread)</p>
<p>- I'm not all that interested in logging how much the house consumes, just harvesting excess energy</p>
<p>- I&nbsp;would like proportional (rather than two step) control of the immersion heater to maximise the energy harvested.</p>
<p>So, I'm thinking of creating something based on all this excellent work, but with the following differences:</p>
<p>- A single current transformer on a meter tail</p>
<p>- Determining the direction of power flow by comparing the phase of voltage and current waveforms, in order to prevent feeding the immersion heater from the grid</p>
<p>- A control loop to power the immersion heater, which will obviously have to be stable</p>
<p>- Generating pulses at 100Hz to trigger a triac to drive the immersion heater, at a phase offset from zero crossing as determined from the voltage waveform.&nbsp; Doing it this way costs a lot less in components than using a Crydom-type proportional control solid state relay:&nbsp;an-opto isolated triac can be obtained for about <a href="http://uk.rs-online.com/web/p/pcb-solid-state-relays-ssr/6675237/">&pound;5</a> (although its tab is not isolated).</p>
<p>Any thoughts on that?</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-2042"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Solar Power Manager</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Sun, 28/08/2011 - 21:32.</div>
    <div class="content">
     <p>The openenergymonitor sketch, when combined with voltage measurement will measure the phase and determine which way the power is flowing (put the CT the wrong way around and you get negative values), so the measurement side should not be too much of a problem. You will need to compensate for the power used by the immersion heater of course, otherwise the system will become unstable.</p>
<p>As for the power side, I needed the confidence that my home wouldn't burst into flames, and stayed with what I knew!!<br />
....but, having established the phase (above), it must be reasonably easy to introduce a 'proportionate' delay to trigger a opto-isolated triac, I would suggest maybe via a second Atmega chip.<br />
I wanted to use a Power Mosfet via PWM, but again safety logistics got in the way.</p>
<p>Please update us with your progress.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
</div><div class="item-list"><ul class="pager"><li class="pager-first first"><a href="217.html" title="Go to first page" class="active">« first</a></li>
<li class="pager-previous"><a href="217.html" title="Go to previous page" class="active">‹ previous</a></li>
<li class="pager-item"><a href="217.html" title="Go to page 1" class="active">1</a></li>
<li class="pager-current">2</li>
<li class="pager-item"><a href="2174658.html?page=2" title="Go to page 3" class="active">3</a></li>
<li class="pager-item"><a href="2179ba9.html?page=3" title="Go to page 4" class="active">4</a></li>
<li class="pager-next"><a href="2174658.html?page=2" title="Go to next page" class="active">next ›</a></li>
<li class="pager-last last"><a href="2179ba9.html?page=3" title="Go to last page" class="active">last »</a></li>
</ul></div></div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
