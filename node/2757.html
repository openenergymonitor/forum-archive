<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/2757 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:27:02 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>EmonCMS on Synology NAS | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">EmonCMS on Synology NAS</h3>
        <span class="submitted">Submitted by Guest on Mon, 02/09/2013 - 09:28</span>
        <div class="content"><p>Hi,</p>
<p>I&#39;m evaluating EmonCMS&nbsp;for its usage with Openremote. First I&#39;ve created account on emoncms.org but after few days I&#39;m unable to login into it regardless of using correct password. This pushed me to install emoncms&nbsp;local on my Synology NAS to be able to hack in cases like this. I&#39;ve followed the linux install steps omitting stuff that already is installed on the NAS (apache&nbsp;and mysql). It seems that almost everything is working except that my installation&nbsp;does not store data feeds. I can see the current feed&#39;s value but when I want to see raw data graph then it is empty. For sure something is missing in my install which is not mentioned in the linux installation&nbsp;guide. My guess is that data storage engine is not properly installed/configured. Can you give me hints how can I proceed to solve this problem (I&#39;m programmer so the guide can be quite technical).</p>
<p>I hope to get it solved as emoncms looks very promising&nbsp;and has potential to become a part of my application.</p>
<p>Thank you,</p>
<p>Michal</p>
  <div class="forum-topic-navigation clear-block">
          <a href="3807.html" class="topic-previous" title="Go to previous forum topic">‹ Need help with input to feed configuration</a>
              <a href="3781.html" class="topic-next" title="Go to next forum topic">PC based application send data to EmonCMS ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-14751"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4288.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Wxll&#039;s picture" title="Wxll&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonCMS on Synology NAS</h3>

    <div class="submitted">Submitted by <a href="../user/4288.html" title="View user profile.">Wxll</a> on Mon, 02/09/2013 - 10:30.</div>
    <div class="content">
     <p>Michal,</p>
<p>I&#39;ve been doing installs like Jira and Confluence on the&nbsp;Synology and it can be hellisch.. However I haven&#39;t worked with EmonCMS, but might be able to help...</p>
<p>Can you elaborate a bit more about the Syno you have?&nbsp;</p>
<p>Is it an i386&nbsp;based or ARM?</p>
<p>Did you bootstrap it?&nbsp;<br />
	<a href="http://forum.synology.com/wiki/index.php/Overview_on_modifying_the_Synology_Server,_bootstrap,_ipkg_etc" title="http://forum.synology.com/wiki/index.php/Overview_on_modifying_the_Synology_Server,_bootstrap,_ipkg_etc">http://forum.synology.com/wiki/index.php/Overview_on_modifying_the_Synol...</a></p>
<p>&nbsp;</p>
<p>I should have a look at the following:</p>
<p>Pulling custom webpages from the Syno, are you sure that it works?<br />
	Try doing a manual POST with Postman and Chrome to the Synology<br />
	<a href="https://chrome.google.com/webstore/detail/postman-rest-client/fdmmgilgnpjigdojojpjoooidkmcomcm?hl=en" title="https://chrome.google.com/webstore/detail/postman-rest-client/fdmmgilgnpjigdojojpjoooidkmcomcm?hl=en">https://chrome.google.com/webstore/detail/postman-rest-client/fdmmgilgnp...</a></p>
<p>Are you sure the synology is not redirecting your request url?</p>
<p>Can you see the request coming in on the Apach logs?<br />
	Did you try to write &quot;Hello World&quot; with a PHP script into the database table to make sure that PHP persistance is in fact working.</p>
<p>Can you create a simple chart with a dot on the screen ? just to check if there is enough graphical libs available for running EmonCMS</p>
<p>Hope this helps. and in the future I might give this a run on my Syno as well, for now waiting for my first Emon hardware :-)<br />
	Keep us posted how you proceed.</p>
<p>&nbsp;</p>
<p>Wxll</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-14756"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="aktur&#039;s picture" title="aktur&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonCMS on Synology NAS</h3>

    <div class="submitted">Submitted by aktur (not verified) on Mon, 02/09/2013 - 13:23.</div>
    <div class="content">
     <p>Hi Wxll,</p>
<p>I think that I did everything for my syno. After consulting&nbsp;readme.md I discovered that I need timestore. Grab it from git, I&#39;ve tweaked some paths for Synology&nbsp;to get it through install and finally got adminkey in /var/lib/timestore. This gives</p>
<p>DiskStation&gt; /etc/init.d/timestore status<br />
	Timestore is running</p>
<p>but I doubt it as ps&nbsp;does not show it, pidof timestore returns empty string and I see nothing written to /var/lib/timestore - no feeds.</p>
<p>PHP and MySQL is good as I&#39;m running many different applications on my Syno box without problems.</p>
<p>On my feed page I&#39;m unable to change realtime&nbsp;feeds from timestore engine to mysql, after selecting mysql it flips back to timestore.</p>
<p>What I would need now is to know how I can bullet proof that the timestore engine is working, or switch the storing engine to mysql&nbsp;(I don&#39;t bother performance and DB size now, my Syno has 15T ;)</p>
<p>Michal</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-14803"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4288.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Wxll&#039;s picture" title="Wxll&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonCMS on Synology NAS</h3>

    <div class="submitted">Submitted by <a href="../user/4288.html" title="View user profile.">Wxll</a> on Tue, 03/09/2013 - 12:25.</div>
    <div class="content">
     <p>Sounds you did a good job there so far. I&#39;m lagging experience with it from here on. Sounds like a good idea to check the timestore on a mysql.</p>
<p>Hope you get it running.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-14806"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="aktur&#039;s picture" title="aktur&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonCMS on Synology NAS</h3>

    <div class="submitted">Submitted by aktur (not verified) on Tue, 03/09/2013 - 12:55.</div>
    <div class="content">
     <p>Yes, I&#39;ve got it running, quite a brute way ;) As I&#39;ve said, although timestore reported running I did not belived it and decided to use only mysql anyway. I&#39;ve forced in the feed_model.php that it always uses MYSQL engine. Now feeds data are stored in mysql&nbsp;tables and graphs are working. But this is not solution for &#39;normal&#39; people ;) They need to wait for a proper Synology port, the best would be as Synology module of course, the same type&nbsp;as phpMyAdmin&nbsp;which is also PHP web aap.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-15002"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3818.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3818.png" alt="fversteegen&#039;s picture" title="fversteegen&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonCMS on Synology NAS</h3>

    <div class="submitted">Submitted by <a href="../user/3818.html" title="View user profile.">fversteegen</a> on Tue, 10/09/2013 - 06:28.</div>
    <div class="content">
     <p>Aktur, could you please share the edits you made so it runs only on MySQL? Timestore looks nice, but is way to complicated to run on webservers on which you do not have ssh access...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-15059"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4268.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="threldor&#039;s picture" title="threldor&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonCMS on Synology NAS</h3>

    <div class="submitted">Submitted by <a href="../user/4268.html" title="View user profile.">threldor</a> on Wed, 11/09/2013 - 08:45.</div>
    <div class="content">
     <p>What port does timestore run on? is this causing problems on the NAS?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-15136"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3818.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3818.png" alt="fversteegen&#039;s picture" title="fversteegen&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonCMS on Synology NAS</h3>

    <div class="submitted">Submitted by <a href="../user/3818.html" title="View user profile.">fversteegen</a> on Fri, 13/09/2013 - 12:01.</div>
    <div class="content">
     <p>Nevermind my previous question. It has already been answered by Trystan:</p>
<p>&nbsp;</p>
<p><em>fversteegen: yes, in fact I have just pushed an update today that allows you to change the default_engine to mysql that would allow use of emoncms exactly as before.</em></p>
<p><em>I have also added another feed engine called phptimeseries which is much faster than mysql but slower than timestore and without averaging, it also uses the same datafile format as mysql so its just a matter of copying the mysql datafiles. To use phptimeseries you need privileges to create a folder and assign www-data access to it.</em></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16034"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3818.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3818.png" alt="fversteegen&#039;s picture" title="fversteegen&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonCMS on Synology NAS</h3>

    <div class="submitted">Submitted by <a href="../user/3818.html" title="View user profile.">fversteegen</a> on Wed, 30/10/2013 - 09:28.</div>
    <div class="content">
     <p>Ok, I have been working on installing timestore, but I keep on getting stuck, What I did is the following (I use /volume1/web as temp dir)</p>
<ol>
<li>
		cd /volume1/web</li>
<li>
		git clone <a href="http://www.mike-stirling.com/git/timestore.git" title="http://www.mike-stirling.com/git/timestore.git">http://www.mike-stirling.com/git/timestore.git</a></li>
<li>
		cd timestore</li>
<li>
		chmod +x install</li>
<li>
		ipkg install libmicrohttpd (since it is not installing properly through the use of install)</li>
<li>
		mkdir /opt/arm-none-linux-gnueabi/lib_disabled</li>
<li>
		mv /opt/arm-none-linux-gnueabi/lib/libpthread* /opt/arm-none-linux-gnueabi/lib_disabled</li>
<li>
		cp /lib/libpthread.so.0 /opt/arm-none-linux-gnueabi/lib/</li>
<li>
		cd /opt/arm-none-linux-gnueabi/lib/</li>
<li>
		ln -s libpthread.so.0 libpthread.so</li>
<li>
		ln -s libpthread.so.0 libpthread-2.5.so</li>
<li>
		Edit install and change first line to: #!/bin/sh</li>
<li>
		sh install</li>
</ol>
<p>After that everything seems to be working fine, but in the end I do not get a timestore admin key. I think that I need to change the foldernames in install, but do not know to what to change them. Any help appreciated!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16962"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="flusk&#039;s picture" title="flusk&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonCMS on Synology NAS</h3>

    <div class="submitted">Submitted by flusk (not verified) on Sun, 22/12/2013 - 12:25.</div>
    <div class="content">
     <p>Came across this page looking for tips on getting emoncms running on my Synology NAS with timestore. A few twists and turns along the way but I now have it working with DSM 4.2 on my DS209+II.</p>
<p>If you have built timestore but not sure it is working try running it from the command line:</p>
<p>timestore -a -d -v3</p>
<p>It should produce enough tracing to convince you if things are ok or not.</p>
<p>You may find like I did that everything looks like it should be working but your graphs are empty. DSM has PHP open_basedir set and you need to go into web settings -&gt; PHP settings and add /var/lib/timestore.</p>
<p>I was migrating from initially having used mysql and found the migration process painless (and very slick).</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-18285"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5487.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rapzak&#039;s picture" title="rapzak&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonCMS on Synology NAS</h3>

    <div class="submitted">Submitted by <a href="../user/5487.html" title="View user profile.">rapzak</a> on Sat, 08/02/2014 - 12:35.</div>
    <div class="content">
     <p>Hi..</p>
<p>I got a I686 NAS (DS710+)</p>
<p>When i install timestore i get this error:</p>
<p>1) COMPILE TIMESTORE<br />
	==============================<br />
	make -C src<br />
	make[1]: Entering directory `/volume1/upload/time/timestore/src&#39;<br />
	gcc -c -Wall -g -Ilibmicrohttpd-0.9.24/image/include tsdb.c -o tsdb.o<br />
	tsdb.c: In function &#39;tsdb_update_layer&#39;:<br />
	tsdb.c:285: error: &#39;NAN&#39; undeclared (first use in this function)<br />
	tsdb.c:285: error: (Each undeclared identifier is reported only once<br />
	tsdb.c:285: error: for each function it appears in.)<br />
	tsdb.c:377: error: &#39;INFINITY&#39; undeclared (first use in this function)<br />
	make[1]: *** [tsdb.o] Error 1<br />
	make[1]: Leaving directory `/volume1/upload/time/timestore/src&#39;<br />
	make: *** [all] Error 2<br />
	==============================<br />
	2) TIMESTORE DATA DIRECTORY<br />
	==============================<br />
	Timestore directory already exists<br />
	==============================<br />
	3) COPY INIT SCRIPT TO INIT.D DIRECTORY<br />
	==============================<br />
	Copying init script<br />
	install: line 35: can&#39;t create /etc/default/timestore: nonexistent directory<br />
	install: line 40: update-rc.d: not found<br />
	==============================<br />
	4) START TIMESTORE<br />
	==============================<br />
	install: line 46: /etc/init.d/timestore: not found<br />
	==============================<br />
	5) TIMESTORE ADMINKEY<br />
	==============================<br />
	cat: /var/lib/timestore/adminkey.txt: No such file or directory</p>
<p>&nbsp;</p>
<p>Some one who has made a fix for this ?</p>
<p>&nbsp;</p>
<p>BR&nbsp;</p>
<p>Rapzak</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/2757"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-eGW9gxc_2ztnToHbnXDj0jqqayjBSvrewX-0dNU3N5k" value="form-eGW9gxc_2ztnToHbnXDj0jqqayjBSvrewX-0dNU3N5k"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
