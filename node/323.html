<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/323 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:08:40 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>How to connect emontx to nanode5 using rmf12 | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">How to connect emontx to nanode5 using rmf12</h3>
        <span class="submitted">Submitted by Guest on Fri, 30/12/2011 - 07:36</span>
        <div class="content"><p>Hello,</p>
<p>I have been working this problem for two days and still cannot determine how to connect emontx to nanode via RMF12 wireless. Could anyone here point me to how I can connect those device? </p>
<p>I have uploaded the sketch to emontx.. but it just stucks when executing the command rfwrite();</p>
<p>It shows on the serial monitor (in emontx): </p>
<p>Node: 10 Freq:&nbsp;433MHz Network:212</p>
<p>&nbsp;</p>
<p>and then just stop. Does that mean my RMF12B is error ? or does the nanode need to be connected first in order for the emontx to be able to send the data?</p>
<p>&nbsp;</p>
<p>And also is it possible to post the reading value in nanode as a webserver? Because I see from the sketch example it only post to pachube and emoncms.</p>
<p>Thanks very much for the help and I apologize if this seems to be a very newbie question. </p>
<p>kind regards,</p>
<p>John</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="320.html" class="topic-previous" title="Go to previous forum topic">‹ Source for Australian AC-AC adapter for voltage monitoring?</a>
              <a href="329.html" class="topic-next" title="Go to next forum topic">NanodeRF adjust onboard time from server reply ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-2595"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to connect emontx to nanode5 using rmf12</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 30/12/2011 - 12:56.</div>
    <div class="content">
     <p>The emonTx stops printing because serial has been disabled, it improves long term stability. To re enable it change #define serial 0 to #define serial 1 on about the 6th line down from the top.&nbsp;</p>
<p>For the wireless to work both the emonTx and Nanode need to be on the same network group and have the same frequenct. The ayload structure as defined near the beginning of the sketch must also be identical in both the emonTx and NanodeRF sketch. We have recently added a new NanodeRF example using the new EtherCard Ethernet library. It's up on github.</p>
<p>To test the wireless in isolation (without energy monitoring and Ethernet code getting i the way) try this sketch:&nbsp;<a href="https://github.com/openenergymonitor/RFM12B_Simple">https://github.com/openenergymonitor/RFM12B_Simple</a></p>
<p>For more information about the RFM12B see:&nbsp;<a href="271.html">http://openenergymonitor.org/emon/node/271</a></p>
<p>Good luck,&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-2618"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="jkoe888&#039;s picture" title="jkoe888&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: How to connect emontx to nanode5 using rmf12</h3>

    <div class="submitted">Submitted by jkoe888 (not verified) on Sun, 01/01/2012 - 03:30.</div>
    <div class="content">
     <p>Hi Glyn,</p>
<p>Thanks for the info. I have enabled the serial 1 at the top of the sketch . But soon after the rfwrite(); commend the serial monitor just stops printing the result.</p>
<p>If I comment out the rfwrite() the sketch works just fine.</p>
<p><img alt="" style="width: 245px; height: 228px;" src="../sites/default/files/image/jkoe888/Screen%20Shot%202012-01-01%20at%2010_21_04%20AM.png" /><img alt="" style="width: 243px; height: 229px;" src="../sites/default/files/image/jkoe888/Screen%20Shot%202012-01-01%20at%2010_22_54%20AM.png" /></p>
<p>The right image is when I comment out the rfwrite(); inside the void loop(){}</p>
<p>&nbsp;</p>
<p>I also notice there are two cmmands one is commented out in the rfwrite method:</p>
<p>rf12_sendStart(0, &amp;emontx, sizeof emontx);</p>
<p>//rf12_sendStart(rf12_hdr, &amp;emontx, sizeof emontx, RADIO_SYNC_MODE);&nbsp; - use instead of line above if emonTx node ID is required in header. For multiple emonTx's to a single emonBase</p>
<p>what's the difference between those two ?</p>
<p>&nbsp;</p>
<p>Thanks again.&nbsp;</p>
<p>&nbsp;</p>
<p>kind regards,</p>
<p>John&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-2626"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to connect emontx to nanode5 using rmf12</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Sun, 01/01/2012 - 22:20.</div>
    <div class="content">
     <p>Mmm, thats strange. The line rfwrite(); is needed, thats the function that actually transmitts the data. Try reducing the ammout of stuff you are serial printing, try printing a single integer to start with. What emonTx firmware example are you using? Try the single CT examaple to start with.&nbsp;</p>
<p>The lines&nbsp;rf12_sendStart(0, &amp;emontx, sizeof emontx); and&nbsp;//rf12_sendStart(rf12_hdr, &amp;emontx, sizeof emontx, RADIO_SYNC_MODE);&nbsp;are the lines which actually transmittt the data. Only one line should be used at a time. The second line includes the emonTx's node ID in the transmission. This is needed to distinguish&nbsp; transmission packets if multiple emonTx's are on the same network. But it does slightly increase the size of the packets and therefore the ammount of power needed. Often the emonTx is powered by batteries and therefore any little power saving trick is helpfull .</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-2627"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="jkoe888&#039;s picture" title="jkoe888&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: How to connect emontx to nanode5 using rmf12</h3>

    <div class="submitted">Submitted by jkoe888 (not verified) on Mon, 02/01/2012 - 01:10.</div>
    <div class="content">
     <p>Hi Glyn,</p>
<p>It turns out that two of the corner pin in RMF12 is not soldered properly.. my mistakes... now everything is working.. It can transmit data and received by the nanode..</p>
<p>Thanks very much !</p>
<p>&nbsp;</p>
<p>cheers,</p>
<p>John</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/323"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-ojHtYQ5rmY8bAuC0HdOfFn8cCRG742TlQ_k5TN64nz4" value="form-ojHtYQ5rmY8bAuC0HdOfFn8cCRG742TlQ_k5TN64nz4"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/323 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:08:40 GMT -->
</html>
