<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11298 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:54:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Interfacers for MQTT -Solved | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Interfacers for MQTT -Solved</h3>
        <span class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Thu, 24/09/2015 - 17:13</span>
        <div class="content"><p>Do&nbsp;I need an interfacer&nbsp;in emonhub.conf to utilise&nbsp;the&nbsp;phpmqtt_input.php script as I can&#39;t seem to get emoncms&nbsp;to subscribe to MQTT. I&#39;ve tried various topics without success (rx/ tx/ emonhub/ rx/emoncms/input etc etc). MQTT is working ok as I&#39;ve written a node-red flow that subscribes to MQTT and forwards data to emoncmcs.org.</p>
<p>I&#39;m running the extended v9 RC2 | 2015.09.15 newly installed on a raspberrypi2&nbsp;with external HDD.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="2723.html" class="topic-previous" title="Go to previous forum topic">‹ Adding modules/pages to Emoncms</a>
              <a href="11175.html" class="topic-next" title="Go to next forum topic">SQL rounds my inputs ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-34448"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Interfacers for MQTT -Solved</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 24/09/2015 - 17:39.</div>
    <div class="content">
     <p>No, emonHub shouldn&#39;t need&nbsp;to be involved for emonCMS to subscribe to MQTT, but I have no idea what the topic arrangements are off-hand, do you have a MQTT&nbsp;tool that you can use subscribe to the topic(s) published by node-red to confirm they are being published and/or publish something to the emonCMS topic,&nbsp;</p>
<p>Is there any emoncms&nbsp;(error)&nbsp;logging ? I just wonder if it&#39;s possible you have tried the correct topic but the message has not conformed in a way that emoncms&nbsp;can parse it, basically are you sure it&#39;s not subscribing or is there just no inputs from MQTT?</p>
<p>Paul&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34449"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Interfacers for MQTT -Solved</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Thu, 24/09/2015 - 17:55.</div>
    <div class="content">
     <p>I&#39;m using MQTT.fx and I can see that topics are being published but I&#39;m seeing nothing in the emoncms.log (well not direct from MQTT at least but plenty from my other emoncms installation&nbsp;which is forwarding to this one via http).</p>
<p>Maybe I&#39;m using the wrong topics, where would I find the correct topics and format ?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34450"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Interfacers for MQTT -Solved</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 24/09/2015 - 18:11.</div>
    <div class="content">
     <p>The phpmqtt_input.php&nbsp;script itself is good place to start, but that seems to say <a href="https://github.com/emoncms/emoncms/blob/9.0/scripts/phpmqtt_input.php#L5">it should be &quot;rx/&quot;&nbsp;on line 5</a>&nbsp;but the examples below&nbsp;that say differently.&nbsp;</p>
<p><s>Do you have <a href="https://github.com/emoncms/emoncms/blob/9.0/default.settings.php#L23">MQTT enabled in the settings</a> ? and</s> are emoncms, node-red and the mqtt broker all on the same machine? If not have you changed the IP address and also opened the firewall on port 1883 ?</p>
<p>Pau</p>
<p>EDIT - scrap the settings check it seems those mqtt settings might only apply to the publishing from emoncms.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34451"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Interfacers for MQTT -Solved</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Thu, 24/09/2015 - 18:25.</div>
    <div class="content">
     <p>I&#39;ve stopped the other emoncms updates which were swamping the log and messed with the MQTT publishing data and now I&#39;m seeing &quot;|ERROR|input_controller.php|Format error, json string supplied is not valid&quot; so&nbsp;it looks like the topic and/or format are invalid, Trouble is it keeps repeating periodically even when I&#39;m&nbsp;not sending so I&#39;m unsure which bits to amend. Surely there&#39;s some documentation somewhere on the expected topics/format.</p>
<p>EDIT:</p>
<p>The error messages are likely a red herring as they continued even after a reboot then disappeared when I set the other emoncms&nbsp;to continue sending data via http</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34452"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Interfacers for MQTT -Solved</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 24/09/2015 - 18:34.</div>
    <div class="content">
     <p>How are you keeping phpmqtt_input running? are you running the init script, or just calling it in a SSH session?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34453"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Interfacers for MQTT -Solved</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Thu, 24/09/2015 - 18:36.</div>
    <div class="content">
     <p>via the init script</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34454"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Interfacers for MQTT -Solved</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Thu, 24/09/2015 - 18:47.</div>
    <div class="content">
     <p>Can you publish to MQTT via the emoncms input process?</p>
<p>To subscribe to a node, I found that &#39;out of the box&#39; provided that the phpmqtt_input script is running, and MQTT has been enabled in settings.php, that publishing a message in the node format rx/20 will create feed 20 in emoncms and update it accordingly. Doesn&#39;t that happen?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34455"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Interfacers for MQTT -Solved</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Thu, 24/09/2015 - 18:54.</div>
    <div class="content">
     <p>Yes that works so I just need to see what the format is and I&#39;m good to go.</p>
<p>OK sorted,&nbsp;looks like things were much simpler than I realised, thanks for your help</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34482"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Interfacers for MQTT -Solved</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Fri, 25/09/2015 - 09:57.</div>
    <div class="content">
     <p>That's good. I was hoping for a more descriptive topic to subscribe to than rx/ see this post - <a href="11290.html" title="http://openenergymonitor.org/emon/node/11290">http://openenergymonitor.org/emon/node/11290</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34489"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Interfacers for MQTT -Solved</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Fri, 25/09/2015 - 11:59.</div>
    <div class="content">
     <p>Well I&#39;ve changed the code in phpmqtt_input.php to use a more descriptive base topic of&nbsp;emoncms/input unfortunately MQTTfx&nbsp;has decide to stop working with an &nbsp;&#39;Error invoking method.&quot; error so I&#39;ve not tested as yet. Tried MQTT-Spy but I can&#39;t get on with it so I&#39;m now looking for another MQTT client/monitor.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34490"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Interfacers for MQTT -Solved</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Fri, 25/09/2015 - 12:19.</div>
    <div class="content">
     <p>Yes, I tried that too, and found that it didnt work!</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34492"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Interfacers for MQTT -Solved</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Fri, 25/09/2015 - 14:09.</div>
    <div class="content">
     <p>Well&nbsp;it works after a fashion but the code expects the 1st item after the &quot;/&quot; to be the input id and after the next &quot;/&quot; the key so no &quot;/&quot;s allowed in the base topic so I&#39;ve settled on &quot;emoncms-in&quot; as the base topic. The other point to bear in mind is that because this isn&#39;t going via emonhub, forwarding to a remote emoncms&nbsp;doesn&#39;t work, but that&#39;s ok as I have a node-red flow for that.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11298"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-qkWRCI-VF8YXVorVi-i2svJxAdMZ2ThRp9QS4F1JhTg" value="form-qkWRCI-VF8YXVorVi-i2svJxAdMZ2ThRp9QS4F1JhTg"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
