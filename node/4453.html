<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/4453 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:07:20 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>error address already in use cannot open port 50011 | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/3.html">Archived: General Discussion</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">error address already in use cannot open port 50011</h3>
        <span class="submitted">Submitted by Guest on Fri, 28/03/2014 - 17:31</span>
        <div class="content"><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Hi everyone,</p>
<p>&nbsp;</p>
<p>First of all, I d like to apologize for my English which is not that well :)</p>
<p>I ve been working for days on your project but I still don&#39;t have data coming on emoncms ...</p>
<p>I ve bought the fully assembled pack and configured correctly the raspberry pi I think with domain and api key changes.</p>
<p>When I access via SSH the raspberry pi the oemgateway.conf returns this :</p>
<p>2014-03-28 16:10:02,244 INFO Logging level set to DEBUG<br />
	2014-03-28 16:10:02,247 INFO Opening gateway...<br />
	2014-03-28 16:10:02,250 INFO Creating buffer emoncms_local<br />
	2014-03-28 16:10:02,254 INFO Creating buffer emoncms_remote<br />
	2014-03-28 16:10:02,258 INFO Creating listener RFM2Pi<br />
	2014-03-28 16:10:02,261 DEBUG Opening serial port: /dev/ttyAMA0<br />
	2014-03-28 16:10:02,265 INFO Setting send time interval to 300<br />
	2014-03-28 16:10:02,268 INFO Setting RFM2Pi | frequency: 8<br />
	2014-03-28 16:10:03,271 INFO Setting RFM2Pi | sgroup: 210<br />
	2014-03-28 16:10:04,275 INFO Setting RFM2Pi | baseid: 15<br />
	2014-03-28 16:10:05,279 INFO Creating listener Socket<br />
	2014-03-28 16:10:05,283 DEBUG Opening socket on port 50011<br />
	2014-03-28 16:10:05,287 ERROR [Errno 98] Address already in use<br />
	2014-03-28 16:10:05,290 ERROR Could not open port 50011<br />
	2014-03-28 16:10:05,311 DEBUG Broadcasting time: 16:10<br />
	2014-03-28 16:10:05,315 INFO Serial RX:<br />
	2014-03-28 16:10:05,318 WARNING Misformed RX frame: [&#39;\x01&#39;]<br />
	2014-03-28 16:10:05,522 INFO Serial RX: &gt; 0s</p>
<p>I don&#39;t know where the error comes from I m really new in that kind of stuff ...</p>
<p>This my emontx code :</p>
<blockquote><p>/*<br />
		&nbsp;<br />
		&nbsp; emonTxV3 Discrete Sampling<br />
		&nbsp;<br />
		&nbsp; If AC-AC adapter is detected assume emonTx is also powered from adapter (jumper shorted) and take Real Power Readings and disable sleep mode to keep load on power supply constant<br />
		&nbsp; If AC-AC addapter is not detected assume powering from battereis / USB 5V AC sample is not present so take Apparent Power Readings and enable sleep mode<br />
		&nbsp;<br />
		&nbsp; Transmitt values via RFM12B radio<br />
		&nbsp;<br />
		&nbsp;&nbsp; -----------------------------------------<br />
		&nbsp; Part of the openenergymonitor.org project<br />
		&nbsp;<br />
		&nbsp; Authors: Glyn Hudson &amp; Trystan Lea<br />
		&nbsp; Builds upon JCW JeeLabs RF12 library and Arduino<br />
		&nbsp;<br />
		&nbsp; Licence: GNU GPL V3</p>
<p>*/</p>
<p>/*Recommended node ID allocation<br />
		------------------------------------------------------------------------------------------------------------<br />
		-ID- -Node Type-<br />
		0 - Special allocation in JeeLib RFM12 driver - reserved for OOK use<br />
		1-4&nbsp;&nbsp;&nbsp;&nbsp; - Control nodes<br />
		5-10 - Energy monitoring nodes<br />
		11-14 --Un-assigned --<br />
		15-16 - Base Station &amp; logging nodes<br />
		17-30 - Environmental sensing nodes (temperature humidity etc.)<br />
		31 - Special allocation in JeeLib RFM12 driver - Node31 can communicate with nodes on any network group<br />
		-------------------------------------------------------------------------------------------------------------</p>
<p>
		Change Log:<br />
		V1.3 - fix filter settle time to eliminate large inital reading<br />
		V1.2 - fix bug which caused Vrms to be returned as zero if CT1 was not connected<br />
		V1.1 - fix bug in startup Vrms calculation, startup Vrms startup calculation is now more accuratre<br />
		*/</p>
<p>#define emonTxV3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Tell emonLib this is the emonTx V3 - don&#39;t read Vcc assume Vcc = 3.3V as is always the case on emonTx V3 eliminates bandgap error and need for calibration <a href="http://harizanov.com/2013/09/thoughts-on-avr-adc-accuracy/" title="http://harizanov.com/2013/09/thoughts-on-avr-adc-accuracy/">http://harizanov.com/2013/09/thoughts-on-avr-adc-accuracy/</a></p>
<p>#include &lt;RFu_JeeLib.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Special modified version of the JeeJib library to work with the RFu328 <a href="https://github.com/openenergymonitor/RFu_jeelib       " title="https://github.com/openenergymonitor/RFu_jeelib       ">https://github.com/openenergymonitor/RFu_jeelib       </a><br />
		ISR(WDT_vect) { Sleepy::watchdogEvent(); }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Attached JeeLib sleep function to Atmega328 watchdog -enables MCU to be put into sleep mode inbetween readings to reduce power consumption</p>
<p>#include &quot;EmonLib.h&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Include EmonLib energy monitoring library <a href="https://github.com/openenergymonitor/EmonLib" title="https://github.com/openenergymonitor/EmonLib">https://github.com/openenergymonitor/EmonLib</a><br />
		EnergyMonitor ct1, ct2, ct3, ct4;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>#include &lt;OneWire.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //http://www.pjrc.com/teensy/td_libs_OneWire.html<br />
		#include &lt;DallasTemperature.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //http://download.milesburton.com/Arduino/MaximTemperature/DallasTemperature_LATEST.zip</p>
<p>
		//----------------------------emonTx V3 Settings---------------------------------------------------------------------------------------------------------------<br />
		const byte Vrms=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 230;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Vrms for apparent power readings (when no AC-AC voltage sample is present)<br />
		const byte TIME_BETWEEN_READINGS= 10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Time between readings&nbsp;&nbsp;</p>
<p>const float Ical1=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 90.9;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (2000 turns / 22 Ohm burden) = 90.9<br />
		const float Ical2=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 90.9;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (2000 turns / 22 Ohm burden) = 90.9<br />
		const float Ical3=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 90.9;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (2000 turns / 22 Ohm burden) = 90.9<br />
		const float Ical4=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 16.6;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (2000 turns / 120 Ohm burden) = 16.6</p>
<p>const float Vcal=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 276.9;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // (230V x 13) / (9V x 1.2) = 276.9</p>
<p>const float phase_shift=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.7;<br />
		const int no_of_samples=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1480;<br />
		const int no_of_half_wavelengths= 20;<br />
		const int timeout=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2000;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //emonLib timeout<br />
		const int ACAC_DETECTION_LEVEL=&nbsp;&nbsp; 3000;<br />
		const int TEMPERATURE_PRECISION=&nbsp; 11;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //9 (93.8ms),10 (187.5ms) ,11 (375ms) or 12 (750ms) bits equal to resplution of 0.5C, 0.25C, 0.125C and 0.0625C<br />
		//#define FILTERSETTLETIME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 25000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Time (ms) to allow the filters to settle before sending data<br />
		#define ASYNC_DELAY 375&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // DS18B20 conversion delay - 9bit requres 95ms, 10bit 187ms, 11bit 375ms and 12bit resolution takes 750ms<br />
		//-------------------------------------------------------------------------------------------------------------------------------------------<br />
		//-------------------------------------------------------------------------------------------------------------------------------------------</p>
<p>
		//----------------------------emonTx V3 hard-wired connections---------------------------------------------------------------------------------------------------------------<br />
		const byte LEDpin=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // emonTx V3 LED<br />
		const byte DS18B20_PWR=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 19;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // DS18B20 Power<br />
		#define ONE_WIRE_BUS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // DS18B20 Data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
		//-------------------------------------------------------------------------------------------------------------------------------------------</p>
<p>//Setup DS128B20<br />
		OneWire oneWire(ONE_WIRE_BUS);<br />
		DallasTemperature sensors(&amp;oneWire);</p>
<p>//-------------------------------------------------------------------------------------------------------------------------------------------</p>
<p>//-----------------------RFM12B SETTINGS----------------------------------------------------------------------------------------------------<br />
		#define RF_freq RF12_868MHZ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Frequency of RF12B module can be RF12_433MHZ, RF12_868MHZ or RF12_915MHZ. You should use the one matching the module you have.<br />
		const int nodeID = 15;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // emonTx RFM12B node ID<br />
		const int networkGroup = 210;&nbsp;<br />
		typedef struct { int power1, power2, power3, power4, Vrms, temp; } PayloadTX;&nbsp;&nbsp;&nbsp;&nbsp; // create structure - a neat way of packaging data for RF comms<br />
		&nbsp; PayloadTX emontx;<br />
		//-------------------------------------------------------------------------------------------------------------------------------------------<br />
		//-------------------------------------------------------------------------------------------------------------------------------------------</p>
<p>
		//Random Variables<br />
		//boolean settled = false;<br />
		boolean CT1, CT2, CT3, CT4, ACAC, debug, DS18B20_STATUS;<br />
		byte CT_count=0;<br />
		int numSensors;<br />
		//addresses of sensors, MAX 4!!&nbsp;<br />
		byte allAddress [4][8];&nbsp; // 8 bytes per address</p>
<p>void setup()<br />
		{</p>
<p>		&nbsp; pinMode(LEDpin, OUTPUT);<br />
		&nbsp; pinMode(DS18B20_PWR, OUTPUT);&nbsp;<br />
		&nbsp; digitalWrite(LEDpin,HIGH);</p>
<p>&nbsp; Serial.begin(9600);<br />
		&nbsp; Serial.println(&quot;emonTx V3 Discrete Sampling V1.3&quot;);<br />
		&nbsp; Serial.println(&quot;OpenEnergyMonitor.org&quot;);<br />
		&nbsp; Serial.println(&quot;Performing power-on tests.....please wait 10s&quot;);<br />
		&nbsp;<br />
		&nbsp; delay(10);<br />
		&nbsp; rf12_initialize(nodeID, RF_freq, networkGroup);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // initialize RFM12B<br />
		&nbsp;&nbsp; for (int i=10; i&gt;=0; i--)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Send RFM12B test sequence (for factory testing)<br />
		&nbsp;&nbsp; {<br />
		&nbsp;&nbsp;&nbsp;&nbsp; emontx.power1=i;<br />
		&nbsp;&nbsp;&nbsp;&nbsp; rf12_sendNow(0, &amp;emontx, sizeof emontx);<br />
		&nbsp;&nbsp;&nbsp;&nbsp; delay(100);<br />
		&nbsp;&nbsp; }<br />
		&nbsp; rf12_sendWait(2);<br />
		&nbsp; emontx.power1=0;<br />
		&nbsp; rf12_sleep(RF12_SLEEP);&nbsp;&nbsp;</p>
<p>		&nbsp;&nbsp;</p>
<p>&nbsp; if (analogRead(1) &gt; 0) {CT1 = 1; CT_count++;} else CT1=0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // check to see if CT is connected to CT1 input, if so enable that channel<br />
		&nbsp; if (analogRead(2) &gt; 0) {CT2 = 1; CT_count++;} else CT2=0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // check to see if CT is connected to CT2 input, if so enable that channel<br />
		&nbsp; if (analogRead(3) &gt; 0) {CT3 = 1; CT_count++;} else CT3=0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // check to see if CT is connected to CT3 input, if so enable that channel<br />
		&nbsp; if (analogRead(4) &gt; 0) {CT4 = 1; CT_count++;} else CT4=0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp; check to see if CT is connected to CT4 input, if so enable that channel<br />
		&nbsp;<br />
		&nbsp; if ( CT_count == 0) CT1=1;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // If no CT&#39;s are connect ed CT1-4 then by default read from CT1</p>
<p>&nbsp; // Quick check to see if there is a voltage waveform present on the ACAC Voltage input<br />
		&nbsp; // Check consists of calculating the RMS from 100 samples of the voltage input.<br />
		&nbsp; Sleepy::loseSomeTime(10000);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //wait for settle<br />
		&nbsp; digitalWrite(LEDpin,LOW);<br />
		&nbsp;<br />
		&nbsp; // Calculate if there is an ACAC adapter on analog input 0<br />
		&nbsp; //double vrms = calc_rms(0,1780) * (Vcal * (3.3/1024) );<br />
		&nbsp; double vrms = calc_rms(0,1780) * 0.87;<br />
		&nbsp; if (vrms&gt;90) ACAC = 1; else ACAC=0;</p>
<p>		&nbsp; if (ACAC)<br />
		&nbsp; {<br />
		&nbsp;&nbsp;&nbsp; for (int i=0; i&lt;10; i++)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // indicate AC has been detected by flashing LED 10 times<br />
		&nbsp;&nbsp;&nbsp; {<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; digitalWrite(LEDpin, HIGH); delay(200);<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; digitalWrite(LEDpin, LOW); delay(300);<br />
		&nbsp;&nbsp;&nbsp; }<br />
		&nbsp; }<br />
		&nbsp; else<br />
		&nbsp; {<br />
		&nbsp;&nbsp;&nbsp; delay(1000);<br />
		&nbsp;&nbsp;&nbsp; digitalWrite(LEDpin, HIGH); delay(2000); digitalWrite(LEDpin, LOW);&nbsp;&nbsp; // indicate DC power has been detected by turing LED on then off<br />
		&nbsp; }</p>
<p>
		//################################################################################################################################<br />
		&nbsp; //Setup and for presence of DS18B20<br />
		&nbsp; //################################################################################################################################<br />
		&nbsp; digitalWrite(DS18B20_PWR, HIGH); delay(50);<br />
		&nbsp; sensors.begin();<br />
		&nbsp; sensors.setWaitForConversion(false);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //disable automatic temperature conversion to reduce time spent awake, conversion will be implemented manually in sleeping <a href="http://harizanov.com/2013/07/optimizing-ds18b20-code-for-low-power-applications/" title="http://harizanov.com/2013/07/optimizing-ds18b20-code-for-low-power-applications/">http://harizanov.com/2013/07/optimizing-ds18b20-code-for-low-power-appli...</a><br />
		&nbsp; numSensors=(sensors.getDeviceCount());<br />
		&nbsp;<br />
		&nbsp; byte j=0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // search for one wire devices and<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // copy to device address arrays.<br />
		&nbsp; while ((j &lt; numSensors) &amp;&amp; (oneWire.search(allAddress[j])))&nbsp; j++;<br />
		&nbsp; digitalWrite(DS18B20_PWR, LOW);<br />
		&nbsp;<br />
		&nbsp; if (numSensors==0) DS18B20_STATUS=0;<br />
		&nbsp;&nbsp;&nbsp; else DS18B20_STATUS=1;</p>
<p>&nbsp;<br />
		//################################################################################################################################</p>
<p>&nbsp; if (Serial) debug = 1; else debug=0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //if serial UART to USB is connected show debug O/P. If not then disable serial<br />
		&nbsp; if (debug==1)<br />
		&nbsp; {<br />
		&nbsp;&nbsp;&nbsp; Serial.print(&quot;CT 1 Calibration: &quot;); Serial.println(Ical1);<br />
		&nbsp;&nbsp;&nbsp; Serial.print(&quot;CT 2 Calibration: &quot;); Serial.println(Ical2);<br />
		&nbsp;&nbsp;&nbsp; Serial.print(&quot;CT 3 Calibration: &quot;); Serial.println(Ical3);<br />
		&nbsp;&nbsp;&nbsp; Serial.print(&quot;CT 4 Calibration: &quot;); Serial.println(Ical4);<br />
		&nbsp;&nbsp;&nbsp; delay(1000);</p>
<p>&nbsp;&nbsp;&nbsp; Serial.print(&quot;RMS Voltage on AC-AC Adapter input is: ~&quot;);<br />
		&nbsp;&nbsp;&nbsp; Serial.print(vrms,0); Serial.println(&quot;V&quot;);<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
		&nbsp;&nbsp;&nbsp; if (ACAC)<br />
		&nbsp;&nbsp;&nbsp; {<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.println(&quot;AC-AC adapter detected - Real Power measurements enabled&quot;);<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.println(&quot;assuming powering from AC-AC adapter (jumper closed)&quot;);<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.print(&quot;Vcal: &quot;); Serial.println(Vcal);<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.print(&quot;Phase Shift: &quot;); Serial.println(phase_shift);<br />
		&nbsp;&nbsp;&nbsp; }<br />
		&nbsp;&nbsp;&nbsp;&nbsp; else<br />
		&nbsp;&nbsp;&nbsp;&nbsp; {<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.println(&quot;AC-AC adapter NOT detected - Apparent Power measurements enabled&quot;);<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.print(&quot;Assuming VRMS to be &quot;); Serial.print(Vrms); Serial.println(&quot;V&quot;);<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Serial.println(&quot;Assuming powering from batteries / 5V USB - power saving mode enabled&quot;);<br />
		&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; if (CT_count==0) Serial.println(&quot;NO CT&#39;s detected, sampling from CT1 by default&quot;);<br />
		&nbsp;&nbsp;&nbsp; else&nbsp;&nbsp;<br />
		&nbsp;&nbsp;&nbsp; {<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (CT1) Serial.println(&quot;CT 1 detected&quot;);<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (CT2) Serial.println(&quot;CT 2 detected&quot;);<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (CT3) Serial.println(&quot;CT 3 detected&quot;);<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (CT4) Serial.println(&quot;CT 4 detected&quot;);<br />
		&nbsp;&nbsp;&nbsp; }<br />
		&nbsp;&nbsp;&nbsp; if (DS18B20_STATUS==1) {Serial.print(&quot;Detected &quot;); Serial.print(numSensors); Serial.println(&quot; DS18B20..using this for temperature reading&quot;);}<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else Serial.println(&quot;Unable to detect DS18B20 temperature sensor&quot;);<br />
		&nbsp;&nbsp;&nbsp; Serial.println(&quot;RFM12B Initiated: &quot;);<br />
		&nbsp;&nbsp;&nbsp; Serial.print(&quot;Node: &quot;); Serial.print(nodeID);<br />
		&nbsp;&nbsp;&nbsp; Serial.print(&quot; Freq: &quot;);<br />
		&nbsp;&nbsp;&nbsp; if (RF_freq == RF12_433MHZ) Serial.print(&quot;433Mhz&quot;);<br />
		&nbsp;&nbsp;&nbsp; if (RF_freq == RF12_868MHZ) Serial.print(&quot;868Mhz&quot;);<br />
		&nbsp;&nbsp;&nbsp; if (RF_freq == RF12_915MHZ) Serial.print(&quot;915Mhz&quot;);<br />
		&nbsp;&nbsp;&nbsp; Serial.print(&quot; Network: &quot;); Serial.println(networkGroup);<br />
		&nbsp;&nbsp; delay(500);&nbsp;<br />
		&nbsp; }<br />
		&nbsp; else<br />
		&nbsp;&nbsp;&nbsp; Serial.end();<br />
		&nbsp;<br />
		&nbsp;<br />
		&nbsp;&nbsp;&nbsp;<br />
		&nbsp; if (CT1) ct1.current(1, Ical1);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // CT ADC channel 1, calibration.&nbsp; calibration (2000 turns / 22 Ohm burden resistor = 90.909)<br />
		&nbsp; if (CT2) ct2.current(2, Ical2);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // CT ADC channel 2, calibration.<br />
		&nbsp; if (CT3) ct3.current(3, Ical3);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // CT ADC channel 3, calibration.<br />
		&nbsp; //CT 3 is high accuracy @ low power -&nbsp; 4.5kW Max @ 240V<br />
		&nbsp; if (CT4) ct4.current(4, Ical4);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // CT channel ADC 4, calibration.&nbsp;&nbsp;&nbsp; calibration (2000 turns / 120 Ohm burden resistor = 16.66)<br />
		&nbsp;<br />
		&nbsp; if (ACAC)<br />
		&nbsp; {<br />
		&nbsp;&nbsp;&nbsp; if (CT1) ct1.voltage(0, Vcal, phase_shift);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // ADC pin, Calibration, phase_shift<br />
		&nbsp;&nbsp;&nbsp; if (CT2) ct2.voltage(0, Vcal, phase_shift);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // ADC pin, Calibration, phase_shift<br />
		&nbsp;&nbsp;&nbsp; if (CT3) ct3.voltage(0, Vcal, phase_shift);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // ADC pin, Calibration, phase_shift<br />
		&nbsp;&nbsp;&nbsp; if (CT4) ct4.voltage(0, Vcal, phase_shift);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // ADC pin, Calibration, phase_shift<br />
		&nbsp; }</p>
<p>		&nbsp; // Do some measurements to allow the software filter to settle - don&#39;t use the result<br />
		&nbsp; if (ACAC)<br />
		&nbsp; {<br />
		&nbsp;&nbsp;&nbsp; if (CT1) for (int j=0; j&lt;5; j++) ct1.calcVI(no_of_half_wavelengths,timeout);<br />
		&nbsp;&nbsp;&nbsp; if (CT2) for (int j=0; j&lt;5; j++) ct2.calcVI(no_of_half_wavelengths,timeout);<br />
		&nbsp;&nbsp;&nbsp; if (CT3) for (int j=0; j&lt;5; j++) ct3.calcVI(no_of_half_wavelengths,timeout);<br />
		&nbsp;&nbsp;&nbsp; if (CT4) for (int j=0; j&lt;5; j++) ct4.calcVI(no_of_half_wavelengths,timeout);<br />
		&nbsp;&nbsp; }<br />
		&nbsp;&nbsp; else<br />
		&nbsp; {<br />
		&nbsp;&nbsp;&nbsp; if (CT1) for (int j=0; j&lt;5; j++) ct1.calcIrms(no_of_samples);<br />
		&nbsp;&nbsp;&nbsp; if (CT2) for (int j=0; j&lt;5; j++) ct2.calcIrms(no_of_samples);<br />
		&nbsp;&nbsp;&nbsp; if (CT3) for (int j=0; j&lt;5; j++) ct3.calcIrms(no_of_samples);<br />
		&nbsp;&nbsp;&nbsp; if (CT4) for (int j=0; j&lt;5; j++) ct4.calcIrms(no_of_samples);<br />
		&nbsp;&nbsp; }<br />
		}</p>
<p>void loop()<br />
		{<br />
		&nbsp;<br />
		&nbsp; if (ACAC) {<br />
		&nbsp;&nbsp;&nbsp; delay(200);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //if powering from AC-AC allow time for power supply to settle&nbsp;&nbsp;&nbsp;<br />
		&nbsp;&nbsp;&nbsp; emontx.Vrms=0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Set Vrms to zero, this will be overwirtten by wither CT 1-4<br />
		&nbsp; }<br />
		&nbsp;<br />
		&nbsp; if (CT1)<br />
		&nbsp; {<br />
		&nbsp;&nbsp; if (ACAC)<br />
		&nbsp;&nbsp; {<br />
		&nbsp;&nbsp;&nbsp;&nbsp; ct1.calcVI(no_of_half_wavelengths,timeout); emontx.power1=ct1.realPower;<br />
		&nbsp;&nbsp;&nbsp;&nbsp; emontx.Vrms=ct1.Vrms*100;<br />
		&nbsp;&nbsp; }<br />
		&nbsp;&nbsp; else<br />
		&nbsp;&nbsp;&nbsp;&nbsp; emontx.power1 = random(100)*Vrms;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Calculate Apparent Power 1&nbsp; 1480 is&nbsp; number of samples<br />
		&nbsp;&nbsp; if (debug==1) {Serial.print(emontx.power1); Serial.print(&quot; &quot;);}</p>
<p>&nbsp; }<br />
		&nbsp;<br />
		&nbsp; if (CT2)<br />
		&nbsp; {<br />
		&nbsp;&nbsp; if (ACAC)<br />
		&nbsp;&nbsp; {<br />
		&nbsp;&nbsp;&nbsp;&nbsp; ct2.calcVI(no_of_half_wavelengths,timeout); emontx.power2=ct2.realPower;<br />
		&nbsp;&nbsp;&nbsp;&nbsp; emontx.Vrms=ct2.Vrms*100;<br />
		&nbsp;&nbsp; }<br />
		&nbsp;&nbsp; else<br />
		&nbsp;&nbsp;&nbsp;&nbsp; emontx.power2 = ct2.calcIrms(no_of_samples)*Vrms;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Calculate Apparent Power 1&nbsp; 1480 is&nbsp; number of samples<br />
		&nbsp;&nbsp; if (debug==1) {Serial.print(emontx.power2); Serial.print(&quot; &quot;);}&nbsp;</p>
<p>&nbsp; }</p>
<p>&nbsp; if (CT3)<br />
		&nbsp; {<br />
		&nbsp;&nbsp; if (ACAC)<br />
		&nbsp;&nbsp; {<br />
		&nbsp;&nbsp;&nbsp;&nbsp; ct3.calcVI(no_of_half_wavelengths,timeout); emontx.power3=ct3.realPower;<br />
		&nbsp;&nbsp;&nbsp;&nbsp; emontx.Vrms=ct3.Vrms*100;<br />
		&nbsp;&nbsp; }<br />
		&nbsp;&nbsp; else<br />
		&nbsp;&nbsp;&nbsp;&nbsp; emontx.power3 = ct3.calcIrms(no_of_samples)*Vrms;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Calculate Apparent Power 1&nbsp; 1480 is&nbsp; number of samples<br />
		&nbsp;&nbsp; if (debug==1) {Serial.print(emontx.power3); Serial.print(&quot; &quot;);}</p>
<p>&nbsp; }<br />
		&nbsp;</p>
<p>&nbsp; if (CT4)<br />
		&nbsp; {<br />
		&nbsp;&nbsp; if (ACAC)<br />
		&nbsp;&nbsp; {<br />
		&nbsp;&nbsp;&nbsp;&nbsp; ct4.calcVI(no_of_half_wavelengths,timeout); emontx.power4=ct4.realPower;<br />
		&nbsp;&nbsp;&nbsp;&nbsp; emontx.Vrms=ct4.Vrms*100;<br />
		&nbsp;&nbsp; }<br />
		&nbsp;&nbsp; else<br />
		&nbsp;&nbsp;&nbsp;&nbsp; emontx.power4 = ct4.calcIrms(no_of_samples)*Vrms;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Calculate Apparent Power 1&nbsp; 1480 is&nbsp; number of samples<br />
		&nbsp;&nbsp; if (debug==1) {Serial.print(emontx.power4); Serial.print(&quot; &quot;);}</p>
<p>&nbsp; }<br />
		&nbsp;<br />
		&nbsp;<br />
		&nbsp; if (ACAC)<br />
		&nbsp; {<br />
		&nbsp;&nbsp;&nbsp; if ((debug==1) &amp;&amp; (!CT_count==0))&nbsp; Serial.print(emontx.Vrms);<br />
		&nbsp; }<br />
		&nbsp;<br />
		&nbsp; if ((debug==1) &amp;&amp; (!CT_count==0)) {Serial.println(); delay(20);}<br />
		&nbsp;<br />
		&nbsp; // because millis() returns to zero after 50 days !<br />
		&nbsp; //if (!settled &amp;&amp; millis() &gt; FILTERSETTLETIME) settled = true; - replaced by filter settle routine at end of setup</p>
<p>&nbsp;<br />
		&nbsp;&nbsp;&nbsp; if (DS18B20_STATUS==1)<br />
		&nbsp; {<br />
		&nbsp;&nbsp;&nbsp;&nbsp; digitalWrite(DS18B20_PWR, HIGH); Sleepy::loseSomeTime(50);<br />
		&nbsp;&nbsp;&nbsp;&nbsp; for(int j=0;j&lt;numSensors;j++) sensors.setResolution(allAddress[j], TEMPERATURE_PRECISION);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // and set the a to d conversion resolution of each.<br />
		&nbsp;&nbsp;&nbsp;&nbsp; sensors.requestTemperatures();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Send the command to get temperatures<br />
		&nbsp;&nbsp;&nbsp;&nbsp; Sleepy::loseSomeTime(ASYNC_DELAY); //Must wait for conversion, since we use ASYNC mode<br />
		&nbsp;&nbsp;&nbsp;&nbsp; float temp=(sensors.getTempC(allAddress[0]));<br />
		&nbsp;&nbsp;&nbsp;&nbsp; digitalWrite(DS18B20_PWR, LOW);<br />
		&nbsp;&nbsp;&nbsp;&nbsp; if ((temp&lt;125.0) &amp;&amp; (temp&gt;-40.0)) emontx.temp=(temp*10);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //if reading is within range for the sensor convert float to int ready to send via RF<br />
		&nbsp;&nbsp;&nbsp;&nbsp; if (debug==1) {Serial.print(&quot;temperature: &quot;); Serial.println(emontx.temp*0.1); delay(20);}<br />
		&nbsp; }<br />
		&nbsp;<br />
		&nbsp;<br />
		&nbsp;<br />
		&nbsp;<br />
		&nbsp;<br />
		&nbsp;<br />
		&nbsp;<br />
		&nbsp;<br />
		// if (settled)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // send data only after filters have settled<br />
		&nbsp; //{<br />
		&nbsp;&nbsp;&nbsp; send_rf_data();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // *SEND RF DATA* - see emontx_lib<br />
		&nbsp;&nbsp;&nbsp;<br />
		&nbsp;&nbsp;&nbsp; if (ACAC)<br />
		&nbsp;&nbsp;&nbsp; {<br />
		&nbsp;&nbsp;&nbsp;&nbsp; delay(TIME_BETWEEN_READINGS*1000);<br />
		&nbsp;&nbsp;&nbsp;&nbsp; digitalWrite(LEDpin, HIGH); delay(200); digitalWrite(LEDpin, LOW);&nbsp;&nbsp;&nbsp; // flash LED - turn off to save power<br />
		&nbsp;&nbsp;&nbsp; }<br />
		&nbsp;&nbsp;&nbsp;<br />
		&nbsp;&nbsp;&nbsp; else<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; emontx_sleep(TIME_BETWEEN_READINGS);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // sleep or delay in seconds<br />
		//&nbsp; }&nbsp;</p>
<p>		}</p>
<p>void send_rf_data()<br />
		{<br />
		&nbsp; rf12_sleep(RF12_WAKEUP);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
		&nbsp; rf12_sendNow(0, &amp;emontx, sizeof emontx);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //send temperature data via RFM12B using new rf12_sendNow wrapper<br />
		&nbsp; rf12_sendWait(2);<br />
		&nbsp; rf12_sleep(RF12_SLEEP);<br />
		}</p>
<p>void emontx_sleep(int seconds) {<br />
		&nbsp; Sleepy::loseSomeTime(seconds*1000);<br />
		}</p>
</blockquote>
<blockquote><p>double calc_rms(int pin, int samples)<br />
		{<br />
		&nbsp; unsigned long sum = 0;<br />
		&nbsp; for (int i=0; i&lt;samples; i++) // 178 samples takes about 20ms<br />
		&nbsp; {<br />
		&nbsp;&nbsp;&nbsp; int raw = (analogRead(0)-512);<br />
		&nbsp;&nbsp;&nbsp; sum += (unsigned long)raw * raw;<br />
		&nbsp; }<br />
		&nbsp; double rms = sqrt((double)sum / samples);<br />
		&nbsp; return rms;<br />
		}&nbsp;</p>
</blockquote>
<p>I m not using any sensor that s why I simulates a current value CT 1.</p>
<p>If someone could help me, it would be really great !!</p>
<p>Thanks&nbsp;</p>
<p>PS : Sorry for the display of my message, I don&#39;t know how to do in a better way&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<blockquote><p>&nbsp;</p>
</blockquote>
  <div class="forum-topic-navigation clear-block">
          <a href="3887.html" class="topic-previous" title="Go to previous forum topic">‹ Monitoring a Greenhouse How to connect</a>
              <a href="4930.html" class="topic-next" title="Go to next forum topic">Smart Charging a EVSE with OpenEnergyMonitor RF data, Working! ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-20205"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="urdel62&#039;s picture" title="urdel62&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: error address already in use cannot open port 50011</h3>

    <div class="submitted">Submitted by urdel62 (not verified) on Sun, 30/03/2014 - 13:19.</div>
    <div class="content">
     <p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Hi,</p>
<p>&nbsp;</p>
<p>None of you had the same error message ?</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20212"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: error address already in use cannot open port 50011</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sun, 30/03/2014 - 15:02.</div>
    <div class="content">
     <p>The problem should lie in the raspberrypi&nbsp;and gateway set-up rather than the sketch.</p>
<p>I have seen this before but only when an instance of oemgateway was already running, try running</p>
<p class="rteindent1"><strong>sudo ps -ef | grep oemgateway</strong></p>
<p>to see if there is another instance and also try running&nbsp;</p>
<p class="rteindent1"><strong>&nbsp;sudo netstat -n -l -p | grep 50011</strong></p>
<p>to see what process is already using the port.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20342"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="urdel62&#039;s picture" title="urdel62&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: error address already in use cannot open port 50011</h3>

    <div class="submitted">Submitted by urdel62 (not verified) on Wed, 02/04/2014 - 16:37.</div>
    <div class="content">
     <p>Thanks for the answer Paul.</p>
<p>Whan &nbsp;I run those stuff I get that :</p>
<p>&nbsp;</p>
<p>root@oemgateway:~/oem_gateway# sudo ps -ef | grep oemgateway&nbsp;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1254&nbsp; 1215&nbsp; 0 16:28 pts/0&nbsp;&nbsp;&nbsp; 00:00:00 grep oemgateway</p>
<p>root@oemgateway:~/oem_gateway# sudo netstat -n -l -p | grep 50011</p>
<p>What does that mean ?</p>
<p>&nbsp;</p>
<p>Moreover, I have a new error code which is quite weird cause I don&#39;t think I change anything :</p>
<p>root@oemgateway:~/oem_gateway# python /root/oem_gateway/oemgateway.py --config-file /boot/oemgateway.conf<br />
	2014-04-02 16:32:04,186 INFO Logging level set to DEBUG<br />
	2014-04-02 16:32:04,189 INFO Opening gateway...<br />
	2014-04-02 16:32:04,193 INFO Creating buffer emoncms_local<br />
	2014-04-02 16:32:04,197 INFO Creating buffer emoncms_remote<br />
	2014-04-02 16:32:04,201 INFO Creating listener RFM2Pi<br />
	2014-04-02 16:32:04,205 DEBUG Opening serial port: /dev/ttyAMA0<br />
	2014-04-02 16:32:04,209 INFO Setting send time interval to 300<br />
	2014-04-02 16:32:04,213 INFO Setting RFM2Pi | frequency: 8<br />
	2014-04-02 16:32:05,217 INFO Setting RFM2Pi | sgroup: 210<br />
	2014-04-02 16:32:06,221 INFO Setting RFM2Pi | baseid: 15<br />
	2014-04-02 16:32:07,225 INFO Creating listener Socket<br />
	2014-04-02 16:32:07,228 DEBUG Opening socket on port 50011<br />
	2014-04-02 16:32:07,251 DEBUG Broadcasting time: 16:32<br />
	2014-04-02 16:32:07,255 INFO Serial RX: &gt; 8b<br />
	2014-04-02 16:32:07,459 INFO Serial RX:<br />
	2014-04-02 16:32:07,463 WARNING Misformed RX frame: [&#39;\x01&#39;]<br />
	2014-04-02 16:32:07,668 INFO Serial RX: &gt; 210g<br />
	2014-04-02 16:32:07,872 INFO Serial RX:<br />
	2014-04-02 16:32:07,875 WARNING Misformed RX frame: [&#39;\x01&#39;]<br />
	2014-04-02 16:32:08,080 INFO Serial RX: &gt; 15i<br />
	2014-04-02 16:32:08,302 INFO Serial RX:<br />
	2014-04-02 16:32:08,305 WARNING Misformed RX frame: [&#39;\x01&#39;]<br />
	2014-04-02 16:32:08,510 INFO Serial RX: &gt; 0s<br />
	2014-04-02 16:32:08,715 INFO Serial RX:&nbsp; -&gt; 4 b<br />
	2014-04-02 16:32:12,193 INFO Serial RX:&nbsp; 10 0 0 0 0 0 0 0 0<br />
	2014-04-02 16:32:12,196 DEBUG Node: 10<br />
	2014-04-02 16:32:12,199 DEBUG Values: [0, 0, 0, 0]<br />
	Traceback (most recent call last):<br />
	&nbsp; File &quot;/root/oem_gateway/oemgateway.py&quot;, line 239, in &lt;module&gt;<br />
	&nbsp;&nbsp;&nbsp; gateway.run()<br />
	&nbsp; File &quot;/root/oem_gateway/oemgateway.py&quot;, line 86, in run<br />
	&nbsp;&nbsp;&nbsp; b.send(values)<br />
	&nbsp; File &quot;/root/oem_gateway/oemgatewaybuffer.py&quot;, line 63, in send<br />
	&nbsp;&nbsp;&nbsp; &quot; -&gt; send data: &quot; + str(data))<br />
	KeyError: &#39;path&#39;</p>
<p>&nbsp;</p>
<p>Do you have any idea ?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20343"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: error address already in use cannot open port 50011</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Wed, 02/04/2014 - 17:02.</div>
    <div class="content">
     <p>The checks show there is nothing else using port 50011 at the time you ran them, which is confirmed by the fact you have passed that point without a problem this time.</p>
<p>The very last line tells you there is an error with the path, What do have set in the oemgateway.conf ? the default settings for &quot;path = &nbsp; &nbsp; &nbsp;&quot; should be blank if sending to emoncms.org or &quot;/emoncms&quot;&nbsp;if sending to local server.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20553"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="urdel62&#039;s picture" title="urdel62&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: error address already in use cannot open port 50011</h3>

    <div class="submitted">Submitted by urdel62 (not verified) on Mon, 07/04/2014 - 08:27.</div>
    <div class="content">
     <p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Thanks Paul,</p>
<p>Sorry for the delay, I could not answer earlier.</p>
<p>In the oemgateway.conf , remote is active with emoncms.org as domain and blank as path, is that right ?</p>
<p>Julien &nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20556"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: error address already in use cannot open port 50011</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 07/04/2014 - 08:48.</div>
    <div class="content">
     <p>Yes that should be correct, are you still getting the same error?</p>
<p>the variable parts of the &quot;path&quot; to emoncms.org are</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; domain = emoncms.org<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; apikey = xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protocol = http://<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; active = True<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; path =</p>
<p>Is it connected to the internet ok?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20562"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: error address already in use cannot open port 50011</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Mon, 07/04/2014 - 09:49.</div>
    <div class="content">
     <p>File &quot;/root/oem_gateway/oemgatewaybuffer.py&quot;, line 63, in send<br />
	&nbsp;&nbsp;&nbsp; &quot; -&gt; send data: &quot; + str(data))<br />
	KeyError: &#39;path&#39;</p>
<p>Apparently your config misses the &#39;path&#39; item. I&#39;d check it complies with pb66&#39;s example config.</p>
<p>BTW? in case your wonder, the warnings about Misformed RX frame in your log don&#39;t matter, you can safely ignore them. I should address that.</p>
<p>I don&#39;t use emoncms.org but my own server as remote, so my path is</p>
<pre>
path = /emoncms</pre><p>I don&#39;t know what is supposed to happen if path is left empty, but according to pb66, it works fine. Otherwise, try</p>
<pre>
path = &#39;&#39;</pre><p>or just post your config here.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20563"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="urdel62&#039;s picture" title="urdel62&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: error address already in use cannot open port 50011</h3>

    <div class="submitted">Submitted by urdel62 (not verified) on Mon, 07/04/2014 - 09:54.</div>
    <div class="content">
     <p>Thanks Paul,</p>
<p>&nbsp;</p>
<p>I can&#39;t connect the Pi to my box before this evening. I ll let you know what I get.</p>
<p>&nbsp;</p>
<p>Julien</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20582"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="urdel62&#039;s picture" title="urdel62&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: error address already in use cannot open port 50011</h3>

    <div class="submitted">Submitted by urdel62 (not verified) on Mon, 07/04/2014 - 15:48.</div>
    <div class="content">
     <p>Thanks Jer&ocirc;me,</p>
<p>I changed path to &#39; &#39; but still not working.</p>
<p>That&#39;s my settings now :</p>
<p>&nbsp;</p>
<p>[[emoncms_local]]<br />
	&nbsp;&nbsp;&nbsp; type = OemGatewayEmoncmsBuffer<br />
	&nbsp;&nbsp;&nbsp; [[[init_settings]]]<br />
	&nbsp;&nbsp;&nbsp; [[[runtime_settings]]]<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; domain = localhost<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; apikey = c***************************9fe6<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protocol = http://<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; active = False<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; path =</p>
<p>[[emoncms_remote]]<br />
	&nbsp;&nbsp;&nbsp; type = OemGatewayEmoncmsBuffer<br />
	&nbsp;&nbsp;&nbsp; [[[init_settings]]]<br />
	&nbsp;&nbsp;&nbsp; [[[runtime_settings]]]<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; domain = emoncms.org<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; apikey = c***************************9fe6<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protocol = http://<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; active = True<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; path = &#39;&#39;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20586"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: error address already in use cannot open port 50011</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 07/04/2014 - 16:19.</div>
    <div class="content">
     <p>@ urdel62 - You should remove part of your api key before posting.</p>
<p>When you say &quot;still not working&quot; do you mean you are still getting exactly the same fault each time?</p>
<p>Does the pi have a working internet connection ?</p>
<p>Have you tried path = / ?&nbsp;</p>
<p>Is the API key correct ?</p>
<p>Aha.. it appears to be your api key at fault, recheck you are using a correct read and write api key.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/4453"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-od2IeYeGroxPYy0QgeFAypvqCKFLIdZ_eqxOcFHR6os" value="form-od2IeYeGroxPYy0QgeFAypvqCKFLIdZ_eqxOcFHR6os"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
