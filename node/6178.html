<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/6178 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:38:51 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Range issues ? What about changing the RF bitrate ? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Range issues ? What about changing the RF bitrate ?</h3>
        <span class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Wed, 26/11/2014 - 09:03</span>
        <div class="content"><p>Hi all.</p>
<p>There has been relatively few discussion about this, but the <a href="502.html">RF range is linked to the RF bitrate</a>.</p>
<blockquote><p>Lowering the bitrate will in essence reduce the required&nbsp;RF-signal bandwidth .</p>
<p>The range improvement is due to the fact that available &nbsp;RF-power is divided on the bandwidth. (A narrow signal will travel further than a broader one, if the power is constant.)</p>
<p>If you need (or want) both power and bandwidth to be untouched, you&#39;ll have to change antenna.</p>
</blockquote>
<p>After a quick search on the forum, it looks like I&#39;m pretty much the only one talking about bitrate modification. Apparently, people are satisfied with the default one. Or maybe they complain about the range but don&#39;t link it to the bitrate.</p>
<p>Anyway, I have been in a situation where I couldn&#39;t get the signal to reach my emonBase and <a href="3958.html">lowering the bitrate was the cure</a>. The thread says that there may have been issues on the TX in the first place (bad soldering of the antenna, bad powering of the RF module through the step-up regulator). But the fact is that in a difficult setup, the bitrate change made the difference.</p>
<p>I opened <a href="https://github.com/openenergymonitor/emonTxFirmware/issues/8">an issue on GitHub</a> to propose a parameter to modify the bitrate. It shouldn&#39;t be too difficult. The question is whether this is useful or not. If everyone is happy with the range (or if range issues are mostly due to a cause that is identified and can be solved otherwise, like bad soldering or anything), maybe it is not worth developing this and adding a new confusing option to the end user.</p>
<p>I&#39;m opening this thread to get your opinions about this.</p>
<p>I&#39;m surprised there is so few persons with range issues (in fact I&#39;ve seen threads where people ask for an RF repeater). Don&#39;t you instrument huge buildings ? What if lowering the bitrate saved you from adding a repeater, for instance ?</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="6391.html" class="topic-previous" title="Go to previous forum topic">‹ EmonTH and a DS2406 - Help Needed</a>
              <a href="6405.html" class="topic-next" title="Go to next forum topic">emonTx just out of range of RFM12Pi ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-25362"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="kammutierspule&#039;s picture" title="kammutierspule&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by kammutierspule (not verified) on Wed, 26/11/2014 - 10:21.</div>
    <div class="content">
     <p>Hi&nbsp;J&eacute;r&ocirc;me, it would be interesting if you could describe your scenario: building / number walls, distance between nodes.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25363"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Wed, 26/11/2014 - 10:26.</div>
    <div class="content">
     <p>Well, what I described was in my former house. The base was in the garage, so it was like:</p>
<p>emonBase - 3m - garage door (wood, about 2cm) - 1.5m - caravan (metal, 3m length) - 2.5m - vegetal hedge - gas meter with emonTX inside</p>
<p>The distance was not the issue: a TX placed further but so that the caravan wouldn&#39;t be in the way could reach the base.</p>
<p>And when the TX was in a room, it could reach the base through a few brick walls.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25367"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Wed, 26/11/2014 - 13:54.</div>
    <div class="content">
     <p>I have lots of problems with radio dropout so much so that I&#39;ve turned off ACKs&nbsp;on most of my nodes as they seemed to be blocking each other. It seems to mainly be a problem when sending multiple data items in one transmission (bigger packets I assume) and if a lower bitrate would help that would be great. I&#39;m even looking at changing the code to cope with missing data where this is important (e.g. rain tipping bucket pulses from my weather station) as I often have gaps of&nbsp;a few minutes in receiving data from nodes that are transmitting every minute. I&#39;ve even tried a full wave antenna at the receiver without much improvement.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25368"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 26/11/2014 - 14:39.</div>
    <div class="content">
     <p>I believe NeilK found that 600 mm thick masonry walls gave him problems and he saw an improvement when he lowered the bit rate.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25369"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5027.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Eric_AMANN&#039;s picture" title="Eric_AMANN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/5027.html" title="View user profile.">Eric_AMANN</a> on Wed, 26/11/2014 - 15:08.</div>
    <div class="content">
     <p>Hi J&eacute;r&ocirc;me,</p>
<p>Using EmonTX/TH is large buildings, I&#39;m not happy with the range (maximum 2/3 walls/floors).</p>
<p>So if modifying the biterate can improve the range,&nbsp; it is worth developing this feature !</p>
<p>Eric</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25370"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6952.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bond79&#039;s picture" title="bond79&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/6952.html" title="View user profile.">bond79</a> on Wed, 26/11/2014 - 18:08.</div>
    <div class="content">
     <p>I had also reception <a href="5819.html">problems </a>with an emonTH and a Jeelink that were fixed by lowering the bitrate with rf12_control.</p>
<p>I have also asked in that thread, is there any downside to lowering the rate? I can&#39;t think&nbsp; and haven&#39;t noticed any problems since lowering the bitrate (I have set mine to 3.918kbps).</p>
<p>
&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25371"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Wed, 26/11/2014 - 22:17.</div>
    <div class="content">
     <p>The only downside of lowering the bitrate, AFAIK, is that the same packet will take more time to transfer.</p>
<p>I think one node is not &quot;allowed&quot; to emit for too long (how long ? says who ? source needed).</p>
<p>Besides, this increases the risk of several nodes emitting in the same time. Bra1n, if you have nodes blocking each other (as in speaking in the same time), then I&#39;m not sure it will help.</p>
<p>Those of you who are interested and able to fiddle a bit with the code can copy what I did in the code I link to in the GitHub issue. The TX part is dead easy. The base part is not more difficult to code, but it needs to setup the environment to compile the sketch (not arduino default) and reflash the base (this can be done from the Pi if you&#39;re using a Pi).</p>
<p>Thank you for your answers. There seems to be an interest, so it is worth digging into this.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25372"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 26/11/2014 - 22:23.</div>
    <div class="content">
     <p>Most of the information you need is <i>somewhere</i> on the JeeLabs site. The rules are for the proportion of the time that one transmitter is transmitting, therefore if you lengthen the time it takes to transmit one message, you need to increase the gap between messages (or send less bytes). "Who says" is International Treaties, backed up by National laws. There are very many bands in the RF spectrum and each has its own rules, which vary from country to country and area to area. </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25373"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Wed, 26/11/2014 - 23:13.</div>
    <div class="content">
     <p>Yes. I&#39;m pretty sure I remember reading about this on this forum (or in the doc). With precise figures and all. But we shall take a look at the Jeelabs website for reference. At least.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25375"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7218.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="emjay&#039;s picture" title="emjay&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/7218.html" title="View user profile.">emjay</a> on Thu, 27/11/2014 - 11:41.</div>
    <div class="content">
     <p>Lowering the bit rate is only part of the story.&nbsp; In brief, a lower bit rate can use a lower frequency deviation - this results in a narrower spectrum around the nominal carrier. Adjusting the RxBandwidth down to match allows less junk into the receiver section.&nbsp; Result - higher signal to noise ratio which is really where the best range gain comes from.</p>
<p>There are limits - setting the RxBandwidth to the minimum requires that the corresponding pairs of crystals on the communicating RF modules agree closely on their versions of &#39;10MHz&#39;.&nbsp; A few ppm is auto corrected by the AFC - a larger ppm delta can take the received signal partly out of the RxBandwidth filter passband, causing the AFC and hence the entire packet reception to fail.</p>
<p>The current settings are at a sweet spot of range/energy consumed per packet (lower bit rates of course take longer, consequently more joules eaten).&nbsp; If remote node battery life is not an issue and the chosen RF channel is lightly loaded, then slowing right down to even 1200baud can have substantial range gains (provided the corresponding tweaks are made as described plus probably a little crystal tuning).</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25376"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Thu, 27/11/2014 - 15:45.</div>
    <div class="content">
     <p>Thanks Martin.</p>
<p>Good point about the battery usage. This advocates for the search of a better trade-off instead of just picking the lowest bitrate.</p>
<blockquote><p>Adjusting the RxBandwidth down to match allows less junk into the receiver section.&nbsp; Result - higher signal to noise ratio which is really where the best range gain comes from.</p>
</blockquote>
<p>Do you mean that by lowering the bitrate I gained in SNR but only a part of what I could have gained if I had also adjusted the Rx BW ? Is this what you refer to as &quot;corresponding tweaks&quot; ? Is this achievable with the RFM12 or RF69 ?</p>
<p>In the GitHub thread, Paul says that for compatibility reasons, it would be even better to propose this upstream (Jeelib). Or maybe they didn&#39;t do it because they thought it was not such a good idea. In which case it is still a good idea to raise the point there.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25400"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7218.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="emjay&#039;s picture" title="emjay&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/7218.html" title="View user profile.">emjay</a> on Sat, 29/11/2014 - 02:54.</div>
    <div class="content">
     <p><em>@J&eacute;r&ocirc;me,</em></p>
<p>&nbsp; &gt; lowering the bitrate .. gains... in SNR</p>
<p>No, not at all.&nbsp; Lowering the bitrate lowers the minimum SNR <strong>needed</strong> to decode the signal.</p>
<p>Reducing the RxBandwidth improves the SNR.&nbsp; Think of it as a squarish window on the RF world - the amount of RF junk picked up is proportional to the width of the window (the &#39;noise&#39; in the SNR formula).&nbsp;&nbsp; Provided the useful part of the transmitted spectrum fits neatly into the window, that is the &#39;signal&#39;.&nbsp;&nbsp; Hence the improvement in ratio which maps to more range.</p>
<p>Chopping off one side of the received spectrum by mismatch in the two crystals, and/or chopping off both sides by an overly narrow filter gives <strong>worse</strong> results, since the information required to recover the modulation is smeared around in the whole of the transmitted spectrum (with repeats in the side lobes).</p>
<p>Oversimplified, but close enough for a guideline.&nbsp; If you really want to get deeper into the dark mysteries of FSK, prepare for a dunking into Bessel functions etc.</p>
<p>Note that the magic table in the RFM12B spec sheet about sweetspot combinations of the key parameters (bit rate, deviation, RxBW) is hard to follow since there is an additional constraint in play - the limited, quantized choices for RxBW.&nbsp;&nbsp; The RFM69 series has more flexibility here, plus a more sensitive receiver section.&nbsp; <strong>Provided there is not too wide a mix of incoming signal strengths</strong>, the RFM69 in general will squeeze out more range with like-for-like parameter settings.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25465"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Mon, 01/12/2014 - 10:27.</div>
    <div class="content">
     <blockquote><p>No, not at all.&nbsp; Lowering the bitrate lowers the minimum SNR needed to decode the signal.</p>
</blockquote>
<p>Right. My formulation was incorrect.</p>
<p>Thanks again for the explanations.</p>
<p>I studied signal processing a while ago. I suppose if I had the time I could dig into the datasheets, docs, etc. and discuss this here or at Jeelabs. But it is not reasonable. I don&#39;t have that kind of time, let alone the skills, and I guess other people at Jeelabs have been thinking about this much more than I did and are way ahead of me.</p>
<p>As a RFM12B or RFM69 user, I am sort of a client of the Jeelib, I never really meant to hack into it.</p>
<p>I just observed that lowering the bitrate (by using the bitrate feature proposed in the jeelib (the #define in the .h file)) did improve my communication and thought I might as well share that and try to facilitate it by adding a simple feature in the code.</p>
<p>In the Jee code, the job is half done, somehow, as the bitrate #define exist but are not used in the code.</p>
<p>If you have grounds to believe that we shouldn&#39;t use this feature because it can worsen things, or if you think the Jeelib manages the bitrate it in a way that is not optimal, then please warn us so that we can wonder where we should go from here: forget about it all, see with people at Jeelabs how this could be improved, etc.</p>
<p>I don&#39;t want to push a feature that will be a mess. I don&#39;t think I even need it anymore myself (I used it in my former house and never switched back). It just seems like other people have had (or expect to have) range issues, and this seemed like an easy improvement.</p>
<p>(In fact, if I manage to use OpenEnergyMonitor someday at work, it is likely to be in big buildings where the range will be an issue, so an easy config would be nice. So I do have an interest in this.)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25471"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 01/12/2014 - 12:03.</div>
    <div class="content">
     <p>Lowering the bit rate is not new. MartinR used the technique a while ago. My view - and I too am not an expert on communications theory - is that the chosen default values are a good choice in most circumstances, but as has been pointed out above, lowering the bit rate too far, or indiscriminately, would usually not be an advantage and could be a major disadvantage. Done with discretion and only when necessary, it is a useful tool. </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25484"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Mon, 01/12/2014 - 20:29.</div>
    <div class="content">
     <p>I just want my modules to work and currently they don&#39;t work well enough, to the point that I&#39;m looking to use cabling and serial communication where at all possible. I&#39;m&nbsp;not&nbsp;talking about long range here either just one side of a modest house to the other, maybe there are other avenues I can explore like reducing transmission packet&nbsp;size but lowering bit rate seems like a good&nbsp;option.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25498"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3426.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3426.jpg" alt="Bill Thomson&#039;s picture" title="Bill Thomson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/3426.html" title="View user profile.">Bill Thomson</a> on Tue, 02/12/2014 - 00:33.</div>
    <div class="content">
     <p>Hello Bra1n,</p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I&#39;ve even tried a full wave antenna at the receiver without much improvement.</em></p>
<p>The impedance of an end fed 1/2, or full wave antenna is quite high, typically 1800 ohms or so, but definitely not the 50 to 75 ohms the RFM12 (and lots of other radio frequency transmitter/receiver equipment) wants to be connected to. The resulting mismatch causes a significant amount of RF energy loss affecting the strength of both the radiated, and received signals. End result, poor range.</p>
<p>Your best bet is to use a 1/4 wave antenna with a counterpoise (aka a ground plane). Here&#39;s a link that shows how easy it can be to build one: <a href="http://www.rcgroups.com/forums/showthread.php?t=1333382">http://www.rcgroups.com/forums/showthread.php?t=1333382</a>.</p>
<p>Connecting the feed line to the RFM12 can be an issue, but if small diameter coaxial cable, say something like RG-174, is used, and the length kept to a meter or less, the results will be a considerable improvement over the 1/4 wave wire antenna alone. One solution is to buy a pre-made cable that has an SMA or BNC male connector on one or both ends and use a female SMA/BNC connector at the antenna feedpoint. It&#39;s even possible to build one with no connector at all. The link above has pictures and instructions for two slightly different build methods, neither with RF connectors at the antenna.</p>
<p>Regards,</p>
<p>Bill</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25501"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Tue, 02/12/2014 - 09:03.</div>
    <div class="content">
     <p>@Bra1n: You seem to be in the same case I was in my former house. Although a user-friendly &quot;bitrate selection&quot; feature has not been implemented already, you could try to modify the bitrate yourself. See my links above. The TX part is the easy part. Just one line or two in the init. The Base part is pretty much the same code-wise, but the extra amount of work is the flashing of the RFM2Pi board. You need to setup avrdude and all. See the docs. If you can reflash the RFM2Pi with the stock firmware and it works, then the most difficult part is done. Modifying the&nbsp;code to hardcode another bitrate is piece of cake.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25510"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Tue, 02/12/2014 - 14:23.</div>
    <div class="content">
     <p>Thanks for the tips Bill and Jerome, I&#39;ll get back onto that when I&#39;ve finished sorting my CCTV issues out.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26439"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Sun, 04/01/2015 - 17:37.</div>
    <div class="content">
     <p>This link (found on top of RF12.h bitrate section) deals with bitrate and bandwidth:</p>
<p><a href="http://blog.strobotics.com.au/2009/07/27/rfm12-tutorial-part-3a/" title="http://blog.strobotics.com.au/2009/07/27/rfm12-tutorial-part-3a/">http://blog.strobotics.com.au/2009/07/27/rfm12-tutorial-part-3a/</a></p>
<p>I moved to RFM69 now. From what I understand, the bit rate setting mechanism is different from the RFM12.</p>
<p>For RFM12, see page 17 of <a href="http://www.hoperf.com/upload/rf/RFM12B.pdf">datasheet</a> and above link.</p>
<p>For RFM69, see page 19 of <a href="http://www.hoperf.com/upload/rf/RFM69HW-V1.3.pdf">datasheet</a>.</p>
<p>As far as I understand, the bitrate setting was not implemented in the Jeelib RFM69 driver. But I may be wrong. (Can anyone confirm ?)</p>
<p>If this is the case, it will be a bit harder to add this feature here: need to add it to the driver first.</p>
<p>It would also mean that the few people using other bitrates are currently stuck on RFM12.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26444"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 04/01/2015 - 19:08.</div>
    <div class="content">
     <p>Are you saying it cannot be done by writing to the Arduino SPI, as MartinR did in his PLL energy diverter for the RFM12B?<br />
(N.B. I'm not saying I've even looked at the problem!)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26445"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Sun, 04/01/2015 - 19:22.</div>
    <div class="content">
     <p>I&#39;m sorry, I might not have looked deep enough into it myself, and I don&#39;t have a clue what you&#39;re talking about.</p>
<p>What I&#39;m saying is that I could achieve it easily with the RF12 driver thanks to this enum</p>
<pre>
/// See <a href="http://blog.strobotics.com.au/2009/07/27/rfm12-tutorial-part-3a/" title="http://blog.strobotics.com.au/2009/07/27/rfm12-tutorial-part-3a/">http://blog.strobotics.com.au/2009/07/27/rfm12-tutorial-part-3a/</a>
/// Transmissions are packetized, don&#39;t assume you can sustain these speeds!
///
/// @note Data rates are approximate. For higher data rates you may need to
/// alter receiver radio bandwidth and transmitter modulator bandwidth.
/// Note that bit 7 is a prescaler - don&#39;t just interpolate rates between
/// RF12_DATA_RATE_3 and RF12_DATA_RATE_2.
enum rf12DataRates {
    RF12_DATA_RATE_CMD = 0xC600,
    RF12_DATA_RATE_9 = RF12_DATA_RATE_CMD | 0x02,  // Approx 115200 bps
    RF12_DATA_RATE_8 = RF12_DATA_RATE_CMD | 0x05,  // Approx  57600 bps
    RF12_DATA_RATE_7 = RF12_DATA_RATE_CMD | 0x06,  // Approx  49200 bps
    RF12_DATA_RATE_6 = RF12_DATA_RATE_CMD | 0x08,  // Approx  38400 bps
    RF12_DATA_RATE_5 = RF12_DATA_RATE_CMD | 0x11,  // Approx  19200 bps
    RF12_DATA_RATE_4 = RF12_DATA_RATE_CMD | 0x23,  // Approx   9600 bps
    RF12_DATA_RATE_3 = RF12_DATA_RATE_CMD | 0x47,  // Approx   4800 bps
    RF12_DATA_RATE_2 = RF12_DATA_RATE_CMD | 0x91,  // Approx   2400 bps
    RF12_DATA_RATE_1 = RF12_DATA_RATE_CMD | 0x9E,  // Approx   1200 bps
    RF12_DATA_RATE_DEFAULT = RF12_DATA_RATE_7,
};</pre><p>and the rf12_control() function.</p>
<p>Just use rf12_control(RF12_DATA_RATE_1) and you&#39;re done.</p>
<p>However, AFAIU, the command and registers differ on the RFM69 and there is no equivalent in the RF69 driver.</p>
<p>I may (and I hope I am) misleaded.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26450"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 05/01/2015 - 00:46.</div>
    <div class="content">
     <p>In MartinR's sketch, he includes SPI.h, and he has a function:</p>
<pre>
// write a command to the RFM12
word rfm_write(word cmd)
{
  word result;
  
  digitalWrite(RFMSELPIN,LOW);
  result=(SPI.transfer(cmd>>8)<<8) | SPI.transfer(cmd & 0xff);
  digitalWrite(RFMSELPIN,HIGH);
  return result;
}
</pre><p>
Then to set up the RFM12B, he uses:</p>
<pre>
  // start the SPI library:
  SPI.begin();
  SPI.setBitOrder(MSBFIRST);
  SPI.setDataMode(0);
  SPI.setClockDivider(SPI_CLOCK_DIV8);
  // initialise RFM12
  delay(200); // wait for RFM12 POR
  rfm_write(0x0000); // clear SPI
  rfm_write(0x80D7); // EL (ena dreg), EF (ena RX FIFO), 12.0pF 
  rfm_write(0x8208); // Turn on crystal,!PA
  rfm_write(0xA640); // 434MHz 
  rfm_write(0xC606); // approx 49.2 Kbps, as used by emonTx
  //rfm_write(0xC657); // approx 3.918 Kbps, better for long range
  rfm_write(0xCC77); // PLL 
  rfm_write(0x94A0); // VDI,FAST,134kHz,0dBm,-103dBm 
  rfm_write(0xC2AC); // AL,!ml,DIG,DQD4 
  rfm_write(0xCA83); // FIFO8,2-SYNC,!ff,DR 
  rfm_write(0xCEd2); // SYNC=2DD2
  rfm_write(0xC483); // @PWR,NO RSTRIC,!st,!fi,OE,EN 
  rfm_write(0x9850); // !mp,90kHz,MAX OUT 
  rfm_write(0xE000); // wake up timer - not used 
  rfm_write(0xC800); // low duty cycle - not used 
  rfm_write(0xC000); // 1.0MHz,2.2V 
</pre><p>
which I guess is much the same as the library does. If you do go this way, it would be a good idea to reverse engineer the library for the RFM69CW to check what it does set up, then do the same but change the settings you want changing. OK, I see it is harder this way, but it looks possible while the library catches up.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26453"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Range issues ? What about changing the RF bitrate ?</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Mon, 05/01/2015 - 09:04.</div>
    <div class="content">
     <p>Yes, he uses the 0xC6xx command to set a bit rate, like the RFM12 lib does.</p>
<p>I didn&#39;t see anything similar in the RFM69 lib, but I don&#39;t claim I took an extensive look.</p>
<p>I think the whole code above is RFM12 specific and would require adaptation to RFM69.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/6178"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-wzo_T0fEbiZqcEeouOEEOWT0YAUjLYlvmFyz0DoPdzM" value="form-wzo_T0fEbiZqcEeouOEEOWT0YAUjLYlvmFyz0DoPdzM"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
