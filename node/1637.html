<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/1637 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 13:41:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Reducing flicker in PV controllers | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/3.html">Archived: General Discussion</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Reducing flicker in PV controllers</h3>
        <span class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Thu, 13/12/2012 - 10:15</span>
        <div class="content"><p>I think most people are using systems based on Robin&#39;s MK2 design for PV control. This uses an &quot;energy bucket&quot; concept with a single threshold at the half-full point. The triac is fired whenever the energy level is above the threshold.</p>
<p>This arrangement works well but it also results in the highest possible flicker frequency. For example if you have 240W of solar and a 3kW load the flicker frequency will be about 4Hz, which can be very annoying.</p>
<p>It occurred to me while messing about with my 3-phase system that it isn&#39;t necessary to fire the triac this often providing the energy level stays within the bucket. If you set an upper and a lower threshold and don&#39;t fire the triac until the energy reaches the upper level, and don&#39;t stop firing it until it reaches the lower level, then the flicker frequency will be greatly reduced.</p>
<p>With the above example, and an upper threshold of 3/4 full and a lower threshold of 1/4 full, the flicker frequency will be reduced to 0.033Hz (once every 30 seconds), which is hardly noticeable.</p>
<p>I can&#39;t see any downside to this. Am I missing something?</p>
<p>(I have posted an updated version of my PLL code on <a href="1535.html">the other thread</a> if anyone wants to try this out)</p>
  <div class="forum-topic-navigation clear-block">
          <a href="2008.html" class="topic-previous" title="Go to previous forum topic">‹ emonGLCD receiving data from emonBase</a>
              <a href="1993.html" class="topic-next" title="Go to next forum topic">Monitor individual storage radiators ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-8191"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Fri, 14/12/2012 - 09:27.</div>
    <div class="content">
     <p>It&#39;s been pointed out to me by Robert Wall that my maths is a bit screwed up here. With the above example and the 2 thresholds the flicker rate will be&nbsp;once every 8-and-a-bit seconds, not every 30 s.</p>
<p>This is still slow enough to be much less annoying than 4Hz though so I think the principle is sound.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8209"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1088.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="fewyatt&#039;s picture" title="fewyatt&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/1088.html" title="View user profile.">fewyatt</a> on Fri, 14/12/2012 - 16:17.</div>
    <div class="content">
     <p>May work but whilst it reduces the frequency of the flicker it is still very noticeable.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8697"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Wed, 26/12/2012 - 12:32.</div>
    <div class="content">
     <p>I thought I&#39;d try and calculate whether it was possible to meet the flicker requirements using this technique after finding <a href="http://0071c19.netsolhost.com/support/articles/66/IEC61000-3-11 Flicker Measurements Up To 75A.pdf">this document</a> which gives most of the information you need (it&#39;s aimed at loads &gt;16A but also has info for loads &lt;16A).</p>
<p>If we assume...</p>
<p>D is the difference between thresholds in Joules</p>
<p>S is the solar power being generated in Watts</p>
<p>L is the load in Watts</p>
<p>T is the flicker period</p>
<p>then:</p>
<p>time to reach upper threshold is D/S</p>
<p>time to reach lower threshold is D/(L-S)</p>
<p>T = D/S + D/(L-S)</p>
<p>It&#39;s clear that T is infinite at the extremes when S=0 (load fully off) or S=L (load fully on) and the minimum value of T is likely to be when S=L/2. You can prove that this is in fact true by differentiating the equation above.</p>
<p>so Tmin = 2D/L + 2D/L = 4D/L</p>
<p>Taking the best possible threshold spacing of 0 and 3600J that will stay within the 1Whr energy bucket (obviously with no margin for error but we are just checking for the possibility of meeting the specs.) and a load of 3000W</p>
<p>Tmin = 4 x 3600 / 3000 = 4.8 seconds or 12.5/minute</p>
<p>Checking this figure against the graph in the document above gives a maximum voltage drop of slightly more than 1%.</p>
<p>The standard&nbsp;impedance for the flicker test is &quot;0.40 ohms resistive in series with 0.25 ohms inductive at 50Hz&quot;. This approximates to 0.47 Ohms&nbsp;in series with the load of about 19.2 Ohms. So the voltage drop will be about 2.4% or roughly double the spec requirement.</p>
<p>There is however a get-out clause in the spec that says if you can&#39;t meet the requirements then you must state the supply impedance which will meet the spec and the equipment can then only be installed in systems which meet his impedance.</p>
<p>In practical terms this means that it would be possible to meet the flicker spec if the voltage drop in your installation is 1% or better. Off to check mine now...</p>
<p>Anyone care to verify my reasoning for this?</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8700"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 26/12/2012 - 12:55.</div>
    <div class="content">
     <p>I did a similar sum a while ago and, whilst I can&#39;t remember the details, I came to a similar conclusion: namely that the spec gives a low value for the system fault level - clearly with the expectation that most systems will be better therefore flicker will be less of a problem - and with a more typical system impedance it was likely that you would be close to the threshold of acceptability.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8703"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Wed, 26/12/2012 - 13:28.</div>
    <div class="content">
     <p>Makes sense Robert, they have to force equipment manufacturers to design to the worst case but at least they&#39;ve given them a way out for well engineered installations.</p>
<p>I just checked&nbsp;the voltage drop for my immersion heater and it&#39;s about 2.5V, so right on the cusp. I think I&#39;d be happy with that. My 10kW floor heating though&nbsp;may be&nbsp;more of a problem!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8705"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 26/12/2012 - 13:59.</div>
    <div class="content">
     <p>I&#39;ve just measured mine too:</p>
<p><img alt="" src="data:image/png;base64,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" /></p>
<p>It looks like I&#39;m inside it at less than 0.8% dip! That puts my fault level at more than about 450 kVA, or the impedance at 0.13 Ohms or less. (The immersion is 16.5 Ohms cold, <strike>so 3.5 kW?</strike> labelled 220/230 V, 3000 W so about 3.5 kW at 245 V).</p>
<p>(N.B. I just grabbed any emonTx sketch - it&#39;s uncalibrated, but that doesn&#39;t matter for this).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8707"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1775.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1775.jpg" alt="Brian D&#039;s picture" title="Brian D&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/1775.html" title="View user profile.">Brian D</a> on Wed, 26/12/2012 - 15:06.</div>
    <div class="content">
     <p><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Normal</w:View>
  <w:Zoom>0</w:Zoom>
  <w:TrackMoves/>
  <w:TrackFormatting/>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-GB</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:DontVertAlignCellWithSp/>
   <w:DontBreakConstrainedForcedTables/>
   <w:DontVertAlignInTxbx/>
   <w:Word11KerningPairs/>
   <w:CachedColBalance/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Normal</w:View>
  <w:Zoom>0</w:Zoom>
  <w:TrackMoves/>
  <w:TrackFormatting/>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-GB</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:DontVertAlignCellWithSp/>
   <w:DontBreakConstrainedForcedTables/>
   <w:DontVertAlignInTxbx/>
   <w:Word11KerningPairs/>
   <w:CachedColBalance/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--></p>
<p><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="true"
  DefSemiHidden="true" DefQFormat="false" DefPriority="99"
  LatentStyleCount="267">
  <w:LsdException Locked="false" Priority="0" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 9"/>
  <w:LsdException Locked="false" Priority="35" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" Priority="10" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" Priority="1" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" Priority="11" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" Priority="22" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" Priority="59" SemiHidden="false"
   UnhideWhenUsed="false" Name="Table Grid"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" QFormat="true" Name="TOC Heading"/>
 </w:LatentStyles>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="true"
  DefSemiHidden="true" DefQFormat="false" DefPriority="99"
  LatentStyleCount="267">
  <w:LsdException Locked="false" Priority="0" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 9"/>
  <w:LsdException Locked="false" Priority="35" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" Priority="10" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" Priority="1" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" Priority="11" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" Priority="22" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" Priority="59" SemiHidden="false"
   UnhideWhenUsed="false" Name="Table Grid"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" QFormat="true" Name="TOC Heading"/>
 </w:LatentStyles>
</xml><![endif]--><!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-qformat:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
</style>
<![endif]--><!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-qformat:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
</style>
<![endif]--></p>
<p class="MsoNormal">So far the flicker debate has ignored possible impacts on how power is conserved. At first glance because the duty cycle remains the same changing the PRF will have no effect on electrical consumption. However, consider the following:</p>
<p class="MsoNormal">If the flicker frequency is low then it&rsquo;s possible for energy that is &lsquo;stored&rsquo; in the meter to be extracted by an intermittent load (appliance X) that happens to be energised during the diverting period of the PV controller&rsquo;s cycle.</p>
<p class="MsoNormal">If the flicker frequency is high then any surplus PV power will be cycled through the meter and sent to the heat store within a fraction of a second.&nbsp;</p>
<p class="MsoNormal">In the above example although no power is wasted it means that in the case of a high flicker frequency a pulse of electricity is purchased to run appliance X in order to save a pulse of gas which costs less than the electricity used.</p>
<p class="MsoNormal">How significant this is over the course of a year I have don&rsquo;t know but it&rsquo;s likely to be very small. It does support the low PRF approach though.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8708"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 26/12/2012 - 16:02.</div>
    <div class="content">
     <p>Sorry Brian, your argument is wrong, it won&#39;t happen. The repetition rate is not fixed, but depends on when the two thresholds are reached. So using your example again, if appliance &#39;x&#39; turns on while the dump load too is on, then the dump load will turn off that much sooner, because the bottom threshold will be hit sooner. Or to put it another way, the frequency is controlled by the two <strong><em>rates</em></strong>, not by time.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8721"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1775.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1775.jpg" alt="Brian D&#039;s picture" title="Brian D&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/1775.html" title="View user profile.">Brian D</a> on Thu, 27/12/2012 - 12:10.</div>
    <div class="content">
     <p>Yup, I reckon you are right! I should not have had that second glass of wine :)</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8741"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Sat, 29/12/2012 - 14:58.</div>
    <div class="content">
     <p>With a dual-threshold arrangement, the fastest rate of flicker occurs when surplus PV is exactly half the capacity of the dump load.&nbsp; With a 3kW load and thresholds at the 25% and 75% points, the system will cycle on and off every 2.4 seconds.&nbsp; At all other rates of surplus power, the cycle rate will be slower than this.&nbsp;</p>
<p>More details, plus a demo tool and video footage of same, are at <a href="8414e02.html?page=11%c2%a0" title="http://openenergymonitor.org/emon/node/841?page=11 ">http://openenergymonitor.org/emon/node/841?page=11 </a> posted on 23/12/12</p>
<p>I wonder what the flicker spec says about performance requirements at 0.4Hz?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8745"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 29/12/2012 - 17:04.</div>
    <div class="content">
     <p>Less than about 0.9% dip.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8747"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Sat, 29/12/2012 - 17:35.</div>
    <div class="content">
     <p>Thanks Robert,</p>
<p>Sorry, I&#39;ve just seen that this ground had been covered already.&nbsp; At least the target now appears to be within striking distance!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8748"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 29/12/2012 - 21:25.</div>
    <div class="content">
     <p>Voltage Dip Curves - versions</p>
<p>I have come across three versions of the curves thus far. Some graphs don&#39;t reproduce well, I have traced all onto the same scale.</p>
<p>The sources are:</p>
<ol>
<li>
<p><font face="arial">Harmonics and Flicker - the low frequency end of the EMC spectrum, Dr. Philip D Slade, Exeter University,<br />
			<a href="http://www.compliance-club.com/archive/old_archive/990619.html"><em>http://www.compliance-club.com/archive/old_archive/990619.html</em></a></font></p>
</li>
<li>
<p><font face="arial">IEC61000-3-11 Flicker Measurements Up To 75A, Voltech Instruments Ltd. Oxford.<br />
			<a href="http://www.tmworld.com/file/4213-104_152_0_5W.pdf"><em>www.tmworld.com/file/4213-104_152_0_5W.pdf</em></a></font></p>
</li>
<li>
<p>Handbook of Power Quality, Angelo Baggini,<br />
			<em><a href="http://books.google.co.uk/books?id=h1YDVXADtiQC&amp;pg=PA6162&amp;lpg=PA6162&amp;dq=IEC61000-3-11+Flicker+Measurements+Up+To+75A&amp;source=bl&amp;ots=6rdd5x3ARJ&amp;sig=92fRWDp9KI3npjppiyl7EheJd8g&amp;hl=en&amp;sa=X&amp;ei=kGPfUILlBeLF0QXUyIDgAw&amp;ved=0CGQQ6AEwCDgK#v=onepage&amp;q=IEC61000-3-11%20Flicker%20Measurements%20Up%20To%2075A&amp;f=false">Google Books</a></em></p>
</li>
</ol>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8750"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Sun, 30/12/2012 - 08:45.</div>
    <div class="content">
     <p>The Voltech graph seems to be the rogue there, the other 2 are almost the same.</p>
<p>I also found a full copy of the first edition of the spec (now out of date) <a href="http://bbs.dianyuan.com/bbs/u/58/975881192756528.pdf">here</a>.</p>
<p>As Robert has shown with his low-impedance supply, it is possible to build a system that meets the requirements if your supply is good enough but for a universal system you&#39;d have to build in a flicker frequency limit and allow the bucket to overflow when it is reached.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8755"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Sun, 30/12/2012 - 13:49.</div>
    <div class="content">
     <p>As a simple stand-alone solution, the idea of having two energy thresholds to minimise flicker is fine.&nbsp; But if this precaution does not meet the flicker spec under all foreseeable conditions, then some additional logic will be needed.&nbsp;</p>
<p>	This new logic would determine whether the triac may be changed from its present state or not.&nbsp; Preventing the triac from turning off sounds a distinctly bad idea, so this new logic should only be applied at the upper end of the bucket&#39;s range when the dump load would normally be turned on.</p>
<p>	For a given &#39;impedance&#39; of the mains, a maximum rate of flicker is defined.&nbsp; A simple counter which prevents the triac from ever turning on within N mains cycles of when it last turned on should guarantee that this requirement is always met.</p>
<p>	The purpose of the energy bucket&#39;s 1Wh range now needs to be reviewed.&nbsp; Thus far, with the level of the threshold for firing the triac having always been set to the half-way point (1800J), the upper half of the the bucket&#39;s capacity has never had any obvious purpose.&nbsp;</p>
<p>	Now, with the anti-flicker logic in place, the level in the bucket will rise above the normal operating threshold whenever the triac is prevented from turning on.&nbsp; The upper part of the energy bucket therefore needs to act as a reservoir.&nbsp; This could be easily achieved by just reducing the threshold point from 1800J to around 500J.&nbsp;</p>
<p>	The reservoir of virtual energy will naturally &#39;overflow&#39; when its maximum level of 3600J is reached.&nbsp; This does not necessarily mean that any <em>real</em> energy will have been lost through the supply meter.&nbsp; Because the two measurement systems are not actively synchronised, there will always be some uncertainty as to how the supply meter will behave.&nbsp;</p>
<p>	The operation of this scheme (or any other) could be readily checked out using the Demo tool that I posted recently.&nbsp; I&#39;d be happy to do this but it may have to wait a few days.&nbsp;</p>
<p>	I think it&#39;s now safe to say that the anti-flicker requirements can definitely be met by this kind of power diversion system.&nbsp; Yes, there could be some loss of &#39;free&#39; energy under certain conditions, but this aspect could no doubt be configurable to match the user&#39;s needs.<br />
	&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8757"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1775.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1775.jpg" alt="Brian D&#039;s picture" title="Brian D&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/1775.html" title="View user profile.">Brian D</a> on Sun, 30/12/2012 - 14:12.</div>
    <div class="content">
     <p>Robin said:</p>
<p><em>For a given &#39;impedance&#39; of the mains, a maximum rate of flicker is defined.&nbsp; A simple counter which prevents the triac from ever turning on within N mains cycles of when it last turned on should guarantee that this requirement is always met.</em></p>
<p>Are you considering the effective reduction in the impedance as the power for the dump load becomes increasingly provided by the PV system? As the flicker frequency increases with increasing PV power the effective impedance must reduce.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8760"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Sun, 30/12/2012 - 15:08.</div>
    <div class="content">
     <p><em>MartinR: </em><em>Are you considering the effective reduction in the impedance as the power for the dump load becomes increasingly provided by the PV system? As the flicker frequency increases with increasing PV power the effective impedance must reduce.</em></p>
<p>Er, in a word, No.&nbsp; I&#39;m assuming that anyone who is interested in meeting the flicker spec will be in a position to quantify the &#39;impedance&#39; of their mains supply so that the appropriate value of N can be determined.&nbsp; N is the number of mains cycles that must occur between consecutive off-to-on transitions of the dump load.</p>
<p>Once the value of N has been set, I think the system should work very well.&nbsp; Whilst the triac is obliged to remain off, the upper part of the energy bucket will act as a reservoir until the triac is able to turn on.&nbsp; Thereafter, the load will remain &#39;on&#39; until the (single) threshold is reached, at which point the triac will immediately turn off.</p>
<p>When minimal surplus power is available, the load will cycle at a rate that just meets the flicker spec.&nbsp; By contrast, if using the twin threshold approach, the cycle rate could drop to virtually nil.&nbsp; This is because the triac, once activated, has to remain on for such a long time.&nbsp;</p>
<p><em>MartinR: for a universal system you&#39;d have to build in a flicker frequency limit and allow the bucket to overflow when it is reached.</em></p>
<p>Agreed, and I think this arrangement would do the job perfectly.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8764"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Sun, 30/12/2012 - 15:51.</div>
    <div class="content">
     <p>I think you meant &quot;Brian D&quot; in your first comment there Robin</p>
<p>I&#39;m not sure it&#39;s as simple as you say since the spec gives a maximum number of flickers per minute, presumably any 60 second period, and there&#39;s also a long-term flicker requirement.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8765"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Sun, 30/12/2012 - 17:08.</div>
    <div class="content">
     <p>Sorry Martin, I&#39;d not checked the author closely enough (I don&#39;t think I understood the point anyway!)</p>
<p>As you say, the flicker spec is stated in terms of transitions per minute, so it would seem best for any new anti-flicker logic to be constructed on a similar basis.&nbsp; But with the weather being so fickle, I&#39;m assuming that it&#39;s sensible to interpret this spec in terms of a maximum switching rate such as 0.4Hz.&nbsp; Logically, I suppose, the new logic could simple count up all of the normally occuring transitions and then switch the triac fully off as necessary to prevent any relevant limit from being breached :-|</p>
<p>The short term requirement can be easily implemented by using a counter which prevents the triac from coming back on too soon.&nbsp; If there&#39;s an additional requirement for long term flicker, that would presumably just involve another counter or three, or whatever.&nbsp; Once the various requirements have been fully understood, creating the necessary logic to implement them should be straightforward enough.</p>
<p>All of this complexity can be hidden away in a subroutine which is called whenever the power-distribution logic would like to turn the triac on.&nbsp; The request will either be authorised or denied.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8770"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 30/12/2012 - 20:03.</div>
    <div class="content">
     <p>It may be worth mentioning that the supply impedance is not constant- it will vary as the network is reconfigured (though probably not by very much); and if mains voltage is being measured (which it must be, of course), then it should be possible to measure the dip &#39;on-the-fly&#39; and calculate the permissible flicker rate.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8772"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ericw&#039;s picture" title="ericw&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by ericw (not verified) on Sun, 30/12/2012 - 20:08.</div>
    <div class="content">
     <p>Is this not the same as having a fixed block length long enough to meet the max flicker frequency and adjusting the mark space ratio of triac on :off cycles within this block to give an overall zero average power.</p>
<p>The limitation to the max block length would be set by the energy packets being imported/exported at 50% mark space being less than that which triggers the meter.</p>
<p>I have done some experiments looking at the effects on a lamp connected to the mains while a 3kW load was being switched with a burst firing circuit</p>
<p>I found that the flicker effect seems to be more pronounced with low wattage bulbs and for single cycle bursts subjectively seems to peak when the load is driven at 1 cycle on to 5 off.&nbsp; After changing it to say 10 on 50 off the flicker is obviously at a much lower speed and does not seem to be anything like as obvious.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8776"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Sun, 30/12/2012 - 20:41.</div>
    <div class="content">
     <p><em>Is this not the same as having a fixed block length long enough to meet the max flicker frequency and adjusting the mark space ratio of triac on :off cycles within this block to give an overall zero average power.</em></p>
<p>Yes, once the system is operational in steady conditions, I think it will behave much as you&#39;ve described.&nbsp;&nbsp; By delaying the switch-on of the triac, the upper part of the reservoir will record how much energy can safely be dumped once the go-ahead is given.&nbsp; Once allowed to go &#39;on&#39;, the load will remain active until all of that reserve capacity has been used up.</p>
<p>The worst case situation will surely be when the rate of surplus power is 50% of the dump load&#39;s rating.&nbsp; To remain within the sweet zone of the utility meter, a 3kW dump load would need to be cycled on and off every three seconds or so.&nbsp; If this behaviour is faster that the flicker spec will allow, then some &#39;free&#39; surplus power would have to be discarded, as Martin has said.</p>
<p>The better that the system is calibrated, the closer one can safely go to using the full 1Wh&#39;s worth of flexibility that the meter allows.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8834"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Sun, 27/01/2013 - 17:40.</div>
    <div class="content">
     <p>A few days ago, I wrote:</p>
<p>	<em>This new logic would determine whether the triac may be changed from its present state or not.&nbsp; Preventing the triac from turning off sounds a distinctly bad idea, so this new logic should only be applied at the upper end of the bucket&#39;s range when the dump load would normally be turned on.</em></p>
<p>	Having just updated my FlickerDemo tool to work in this way, its behaviour was not always as I envisaged.&nbsp; Although consecutive off-to-on transitions of the triac are never closer than specified, the system can adopt an irregular pattern in which the triac is on for alternate long and short bursts.&nbsp; I fear that this uneven pattern could be more distracting than the problem we&#39;re trying to solve.</p>
<p>	The big advantage of a dual-threshold hysteresis-based approach is that the triac will always stay on or off for a decent amount of time.&nbsp; Adding an extra requirement such that it may not come back on again before a specified period has elapsed would seem to be the most satisfactory anti-flicker arrangement that is available.</p>
<p>The attached (version 2) demo works in this way.&nbsp; As posted, the minimum repetition period is set at 5 seconds which can be seen to cause some surplus energy to be lost when the bucket&#39;s level gets to 3600J and it &#39;overflows&#39;.&nbsp; This only occurs when surplus power is around 50% of the dump load&#39;s rating.&nbsp; With the min repetition period reduced to 3 seconds, very little if any energy is lost.</p>
<p>The lower threshold is currently set at 20% of the bucket&#39;s capacity.&nbsp; This allows the upper 80% of the bucket to be used as an energy reservoir. &nbsp; Setting the threshold to be any lower than this would require great precision when calibrating the system.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9310"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Tue, 22/01/2013 - 23:11.</div>
    <div class="content">
     <p>Here is a simulation tool which can hopefully provide most of the anti-flicker measures that have been discussed to date.&nbsp; In particular, it can cope with multiple loads, each with its own triac.&nbsp; Anti-flicker logic is now an integral part of the standard logic.&nbsp; The &quot;normal&quot; (flicking) mode is a special case, just as a circle is a special case of an elipse.</p>
<p>After a 7-second delay (added for the benefit of emonTx users), the Serial monitor shows the functionality that is supported:</p>
<pre>
-----------------------------------------------
Welcome to the Flicker Demo tool for multiple loads. 
Please note that various settings can be changed at compile time: 

- include the #define DEBUG line to operate without a voltage sensor  
- set the number of triacs, noOfTriacs 
- set the rating of each &#39;dump load&#39;, powerRatingOfDumpLoad[i] 
- set the energy thresholds for a/f, offsetOfEnergyThresholds 
- set the max flick rate for a/f, minCycleCountsBetweenTransitions 
- set the conditions for &#39;normal&#39;, which is now a special case of anti-flicker
- set the display rate, maxCycleCountForDisplay
- set the simulation rate, perCycleDelayForDebugMode (DEBUG mode only)

Once running, the energy bucket&#39;s level, and the state of all triacs are
repeatedly displayed.  Any overflow or underflow is shown at the on-board LED
The following commands can be entered at any time, followed by &#39;CR&#39;:

- the surplus PV power value, in Watts (max 32kW)
- the character &#39;g&#39;, to start the simulation
- the character &#39;p&#39;, to pause the simulation

paused ...</pre><p>A sample output is attached in which the user-input was:</p>
<p>&#39;g&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp; to get the action started<br />
	4500&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - which caused triac[0] to turn on full and triac[1] to cycle on/off under a/f restrictions<br />
	&#39;p&#39;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; - &nbsp; pause<br />
	&#39;g&#39;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; - go<br />
	&#39;11000&#39;&nbsp;&nbsp; - serious sunshine!! (triacs 0-2 went full on, and triac[3] cycled under a/f restrictions)<br />
	&#39;p&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - time to relax :-)<br />
	&#39;g&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - all good things have to end sometime :-(<br />
	1234 &nbsp; &nbsp;&nbsp; - clouds have returned<br />
	0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - shutdown</p>
<p>As with previous versions of FlickerDemo, pin9 controls the trigger for the first triac, so a bulb can be usefully be added to show what triac[0] is doing.&nbsp; Unlike previous versions, this one does not require an AC voltage sensor.</p>
<p>The on-board LED comes on whenever the 3600J energy bucket overflows or underflows.&nbsp; Note that this only happens when the rate of surplus PV changes substantially.&nbsp; A constant rate of 11kW involves no energy loss or cost penalty after the system has settled.&nbsp; This takes approx 10 seconds, depending on the a/f settings.</p>
<p>This info was posted yesterday on a new thread in error and has been moved here.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9436"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Sun, 27/01/2013 - 12:50.</div>
    <div class="content">
     <p>Here&#39;s an improved version of my multi-load Flicker Demo tool in which the amount of surplus PV can only change at a pre-determined rate.&nbsp; Applying an instantaneous step-change in surplus power, whilst imposing rigid a/f restrictions, does not make much sense.&nbsp; With the new version, any change of power setting is applied gradually, which seems more realistic.&nbsp; A sample output file is attached.</p>
<p>Various anti-flicker parameters are closely related:&nbsp; the separation of the upper and lower threshold (now specified as 0 - 0.5); the time interval between successive transitions at any triac; and the max rate of change of surplus power.&nbsp; As posted, this latter value is 300W per second:</p>
<p><strong><em>float maxRateOfChangeOfPower = 300; // in Watts per second</em></strong></p>
<p>There is now a proper mechanism to capture any overflow or underflow events, the revised output format now being:</p>
<p><strong>&nbsp; Serial.println (&quot;- The selected level of surplus energy (W)&quot;);<br />
	&nbsp; Serial.println (&quot;- The current level of surplus energy (W)&quot;);<br />
	&nbsp; Serial.println (&quot;- The on/off state of each triac&quot;);<br />
	&nbsp; Serial.println (&quot;- the level in the energy bucket&quot;);<br />
	&nbsp; Serial.println (&quot;- any overflow events since the last display line?&quot;);<br />
	&nbsp; Serial.println (&quot;- any underflow events since the last display line?&quot;);</strong></p>
<p>If you&#39;re at all interested in multi-load operation, do please give this simulation a try.&nbsp; All you need is an Arduino or similar, it no longer requires a mains supply.&nbsp; As posted, the tool is in DEBUG mode and should run straight out of the box ...<br />
	&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9492"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Tue, 29/01/2013 - 09:58.</div>
    <div class="content">
     <p>I&#39;ve just tried the above demo tool on the Windows laptop, and it doesn&#39;t run :-(</p>
<p>The easiest way around this is to simply comment out the <strong>pause(); </strong>line at the very end of setup().&nbsp; A pause/go facility seemed like a good idea - but not if it stops the whole thing from working!&nbsp; With this line removed, the actual demo works fine which is the only important thing really .&nbsp;</p>
<p>There&#39;s no problem when using my PowerPC-based Mac.&nbsp; These Serial aspects are infuriating at times ...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9495"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Tue, 29/01/2013 - 10:50.</div>
    <div class="content">
     <p>As posted, my demo tool has a restriction that prevents the triac turning off within 1.5 seconds of when it turned on.&nbsp; This makes little sense as it is bound to invoke cost for the user.&nbsp; When there is minimal surplus power, the energy bucket will slowly fill until the triac is able to come on.&nbsp; With a 3 kW load, it is <em>essential</em> that the load is turned off again within 1.2 seconds, otherwise a cost penalty will undoubtedly be incurred by the user.&nbsp; (3 kW for 1.2 seconds consumes 3600 Joules.)</p>
<p>The A/F logic in my Mk2a/Mk2i code is different in that the restriction applies between consecutive activations of the triac rather than consecutive transitions.&nbsp; Although this alternative criterion is easier to meet&nbsp; (which is why I wrote it that way), it may be regarded as &quot;cheating&quot; by some.</p>
<p>If anyone has any thoughts about this - i.e. about how to implement a more meaningful anti-flicker regime - I would be most interested to hear about it, preferably via this thread.&nbsp; Having posted various simulations/builds, there doesn&#39;t seem to have been much progress on this topic of late.&nbsp; I&#39;m happy enough to include a more robust anti-flicker regime in my burst-mode PV Router code, but am currently lacking any guidance as to how to go about this.&nbsp;</p>
<p>As with most things, anti-flicker measures will need to be designed before they can be implemented!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9497"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Tue, 29/01/2013 - 11:37.</div>
    <div class="content">
     <p>Don&#39;t forget Robin that the minimum flicker period you would be allowed in order to meet the specs&nbsp;for any particular installation is dependent on the voltage drop that occurs when the load switches on.</p>
<p>You could potentially measure that in your script and calculate the minimum period for a given installation.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9500"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Tue, 29/01/2013 - 16:07.</div>
    <div class="content">
     <p>Yes, Martin, that would indeed be possible, as Robert has already suggested. &nbsp;</p>
<p>I&#39;ve never intended that my power router design should be accurately calibrated, so measuring a small voltage drop and then altering the A/F settings accordingly is just not a route that that I would wish to take. &nbsp; It should be entirely feasible to measure the percentage voltage drop when the triac comes on.&nbsp; I would certainly find it a lot easier to do this by using an Arduino sketch than by any other means.</p>
<p>Not so long ago, anti-flicker was seen as a critical requirement by many contributors.&nbsp; Now that I&#39;ve included a simple algorithm or two, both based on your idea of having two energy thresholds, I was just hoping for some more input as to how this arrangement could be refined.&nbsp;</p>
<p>I have an idea for an alternative (calibration-free) approach which appears to simulate OK.&nbsp; But I&#39;d better see how it works in practice before posting anything, weather permitting.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9502"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2888.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/2888.html" title="View user profile.">Tinbum</a> on Tue, 29/01/2013 - 17:03.</div>
    <div class="content">
     <p>As you know Robin I have just built up an emonTx with the emonGLCD display and without any calibration at all it seems pretty good. I&#39;m only using the solar pv inverter reading as a comparison, but in the six months I&#39;ve had that the kwh meter reading on&nbsp;that, compared with the grid meter, it&#39;s within a KWH or two. But for accuracy how long is the piece of string?</p>
<p>&nbsp;</p>
<p>Re the regulations, which I still need to study, is there a place where the voltage drop measurement needs to be taken?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9504"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Tue, 29/01/2013 - 17:31.</div>
    <div class="content">
     <p>Sorry, I no expert in the anti-flicker arena.&nbsp; I&#39;m just trying to cobble together something which meets the requirements.&nbsp; Given the vagaries of surplus PV, this one seems a difficult nut to crack.&nbsp; If we were operating an industrial process, whereby some load or other were cycling on and off all day, things would be very different.</p>
<p>I&#39;m interested to know what code you&#39;ve had running on the emonTx.&nbsp; Also, how you can get such accuracy without any calibration.&nbsp; Or is the alignment between two pieces of kit, neither of which Arduino-based?</p>
<p>Very good point about where exactly the voltage drop measurement should be taken.&nbsp; I can only assume at the grid connection point, which in practice probably means the bus-bar in the CU (the cover of which one should, of course, never remove!)&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9505"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Wed, 30/01/2013 - 09:19.</div>
    <div class="content">
     <p>Back in October, on a different thread, I posted a piece about <a href="857.html#comment-6867">how digital meters record forward and backward flow</a>.&nbsp; At that time, I don&#39;t think anti-flicker measures were being seriously considered.&nbsp; That material seems more relevant now.</p>
<p>If a poorly calibrated a/f system were to divert power in chunks that were any larger than 3600 J, the user&#39;s meter would register one pulse every time.&nbsp; All benefit of the system would then have disappeared.&nbsp; The meter acts like a ratchet; the &quot;sweet zone&quot; advances by 3600J up the consumed energy scale whenever a meter pulse occurs. &nbsp; But unless the sketch were to record such pulses, and take appropriate action (e.g. to instantly <strike>zero</strike> <strike>set the energy bucket to full</strike>), it has no way of knowing what&#39;s going on at the meter.&nbsp;</p>
<p>[<em>Update - the best course of action to be taken when a pulse is detected is not obvious to me.&nbsp; Maybe the bucket should be set to just below the upper energy threshold.&nbsp; Then, we can feel confident that the next &#39;on&#39; burst of the load will not trigger another pulse.&nbsp; If a meter pulse were to be detected during any period while the triac is &#39;on&#39;, that event would certainly be of significance.</em>]</p>
<p>In practice, this behaviour should be noticeable, so the a/f logic could be altered somehow to prevent it.&nbsp; But if it only occurred under certain conditions, a/f measures could prove to be an expensive feature.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9507"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2888.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/2888.html" title="View user profile.">Tinbum</a> on Tue, 29/01/2013 - 19:32.</div>
    <div class="content">
     <p>Hi Robin,</p>
<p>I&nbsp;just used the following and was surprised at how accurate it seems to be, but then I&#39;ve been using efergy monitors. It does depend upon what accuracy is required though.&nbsp;</p>
<p><a href="https://github.com/openenergymonitor/emonTxFirmware " title="https://github.com/openenergymonitor/emonTxFirmware ">https://github.com/openenergymonitor/emonTxFirmware </a> (emonTx_CT123_Voltage)</p>
<p>and</p>
<p><a href="https://github.com/openenergymonitor/EmonGLCD" title="https://github.com/openenergymonitor/EmonGLCD">https://github.com/openenergymonitor/EmonGLCD</a> (solarPV)</p>
<p><em>But unless the sketch were to record such pulses, and take appropriate action (e.g. to instantly zero set the energy bucket to full), it has no way of knowing what&#39;s going on at the meter</em>.&nbsp;</p>
<p>I&nbsp;was wondering about that one, but on the bit of testing I&#39;ve done I&#39;ve not&nbsp;&nbsp;noticed the meter advance, but then we&#39;ve not had much sun.&nbsp;I also tried a spare 3 phase meter with the load (heaters) going through phase 1 &nbsp;the correct way and the PV (heaters) going through the 2nd phase but the wrong way in anti flicker mode&nbsp;and the meter didn&#39;t advance.</p>
<p>What happens on the disk type meter?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9509"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 29/01/2013 - 20:40.</div>
    <div class="content">
     <p><em>What happens on the disk type meter?</em></p>
<p>The three disks are on the same shaft!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9513"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Wed, 30/01/2013 - 09:21.</div>
    <div class="content">
     <p>I&#39;ve just taken some measurements of voltage dip.&nbsp;&nbsp; The sketch calculates real power and rms voltage for each mains cycle, but only one pair of values in every 50 is sent to the Serial monitor.&nbsp; I just turned the <strike>fire</strike> 3 kW heater on and off every few seconds and recorded the results.&nbsp; Apart from putting a blank line between each set of on/off lines, the data has not otherwise been changed.</p>
<p>The load was drawn from one side of a 13A socket, and the voltage measurement was taken from the other side of the same socket.&nbsp; The voltage dip appears to be around 6V, so that&#39;s approx 2.6% of 230V.&nbsp; But that is on the same ring-main.&nbsp; When I measured the dip some months ago with a hand-held multimeter, I think it was around 2V near the CU on a convenient spur that was fitted for our PV.</p>
<p>How this affects our A/F requirements, I wouldn&#39;t like to say.&nbsp; Sketch attached, if anyone would like to repeat the measurements.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9516"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2888.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/2888.html" title="View user profile.">Tinbum</a> on Wed, 30/01/2013 - 00:36.</div>
    <div class="content">
     <p><em>The three disks are on the same shaft!</em></p>
<p>&nbsp;</p>
<p>I know that,&nbsp;I mean in a single phase meter.</p>
<p>I meant if the disk was midway between the ratchet stop and the point of turning the next digit over&nbsp;will it rotate and counter rotate crossing the point of where it changes the digits in the display. Or is the ratchet at that point? Guess i&#39;ll have to get a disk meter out from my pile of bits and see.</p>
<p>Typical my disk meter doesn&#39;t have a ratchet.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9523"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Wed, 30/01/2013 - 10:07.</div>
    <div class="content">
     <p><em>Or is the ratchet at that point?</em></p>
<p>In the only meter that I&#39;ve inspected, the ratchet mechanism is a little piece of plastic that sits on top of a shaft like a top hat.&nbsp; When the shaft rotates in the forward direction, the &#39;hat just bobs this way and that and does not impede the motion.&nbsp; But when the shaft starts to rotate in the other direction, the plastic soon gets moved in such a way as to impede further movement.&nbsp; There must be a clutch of some kind in there which slips when this mechanism cuts in.&nbsp;</p>
<p>Depending on the state of the various components, the ratchet mechanism will allow a variable amount of reverse movement to occur after the meter ceases to move in its forward direction.&nbsp; This permitted amount of reverse movement never appears to be less than around half of a disc revolution which is 2.5 Wh on the meter that I have.&nbsp; During this reverse movement, it is possible that the numbers on the dial will move back ever so slightly, but I think it unlikely that this would have any non-reversible effect.&nbsp; I certainly don&#39;t think that there&#39;s any possibility of the meter rapidly ratcheting up numbers as small quantities of energy flow forward and back.</p>
<p>A disc-meter has a mechanical basis, and the visible numbers only increase when the disc has advanced by a certain number of turns - I&#39;m fairly sure there are 200 turns/kWh for the meter I have.&nbsp; Moreover, after ceasing to consume energy, you can always export around 2.5 J and be certain of getting it back without penalty or loss.</p>
<p>A digital meter is much more insidious.&nbsp; Diverting surplus energy in chunks of 3700 J would result in one 3600 J pulse on <strong><em>every</em></strong> occasion.&nbsp; By contrast, a non-reversing disc meter would only charge the user for 100W per iteration.&nbsp; So that&#39;s 36 times more&nbsp; penalty for being slightly out on the calibration if you have a digital meter!</p>
<p>Optimal anti-flicker measures, for use with a digital meter, is not a straightforward matter.&nbsp; A tool which simulates both the supply meter <em>and</em> the &#39;energy diverter&#39; may be of use. &nbsp; The effect of different &#39;phasing&#39; between the two could then be investigated.&nbsp; Monitoring the meter&#39;s LED activity, so that the two measurement systems could then be &#39;locked&#39; into step would seem to be an excellent idea, IMHO.</p>
<p>I&#39;ll no doubt be pondering about all of this when next walking the dog!&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9547"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Thu, 31/01/2013 - 20:38.</div>
    <div class="content">
     <p>The objective of any anti-flicker measure is to reduce the frequency at which the load is switched.&nbsp; Having said which, it is clearly important not to stray beyond the &quot;sweet zone&quot; of the meter.</p>
<p>But what would actually happen if we were to just stray a bit outside this zone?&nbsp; Would we be taking mico-pence or mega-bucks?&nbsp; This seemed like a job for another simulation, in which all the various component can be assembled together to see what happens.</p>
<p>Cue FlickerToolWithMeter.&nbsp; As its name suggests, this simulation includes the supply meter as well as the normal energy bucket type of power router.&nbsp; It requires no hardware other than an Arduino or similar.</p>
<p>The key point about a digital meter is that its performance is not symmetrical.&nbsp; Nudge one end, and a few Joules slip quietly away.&nbsp; But if you nudge the other end, the scorpion stings!&nbsp; A 1 Wh pulse is applied <u>and</u> the sweet zone instantly advances by 3600 Joules.&nbsp; Thankfully, the simulation does a better job of explaining how this than I can.</p>
<p>The attached display is for a run where the settings appear to be innoccuous enough.&nbsp; There&#39;s a 1.5 second restrictiion between consecutive transitions, and upper and lower energy-bucket limits of 10% and 90% respectively.&nbsp; The calibraton of the (simulated) rig was correct.</p>
<p>At startup, there was no PV so nothing of interest was happening,&nbsp; I then applied 1500W of PV.&nbsp; Although this is a step-change, progress towards any new power target is ramped at a settable rate,&nbsp; In this case, I was using 500W/sec, so it took 3s to ramp from 0W to 1500W.&nbsp;</p>
<p>Having reached the 1500W mark, the system settled down nicely with the triac diverting power as expected.&nbsp; No problems.&nbsp; The two energy buckets (Mk2 and meter) are perfectly in step.</p>
<p>When I increased the power to 90%&nbsp; (2700W), small periods of overflow could then be seen at the router&#39;s energy bucket.&nbsp; On each occasion, the reference point of the meter can be seen to change by a similar amount.&nbsp; But no big deal, just a bit of leakage.&nbsp;</p>
<p>Then the PV was dropped to just 10% (300J).&nbsp; Needless to say, it takes much longer now to reach the upper threshold, but just look at what happens when the triac comes on.&nbsp; On each occasion, it stays on just long enough to nudge the lower end of the meter wherupon a chargeable pulse is applied.&nbsp; But the worst is yet to come.&nbsp; As the Mk2&#39;s energy bucket refills, so the meter&#39;s reference point / offset / sweet zone slips until we&#39;re not far from where we were before.&nbsp; Then the cycles repeats, and we are charged again for our efforts.&nbsp;&nbsp; <u>We may think that we&#39;re diverting surplus power, but we&#39;re actually heating our water at grid cost, and allowing a similar amount to slip away at the same time.</u></p>
<p>For anyone who&#39;s at all interested in A/F measures, I think this behaviour is well worth studying in some detail and understanding.</p>
<p>Finally, at -1000 W of PV (heating a kettle maybe), the system&#39;s behaviour is fairly self-evident.&nbsp; As it is at 3500W when the triac is fully on and 500W leaks away.</p>
<p>This simulation could no doubt benefit from a bit more refinement, but it seems better for it to be out in the public arena for all to see and use in the meantime.&nbsp;</p>
<p>PS.&nbsp; Try relaxing the A/F constraints so that the problem goes away, and then adjust the setting of <strong>float</strong><span style="font-weight: bold;"> </span><strong>calErrorOfRouter = 1.0; // 0.9 under-reads by -10%; 1.1 over-reads by 10%.</strong><br />
	&nbsp;It may just come back ...</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9554"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2888.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/2888.html" title="View user profile.">Tinbum</a> on Fri, 01/02/2013 - 08:58.</div>
    <div class="content">
     <p>Very Interesting. I&#39;ll give it a try later today.</p>
<p>I&#39;m running mine in anti flicker mode as my 3Kw loads are not purely just resistive and require full voltage. The system seems to be running extremely well but as the sun is so scarce at the moment its hard to be absolutely certain. We also have a house base load of a minimum of 800w - 900w. Yesterday morning was sunny but had loads of fast moving clouds and some duller periods. Over a 5 hour period we imported&nbsp;about 1.5 KWh but we also did 2 loads of washing.&nbsp;I may fit another meter in to see what we export- if any.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9561"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Fri, 01/02/2013 - 14:27.</div>
    <div class="content">
     <p>I haven&#39;t tried your simulation Robin but I think the issue here is that you are putting a restriction on the time between adjacent voltage changes. When you have either very little PV or PV close to the load power then the transition in one direction will be fast but the transition in the other direction will be slow so the number of transitions per minute may still meet the spec even though some transitions are close together.</p>
<p>As I understand the requirement the restriction is on the number of transitions per minute. I don&#39;t think there&#39;s any minimum time between individual transitions is there?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9563"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Fri, 01/02/2013 - 15:52.</div>
    <div class="content">
     <p>You&#39;re entirely correct, Martin, to point out that A/F measures behave differently when different amounts of surplus power are available.&nbsp; Mid-power gives the fastest rate of cycling, but near-minimal and near-maximum rates are more likely to result in&nbsp; underflow or overflow, as you&#39;ve pointed out.&nbsp; The location of the twin energy levels is/are relevant too.&nbsp; As yet, I&#39;m not aware that anyone has suggested how an A/F algorithm should actually be implemented.&nbsp; I&#39;ve just posted a couple of ideas to get the ball rolling.</p>
<p>When in A/F mode, my Mk2a/Mk2i versions always turn the triac off when the energy bucket&#39;s lower limit is reached, this being to avoid any chance of incurring charges.&nbsp; When necessary, the triac&#39;s off-&gt;on transitions are delayed to keep the triac&#39;s cycle time below a specified rate.&nbsp; My Flicker Demo tool, however, places a time restriction on each pair of consecutive transitions, so both under- and over-flow can occur.&nbsp; The main purpose of this tool to promote discussion about the subject.&nbsp; As far as I&#39;m aware, the direction of voltage steps is not of relevance to the A/F specs; it is only their magnitude that matters.</p>
<p>I do have an alternative A/F scheme in the pipeline.&nbsp; This arrangement will have only one threshold and require no calibration.&nbsp; It will also have a difference performance profile across the range of powers that we need to deal with.</p>
<p>It may be that we&#39;re getting rather carried away with this one.&nbsp; A/F specifications are no doubt intended for standard domestic or commercial appliances where the cycling rate would be relatively constant.</p>
<p>Having said which, the unabated flicking of my original Mk2 PV Router design is not ideal, and I am grateful for everyone who has encouraged me to do something about it!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9564"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2888.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/2888.html" title="View user profile.">Tinbum</a> on Fri, 01/02/2013 - 16:47.</div>
    <div class="content">
     <p>I&#39;ve been running Mk2i in Anti flicker mode today and&nbsp;I did watch the meter while the pv amount&nbsp;&nbsp;available was very close to the demand with the triac on and&nbsp;I noticed the odd&nbsp;pulse on the meter. My meter&nbsp;led lights up green when feeding the grid, but its so dull you can&#39;t see it. (I have a second meter that always has the green led on and that&#39;s&nbsp;hard to see even in the dark).&nbsp;&nbsp;&nbsp;</p>
<p>Saying that&nbsp;I am exceptionally happy with how its running and it still needs some setting up, and possibly a different CT. My batteries have been very nicely charged up today using it&nbsp;and its been much better than going over to turn the chargers&nbsp;on and off depending on the suns&nbsp;power and the clouds going past.</p>
<p>I&#39;d publicly like to thank Robin for his all work on this, its an exceptionally clever idea.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9567"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Fri, 01/02/2013 - 19:46.</div>
    <div class="content">
     <p><em>I&#39;d publicly like to thank Robin for his all work on this, its an exceptionally clever idea.&nbsp;</em></p>
<p>Thanks, positive feedback is always appreciated.&nbsp; I&#39;m happy to take some credit for the Mk2 base code, but the anti-flicker feature is not really mine.&nbsp; Having tried to ignore the problem for as long as possible, I&#39;ve had to concede that it is a good idea to include some kind of A/F measure.&nbsp; If you, or anyone else, is seeing any pulses at the meter while power is being diverted, I would strongly recommend reducing the A/F criteria until they go away.&nbsp; Especially if the neighbours aren&#39;t breathing down your neck!</p>
<p>With any Mk2x code of mine, I would not expect there to be any chargeable events while power is being diverted.&nbsp; Leakage to the grid, yes, but no meter pulses.&nbsp; As posted, the triac always turns off as soon as the lower energy threshold is reached.&nbsp; Maybe you&#39;ve made some changes that have affected this part of your code?&nbsp; I&#39;ll send you a PM.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9570"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2888.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/2888.html" title="View user profile.">Tinbum</a> on Sat, 02/02/2013 - 10:36.</div>
    <div class="content">
     <p>It may be possible that something is turning on in the house just as the energy bucket gets to it low threshold or that my powercal is slightly too high. When i calibrated for that there was quite a high range and&nbsp;I chose a value just higher than the average.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9571"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Sat, 02/02/2013 - 15:39.</div>
    <div class="content">
     <p>The guidance for setting <strong>powerCal</strong> in most Mk2 sketches ends with:</p>
<pre>
// powerCal is the RECIPR0CAL of the power conversion rate.  A good value
// to start with is therefore 1/20 = 0.05 (Watts per ADC-step squared)
//
const float powerCal = 0.061;  // &lt;---- powerCal value
</pre><p>In the modified sketch you sent me, I noticed you had powerCal set to 0.8.&nbsp; This sounds very high.&nbsp; If this value is correct for your hardware, it suggests that you&#39;re using very little of the available range at the ADC.&nbsp; Without changing anything, try running <a href="1757.html">RawSamplesTool</a>, and see what your waveforms look like.&nbsp; If voltage and max current are not each spanning 80-90% of the available range, then you would do well to adjust your sensor&#39;s component values until they are.&nbsp; Then set powerCal to get the right value for a known load.</p>
<p>By far the easiest way to check powerCal is to run the code in Tallymode mode (just comment in the<strong> #define TALLYMODE</strong> line.&nbsp; I&#39;ve yet to hear of anyone having used this feature, but it is ideal for calibration purposes.&nbsp; All you need is a suitable load, no multimeters or extra hardware is required.&nbsp; Calibration need not be done kW, a 60W bulb or similar should suffice.&nbsp; For the router to work correctly, its measurement side needs to be linear.&nbsp; So you should be able to calibrate it for power using Watts, and then divert power in kW (or in your case, tens of kW) no problem!</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9572"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2888.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Tinbum&#039;s picture" title="Tinbum&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/2888.html" title="View user profile.">Tinbum</a> on Sat, 02/02/2013 - 17:15.</div>
    <div class="content">
     <p>Hi Robin,</p>
<p>I did use TALLYMODE for the set up of PowerCal using a 2kw heater. One thing that does cross my mind though is how to check accurately that the 2KW heater is actually exactly 2KW. Various ways I&#39;ve tried measuring it gives different values.Using TALLYMODE did give a spread on its results, suggesting it may be the sensors need to use more&nbsp;sensitive.&nbsp;You mentioned on one of your other threads a CT from Rapid that you used, but as you said in the thread,&nbsp;the one you have without the burden resistor wasn&#39;t available any longer, so&nbsp;I went with&nbsp; the 50A CT&nbsp; . That&nbsp;CT gives 30ma for 50A which as you say doesn&#39;t give that much range. I initially tried with an amp but that wasn&#39;t successful. I didn&#39;t really want to add an extra burden resistor but&nbsp;I guess&nbsp;that is a possibility.&nbsp;I moved the PowerCal value today down to 7.9 and that was much better. I think&nbsp;I probably will change the CT and will probably go for a Ring type one, with 1v for 50a if possible.</p>
<p>As you say calibration is very important in A/F mode. but&nbsp;I am extremely happy with how things are going. Today&nbsp;I had all sorts of loads on and the meter only advanced 0.5KWh and the sun was going behind clouds and we have a high house base load, without the washing machine and kettle.</p>
<p>I will try the RawSamplesTool.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9576"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Sat, 02/02/2013 - 18:49.</div>
    <div class="content">
     <p><em>I do have an alternative A/F scheme in the pipeline.&nbsp; This arrangement will have only one threshold and require no calibration.&nbsp; It will also have a difference performance profile across the range of powers that we need to deal with.</em></p>
<p>Well, that was my prediction.&nbsp; The outcome is not quite as I envisaged, but that&#39;s the beauty of simulations.&nbsp; The profile of my alternative scheme (B) is actually just like the original one (A), but shifted up the time axis a bit.</p>
<p>&nbsp;</p>
<p><a href="../sites/default/files/AF_scheme_A.jpg"><img alt="" height="250" src="../sites/default/files/AF_scheme_A.jpg" width="600" /></a></p>
<p><a href="../sites/default/files/AF_scheme_B.jpg"><img alt="" height="250" src="../sites/default/files/AF_scheme_B.jpg" width="600" /></a></p>
<p>Although both schemes do a similar job, they work in fundamentally different ways.&nbsp; Scheme A is as already posted but without any time constraint.&nbsp; It has two energy thresholds, their only relevance being their separation.&nbsp; Their absolute location within the 3600J bucket is of no consequence because the router&#39;s bucket is not linked to the meter in any absolute way.&nbsp;</p>
<p>Scheme B has a lesser performance but it has the major advantage that no calibration is required.&nbsp; Actually, that statement is not totally correct in that I&#39;m relying on the manufacturer&#39;s calibration of my immersion heater.&nbsp; If it were to draw 4kW rather than 3kW, then Scheme B would fail.&nbsp;</p>
<p>The time delay in Scheme B is determined by how long it takes the dump load to drain the energy bucket from half-full.&nbsp; A 3kW load consumes 1800J in 0.6 seconds, so any value up to 0.5s seconds should be fine for this parameter.</p>
<p>As far as I can see, these are the only &#39;pure&#39; implementations of anti-flicker logic that are possible.&nbsp; Additional timing constraints could no doubt be added if that were felt to be necessary.&nbsp; My gut feeling is that the published A/F specs are intended for conventional domestic or commercial appliances which can be tested under repeatable laboratory conditions.&nbsp; These specs should not be interpreted too literally for an application that is subject to the vagaries of the British Weather.&nbsp;</p>
<p>Both schemes will greatly reduce flicker when compared with any un-constrained burst-mode power diverter.&nbsp; And if properly implemented, neither should involve any cost penalty or loss of surplus power to the user.</p>
<p>All feedback welcome.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9577"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Markus&#039;s picture" title="Markus&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by Markus (not verified) on Sat, 02/02/2013 - 20:16.</div>
    <div class="content">
     <p>Hi Robin</p>
<p>I have a question, with a 2 phase 230Volt system, will the MK2 work?</p>
<p>This is what I have in Spain.</p>
<p>Thanks</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9583"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Sun, 03/02/2013 - 10:54.</div>
    <div class="content">
     <p>Hi Marcus,</p>
<p>I see that Robert Wall has just answered a similar question that you posted on a different thread.&nbsp;</p>
<p>Maybe it would be best to start with the simple V&amp;I sketch from the Building Blocks page.&nbsp; Once you have got the basic OEM measurement routines to work, then any version of the Mk2 power router should be OK.&nbsp; You may need to adjust the output components to suit your mains supply.&nbsp;</p>
<p>Your system will no doubt work much better than mine does at 54 degrees North :-(</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9584"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Sun, 03/02/2013 - 11:10.</div>
    <div class="content">
     <p>For the Scheme B A/F diagram that I posted yesterday, the underlying logic is not clear to see.&nbsp; Nor is it from the spreadsheet.&nbsp;&nbsp;&nbsp; Sorry for the omission.&nbsp;</p>
<p>My Scheme B logic is just as the original Mk2 energy-bucket setup, with one change:</p>
<p>&quot;The triac may not switch state within D seconds of crossing the mid-point of the bucket.&quot;</p>
<p>As posted, D = 0.5 seconds.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9656"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Reducing flicker in PV controllers</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Thu, 07/02/2013 - 21:14.</div>
    <div class="content">
     <p>Since posting my original Mk2 Router design, I&#39;ve always felt that it would be a good idea to somehow link the operation of its energy bucket to that of the utility meter.&nbsp; Recording events from the meter&#39;s LED is not difficult, nor is analysing their meaning, but I&#39;ve never worked out what can be usefully done with this information.</p>
<p>	A standard meter dispenses energy on demand in units of 1 Wh, or 3600 Joules.&nbsp; The user is then free to consume that energy at their leisure.&nbsp; The user may introduce small amounts of reverse flow, and no penalty is imposed providing that the meter&#39;s &quot;sweet zone&quot; is not exceeded.&nbsp; This is the 3600 J zone which lies immediately &quot;beyond&quot; the point where the last pulse occurred.</p>
<p>	During normal operation, each &quot;sweet zone&quot; follows on consecutively after the previous one.&nbsp; Moreover, the user always gets the full benefit of each purchase of energy.&nbsp; If, however, export ever causes the meter&#39;s energy state to drop below the level where the most recent pulse occurred, the lower limit of the sweet zone is shifted accordingly.&nbsp;</p>
<p>	If export were to continue for, say, 20 J beyond the 0 J point of the meter, then the meter&#39;s sweet zone would be permanently shifted down by 20 J to match this level.&nbsp; The next consumption pulse will therefore occur 20 J sooner than it would otherwise have done.&nbsp; 20 Joules of the energy that has been recently purchased by the user has been permanently donated back to the grid.</p>
<p>	This clawback mechanism affects any system where there can be reverse flow.&nbsp; The amount of energy that is permanently lost, or &quot;donated&quot;, to the grid following each meter pulse is approximately equal to the &quot;depth&quot; of the see-saw action that the energy profile takes.&nbsp;</p>
<p>	In its normal mode, my Mk2 router only needs around 200J of elbow room, so the rate at which energy is lost by this process is fairly small.&nbsp; But when running in anti-flicker mode, the depth of its reciprocating action is far greater, usually covering around 80% of the available range.&nbsp; In this case, for every charge pulse that occurs, around 2800 J of the 3600 J that has just been purchased will be donated back to the grid almost immediately.&nbsp;</p>
<p>	In a perfect world, the two measurement systems - router and meter - would always remain in perfect alignment.&nbsp; In that case, the router would always know exactly when to turn the dump load on and off in order to remain in the meter&#39;s sweet zone.&nbsp;</p>
<p>	But life is seldom like that.&nbsp; In our case, any non-linearity of the router&#39;s measurement system could result in slightly too much power being exported.&nbsp; Running the CT beyond its recommended output range would be likely to have just this effect when the amount of surplus PV is low.&nbsp; In the absence of any mechanism to keep the two systems in alignment, there is bound to be some relative drift between them.</p>
<p>	While actively diverting surplus power, it seems inevitable that occasional pulses will be levied by the meter.&nbsp; Whenever a chargeable event is recorded by the meter, the goalposts immediately shift by 3600J.&nbsp; The consequence of this shift is that a considerable amount of energy (approx 0.8 Wh) will very soon be lost from the user&#39;s premises while the meter realigns itself to the energy profile that is in force.&nbsp; The first of my two (sketched!) sketches show this process in operation.&nbsp;</p>
<p>&nbsp;</p>
<p>But what if we were to monitor the meter&#39;s LED.&nbsp; Could anything be done to mitigate the effect of such chargeable events while surplus power is being actively diverted?&nbsp; The answer to this question is most definitely, &quot;Yes!&quot;.</p>
<p>	Immediately after a chargeable event (aka meter pulse) occurs, there is no benefit whatsoever in exporting any energy.&nbsp; You&#39;re simply giving it away for someone else to use.&nbsp; The right time to export energy for subsequent reclaim is towards the end of the meter&#39;s sweet zone, shortly before the next pulse is due.&nbsp; Timely knowledge of the occurrence of each meter pulse can be used to align the state of the router&#39;s energy bucket with that of the meter.&nbsp; Whenever the meter reaches either end of its 1 Wh range, something happens at its LED.&nbsp; By monitoring and reacting to such stimuli, we can ensure that the two systems are accurately re-aligned at every available opportunity.&nbsp;</p>
<p>	In particular, we need to ensure that no export of surplus energy takes place immediately following a meter pulse.&nbsp; To do this, we should reset the energy bucket&#39;s level to some suitable value near the <em>upper</em> end of its range whenever a pulse occurs.&nbsp; There is nothing underhand about doing this.&nbsp; We are merely &quot;inventing&quot; virtual energy to match the packet of real energy for which we have just been charged.&nbsp; The control logic can then work on this modified value of virtual energy in order to get the triac to direct our real energy as is best for our cause. &nbsp;&nbsp;</p>
<p>	My second sketch shows such a scheme in operation.&nbsp; The net effect is to gain an extra (or longer) freebie burn of the dump load via the triac.&nbsp; Note that this scheme should only be used during periods when surplus power is being actively diverted, i.e when the triac is on.&nbsp; In practice, it may be necessary to record when the triac has been recently on because it could take around 50mS for each chargeable event to be detected.&nbsp; Meter pulses are around 38mS in duration.</p>
<p>A comprehensive system which uses all led events from the meter to maintain alignment with the router&#39;s energy bucket will take a bit more thinking about.&nbsp; Any ideas?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/1637"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-pHdVVsG4-4y4rH45VtO-2t1TjQadmeQuUkGpVRF6rzM" value="form-pHdVVsG4-4y4rH45VtO-2t1TjQadmeQuUkGpVRF6rzM"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/1637 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 13:42:05 GMT -->
</html>
