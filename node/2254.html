<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/2254 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:53:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Forward &#039;custom&#039; node to emoncms.org | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Forward &#039;custom&#039; node to emoncms.org</h3>
        <span class="submitted">Submitted by <a href="../user/3052.html" title="View user profile.">engeeaitch</a> on Wed, 17/04/2013 - 21:44</span>
        <div class="content"><p>Hi - I have a couple of remote temperature sensors transmitting to a receiver on my raspberry pi, and I have successfully forwarded these inputs to emoncms.org</p>
<p>I have also created a pseudo node using the input api in emoncms, which I post values to from a program running on my raspberry pi.&nbsp;However, this node is not showing up in emoncms.&nbsp;Is there any way in which I can get these values forwarded to emoncms as well please?</p>
<p>Thanks for any help.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="2272.html" class="topic-previous" title="Go to previous forum topic">‹ Instructions for Installing Emoncms on NAS4Free / FreeBSD file server</a>
              <a href="2267.html" class="topic-next" title="Go to next forum topic">Emoncms High Values for data ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-11401"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Forward 'custom' node to emoncms.org</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Wed, 17/04/2013 - 21:54.</div>
    <div class="content">
     <p>I&#39;m afraid the simplest way is to modify your program to post to both local and remote emoncms.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-11453"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3052.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="engeeaitch&#039;s picture" title="engeeaitch&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Forward 'custom' node to emoncms.org</h3>

    <div class="submitted">Submitted by <a href="../user/3052.html" title="View user profile.">engeeaitch</a> on Fri, 19/04/2013 - 06:22.</div>
    <div class="content">
     <p>Thanks for the reply.&nbsp; My concern with doing this is that it will slow down my program - especially if there is some problem with the internet whilst posting to emoncms.org. Do you have any pointers as to how to do this as part of the other feeds?&nbsp; I am happy to play about with changing php code files.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-11462"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Forward 'custom' node to emoncms.org</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Fri, 19/04/2013 - 08:19.</div>
    <div class="content">
     <p>I remember another message on this forum (or on github) from someone who wanted remote forwarding in emonCMS so that he could use a Nanode (if I remember well) to post to emonCMS locally and have local emonCMS forward the data.</p>
<p>AFAIU, current design follows the opposite logic, leaving it up to the application to send the data to any number of emonCMS instances.</p>
<p>I think the reason for this is that historically people would use a Nanode or such and necessarily post to a remote emonCMS. Then came the Pi and the possibility to host a local instance, and it was assumed that the data would come through the RFM2Pi from emonTX nodes.</p>
<p>Implementing the forwarding feature in emonCMS may be a complicated task, depending on how confident you are with php. You may want to raise this issue on github as it is a long time design choice. Perhaps Trystan would be interested. But don&#39;t expect this to be done soon.</p>
<p>Meanwhile, I&#39;m thinking of another way.</p>
<p>It shouldn&#39;t be too difficult to modify both your application and the python gateway script to do what you want (this is the pythonist speaking, here). Say you create a file that would act as a FIFO buffer. You application writes a line in the file instead of sending to emonCMS. Then it&#39;s just a matter of reading the file from the python script just as we would read the COM port, sending to local and remote emonCMS. I can help with the python part. I think we can reuse a great part of the code. Not much more to create. (This is me being optimistic. Sunny day, good mood.)</p>
<p>Perhaps someone else with come up with a better answer.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-11485"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3052.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="engeeaitch&#039;s picture" title="engeeaitch&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Forward 'custom' node to emoncms.org</h3>

    <div class="submitted">Submitted by <a href="../user/3052.html" title="View user profile.">engeeaitch</a> on Sat, 20/04/2013 - 10:16.</div>
    <div class="content">
     <p>Hi - I am happy to help with this (but I don&#39;t know python).&nbsp; Do you simply mean append a line to a file, or is there something more complicated that you had in mind?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-11487"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Forward 'custom' node to emoncms.org</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Sat, 20/04/2013 - 12:14.</div>
    <div class="content">
     <p>When received through the RF, the data is read by the script through the serial port with the following form:</p>
<pre>
  10 132 6</pre><p>where 10 is the node ID and the trailing values are the data.</p>
<p>If your software appended the samples this way in a file, I don&#39;t think it would take much work to adapt the python (or php) script to use them.</p>
<p>What language is your software written with ?</p>
<p>I believe I could add an option in the script to parse a file. It would be generic enough to be worth doing (not specific to your case).</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-11492"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3052.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="engeeaitch&#039;s picture" title="engeeaitch&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Forward 'custom' node to emoncms.org</h3>

    <div class="submitted">Submitted by <a href="../user/3052.html" title="View user profile.">engeeaitch</a> on Sat, 20/04/2013 - 21:47.</div>
    <div class="content">
     <p>Hi - sounds great.&nbsp; I think I could do this easily enough (but not quite sure what the data values are - I am currently sending a json string of the form&nbsp;input/post?json={boiler:1}&nbsp;.&nbsp; &#39;boiler&#39; is the name I have given to the node, and 1 (or 0) is the value.&nbsp; My script is written in PHP.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-11508"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Forward 'custom' node to emoncms.org</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Sun, 21/04/2013 - 20:43.</div>
    <div class="content">
     <p>A shortcoming of the python (and the php) gateway script, is that it can&#39;t send an input name (such as &#39;boiler&#39;), just values.</p>
<p>(The node sends values like this other RF: 10 123 45 43 65 and the gateways knows it means NodeID 10 and values &quot;123 45&quot; and &quot;43 65&quot;. There is actually a little bit of coding here, as these are not the values themselves. Signed long are encoded as two unsigned shorts.</p>
<p>The values must be recombined: 123 45 -&gt; 123 * 256 + 45, then if &gt; 32768, substract 65536.</p>
<p>We have a choice, for the format of the buffer file. Either use the same coding, or write values the natural way. Former means more calculation, just for the sake of keeping the same format. Not sure it is useful. We could go for the natural way... and break that if we realize later on it was not the best choice.)</p>
<p>The name is not absolutely needed, rather practical. An input will be created for your virtual node with ID &quot;1&quot; and you&#39;ll make a feed called &quot;boiler&quot; where you&#39;ll log this input.</p>
<p>This means each call (each line in the file) must contain all values, all in the same order.</p>
<p>I&#39;d like to introduce a rework in the next version, offering the ability to set names to the inputs. This is a bit of an issue because the python gateway uses the &quot;bulk&quot; syntax to send values remotely: <a href="2249.html" title="http://openenergymonitor.org/emon/node/2249">http://openenergymonitor.org/emon/node/2249</a>. The idea was to be able to send several samples in one request, but this itself may not be necessary. Even one http request every 3 seconds is not a big deal. Also, there is no way to tell the gateway which name corresponds to which RF received value. That&#39;s a few things to think about before starting implementing.</p>
<p>I haven&#39;t thought of it too much, I may be missing the obvious. I&#39;m just thinking out loud, as I wanted to answer your specific question.</p>
<p>Bottom line, if you write the file this way:</p>
<pre>
12 1
12 0
</pre><p>where I set 12 as an arbitrary node ID and 1 or 0 are the values, then it shouldn&#39;t be too hard to adapt the gateway script to send that locally and remotely, in a fashion that would let that feature be as generic as possible.</p>
<p>The rest is future and I need to re-think it.</p>
<p>Perhaps a totally different approach implying the creation of an input processor that would forward the data is a better approach...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/2254"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-JkbrfUGF3OY1Ph-wG3eWCclOjLX3uVkY_ozg26ir8sw" value="form-JkbrfUGF3OY1Ph-wG3eWCclOjLX3uVkY_ozg26ir8sw"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
