<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11292 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:12:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>EmonTX shield using the Particle (formerly Spark) Photon  | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">EmonTX shield using the Particle (formerly Spark) Photon </h3>
        <span class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Tue, 22/09/2015 - 15:34</span>
        <div class="content"><p>I am publishing this as an initial design to let people comment on it. The idea is to take all the best bits of EmonTX&nbsp;v3.4 and any other stuff that we have learnt about since then and use a chip that is faster than the Arduino.&nbsp;</p>
<p>The Particle Photon seems like a good replacement and best of all is web connected already.&nbsp;</p>
<p>Once we get the hardware sorted we can get to work on the software. People have already ported some bits of the required software to the Photon&#39;s predecessor (Core). But a pre-built shield isn&#39;t available, hence this project.&nbsp;</p>
<p>1. All the Analogue inputs will be used for Voltage and Current detection.&nbsp;</p>
<p>2. All the Digital IOs will be exposed to allow other stuff to be connected e.g. OLED display, temperature sensor, pulse, IR&nbsp;etc.&nbsp;</p>
<p>Note : The diagram symbol used for the LMV321 is wrong. I couldn&#39;t find a nice 5 pin op-amp symbol in Fritzing to use! Pin numbers used are correct.&nbsp;</p>
<p>Go on.&nbsp;Have your say.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11723.html" class="topic-previous" title="Go to previous forum topic">‹ Pi UPS</a>
              <a href="11771.html" class="topic-next" title="Go to next forum topic">avrdude: stk500_recv(): programmer is not responding ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-34381"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5888.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sd solar&#039;s picture" title="sd solar&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/5888.html" title="View user profile.">sd solar</a> on Tue, 22/09/2015 - 19:27.</div>
    <div class="content">
     <p>This looks like an interesting project --- I have a SparkFun&nbsp;Photon&nbsp;Red Board on the way.</p>
<p>It has a P1 Particle module on a board / shield which should make the hardware hookups easier and sells for only $39.95.</p>
<p>Definitely be watching this thread for info as more software is developed for it.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34383"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Tue, 22/09/2015 - 20:05.</div>
    <div class="content">
     <p>I too would have gone that way, if the emontx shield had kept up with the improvements. </p>
<p>So decided that creating a new one was not a bad plan. So took the opportunity to develop the board that takes all the best bits. </p>
<p>Just waiting for the comments and then I can move to building a sample batch.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34393"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Wed, 23/09/2015 - 07:24.</div>
    <div class="content">
     <p>Robert and dBC mentioned that a 3 phase monitoring will need 3 ac inputs. I'll see if I can design 3 inputs to configurable either as CT inputs or AC inputs. We have the ADCs so might as well use them, right. </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34485"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8744.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Roeland54&#039;s picture" title="Roeland54&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8744.html" title="View user profile.">Roeland54</a> on Fri, 25/09/2015 - 10:59.</div>
    <div class="content">
     <p>I had the same idea this morning. I would like to help.</p>
<p>I see some nice advantages with the Photon:</p>
<p>- More analog inputs than the Arduino and more processing power.</p>
<p>- No need for RF by using the Wifi (cost reduction)</p>
<p>- Possible standalone solution without raspberry pi. (cost reduction). Directly posting to emoncms.org or own webserver/nas.</p>
<p>It would be nice to have full 3 phase monitoring and maybe 1 phase solar installation.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34524"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Sat, 26/09/2015 - 23:49.</div>
    <div class="content">
     <p>Does anyone know of a 3 channel op-amp that I can use instead of 3 separate LMV321 in case I need to include 3 phase monitoring on the board?</p>
<p>Otherwise, I&#39;ve had no further feedback to the initial thoughts.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34525"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 26/09/2015 - 23:57.</div>
    <div class="content">
     <p>No! They tend to come as 1-channel, 2-channel or 4-channel. Have you thought about looking at the LMV321 data sheet - the TI version at least. [BIG HINT!  BIG, BIG HINT! ! !]</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34526"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5888.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sd solar&#039;s picture" title="sd solar&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/5888.html" title="View user profile.">sd solar</a> on Sun, 27/09/2015 - 01:34.</div>
    <div class="content">
     <p>My &quot;vote&quot;&nbsp; on getting this project up and running is to first do it as a considerably simpler single phase monitoring system. If you have boards made up for this --- put me down for a couple.</p>
<p>As for op-amps, I have been searching for some components myself to do some proto- typing. The only LMV321&#39;s I can find all have SMD/SMT cases --- not very friendly for this use.</p>
<p>I did order some LM358 op-amps in a Dip 8 Pkg at a very low cost 10 for $2.07 with free shipping. I think Robin has used the LM358 in some of his designs.</p>
<p><a href="http://www.amazon.com/gp/product/B00CL588O2?psc=1&amp;redirect=true&amp;ref_=oh_aui_detailpage_o00_s00" title="http://www.amazon.com/gp/product/B00CL588O2?psc=1&amp;redirect=true&amp;ref_=oh_aui_detailpage_o00_s00">http://www.amazon.com/gp/product/B00CL588O2?psc=1&amp;redirect=true&amp;ref_=oh_...</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34530"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8744.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Roeland54&#039;s picture" title="Roeland54&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8744.html" title="View user profile.">Roeland54</a> on Sun, 27/09/2015 - 08:49.</div>
    <div class="content">
     <p>Why can&#39;t we use 1 op-amp for all sensors?&nbsp;</p>
<p>The documentation states:&nbsp;&quot;Only one op.amp is needed, the current sensors can share the bias supply and connect to amplifier output (&ldquo;mid-point&rdquo;) with little fear of interaction between the inputs (which can be troublesome in some circumstances).&quot;</p>
<p><a href="https://learn.openenergymonitor.org/?redirect=acac-buffered-voltage-bias">http://openenergymonitor.org/emon/buildingblocks/acac-buffered-voltage-bias</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34532"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Sun, 27/09/2015 - 09:06.</div>
    <div class="content">
     <p>If we are going to attempt a proper 3 phase monitoring system then we need 3 op amps all on separate channels. </p>
<p>The op amp output can be shared by the CTs. </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34534"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 27/09/2015 - 10:13.</div>
    <div class="content">
     <p>If you're using the op. amp. as the bias source, you only need one. If you're using it to isolate/amplify, you need 4. I think we need an outline circuit diagram of your 3-phase arrangement. </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34535"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Sun, 27/09/2015 - 10:25.</div>
    <div class="content">
     <p>I'm going to start with just the 1 for single phase and bias source. </p>
<p>But why 4? Even for 3 phase I would have thought you needed only 3. </p>
<p>Also does anyone know which ADC is connected to which Photon pins </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34536"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 27/09/2015 - 10:46.</div>
    <div class="content">
     <p><em>&quot;But why 4?&quot;</em></p>
<p>3 to buffer/amplify each phase and 1 for the common bias.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34538"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Sun, 27/09/2015 - 11:57.</div>
    <div class="content">
     <p>I am having a slow day today, so forgive me. </p>
<p>So in a single phase setup, how come we have just one doing both the buffer/amplification and the bias?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34539"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5888.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sd solar&#039;s picture" title="sd solar&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/5888.html" title="View user profile.">sd solar</a> on Sun, 27/09/2015 - 12:51.</div>
    <div class="content">
     <p>&quot;Also does anyone know which ADC is connected to which Photon pins&quot;</p>
<p>From the Photon Docs:</p>
<p>A0~A7 12-bit Analog-to-Digital (A/D) inputs (0-4095), and also digital GPIOs.</p>
<p><a href="https://docs.particle.io/datasheets/photon-datasheet/" title="https://docs.particle.io/datasheets/photon-datasheet/">https://docs.particle.io/datasheets/photon-datasheet/</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34543"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Sun, 27/09/2015 - 13:30.</div>
    <div class="content">
     <p>What I meant is, I know the ARM chip used in the Photon has 3 ADCs, so does anyone know if the ADCs are dedicated to the pins or do they just use some algorithm to divide the load between them?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34544"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 27/09/2015 - 14:38.</div>
    <div class="content">
     <p><em>&quot;I am having a slow day today, so forgive me</em><br />
<i>So in a single phase setup, how come we have just one doing both the buffer/amplification and the bias&quot;</i></p>
<p>In the diagram in&nbsp;<a href="https://learn.openenergymonitor.org/?redirect=acac-buffered-voltage-bias">http://openenergymonitor.org/emon/buildingblocks/acac-buffered-voltage-bias</a>, the op.amp. is purely providing a low impedance (whatever the output impedance of the op.amp. is in voltage follower mode, probably a few ohms) bias supply. It is not doing any amplification at all. When you said you needed one per phase, I thought you wanted to use an op.amp. as a switched gain amplifier (as per the Atmel&nbsp;application note) to improve the sensitivity at low currents, which is a common complaint from those who want to measure just a few watts.</p>
<p>I can&#39;t see any advantage in having multiple op.amps and multiple bias supplies.</p>
<p>There might be some value in <em>measuring</em>&nbsp;the&nbsp;bias supply by&nbsp;each ADC (assuming they are multiplexed);&nbsp;that would be justified if the difference in the ADC readings around the midpoint due to non-linearity errors was &#39;significant&#39;. (I&#39;ll leave you to decide what that means - I&#39;d suggest more than 1 count, because the software filter works down to a fraction of&nbsp;1 count. It depends on what the minimum current you want a reliable reading for is, and the errors you can accept.)&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34545"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Sun, 27/09/2015 - 17:34.</div>
    <div class="content">
     <p>My basic need is to measure current and voltage as accurately as possible. The only reason we started talking about using more than 1 op-amp was to satisfy the use within a 3 phase installation. Lets leave that to one side for the moment.&nbsp;</p>
<p>If we are going to only use this within a single phase installation can we stick with the design as above. Or are there any further suggestions to improve on the design?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34549"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dBC&#039;s picture" title="dBC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Sun, 27/09/2015 - 21:49.</div>
    <div class="content">
     <p><em>so does anyone know if the ADCs are dedicated to the pins</em></p>
<p>See my comment here:&nbsp;<a href="10428.html#comment-34308">http://openenergymonitor.org/emon/node/10428#comment-34308</a></p>
<p>That&#39;s based on a quick perusal of the datasheet mind, no personal experience, so you might want to confirm that with your own research.</p>
<p><em>use some algorithm to divide the load between them</em></p>
<p>That&#39;ll be your job, and what I was referring to when I wrote &quot;If you&#39;re prepared to put the coding effort in...&quot;. &nbsp;There&#39;ll be lots of fun design decisions to play with there. &nbsp;If your mid-rail and ADCs are as stable as I think they will be, you might be able to use all sorts of strategies, like have each ADC read the mid-rail once-in-a-while (every second instead of every 10usecs for example) and run with that for its subtractions until the next second. &nbsp;Since each ADC can read the mid-rail for itself, I don&#39;t think there are&nbsp;any issue with offset errors between the ADCs. &nbsp;</p>
<p>It looks like you can even configure it for simultaneously triggered conversions. &nbsp;So you might set it up so that one is reading V, and the other two are reading CT1 and CT2, and then say &quot;GO&quot;... that alleviates the typical phase shift introduced by the software starting the conversions, though you&#39;d still need to deal with all the other sources of phase error (external and internal).</p>
<p>I think the first thing you&#39;re going to have to do is throw out the Photon programming manual and hit the ST datasheet and use that as your manual for all things ADC related. &nbsp;(OK, maybe the second thing:&nbsp; using the existing synchronous library calls is probably a good way to make sure the hardware is working the way you intended).</p>
<p><em>Or are there any further suggestions to improve on the design?</em></p>
<p>&nbsp;</p>
<p>I&#39;d probably put anti-aliasing filters on all your inputs. &nbsp;There are plenty of references on the web that will talk you through that... including the datasheet for just about any ADC, or any CPU containing an ADC. &nbsp;You can see a picture of one doing its thing in this thread: &nbsp;<a href="9956.html#comment-26546">http://openenergymonitor.org/emon/node/9956#comment-26546</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34555"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dBC&#039;s picture" title="dBC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Mon, 28/09/2015 - 07:37.</div>
    <div class="content">
     <p>You might want to keep an eye on this thread too:&nbsp;<a href="11309.html#comment-34553">http://openenergymonitor.org/emon/node/11309#comment-34553</a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34584"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Tue, 29/09/2015 - 20:12.</div>
    <div class="content">
     <p>@dBC any suggestions on how to go about the anti-aliasing filter?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34586"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dBC&#039;s picture" title="dBC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Tue, 29/09/2015 - 21:47.</div>
    <div class="content">
     <p>Google is your friend in this case. &nbsp; Here are a few I just found:</p>
<p><a href="https://www.maximintegrated.com/en/app-notes/index.mvp/id/928">https://www.maximintegrated.com/en/app-notes/index.mvp/id/928</a></p>
<p><a href="http://www.ti.com/tool/antialiasingcalc">http://www.ti.com/tool/antialiasingcalc</a></p>
<p>​and an&nbsp;application note from your own vendor:</p>
<p><a href="http://www.st.com/web/en/resource/technical/document/application_note/CD00211314.pdf">http://www.st.com/web/en/resource/technical/document/application_note/CD00211314.pdf</a></p>
<p>You&#39;ll need to know your sampling rate&nbsp;which you may not &nbsp;know for sure still you start banging on the ADC registers, so you might need to tweak the filter later, but as the ST note says, it&#39;s not super-critical. &nbsp;You want the corner frequency at about half the sampling rate, and above any frequencies of interest in the signal.</p>
<p>The only other tip I&#39;d add is to&nbsp;put the exact same filter on all your inputs, including V. &nbsp;That way any phase shift they introduce will be roughly the same across all your inputs.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34588"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5888.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sd solar&#039;s picture" title="sd solar&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/5888.html" title="View user profile.">sd solar</a> on Wed, 30/09/2015 - 05:27.</div>
    <div class="content">
     <p>I would encourage keeping this as simple as possible and a usable product as soon as possible.&nbsp; The EmonTx, in my experience has more than adequate accuracy / resolution without anti-aliasing filters and the Photon will have considerable higher resolution capability.</p>
<p>By far most of my difficulties have been with the limited radio range of the EmonTx. &nbsp;I have large PV installations on farms at both my location and my sons, where the Utility main feed / connection panels are over 100 feet from the house and other out buildings. Signal drop outs are a problem.</p>
<p>Hopefully, the Photons WiFi range will be an improvement, even if I need to add access points.</p>
<p>In 3 or 4 months, the Particle Electron with Cellular &ndash; Connected Capability will be available, which will make the radio range a moot problem. I have them on pre-order.</p>
<p><a href="https://store.particle.io/?product=particle-electron" title="https://store.particle.io/?product=particle-electron">https://store.particle.io/?product=particle-electron</a></p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34765"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8744.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Roeland54&#039;s picture" title="Roeland54&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8744.html" title="View user profile.">Roeland54</a> on Wed, 07/10/2015 - 17:11.</div>
    <div class="content">
     <p>I agree with sd solar. Lets keep this idea alive and try to make a usable design first. If someone can tell us what components we need to place for the&nbsp;anti-aliasing&nbsp;filter we can implement it. But personally&nbsp;I am not experienced enough to figure&nbsp;it out by myself an be sure it wil work as expected.<br />
If everything works like we want we can just make a V2 version with improvements.&nbsp;</p>
<p>Lets list what features we want:</p>
<p>We have 8 ADC inputs to work with.<br />
-1 input for monitoring the bias source?<br />
-1 input for AC Voltage monitoring (Or 3 for the 3 phase variant)<br />
-6 inputs for CT sensors? (Or 4 for the&nbsp;3 phase variant)</p>
<p>Do we want other sensor inputs? Do we prepare something for the digital IO pins?</p>
<p>Lets say we make it possible to break out al the pins of the photon. How do we do that?&nbsp;Make it arduino&nbsp;shield compatible? Or is there a better way?</p>
<p>I also started drawing a schematic.<br />
You can view it at&nbsp;<a href="https://easyeda.com/Roeland54/Photon_emon_shield-lFDBzUSs2">https://easyeda.com/Roeland54/Photon_emon_shield-lFDBzUSs2</a><br />
&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34781"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5888.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="sd solar&#039;s picture" title="sd solar&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/5888.html" title="View user profile.">sd solar</a> on Fri, 09/10/2015 - 00:28.</div>
    <div class="content">
     <p>The schematic looks good. In my case, I don&rsquo;t have any need / use for the digital IO pins at the location I will be installing the Photon.</p>
<p>I have done a very similar circuit on a prototype board, but using a LM358 op amp In a dual 8 pin pkg for the bias and the outputs from the CT&rsquo;s and voltage adapter are right on.</p>
<p>The real challenge, for me is going to be getting the code correct and flashed.</p>
<p>Officeboy has published some extensive work on this at:</p>
<p><a href="https://github.com/officeboy/EmonCore" title="https://github.com/officeboy/EmonCore">https://github.com/officeboy/EmonCore</a></p>
<p>I have tried modifying his for my setup and flashing the Photons firmware, but the result is it now won&rsquo;t even go on line and connect with the Cloud.&nbsp; I then have to force it into Safe Mode and re-flash a known good firmware before it will connect again.</p>
<p>This type of coding is way above my pay grade.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34796"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Fri, 09/10/2015 - 19:14.</div>
    <div class="content">
     <p>I got a decently good design but was quoted an insane figure to turn it into a PCB.<br />
If there are people on here who could help with designing a PCB, for a fee of course then we may be able to get this out for people to play and develop on.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34819"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8744.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Roeland54&#039;s picture" title="Roeland54&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8744.html" title="View user profile.">Roeland54</a> on Sat, 10/10/2015 - 19:36.</div>
    <div class="content">
     <p>I will try to design a pcb. It wil be a smd pcb. I&#39;m going&nbsp;to try to make 1 pcb that can be used for 3 phase or Single phase. If jou want 3 phase jou can put the components for 3 phase on the board. Then you wil have 4 ct&#39;s and&nbsp;3 ac inputs.</p>
<p>For single phase you wil have 6 ct&#39;s and 1 ac input.&nbsp;</p>
<p>It wil make the pcb a little bigger but I think it is worth it to have 1 design to meet both requirements.</p>
<p>Anyone having a request about the pcb size/shape?&nbsp;</p>
<p>updated schematic :&nbsp;<a href="https://easyeda.com/Roeland54/Photon_emon_shield-lFDBzUSs2">https://easyeda.com/Roeland54/Photon_emon_shield-lFDBzUSs2</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34825"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Sun, 11/10/2015 - 08:17.</div>
    <div class="content">
     <p>Will be make the pcb gerber files available to all? In that case we can collaborate?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34826"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dBC&#039;s picture" title="dBC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Sun, 11/10/2015 - 09:09.</div>
    <div class="content">
     <p>What problem is L1 trying to solve, and how does it solve it?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34827"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8744.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Roeland54&#039;s picture" title="Roeland54&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8744.html" title="View user profile.">Roeland54</a> on Sun, 11/10/2015 - 09:50.</div>
    <div class="content">
     <p>I will share the design files to all and I will need some collaboration. I am not a pcb&nbsp;expert. The last time I designed a pcb was in school 8 years ago.&nbsp;</p>
<p>I copied L1 from the emontcV3.4 design. It is a ferrite bead &nbsp;to filter out noise from the microcontroller.&nbsp;<br />
I don&#39;t know if it is really necessary.&nbsp;&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34828"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dBC&#039;s picture" title="dBC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Sun, 11/10/2015 - 10:09.</div>
    <div class="content">
     <p>There&#39;s more on L1 here: &nbsp;<a href="11130.html">http://openenergymonitor.org/emon/node/11130</a>&nbsp;and here:&nbsp;<a href="6196.html">http://openenergymonitor.org/emon/node/6196</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34829"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 11/10/2015 - 12:34.</div>
    <div class="content">
     <p>In particular, in one of those threads I wrote "L1 was included by mistake, carried over from a previous version. If you had checked the pcb layout, you would have found that it's actually shorted out by copper, and hasn't been removed from the assembly process because it costs more to do that than to leave it."</p>
<p>In particular, you need to keep the analogue and digital sides totally separate, except for one common ground point and a filter separating the digital power from the analogue power and reference voltage. It seems that in the emonTx, the largest noise contribution comes in via the analogue reference. It is well worth taking a lot of care with the analogue inputs, as noise limits the performance of the emonTx even though it's only a 10-bit ADC. If you're not a pcb expert specializing in low-level analogue stuff, you need to do a lot of reading - some of the better sources are the application notes for high-end ADCs.</p>
<p>I like the idea of a common pcb, populating it for 1-phase or 3-phase as appropriate.</p>
<p>If you are having any digital inputs or outputs, arrange an adequate number of ground and supply terminals adjacent so that you have a choice of connecting the sensor / output between Gnd or Vcc. Provision for wire-ended pull-up or pull-down resistors could be useful, as would be provision for wire-ended burden resistors on the CTs and voltage divider resistors on the VTs.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34830"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Sun, 11/10/2015 - 14:28.</div>
    <div class="content">
     <p>Doesn&#39;t look like I have anyone ready to turn my design into a PCB.&nbsp;</p>
<p>I had aimed for a completely through&nbsp;hole design for maximum flexibility. And the only part that needed to be replaced was the op amp with the&nbsp;LM358.&nbsp;</p>
<p>What I had done was used the left hand ground for all the analogue inputs. And the right hand ground was reserved for the digital inputs.&nbsp;</p>
<p>To reduce the part count and to avoid someone putting both VT and CT into one input I added a jumper to switch the input between being a VT or a CT. You can still use the 1K and the 2 protection diodes for either.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34840"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dBC&#039;s picture" title="dBC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Sun, 11/10/2015 - 20:31.</div>
    <div class="content">
     <p>That ST Micro application note referenced above (from your own vendor no less!) touches on most of the issues you need to consider for good analog results. &nbsp;Much of it is directed at&nbsp;someone designing the entire board, but some of it will apply to your &quot;shield&quot;.&nbsp; Because&nbsp;you&#39;re using the Photon module you&#39;ll&nbsp;be at the mercy of how well they followed those guidelines, and that probably depends on how concerned they were with permitting&nbsp;good low-noise low-level analog measurements.</p>
<p>It might be worth doing some up-front tests on the Photon to see how well it behaves. &nbsp;A really simple test is to inject a stable low-ripple low voltage into one of the analog inputs and then have the f/w read it repeatedly and measure the PtoP noise in A/D units. &nbsp;Ideally it&#39;ll be 0 or 1 even&nbsp;while doing other stuff like wifi transmitting the results.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35077"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4591.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MattyZee&#039;s picture" title="MattyZee&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/4591.html" title="View user profile.">MattyZee</a> on Mon, 19/10/2015 - 10:41.</div>
    <div class="content">
     <p>@Roeland54</p>
<p>Just looking at your schematic. I think there is a major error. I assume your stereo jack are the switching type that short pins 2&amp;3 and 4&amp;5 if no plug is inserted? On the V3 shield i understand this is used to detect if a CT is plugged in or not. That works on the V3 boards as each has its own bias reference made up of a resistor divider. Shorting the bias to ground is ok and only a small amount of current is drawn from the voltage rail through the 470k ohm resistor. But in your case, you have the op amp supplying the bias reference. So if ANY one of the CT&#39;s isn&#39;t plugged in, the output of the op amp is pulled directly to ground. This affects ALL the inputs.</p>
<p>Please correct me if i&#39;m wrong. Just wanting to help....</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35093"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8744.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Roeland54&#039;s picture" title="Roeland54&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8744.html" title="View user profile.">Roeland54</a> on Mon, 19/10/2015 - 12:35.</div>
    <div class="content">
     <p>@Robert Wall: Thank you for the feedback.</p>
<p>- I removed L1 from the schematic.<br />
- I will read up on using ADC&#39;s.<br />
- Are the internal pull up/down resistors of the Photon STM micocontroller not good enough?<br />
&nbsp; Still not sure if I should add the digital I/O breakouts.<br />
- Added wire ended resistors for the CT &amp; VT inputs<br />
&nbsp;</p>
<p>@MattyZee: Thanks for spotting the major error. Could we solve this by adding a 470K resistor between pin4 of the jack and the ground? Or we could delete the connection to the ground completely. Do we need the detection?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35096"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 19/10/2015 - 13:31.</div>
    <div class="content">
     <p><i>"Do we need the detection?"</i><br />
The answer to that is, will you get 'noise' output when no CT is connected and will it be troublesome, or do you otherwise need or want to know, i.e. so that you don't send a string of zero values for non-existent inputs?</p>
<p>The idea (on the emonTx) is if the input is a solid zero at power-up, there is no plug in the socket. That's not quite the same as no CT. If you retain the detection facility, you need a lowish value resistor (say 2.2 k&Omega; at a guess, which will still give a low impedance source but not cost excessive current to be supplied by the op.amp even with nothing plugged in anywhere) between the op-amp output and each socket, not between the socket and ground.</p>
<p>If you don't want detection, by far the best solution is to leave the switched short to ground off completely.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35102"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8744.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Roeland54&#039;s picture" title="Roeland54&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8744.html" title="View user profile.">Roeland54</a> on Mon, 19/10/2015 - 17:10.</div>
    <div class="content">
     <p>Ok thanks. I will leave the the detection off. I think the sensor configuration&nbsp;changes rarely in most setups and we could make it configurable by a web interface.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35526"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8744.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Roeland54&#039;s picture" title="Roeland54&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8744.html" title="View user profile.">Roeland54</a> on Fri, 30/10/2015 - 19:45.</div>
    <div class="content">
     <p>First pcb version &quot;ready&quot; at&nbsp;<a href="https://easyeda.com/Roeland54/Photon_emon_shield-lFDBzUSs2">https://easyeda.com/Roeland54/Photon_emon_shield-lFDBzUSs2</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35535"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Fri, 30/10/2015 - 22:13.</div>
    <div class="content">
     <p>I&#39;ve also got a PCB ready. But I&#39;ve taken a different route to the design. I&#39;ll publish my design next week.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35849"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Thu, 12/11/2015 - 22:06.</div>
    <div class="content">
     <p>Finally!</p>
<p>Here is my take on using all the best bits and working it into a single Photon OEM board.&nbsp;</p>
<p><span style="line-height: 1.6;">Features:</span></p>
<p>1. 8 CT inputs.</p>
<p>2. 3 VT inputs.</p>
<p>3. Switch 3 inputs between CT or VT via jumper.&nbsp;</p>
<p>4. Switch 1 input between CT or Voltage Bias Ref.</p>
<p>5. Voltage terminals accessible on the wire end terminal block.&nbsp;</p>
<p>6. All the Digital and analogue inputs are accessible.&nbsp;</p>
<p>7. The Digital inputs can be pulled up or down as required.&nbsp;</p>
<p>8. The Rj45&nbsp;connector is also available to connect OEM sensors as required.&nbsp;</p>
<p>9. The board should be able to take the Electron as well, when it&#39;s released later.&nbsp;</p>
<p>10. Deliberately went for a through hole version to allow components to be either changed or not added at all.&nbsp;</p>
<p>&nbsp;</p>
<p>Comments? Before I make up a few board for people to have a play with.&nbsp;</p>
<p>&nbsp;</p>
<p>This wouldn&#39;t have been possible without Robert, Robin and dBC. So thank you guys.&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35862"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8744.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Roeland54&#039;s picture" title="Roeland54&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8744.html" title="View user profile.">Roeland54</a> on Fri, 13/11/2015 - 09:05.</div>
    <div class="content">
     <p>Nice to see your take on it. I have few questions.</p>
<p>Is it possible to upload a higher resolution schematic I can&#39;t read some component values &amp; the PCB design with visible traces?</p>
<p>What are the dimensions of the PCB ?</p>
<p>Can you explain how you determined the capacitor value at the input of the ADC&#39;s?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35877"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6518.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="JD&#039;s picture" title="JD&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/6518.html" title="View user profile.">JD</a> on Fri, 13/11/2015 - 14:23.</div>
    <div class="content">
     <p>That&#39;s awesome! &nbsp;Can you use at least 6 CT&#39;s and 3 VT&#39;s simultaneously? &nbsp;If so I&#39;m in for a few of these.</p>
<p>JD<br />
&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35881"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Fri, 13/11/2015 - 15:02.</div>
    <div class="content">
     <p>The Photon only has 8 inputs. So max you can have 3 VTs and 5 CTs. Or any combination inbetween.</p>
<p>All the digital inputs are free for you to what you want. </p>
<p>The good thing is that you can connect an I2C display to D0 and D1 using 2 4K7 pull up resistors. This then becomes a stand alone monitor and display too.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35968"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Mon, 16/11/2015 - 16:25.</div>
    <div class="content">
     <p>I&#39;m getting an initial batch of boards made up.Those interested just drop me a PM and we&#39;ll take it from there.&nbsp;Do people want fully populated boards, just PCBs or PCB kits.&nbsp;</p>
<p>I just changed the design slightly to add a 5V power line as well, incase some sensors are better run via 5V (remember the emonTX&nbsp;v2 where the board runs at 3.3 but the temperature sensor runs at 5V)</p>
<p>Also all Photon pins are also now accessible. And in case you are wondering what those cut-outs on the board are for, they are for some kind of USB plug strain relief. I wasn&#39;t too happy with the USB plug just hanging off the photon unsecured.&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36904"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7815.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-7815.jpg" alt="officeboy&#039;s picture" title="officeboy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/7815.html" title="View user profile.">officeboy</a> on Thu, 10/12/2015 - 21:07.</div>
    <div class="content">
     <p>I am just getting wrapped up enough with life projects to get back into this. &nbsp;What are you using on the software end? &nbsp;Is the&nbsp;Cinezaster/EmonLib still a good working library? &nbsp; What code are you running? &nbsp;And Bruce, how is your PCB working out?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36908"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8012.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bruce_miranda&#039;s picture" title="bruce_miranda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonTX shield using the Particle (formerly Spark) Photon </h3>

    <div class="submitted">Submitted by <a href="../user/8012.html" title="View user profile.">bruce_miranda</a> on Fri, 11/12/2015 - 06:40.</div>
    <div class="content">
     <p>My pcb will have to wait until the new year unfortunately. Am told Tis the season to be jolly not soldering. </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11292"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-Cw8pLPQwzU_jLsEYArgSCSnfOaAp70QpJJRV_73ggwA" value="form-Cw8pLPQwzU_jLsEYArgSCSnfOaAp70QpJJRV_73ggwA"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
