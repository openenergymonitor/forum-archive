<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11334 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:54:38 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>regenerate kwh data | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">regenerate kwh data</h3>
        <span class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Mon, 05/10/2015 - 21:06</span>
        <div class="content"><p>Help!</p>
<p>I upgraded to version 9 rc2 from git. Since then my kwh data reset back to zero.</p>
<p>New data is adding correctly and as expected now increasing again - a nice sawtooth pattern.</p>
<p>Is there anyway to recreate all the data by processing the raw &quot;feed to log&quot; data - both are phpfina&#39;s</p>
<p>I also need to do the same for all the subsequent data feeds</p>
<p>Any thoughts?</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11326.html" class="topic-previous" title="Go to previous forum topic">‹ Input calculations</a>
              <a href="10683.html" class="topic-next" title="Go to next forum topic">emonhub hacking - which git? ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-34709"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Mon, 05/10/2015 - 23:25.</div>
    <div class="content">
     <p>Yes I had (have) the same problem...</p>
<p>Trystan&nbsp;<a href="11009.html#comment-33665">commented about this here</a>, but it didn&#39;t work for me.<br />
However, my &#39;feed to log&#39; was phpfiwa, so please let us know if it works for you.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34716"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Tue, 06/10/2015 - 08:33.</div>
    <div class="content">
     <p>The other wrinkly is that if I use the &quot;live&quot; feed view and zoom out to the &quot;hour&quot; view</p>
<p>i get no data.. just blank - any fixes ?</p>
<p>I&#39;ll try trystans re-generation script later. Hopefully there&#39;s similar for the kwh/d and the histograms...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34735"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Tue, 06/10/2015 - 22:25.</div>
    <div class="content">
     <p>Running the process script and it chucks out a few errors</p>
<p>Warning: unpack(): Type f: not enough input, need 4, have 0 in /var/www/emoncms/usefulscripts/process/Lib/PHPFina.php on line 320<br />
PHP Warning: &nbsp;unpack(): Type f: not enough input, need 4, have 0 in /var/www/emoncms/usefulscripts/process/Lib/PHPFina.php on line 320</p>
<p>&nbsp;</p>
<p>Will let you know how it finishes..</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34736"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Tue, 06/10/2015 - 22:42.</div>
    <div class="content">
     <p>...this is an issue that really could do with sorting.</p>
<p>For example, below is my &#39;Power&nbsp;to kWh&#39; feed, and as you can see, everytime there is an interruption to the network, the accumulative totals drop - meaning negative values in &#39;my power&#39; and a distorted view of imported power.</p>
<p>&nbsp;<img alt="" src="../sites/default/files/file%20(2).png" style="width: 626px; height: 308px;" /></p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34738"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Tue, 06/10/2015 - 22:53.</div>
    <div class="content">
     <p>yeap that looks like mine - but i only have 2 drops - last time the clock changed and this upgrade.</p>
<p>But I&#39;m running it all locally so the &quot;network&quot; is only from the emontx to the raspberry.</p>
<p>the processing seems to be taking a while so I&#39;m testing the time it will take over night. do the proper fix tomorrow...</p>
<p>Any ideas on the zoom out issue - its really annoying not getting the &quot;hour&quot; view. Is it because its a fina and it should be a fiwa&nbsp;?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34742"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Wed, 07/10/2015 - 08:11.</div>
    <div class="content">
     <p>Paul - the network interruption is that on the original log to feed and the impact of that is being felt in the output of the power to kwh?&nbsp;</p>
<p>Does the log to feed get upset when there is no data for a given timestamp? is it a fixed time data record type issue? my initial log to feed is a REALTIME / PHPFINA&nbsp;data source - what&#39;s yours?</p>
<p>Perhaps the other question is - what should it be ?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34743"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Wed, 07/10/2015 - 08:42.</div>
    <div class="content">
     <p>The network interruption is where I&#39;ve unplugged to ethernet cable, disconnecting the Pi from the LAN (my router&nbsp;only has 2 ethernet ports - one&nbsp;is used for VOIP full time, and the other I&#39;ve needed to occasionally share with another project I&#39;ve been working on). The dips seem to coincide with when the LAN is disconnected.<br />
The original log to feed is a realtime&nbsp;phpfiwa feed, and that looks completely normal, with no changes whatsoever when the &#39;power to kwh&#39; feed shows the&nbsp;dips.</p>
<p>This is more a minor annoyance for me, hence I haven&#39;t&nbsp;looked too far into it, however to others it could present a considerable issue if that&nbsp;data is important.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34744"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Wed, 07/10/2015 - 08:46.</div>
    <div class="content">
     <p>is your Pi reporting the data across to a remote emoncms then?</p>
<p>Mine is doing it all locally - hence less issues i guess.</p>
<p>I&#39;m sure that the power to kwh will have a knock-on impact on the kwh/d process and the histogram&#39;s that i&#39;m running as well. Yes for me the data is important - using it to build a case to get an battery to increase my self-consumption...</p>
<p>PS you can get a network switch to solve your 2 port issue ;-)&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34745"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Wed, 07/10/2015 - 08:54.</div>
    <div class="content">
     <p>I&#39;m not reporting to a remote emoncms, just need the LAN connection for apache&nbsp;to serve up the website.</p>
<p>If I run the script (just tried again), I get;</p>
<pre>
pi@raspberrypi ~/usefulscripts/process $ sudo php power_to_kwh.php
Power to kWh processor feed 14 -&gt; feed 41
Recalculated in 71s
pi@raspberrypi ~/usefulscripts/process $</pre><p>And the graph looks exactly the same.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34746"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Wed, 07/10/2015 - 08:58.</div>
    <div class="content">
     <p>71s? What are you running it on?</p>
<p>mine hasn&#39;t finished yet.</p>
<p>So a regeneration won&#39;t fix it - probably related to all the errors</p>
<p>Warning: unpack(): Type f: not enough input, need 4, have 0 in /var/www/emoncms/usefulscripts/process/Lib/PHPFina.php on line 320</p>
<p>The issues must be in the source data - or how the missing data is being handled&nbsp;</p>
<p>who knows most about that PHPFina.php code?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34747"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 07/10/2015 - 10:51.</div>
    <div class="content">
     <p>I&#39;ve implemented what I think should be a fix for the error on line 320 of PHPFina, but I dont think this is the cause of the larger issue. Can there be a large negative spike at that point in the power feed?</p>
<p>It may be possible to get around this issue with an extra line after line 67: <a href="https://github.com/emoncms/usefulscripts/blob/master/process/power_to_kwh.php#L67" title="https://github.com/emoncms/usefulscripts/blob/master/process/power_to_kwh.php#L67">https://github.com/emoncms/usefulscripts/blob/master/process/power_to_kw...</a></p>
<p>if ($kwh_inc&lt;0) $kwh_inc=0;</p>
<p>but ideally it would be good to know whats causing the large negative $kwh_inc values</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34749"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Wed, 07/10/2015 - 11:00.</div>
    <div class="content">
     <p>Mine runs from a powered hub, which also powers the USB HDD too.<br />
Whenever I shut down the pi, I always use sudo poweroff, and ensure that it's completed it's shutdown before removing the power.<br />
So no idea where the spike is coming from.<br />
Didn't you experience the same issue when you installed v9 too.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34752"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Wed, 07/10/2015 - 11:13.</div>
    <div class="content">
     <p>trystan&nbsp;- thats &nbsp;not fixed it. I added an extra line of debug -&gt;&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($last_time &amp;&amp; ($time-$last_time)&lt;7200)<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // kWh calculation<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $time_elapsed = ($time - $last_time);<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $kwh_inc = ($time_elapsed * $power) / 3600000.0;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($kwh_inc&lt;0) {<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print &quot;Weird low spike power = &nbsp;last time=$last_time, time=$time, power=$power, kwh_inc = $kwh_inc\n&quot;;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $kwh_inc=0;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $kwh += $kwh_inc;</p>
<p>but that debug never appears - but still getting the same error.&nbsp;</p>
<p>Adding some more debug its actually the read&nbsp;</p>
<p>&nbsp; &nbsp; while ($dp = $engine[$source_engine]-&gt;readnext($source))</p>
<p>that is throwing the error. (added debug at the beginning and end of the loop...)</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34753"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 07/10/2015 - 11:23.</div>
    <div class="content">
     <p>@Paul I think that was a separate issue to do with existing power_to_kwh feeds, my solution was to recompile using the script?</p>
<p>@Octagon, what error exactly is while ($dp = $engine[$source_engine]-&gt;readnext($source)) throwing. It&#39;s not using the lastvalue function in which &quot;Warning: unpack(): Type f: not enough input, need 4, have 0 in /var/www/emoncms/usefulscripts/process/Lib/PHPFina.php on line 320&quot; originated?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34754"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Wed, 07/10/2015 - 11:41.</div>
    <div class="content">
     <p>Notice: Trying to get property of non-object in /var/www/emoncms/usefulscripts/process/Lib/PHPFina.php on line 422<br />
PHP Notice: &nbsp;Trying to get property of non-object in /var/www/emoncms/usefulscripts/process/Lib/PHPFina.php on line 422</p>
<p>the read is now responsible for that above !</p>
<p>Seems we have moved the target.&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34756"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Wed, 07/10/2015 - 11:59.</div>
    <div class="content">
     <p>Ah that one was my bad. I&#39;d copied the original feed I wanted to process so that emon could continue running, But i&#39;d not done the meta data...</p>
<p>Now my debug is working I get output like :&nbsp;</p>
<p>Weird low spike power = &nbsp;last time=1405761350, time=1405761360, power=-113, kwh_inc = -0.00031388888888889<br />
Weird low spike power = &nbsp;last time=1405761360, time=1405761375, power=-87, kwh_inc = -0.0003625<br />
Weird low spike power = &nbsp;last time=1405761375, time=1405761385, power=-68, kwh_inc = -0.00018888888888889<br />
Weird low spike power = &nbsp;last time=1405761385, time=1405761395, power=-86, kwh_inc = -0.00023888888888889</p>
<p>I produce a chunk of electricity from the PV. My graphs can go &quot;negative&quot; because of the amount i pump out...</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34757"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Wed, 07/10/2015 - 12:02.</div>
    <div class="content">
     <p>careful timing caught this :</p>
<p>Weird low spike power = &nbsp;last time=1409501355, time=1409501365, power=-28, kwh_inc = -7.7777777777778E-5<br />
Weird low spike power = &nbsp;last time=1409501365, time=1409501375, power=-20, kwh_inc = -5.5555555555556E-5<br />
Weird low spike power = &nbsp;last time=1409501395, time=1409501410, power=-6, kwh_inc = -2.5E-5<br />
PHP Warning: &nbsp;unpack(): Type f: not enough input, need 4, have 0 in /var/www/emoncms/usefulscripts/process/Lib/PHPFina.php on line 320</p>
<p>Warning: unpack(): Type f: not enough input, need 4, have 0 in /var/www/emoncms/usefulscripts/process/Lib/PHPFina.php on line 320<br />
Weird low spike power = &nbsp;last time=1409557125, time=1409557135, power=-7, kwh_inc = -1.9444444444444E-5<br />
Weird low spike power = &nbsp;last time=1409557135, time=1409557145, power=-7, kwh_inc = -1.9444444444444E-5</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34763"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Wed, 07/10/2015 - 16:08.</div>
    <div class="content">
     <p>well it ran - now looks as if something had eaten a small slice !</p>
<p>Going to re-run without the kwh_inc resets and see what happens.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34764"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: regenerate kwh data</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Wed, 07/10/2015 - 16:30.</div>
    <div class="content">
     <p>OK the graph looks better now.</p>
<p>Now when I&#39;m exporting it does what I&#39;m expecting - not add it onto the consumption :)</p>
<p>still annoying to get those huge &quot;anti-spike&quot;s in the data</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11334"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-INThChrOWYBsCqWlciTpOpzIhf7ba96D5tmWw-rkTWI" value="form-INThChrOWYBsCqWlciTpOpzIhf7ba96D5tmWw-rkTWI"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
