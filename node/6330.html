<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/6330 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:26:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Emonhub failing? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Emonhub failing?</h3>
        <span class="submitted">Submitted by <a href="../user/7397.html" title="View user profile.">David46</a> on Fri, 19/12/2014 - 23:16</span>
        <div class="content"><p>Hi,&nbsp; My emoncms feeds/inputs fail randomly.&nbsp; Sometimes it will run for 12+ hours, other times only 2 minutes.&nbsp; I have a system with the data being sent back to a raspberry pi as serial data, and when emoncms fails I can still see the pi receiving from the sensors using minicom.</p>
<p>I set up the pi to send to both local and remote emoncms, but they both stopped displaying updates this morning.</p>
<p>This is an error I captured from the pi:</p>
<p><strong>Traceback (most recent call last):<br />
&nbsp; File &quot;/usr/share/emonhub/emonhub.py&quot;, line 336, in &lt;module&gt;<br />
&nbsp;&nbsp;&nbsp; hub.run()<br />
&nbsp; File &quot;/usr/share/emonhub/emonhub.py&quot;, line 90, in run<br />
&nbsp;&nbsp;&nbsp; values = I.read()<br />
&nbsp; File &quot;/home/pi/emonhub/src/emonhub_interfacer.py&quot;, line 368, in read<br />
&nbsp;&nbsp;&nbsp; return self._process_frame(f, t)<br />
&nbsp; File &quot;/home/pi/emonhub/src/emonhub_interfacer.py&quot;, line 106, in _process_frame<br />
&nbsp;&nbsp;&nbsp; frame = self._decode_frame(ref, validated)<br />
&nbsp; File &quot;/home/pi/emonhub/src/emonhub_interfacer.py&quot;, line 228, in _decode_frame<br />
&nbsp;&nbsp;&nbsp; decoded.insert(0, int(node))<br />
ValueError: invalid literal for int() with base 10: &#39;.48&#39;</strong></p>
<p>My data is in node 10 with 5 values (4 CT one VT)</p>
<p>Can I view the local database to see the invalid value?</p>
<p>I have seen the notify module as an add on for emailing if feeds are down,&nbsp; can this be used to restart emonhub as well as email?</p>
<p>I also considered restarting thje pi once per day, but sometimes after a restart the feeds still won&#39;t work- so it takes two restarts.</p>
<p>Has anyone had a similar problem or could provide any advice?</p>
<p>&nbsp;</p>
<p>Thanks,</p>
<p>David.</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="6390.html" class="topic-previous" title="Go to previous forum topic">‹ Daemon Not Working</a>
              <a href="6379.html" class="topic-next" title="Go to next forum topic">Emoncms.org site failed to publish dashboard view in public mode ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-26008"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7397.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="David46&#039;s picture" title="David46&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emonhub failing?</h3>

    <div class="submitted">Submitted by <a href="../user/7397.html" title="View user profile.">David46</a> on Sat, 20/12/2014 - 06:52.</div>
    <div class="content">
     <p>More testing using minicom I am pretty sure the emonhub service stops when minicom reports an incorrect line,</p>
<p><strong>10 966.87 -534.54 0.29 -0.16 240.80</strong>&nbsp;&nbsp; is the normal output, but when it crashes I had a line missing the node and the first 2 CT&nbsp;values</p>
<p>Originally I was using copper for the direct serial connection, but I have since replace that with a 433mhz wireless serial link.</p>
<p>Is it possible to make it discard this packet with missing data and continue?</p>
<p>&nbsp;</p>
<p>Thanks</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26009"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emonhub failing?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sat, 20/12/2014 - 11:16.</div>
    <div class="content">
     <p>Hi David.</p>
<p>It indeed looks like incomplete data is the root problem&nbsp;and finding the cause of that should be the main&nbsp;focus.</p>
<p>There is no question emonhub&nbsp;should handle this exception far more gracefully and I can&nbsp;take a look into that, But while emonhub can do&nbsp;some integrity checks like check if a number is a float or within a&nbsp;range etc it can&#39;t totally validate all data, yes in the case of &quot;.48&quot; that obviously isn&#39;t an int&nbsp;so that packet could be discarded, but how many times has &quot;10.48&quot; been passed as 10&nbsp;<span style="font-size:12.7272720336914px; line-height:18.9090900421143px">without a problem&nbsp;</span><span style="font-size:13px; line-height:1.6">when it was intended to be 210.48 or -4410.48 ? If the &quot;0.48&quot; was discarded gracefully (as it should be) unless you check the logs regularly you are oblivious to a problem&nbsp;until&nbsp;you spot&nbsp;anomalies the data you are collecting.&nbsp;</span></p>
<p>Partial numbers are difficult to detect but partial frames can&nbsp;be a little easier. If you were receiving data in individual bytes and reconstructing to real numbers&nbsp;in emonhub, then a&nbsp;&quot;datacodes&quot;&nbsp;string could provide a fixed value count, but since you are receiving real values the &quot;datacodes&quot; decoding is not used so no checks are done. It may be handy if emonhub&nbsp;was able to use this to confirm the value count if demanded and I can look into that too, but this still wouldn&#39;t prevent partial numbers distorting the data.</p>
<p>How are you collecting data? what rf &quot;system&quot; are you using? the rf12&#39;s we use discard any incomplete packets so it&#39;s not something emonhub&nbsp;or other&nbsp;softwares need to worry too much about, hence the unnoticed&nbsp;&quot;hole&quot; :-)</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26013"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emonhub failing?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sat, 20/12/2014 - 15:28.</div>
    <div class="content">
     <p>Thinking about the value count, there is a possibility emonhub&nbsp;may be able to check this already if you put an entry in the [nodes] section of the conf eg</p>
<blockquote><p>[nodes]</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; [[10]]</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;datacodes = 0, 0, 0, 0, 0</p>
</blockquote>
<p>where each value is declared as a&nbsp;datatype &quot;0&quot;. The &quot;0&quot; datatype was intended to tell emonhub&nbsp;not to decode real values and is the default datacode for all interfacers except the one for the RFM2Pi. Currently if you do not have any [nodes] data in the conf&nbsp;for node 10, emonhub will basically expect an unknown number of datatype&nbsp;&quot;0&quot; values, I haven&#39;t tried this, but in theory the string above will tell emonhub to &quot;do nothing&quot; for each of the 5 expected values and if there isn&#39;t 5 values to &quot;do nothing&quot; to, discard the frame. No guarantee it will work but there is a strong enough possibility&nbsp;it will work to justify trying it out.</p>
<p>if the frame is incomplete it should log&nbsp;a warning saying &quot;RX data length: 4&nbsp;is not valid for datacodes&nbsp;0, 0, 0, 0, 0&quot; for example if only 4 of the 5 expected are found.</p>
<p>A node id type check will be added when I get a mo to decide the best place for it and give it a test.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26023"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7397.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="David46&#039;s picture" title="David46&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emonhub failing?</h3>

    <div class="submitted">Submitted by <a href="../user/7397.html" title="View user profile.">David46</a> on Sat, 20/12/2014 - 22:27.</div>
    <div class="content">
     <p>Hi Paul thanks for the reply,</p>
<p>&nbsp;</p>
<p>I am using the Shield_CT1234_Voltage sketch with the output :</p>
<p><strong>// Print to serial<br />
&nbsp;&nbsp;&nbsp; Serial.print(nodeID); Serial.print(&#39; &#39;);<br />
&nbsp;&nbsp;&nbsp; Serial.print(ct1.realPower); Serial.print(&#39; &#39;);<br />
&nbsp;&nbsp;&nbsp; Serial.print(ct2.realPower); Serial.print(&#39; &#39;);<br />
&nbsp;&nbsp;&nbsp; Serial.print(ct3.realPower); Serial.print(&#39; &#39;);<br />
&nbsp;&nbsp;&nbsp; Serial.print(ct4.realPower); Serial.print(&#39; &#39;);<br />
&nbsp;&nbsp;&nbsp; Serial.println(ct1.Vrms);</strong></p>
<p>being sent to a HC-11 433Mhz Wireless to TTL CC1101 Module.&nbsp; This is then received by another of the same modules feeding the Rx pin on the R pi.</p>
<p>In the emonhub.conf I have hashed out the RFM2Pi and added a serial direct interfacer.</p>
<p>Nodes is set as:</p>
<p><strong># List of nodes by node ID</strong></p>
<p><strong># &#39;datacode&#39; is default for node and &#39;datacodes&#39; are per value data codes.</strong></p>
<p><strong># if both are present &#39;datacode&#39; is ignored in favour of &#39;datacodes&#39;</strong></p>
<p><strong>[[99]]</strong></p>
<p><strong>datacode = h</strong></p>
<p><strong>datacodes = h, f, f, f, f, f</strong></p>
<p>Are you saying that if I use the interfacer for the RFM2Pi then the packets would be processed better? Or is my hardware not suitable for that because it is effectively a dumb repeater.&nbsp;</p>
<p>Does datacode = h provide the best error checking, whereas I am using = h, f, f, f, f, f which is causing the errors,&nbsp; maybe the h could be a non numerical value to identify node and if it is not followed by 5 f values it discards all till a new h is received.&nbsp; using a non numerical h would remove errors where an f value could be mistaken as the h to start the packet?</p>
<p>David.</p>
<p>edit:&nbsp; sorry typed the above before reading your last post,&nbsp; I have just&nbsp;changed the conf file to replace the datacodes&nbsp;f with 0,&nbsp; will let you know the results.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26025"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emonhub failing?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Sat, 20/12/2014 - 23:34.</div>
    <div class="content">
     <p>Hi David,</p>
<p>I&#39;m not familiar with the rf devices you are using but I gather the sketch is just &quot;printing&quot; real human readable values which are then repeated via rf to the&nbsp;serial gpio, so I expect the &quot;normal output&quot; like that in bold in the 2nd post is exactly as you see in minicom. Therefore the values do not need decoding and are dealt with by emonhub&#39;s default &quot;0&quot; datatype.&nbsp;</p>
<p>The hypothetical&nbsp;(out of range)&nbsp;node [[99]] in the conf&nbsp;was just an example template and changing the datacodes as you had will not of had any effect (unless you actually have a node 99 of course) I note you had used datacodes&nbsp;h, f, f, f, f, f to include the node id the datacodes are actually a template or key to decode just the data so the h wasn&#39;t required even if the f&#39;s had been correct for the data.</p>
<p>Up&nbsp;until now the node ids have only been numbers and more specifically usually between 1 and 31, and is not intended to process anything non-numeric (yet) and&nbsp;I think the &quot;0&quot; datatypes may provide a check for incomplete packets.</p>
<p>The correct interfacer&nbsp;to use is&nbsp;indeed the serial interfacer, the RFM2Pi&nbsp;&#39;Jee&#39;&nbsp;interfacer is too tailored to the RFM2Pi to work with what you have.</p>
<p>Lets see how or if the&nbsp;&quot;0&quot;&nbsp;datacodes help and with a better node id test you should be good.</p>
<p>Paul&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26046"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7397.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="David46&#039;s picture" title="David46&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emonhub failing?</h3>

    <div class="submitted">Submitted by <a href="../user/7397.html" title="View user profile.">David46</a> on Mon, 22/12/2014 - 07:24.</div>
    <div class="content">
     <p>Hi,</p>
<p>I worked for a while, but broke again.&nbsp; Initially when I changed the conf file I restarted the Pi.&nbsp; Maybe I did not wait long enough, but the local emoncms did not start updating feeds.&nbsp; I tried to start it manually but ended up with a few errors- different things already started or failed to start?</p>
<p>&nbsp;</p>
<p>Anyway eventually I got it all going for maybe 8 hours,&nbsp; it seemed to handle &quot;bad packets&quot; without causing the emonhub service to stop.&nbsp; When I woke this morning it had already&nbsp;failed, then after 2 hours it failed again, each time requiring restart of the service.</p>
<p>&nbsp;</p>
<p>These are the last two error logs:</p>
<p><strong>2014-12-22 15:44:50,079 WARNING 493 Discarded RX frame &#39;non-numerical content&#39; : [&#39;\xa6\xa6\x02j\x82r\x82\x92\x02\x92\xa2\x92r\x92\xc2j\n10&#39;, &#39;1319.71&#39;, &#39;-751.36&#39;, &#39;0.41&#39;, &#39;0.57&#39;, &#39;242.27&#39;]<br />
2014-12-22 15:45:31,029 WARNING 498 Discarded RX frame &#39;non-numerical content&#39; : [&#39;\xaa\x02\x82r\x92\x82\x02\x92\xa2\x9ar\x82\x9aj\n10&#39;, &#39;1304.53&#39;, &#39;-744.21&#39;, &#39;-0.10&#39;, &#39;-0.27&#39;, &#39;241.87&#39;]</strong></p>
<p>I do notice that I have alot more inputs now,&nbsp; 2 from each node 4, 5, 7 and 14.&nbsp; and key 6, 7, and 8 from my normal node 10 have values 21 hours old?</p>
<p>&nbsp;</p>
<p>I have left another putty session open to constantly watch the minicom events<br />
&nbsp;</p>
<p>&nbsp;</p>
<p>edit:&nbsp;&nbsp;&nbsp; failed again and the only irregularity I can see in minicom is</p>
<p>
<strong>10 98.83 566.68 0.29 -0.02 238.40<br />
10 101.39 563.63 0.08 -0.31 237.22<br />
5 -0.03 239.12<br />
10 100.87 548.33 -0.54 -0.07 238.97<br />
10 94.80 537.05 0.08 0.74 235.65</strong></p>
<p>That node 5 with 2 values</p>
<p>Restarted emonhub twice,&nbsp; did not help so restarted pi-&nbsp; all good again</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>
&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26049"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emonhub failing?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 22/12/2014 - 12:20.</div>
    <div class="content">
     <p>It&#39;s quite difficult to tell what&#39;s happening without the full picture, but reading between the lines a&nbsp;little&nbsp;here and there, I can see the issues definitely&nbsp;need tackling before emonhub.</p>
<p>The &quot;last two error logs&quot; tells us firstly that emonhub handled those bad packets by recognizing the &quot;flaw&quot; and discarding them with a error message, it also tells us that is not the cause as emonhub continued to function after the first to report the second. Then theres the content which is not &quot;incomplete&quot; or even just 2 messages amalgamated, they contain raw hex passed as a string too.</p>
<p>Old&nbsp;Inactive inputs on node 10 is a good sign as that suggests the &quot;0&quot; datacodes are doing their bit and only &quot;5 value&quot; node 10 frames are getting through.</p>
<p>If you are seeing &quot;alot more inputs now&quot; that may be a good thing&nbsp;by filtering more out, more is getting through. But it suggests&nbsp;how &quot;random&quot; the resulting data might&nbsp;be as only the node id irregularities are highlighted by creating an extra node. Something else to consider is emoncms discards any frames that have a node id outside the range 0-32 so how many other inputs would be created if that wasn&#39;t the case is not known.</p>
<p>The &quot;node 5 with 2 values&quot; is just half a packet and would of been passed to emoncms&nbsp;as normal, emonhub has no way of knowing it&#39;s not genuine.&nbsp;</p>
<p>The fact that restarting emonhub&nbsp;doesn&#39;t&nbsp;clear the problem every time actually suggests something else is at fault.&nbsp;</p>
<p>emonhub is designed to catch the occasional fault rather than pick out&nbsp;good packets from a unmanaged stream, Tackling this is maybe&nbsp;a good exercise&nbsp;for the development of&nbsp;emonhub as it is testing the error handling to an increased level, this can help emonhub&nbsp;become more robust, but from your point of view the more it discards and filters out, the less data&nbsp;you&#39;re left with and with a high probability of error in the remaining the data, it will at best be inconsistent and therefore&nbsp;unreliable and possibly misleading information.&nbsp;It would take far less effort and yield much better results to tackle the issue at source.</p>
<p>This probably isn&#39;t what you want to hear but I think you should reconnect using a direct wired connection and if all is well, then look at improving the wireless link either by building on what you have or switching to a known good rf link. The rfm2pi&nbsp;board is relatively cheap and a rfm12 or rfm69&nbsp;will drop straight onto&nbsp;the shield.</p>
<p>Paul</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26050"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emonhub failing?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 22/12/2014 - 12:39.</div>
    <div class="content">
     <p>Just to clarify, I&#39;m not suggesting emonhub is without fault. We have clearly already identified that if a non-numeric node id including a partial number eg &quot;.2&quot; (decimal point but&nbsp;no leading digit) will cause emonhub to fall over and that needs to be and will be addressed and that may well&nbsp;improve things a little for your data. But I&#39;m very&nbsp;aware that emonhub is unlikely to be able to condition&nbsp;the current input stream&nbsp;to make it credible enough.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26053"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emonhub failing?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 22/12/2014 - 13:26.</div>
    <div class="content">
     <p>So i started looking into the above &quot;non-numeric node id&quot; issue and have found it would be caught by the recent change&nbsp;made to catch empty frames. Similarly the empty frames shouldn&#39;t of reached emonhub but that doesn&#39;t mean emonhub should be vulnerable to such occurrences.<a href="https://github.com/emonhub/emonhub/issues/133">(see issue for more info)</a>.</p>
<p>I have now merged those changes from the &quot;testing&quot; branch so if you update emonhub to rc1.2 using a git pull we can eliminate those errors causing emonhub to fail.</p>
<p>Paul&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26080"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7397.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="David46&#039;s picture" title="David46&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emonhub failing?</h3>

    <div class="submitted">Submitted by <a href="../user/7397.html" title="View user profile.">David46</a> on Tue, 23/12/2014 - 12:01.</div>
    <div class="content">
     <p>Hi Paul,&nbsp; thankyou for all your help so far.&nbsp; I will update emonhub soon and see how much it improves, and will see if I can reconnect the serial link with copper.&nbsp; That will be a bit involved since they are each installed in position. The raspberry pi will probably have to be moved closer to the switchboard but it will be good to remove the wireless link to help isolate my fault(s)</p>
<p><strong>$ tail -f /var/log/emonhub/emonhub.log<br />
&nbsp;&nbsp;&nbsp; version, status, reason = self._read_status()<br />
&nbsp; File &quot;/usr/lib/python2.7/httplib.py&quot;, line 365, in _read_status<br />
&nbsp;&nbsp;&nbsp; line = self.fp.readline()<br />
&nbsp; File &quot;/usr/lib/python2.7/socket.py&quot;, line 447, in readline<br />
&nbsp;&nbsp;&nbsp; data = self._sock.recv(self._rbufsize)<br />
timeout: timed out</strong></p>
<p><strong>2014-12-23 22:21:05,136 WARNING Send failure: wanted &#39;ok&#39; but got<br />
2014-12-23 22:35:59,212 WARNING Couldn&#39;t send to server, URLError: timed out<br />
2014-12-23 22:35:59,214 WARNING Send failure: wanted &#39;ok&#39; but got</strong></p>
<p>This was my last log entry but it is all still working ok at 23:00</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26142"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emonhub failing?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Fri, 26/12/2014 - 13:07.</div>
    <div class="content">
     <p>Hi David, not sure why but those logs point to an issue at the emoncms end. the request is timing out before emonhub is getting the &quot;ok&quot; response it expects.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26149"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emonhub failing?</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Fri, 26/12/2014 - 15:48.</div>
    <div class="content">
     <p>are you posting to emoncms.org? there is an intermittent load issue on emoncms.org at the moment that may cause the timeout, that would affect a couple of posts every now and then while receiving most of them correctly.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26248"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7397.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="David46&#039;s picture" title="David46&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emonhub failing?</h3>

    <div class="submitted">Submitted by <a href="../user/7397.html" title="View user profile.">David46</a> on Tue, 30/12/2014 - 11:35.</div>
    <div class="content">
     <p>Hi,&nbsp; yes I am posting to emoncms.org and to the local RPi.</p>
<p>Prior to today I had about 3 days of uninterrupted data.&nbsp; Pretty sure this lined up wtih upgrading emonhub to version 1.2&nbsp; Thankyou for your good work on that Paul.&nbsp; My log file was still showing errors- unable to send to server, non numerical, string too short and I think&nbsp;a node id error.&nbsp; But it kept running and processing what it could.</p>
<p>Todays fault was something in the switchboard but it is all running fine again.</p>
<p>&nbsp;</p>
<p><strong>2014-12-30 16:55:02,576 WARNING 1 Discarded RX frame &#39;non-numerical content&#39; : [&#39;\xc2\x11\x02\x13\x10\x05\x1a\x13\x13\x0c\x0e\n\x13\x1b\x01\t\x0e\x19\x1a\x13\x17\x15\x02\x13\x10\x15\x19\x10\x12\t\x06\x12\x02\x12\x18\x19\t\x0c\x19\x02\x12\x19\r\x02\x13\x17\x05\n\x13\x03\n\x1e10&#39;, &#39;1640.67&#39;, &#39;-1236.34&#39;, &#39;-0.07&#39;, &#39;0.16&#39;, &#39;235.72&#39;]</strong><br />
&nbsp;</p>
<p>The above error, similar to what we have seen from my system before does not seem to be created by my wireless link for a serial connected system.&nbsp; A friend tried a setup with a different sketch modified for serial but was using a copper link for the transmit to the RPi and was getting similar garbage in his log.</p>
<p>&nbsp;</p>
<p>Maybe some other direct serial&nbsp;users could provide feedback, although the newer emonhub does not seem troubled by it.</p>
<p>&nbsp;</p>
<p>Also is&nbsp;Emoncms configurable so it logs my 24hour time&nbsp;period for accumulated data?&nbsp; My daily totals seem to turn up maybe in line with your midnight?&nbsp; Which means the totals do not match my inverter.</p>
<p>&nbsp;</p>
<p>Thanks</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26272"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emonhub failing?</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 30/12/2014 - 23:32.</div>
    <div class="content">
     <p>Good to hear you&#39;ve made some progress. The log excerpt shown includes a string of hex control codes and as it was the first line read it maybe it is some set up data from the rf module perhaps. Do you see these anomalies in minicom too?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26279"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7397.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="David46&#039;s picture" title="David46&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emonhub failing?</h3>

    <div class="submitted">Submitted by <a href="../user/7397.html" title="View user profile.">David46</a> on Wed, 31/12/2014 - 05:50.</div>
    <div class="content">
     <p>Hi,&nbsp; I did not have an instance of minicom running at the time, but I have seen it a bit in the emonhub log file.&nbsp; I thought maybe it was my garage door remote,&nbsp; but I could not reproduce it.&nbsp; Possibly something from the neighbours devices.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/6330"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-Gq-gGznUjOybP082BCahHBTScmnMmrFc3H-EYbd24rg" value="form-Gq-gGznUjOybP082BCahHBTScmnMmrFc3H-EYbd24rg"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
