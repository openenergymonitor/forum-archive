<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11827 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:47:48 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Will shortening my posting interval and retaining my present feed interval nullify my historic data | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Will shortening my posting interval and retaining my present feed interval nullify my historic data</h3>
        <span class="submitted">Submitted by <a href="../user/3988.html" title="View user profile.">EricD</a> on Fri, 18/12/2015 - 16:32</span>
        <div class="content"><p>Guys, please excuse me while I check my grasp and understanding of the emoncms&nbsp;data feeds.</p>
<p>At the moment I have 5 feeds each set to 10 second feed intervals for fixed Interval, no averaging;<br />
real power, solar power&nbsp;(which I calculate), solar meter pulses,&nbsp;Vrms&nbsp;&amp;&nbsp;Irms,</p>
<p>And my EmonTx v2.2 presently transmits at this rate too.</p>
<p>I used 10 seconds because I am measuring the solar output by counting meter pulses, and it seemed to me that 10 seconds was the minimum requirement to get a reasonable estimate.</p>
<p>Things have changed a bit, and I now only use the real_power figure to calculate how much power I can feed into my immersion heater, via a phase angle thyristor controller. The solar power available is still very interesting, but no longer a part of my decision making algorithm.</p>
<p>So now I&#39;m thinking that I could shorten the transmission interval on the EmonTx, to maybe 5 seconds, and then be able to follow the ups and down of my usage and available power more closely. Perhaps I could also figure out a way to calculate a moving average for the solar power as well, or in the longer term talk directly to the SMA inverter via bluetooth.</p>
<p>I think I understand that&nbsp;left as it is, the feed engine would still only look&nbsp;at the data every 10 seconds and would therefore ignore the &quot;extra&quot; feeds that it would be getting if I fed it every 5 seconds. <em>&nbsp;<strong>Is that correct?</strong></em></p>
<p>All suggestions and comments are so very welcome.</p>
<p>Just while I&#39;m here, the emoncms logging system is remarkably accurate. Stunningly so, in fact. I did check a few months of reading against my monthly reading for the energy companies and they were spot on. One I can remember that I noted &nbsp;was 155.7 kWhrs, which was&nbsp;correctly estimated to plus or minus, nothing - brilliant!</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="12336.html" class="topic-previous" title="Go to previous forum topic">‹ Unable to remove invalid data from feed</a>
              <a href="12306.html" class="topic-next" title="Go to next forum topic">Posting values to Localhost ERROR message ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-37990"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8942.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="jasonnet&#039;s picture" title="jasonnet&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Will shortening my posting interval and retaining my present feed interval nullify my historic data</h3>

    <div class="submitted">Submitted by <a href="../user/8942.html" title="View user profile.">jasonnet</a> on Thu, 07/01/2016 - 18:58.</div>
    <div class="content">
     <p>I had the same question.&nbsp;&nbsp; In my case I&#39;ve shortened my emonTx transmission interval, but my feed still seemed to record every 10 seconds.&nbsp;&nbsp;&nbsp; I was wondering how I could record the history more finely so that I can pick up the current spikes as some devices turn on.&nbsp; (With a 10 sec interval it appears the spikes are picked up rarely.)&nbsp; I was curious about that both academically and to help me better chose a backup power generator.</p>
<p>Here&#39;s what I&#39;ve discovered.</p>
<p>On the &quot;Nodes&quot; page, if you/I configure &quot;log to feed&quot; with the &quot;fixed interval, no averaging FINA&quot;, we will have the data logged every n seconds even if the emonTx is feeding more frequently than that.&nbsp; (Where n is the value you specify in the UI.&nbsp; I don&#39;t yet know where that interval value is stored.)&nbsp; OTOH, if we feed with &quot;variable interval, no averaging PHPTIMESERIES&quot;, the data seems to log at the rate that it comes in, but still apparently not with a resolution finer than 1.0 second.&nbsp; You can view that by clicking on an eye icon on the Feeds page. &nbsp; Lower on the graph page, you can click on &quot;Show CSV Output&quot;.&nbsp;&nbsp; You&#39;ll also want to set the interval field above to 0, uncheck &quot;Skip missing&quot; and &quot;Limit interval&quot; and click &quot;Resend&quot;.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38094"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3988.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="EricD&#039;s picture" title="EricD&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Will shortening my posting interval and retaining my present feed interval nullify my historic data</h3>

    <div class="submitted">Submitted by <a href="../user/3988.html" title="View user profile.">EricD</a> on Sun, 10/01/2016 - 17:01.</div>
    <div class="content">
     <p>Thanks very much for replying, I had assumed that if I was way out with my assumptions that hopefully someone would put me right, but it&#39;s very nice to have a positive reply.</p>
<p>So, having had that confirmed, thanks again, that&#39;s it&nbsp;- I&#39;m going to cut my interval down to 5 seconds and try to catch a few more of those spikes and peaks, much the same as yourself, so that it&#39;ll spot the kettle going on a bit quicker, etc. And then my thyristor control system can react&nbsp;quicker to limit any power being delivered to my immersion heater - I might save a few pence :-)</p>
<p>Nonetheless, from a recording point of view I have found the recording of my real power usage by the emoncms time series to be staggeringly accurate, when I compare it with my &quot;actual&quot; usage as shown my regular meter readings for my power supply company - and that&#39;s with a 10 second interval.</p>
<p>It&#39;s all a lovely game! &nbsp;Cheers, and thanks again for the information.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38924"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3988.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="EricD&#039;s picture" title="EricD&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Will shortening my posting interval and retaining my present feed interval nullify my historic data</h3>

    <div class="submitted">Submitted by <a href="../user/3988.html" title="View user profile.">EricD</a> on Sun, 31/01/2016 - 10:50.</div>
    <div class="content">
     <p>I&#39;ve finally got round to doing this. I&#39;ve shortened my transmission interval from the emonTX&nbsp;v2.2&nbsp;to around 5 seconds and have also changed the way of calculating the solar power to noting the interval between pulses and calculating the solar power from that, rather than my previous method of using the number of pulses per interval as the basis of the calculation. Also now sending the number of pulses to emoncms as an ever increasing number to be used in the wh accumulator process.</p>
<p>I&#39;ve had to use long integers in the emonTX&nbsp;sketch&nbsp;for these time intervals, otherwise they overflow very quickly on dull days and also zeroise the total pulse count as it goes negative at 32767.</p>
<p>It&#39;s working great. Have fun.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38928"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Will shortening my posting interval and retaining my present feed interval nullify my historic data</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 31/01/2016 - 12:39.</div>
    <div class="content">
     <p>I&#39;ve just noticed a sentence in your post above, Eric: &quot;<em>And then my thyristor control system can react quicker to limit any power being delivered to my immersion heater&quot;</em></p>
<p>Just for information, the energy diverters by MartinR and Robin Emley react just a little bit faster than your 5 or 10&nbsp;s, they react on the next mains cycle, and given a compatible tariff meter, they can trim the immersion heater power so that absolutely no energy is unnecessarily returned to the supply network.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38934"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3988.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="EricD&#039;s picture" title="EricD&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Will shortening my posting interval and retaining my present feed interval nullify my historic data</h3>

    <div class="submitted">Submitted by <a href="../user/3988.html" title="View user profile.">EricD</a> on Sun, 31/01/2016 - 14:04.</div>
    <div class="content">
     <p>Thanks for your reply Robert, it&#39;s really nice to hear from somebody who knows where I&#39;m coming from. I&#39;m afraid I sometimes bore the whatsisname out of some of the guys down the pub.</p>
<p>It&#39;s not so much a limitation of the Eurotherm 425A that I&#39;m using that limits my control intervals, it&#39;s the way my system is set up really. The emonTX sits by the consumer unit downstairs, as you&#39;d expect, and sends the wireless signal upstairs to a pi with a rfm12pi v2 attached. My immersion heater is powered from the linen cupboard upstairs, so the option of controlling it&nbsp;directly in the downstairs cupboard wasn&#39;t available.</p>
<p>So, a bash script looks at the emonhub&nbsp;log on the pi upstairs as each record arrives, and drives a DAC that controls the Eurotherm with 0-5v&nbsp;(actually I only use 0 - 3.3v)&nbsp;as it figures out how much power it can divert, given the amount of &quot;spare&quot; power. The Eurotherm sits in a metal box, in&nbsp;the airing cupboard wired into the immersion heater power supply.</p>
<p>I&#39;ve been a bit self indulgent with this control script; it&#39;s parameters are alterable on the fly so I can &quot;tune&quot; it whilst it&#39;s working, and among other things, it sends me emails as it starts up in the morning and shuts down at sunset.&nbsp;It would be lovely if I could&nbsp;communicate&nbsp;with the&nbsp;emonTX&nbsp;so I could alter it&#39;s parameters on the fly too.</p>
<p>I could up the frequency until the bash script was fully committed, I reckon every&nbsp;1 or 2 seconds would be the limit, but&nbsp;I&#39;m aware that if I increase the frequency it&#39;ll up my traffic volume to emoncms, and maybe that would be a bit antisocial?</p>
<p>Thanks for your comments Robert, and prompting me think about it again, it&#39;s all good fun!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38936"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Will shortening my posting interval and retaining my present feed interval nullify my historic data</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 31/01/2016 - 14:46.</div>
    <div class="content">
     <p>Are you talking about emoncms.org? That would not only be antisocial, but it wouldn&#39;t work because Trystan&nbsp;has a rate limiter on it to allow everyone a fair crack of the whip. But surely you can work your script so that it sends commands every second or less, but aggregates the data and sends that to emoncms.org every 10 or 20 s?</p>
<p>And the emonTx&nbsp;<u>can</u>&nbsp;accept input over the radio, it&#39;s just not set up to do it. You&#39;d need to look at the emonGLCD&nbsp;code to see how its done, and remove all the &quot;sleep&quot; from the emonTx so that it can stay awake listening to the radio.</p>
<p>But I think the neatest way would be to run a small (3 mm diameter or so) microphone-type cable to your linen cupboard and let the emonTx drive the Eurotherm directly. The restriction there is your ability to find an acceptable route for the&nbsp;cable. Failing that, you could, using possibly a second emonTx, generate the analogue signal to control the Eurotherm independently of the Pi, so your downstairs emonTx would send the standard message to the Pi, but as a different node send (possibly several times a second) a separate very short message - it only needs a single byte of payload,&nbsp;staying below the 1% band occupancy limit - to the emonTx controlling the Eurotherm. You&#39;d need&nbsp;to make sure your Pi ignored those messages so that they didn&#39;t get sent to emoncms.org.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38940"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3988.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="EricD&#039;s picture" title="EricD&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Will shortening my posting interval and retaining my present feed interval nullify my historic data</h3>

    <div class="submitted">Submitted by <a href="../user/3988.html" title="View user profile.">EricD</a> on Sun, 31/01/2016 - 16:42.</div>
    <div class="content">
     <p>Oh boy, now that&#39;s made me think again.</p>
<p>I have contemplated running a cable twixt understairs and airing cupboard, but it is awkward, them not being above each other, and not even sharing a wall. But with a short run along a downstairs skirting board it could be done, a long way round - about 11 meters. As&nbsp;you say it is the simplest and most elegant solution.&nbsp;I can&#39;t find any thin microphone cable on my favourite online stores, but&nbsp;I do have a reel of telephone cable (2 pair) scudding about somewhere. That might do it, it&#39;s certainly quite slim in profile.</p>
<p>See now I&#39;ve recently been buying lots of cheap&nbsp;Arduino kit and accessories from China and I&#39;ve also got an rfm12B&nbsp;with a breakout board&nbsp;that I had been intending to use to make a monitor by listening in on the emonTXs transmissions and putting up some sort of display. But, but, I could use that to be the controller of the Eurotherm. Or, as you say, just buy another emonTX, or maybe a shield. Never thought of that.</p>
<p>I haven&#39;t looked very closely at all into the libraries used by my emonTX&nbsp;sketch - I&#39;ve just used the send_rf_data() function having set up the nodeID in the definitions, presumably you can vary this before calling send_rf_data()&nbsp;and send a different packet as a&nbsp;different nodeID. Now that never occurred to me either.</p>
<p>It has struck me lately that I do seem to be doing the equivalent of&nbsp;recording off the radio by sticking a microphone in front of it&#39;s speakers, and you&#39;ve given me quite a few fresh ideas there Robert, excellent thanks very much.</p>
<p>Just when I thought I was running short of things do on my Solar POwer Diversion (I call it spod) I now seem to have lots more to think about, Cheers, I&#39;m off the pub to bore somebody senseless !!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40280"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3988.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="EricD&#039;s picture" title="EricD&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Will shortening my posting interval and retaining my present feed interval nullify my historic data</h3>

    <div class="submitted">Submitted by <a href="../user/3988.html" title="View user profile.">EricD</a> on Sat, 12/03/2016 - 16:59.</div>
    <div class="content">
     <p>So, just in case anyone is listening, I&#39;ll finish this thread off with the stuff that&nbsp;I&#39;ve now done.</p>
<p>I followed some of Robert&#39;s advice above; the long wire didn&#39;t ring my bells, if for no other reason than I wanted control of the solar power diversion logic close to hand and not in my under stairs cupboard. So the two node IDs was the path I chose.</p>
<p>My emonTx&nbsp;2.2&nbsp;now uses two node ID&#39;s one only for emoncms.org&nbsp;(10)&nbsp;and the other (27)&nbsp;for control of the Eurotherm&nbsp;phase angle thyristor controller. I swap the node&nbsp;Id&nbsp;from 27 to 10&nbsp;every 10th transmission and then back again afterwards. The sketch only calculates the solar power from the solar meter&#39;s led flashes for the emon type transmission and leaves it as it is for the others. Transmissions from the rfm12b are now every 0.8 seconds, and 1 in ten of those goes to emoncms.org (with updated solar power),&nbsp;so that&#39;s&nbsp;every 8 seconds.</p>
<p>Both transmissions are recorded in emonhub.log and my raspberry pi bash scripts digs them out and uses them both to eventually, after some thought, feed an analog&nbsp;(0 - 3.3v)&nbsp;signal to the Eurotherm.</p>
<p>I have built an Arduino based lcd monitor that displays the transmissions from the Rfm12b and does some rudimentary calculations of solar power generated so far.</p>
<p>I am now working on an Arduino (Nano) based system (Nano,&nbsp;I2C LCD screen and MCP4921)&nbsp;to listen to the rfm12b transmissions and eventually take over control of the Eurotherm&nbsp;phase angle&nbsp;thyristor&nbsp;controller - just for the crack really, as the Pi based one now seems to be doing great.</p>
<p>Having fun!!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11827"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-rANOZYP4l7n13FkofbOxcq5KQqsrQH-b9MdvTGEgDG0" value="form-rANOZYP4l7n13FkofbOxcq5KQqsrQH-b9MdvTGEgDG0"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
