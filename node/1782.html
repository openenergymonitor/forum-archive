<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/1782 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:50:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Emoncms adding feeds together? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Emoncms adding feeds together?</h3>
        <span class="submitted">Submitted by <a href="../user/2128.html" title="View user profile.">jb79</a> on Thu, 03/01/2013 - 00:48</span>
        <div class="content"><p>Hello!</p>
<p>I&#39;m just trying to get Martin&#39;s 3 phase setup (3 EmonTX connected via I2C) to work, but I have a problem when calculating feeds on&nbsp;Emoncms:</p>
<p>Martin&#39;s script sends power and voltage, I want to have current too. First I log the power value(s) into a feed, then I divide it by the voltage to get the current (logging it in a feed too). After that I multiply it again to get the power again and calculate the kWh/d. Now my problem: I want to add the 3 power values of every phase together to get the total power of the system, but how can I do that without affecting the calculation of kWh/d (for each phase) because i is possible to add another feed but not to subtract a feed.<br />
	&nbsp;Is it possible to save a value somewhere and get it back later in the calculation of a feed? If yes, how can this be done?</p>
<p>I&#39;ve added a screenshot of the input. The normal calculation power to feed, current to feed, power (kWh/d) is done in 1-7, with 8&amp;9 I want to add up the power values of phase 2 &amp; 3, to get the total value for the total power feed.</p>
<p>&nbsp;</p>
<p>I think I will edit the firmware for the EmonTX too to get only current and voltage, so there is no need for the EmonTX to calculate power and for the Raspberry to divide it again to get the current values out f the power values. This would save a lot of calculation =&gt; faster execution, maybe lower power consumtion on EmonTX.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="1813.html" class="topic-previous" title="Go to previous forum topic">‹ Sending data back to the emonGLCD</a>
              <a href="1781.html" class="topic-next" title="Go to next forum topic">Feed list in multigraph editor too wide - not possible to click Add button ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-8848"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms adding feeds together?</h3>

    <div class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Thu, 03/01/2013 - 16:37.</div>
    <div class="content">
     <p>Wouldn&#39;t it be easier just to add Irms to the emonTx payload? It&#39;s calculated anyway with the call to calcVI().</p>
<p>The current you are calculating will only be equal to Irms if the power factor is 1</p>
<p>Good to hear that you have the hardware working.</p>
<p>-martin</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8860"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms adding feeds together?</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Thu, 03/01/2013 - 21:03.</div>
    <div class="content">
     <p>The Power to kWh/d input processor returns the power value unchanged. So it should be possible to do something along the lines of:</p>
<p>Log to feed:&nbsp;power1</p>
<p>power to kwhd: kwhd1</p>
<p>+ input: power2</p>
<p>+ input power3</p>
<p>Log to feed: totalpower</p>
<p>power to kwhd: totalpower_kwhd</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8870"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2128.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="jb79&#039;s picture" title="jb79&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms adding feeds together?</h3>

    <div class="submitted">Submitted by <a href="../user/2128.html" title="View user profile.">jb79</a> on Fri, 04/01/2013 - 02:26.</div>
    <div class="content">
     <p>Hello!</p>
<p>@TrystanLea: Perfect, that would simplify my calculations a lot. Meanwhile I also found out that the power to kWh/d doesn&#39;t change the power value. But is it possible to add &quot;- feed xy&quot; to one of the following versions of EmonCms?</p>
<p>I could also be useful to update the documentation of the input processing: <a href="297.html" title="http://openenergymonitor.org/emon/node/297">http://openenergymonitor.org/emon/node/297</a>. Some of the functions there are still not documentated.</p>
<p>Another question: Is there a version number in EmonCms anywhere or is the modular version the same as in the middle of December (no changes since the release)?</p>
<p>@Martin!</p>
<p>After reinstalling the software on the 3 EmonTx several times and also testing some single EmonTX scripts it seems that is is working stable most of the time. But there are some problems to solve for me:</p>
<p>1.) Calibration: How to get the correct phase calibration values?</p>
<p>2.) sometimes I get values of about 65xxx from one of the slave boards, that destroys every measurement because if they were real, the power has to be about 100kW at that time. In a graph I can only see this spikes, the rest is at about 2-3% of that =&gt; can&#39;t be seen. So I think there has to be a &quot;filter&quot; on the master-EmonTX to eliminate these high values, maybe by sending the old, plausible values until the actual value comes back into a plausible area, lets say about 8kW per phase that would perfectly fit the value of the main fuses in my house (I think they are 35A)</p>
<p>3.) Testing the Range of the EmonTx because 1 single version will be mounted into my gardenhouse, 25m away from the house. Maybe it can help to put the Raspberry in the attic to get a better connection...</p>
<p>&nbsp;</p>
<p>My test setup hosted on the RaspberryPI:</p>
<p><a href="http://jb79.no-ip.org/emoncms/brennerj&amp;id=10" title="http://jb79.no-ip.org/emoncms/brennerj&amp;id=10">http://jb79.no-ip.org/emoncms/brennerj&amp;id=10</a></p>
<p>On the test-dashboard you can see the actual power consumtion of my house, but 2 voltage sensors are missing (ordered in shop, allready on the way). So there is only one phase measured by the 3 phase 3xEmonTx system with Martin&#39;s firmware. 3 additional CTs will be installed soon for measuring the power consumtion of the heat-pump system, option for 3 phase PV system with another 3 CTs in the future.</p>
<p>The second system has temperature sensors. Sensor 1 is hanging outdoor under the office window, sensor 2 is under the office table (PC), sensor 3&amp;4 are also indoor next to the window. CT (Solar) is hanging on the halogen desk lamp (values are wrong because they&#39;re calculated for 230V but the lamp has only 12V...).</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8872"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms adding feeds together?</h3>

    <div class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Fri, 04/01/2013 - 07:57.</div>
    <div class="content">
     <p>I don&#39;t think any of your problems are related to the 3-phase part of your system, they&#39;re just general emonTx &nbsp;issues which have been answered in other posts.</p>
<p>The 65xxx values are correct, they&#39;re just small negative values.There was an old&nbsp;version of&nbsp; EmonCMS that didn&#39;t handle negative values correctly.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8897"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms adding feeds together?</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Sat, 05/01/2013 - 19:56.</div>
    <div class="content">
     <p>Jurgen, Emoncms has only just been updated since the middle of december (2 hours ago). best way to check is to look at the github&nbsp;repo lists the last time it was updated there <a href="https://github.com/emoncms/emoncms" title="https://github.com/emoncms/emoncms">https://github.com/emoncms/emoncms</a></p>
<p>We did discuss creating some form of version numbering a while back but Im&nbsp;no further with it im afraid.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/1782"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-ic0NfqIS8R1DJulpfhklIDZKY_oHmQGlilRO4CXu6Lo" value="form-ic0NfqIS8R1DJulpfhklIDZKY_oHmQGlilRO4CXu6Lo"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
