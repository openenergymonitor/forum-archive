<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11728 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:56:09 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>how does the button widget work ? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">how does the button widget work ?</h3>
        <span class="submitted">Submitted by <a href="../user/8839.html" title="View user profile.">joyrider3774</a> on Wed, 02/12/2015 - 00:07</span>
        <div class="content"><p abp="733">Hi,</p>
<p abp="735">i created a new feed (i tried virtual and normal) and then i added a button widget, selected the new feed and choose to set value to 1 i added another button widget selected same feed and set value to 0.&nbsp;</p>
<p abp="735">i then wanted in nodered to reed from that feed, if a change is detected and the value 1 is one, my wemo insight should turn on if it&#39;s 0 it should turn off.</p>
<p abp="735">However this does not seem to work, whenever i click on a button widget it briefly turns green and then back to red but no value is being written to the feed.</p>
<p abp="735">Is this normal ? How is this supposed to work the button widget ? cause i can&#39;t seem to make it work or to make it write a value to a (new) feed</p>
<p abp="735">&nbsp;</p>
<p abp="735">thanks</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11886.html" class="topic-previous" title="Go to previous forum topic">‹ Emonlib library with standalone atmega</a>
              <a href="11916.html" class="topic-next" title="Go to next forum topic">RSSI values always reporting as  &quot;RSSI: -2147483648&quot; - Unreliable content? ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-36648"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8839.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="joyrider3774&#039;s picture" title="joyrider3774&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: how does the button widget work ?</h3>

    <div class="submitted">Submitted by <a href="../user/8839.html" title="View user profile.">joyrider3774</a> on Thu, 03/12/2015 - 20:09.</div>
    <div class="content">
     <p abp="718">nevermind i got it working had to change source code, i can now succesfully change the value of a feed to 1 or 0&nbsp; using the button widget read from node-red and switch my plug on or off</p>
<p abp="718">&nbsp;</p>
<p abp="718">this post pointed me in the right direction: <a href="6394.html" title="http://openenergymonitor.org/emon/node/6394">http://openenergymonitor.org/emon/node/6394</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36651"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8839.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="joyrider3774&#039;s picture" title="joyrider3774&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: how does the button widget work ?</h3>

    <div class="submitted">Submitted by <a href="../user/8839.html" title="View user profile.">joyrider3774</a> on Thu, 03/12/2015 - 20:32.</div>
    <div class="content">
     <p abp="771">here&#39;s what i changed</p>
<p abp="771">in the button widget the render function (not sure if everything is needed):</p>
<p abp="773">function button_events()<br abp="774" /><br />
{<br abp="775" /><br />
&nbsp; $(&#39;.button&#39;).on(&quot;click&quot;, function(event) {<br abp="776" /><br />
&nbsp;&nbsp;&nbsp; var feedid = $(this).attr(&quot;feedid&quot;);<br abp="777" /><br />
&nbsp;&nbsp;&nbsp;<br abp="778" /><br />
&nbsp;&nbsp;&nbsp; if (associd[feedid] !== associd[feedid]) {<br abp="779" /><br />
&nbsp;&nbsp;&nbsp;&nbsp; if ($(this).attr(&quot;value&quot;) !== $(this).attr(&quot;value&quot;)) $(this).attr(&quot;value&quot;,0);<br abp="780" /><br />
&nbsp;&nbsp;&nbsp;&nbsp; associd[feedid] = $(this).attr(&quot;value&quot;);<br abp="781" /><br />
&nbsp;&nbsp;&nbsp;&nbsp; }<br abp="782" /><br />
&nbsp;&nbsp;&nbsp; var outval = 0;<br abp="783" /><br />
&nbsp;&nbsp;&nbsp; var invalue = associd[feedid][&#39;value&#39;]*1;</p>
<p abp="784">&nbsp;&nbsp;&nbsp; if ((invalue) == 0) outval = 1;<br abp="785" /><br />
&nbsp;&nbsp;&nbsp; if ((invalue) == 1) outval = 0;</p>
<p abp="786">&nbsp;&nbsp;&nbsp; feed.update(feedid,parseInt((new Date()).getTime()/1000),outval);<br abp="787" /><br />
&nbsp;&nbsp;&nbsp; $(this).attr(&quot;value&quot;,outval);</p>
<p abp="788">&nbsp;&nbsp;&nbsp; var id = &quot;can-&quot;+$(this).attr(&quot;id&quot;);<br abp="789" /><br />
&nbsp;&nbsp;&nbsp; draw_button(widgetcanvas[id], outval + 4);<br abp="790" /><br />
&nbsp;&nbsp;&nbsp; associd[feedid][&#39;value&#39;] = outval;<br abp="791" /><br />
&nbsp; });<br abp="792" /><br />
}</p>
<p abp="794">&nbsp;</p>
<p abp="794">in the modules\feed\feed.js add the following function between one of the others</p>
<p abp="794">&nbsp;</p>
<p abp="794">&#39;update&#39;:function(id, time, value)<br abp="829" /><br />
&nbsp;&nbsp; {<br abp="830" /><br />
&nbsp;&nbsp;&nbsp;&nbsp; var result = {};<br abp="831" /><br />
&nbsp;&nbsp;&nbsp;&nbsp; $.ajax({ url: path+&quot;feed/update.json&quot;, data: &quot;id=&quot;+id+&quot;&amp;time=&quot;+time+&quot;&amp;value=&quot;+value, async: false, success: function(data){} });<br abp="832" /><br />
&nbsp;&nbsp;&nbsp;&nbsp; return result;<br abp="833" /><br />
&nbsp;&nbsp; },</p>
<p abp="794">&nbsp;</p>
<p abp="794">and this is my flow for node red:</p>
<p abp="794">[{&quot;id&quot;:&quot;73bf269f.f3eff8&quot;,&quot;type&quot;:&quot;emoncms-server&quot;,&quot;z&quot;:&quot;bbadf73d.4c57f8&quot;,&quot;server&quot;:&quot;http://localhost:8083/emoncmsnew&quot;,&quot;name&quot;:&quot;wamp emoncms&quot;},{&quot;id&quot;:&quot;42a2eb3c.3c6578&quot;,&quot;type&quot;:&quot;wemo out&quot;,&quot;z&quot;:&quot;bbadf73d.4c57f8&quot;,&quot;ipaddr&quot;:&quot;192.168.0.114&quot;,&quot;name&quot;:&quot;&quot;,&quot;x&quot;:1195,&quot;y&quot;:474,&quot;wires&quot;:[]},{&quot;id&quot;:&quot;830fedae.c692&quot;,&quot;type&quot;:&quot;template&quot;,&quot;z&quot;:&quot;bbadf73d.4c57f8&quot;,&quot;name&quot;:&quot;&quot;,&quot;field&quot;:&quot;payload&quot;,&quot;format&quot;:&quot;handlebars&quot;,&quot;template&quot;:&quot;0&quot;,&quot;x&quot;:975,&quot;y&quot;:453,&quot;wires&quot;:[[&quot;42a2eb3c.3c6578&quot;]]},{&quot;id&quot;:&quot;9b5b4dec.514a5&quot;,&quot;type&quot;:&quot;template&quot;,&quot;z&quot;:&quot;bbadf73d.4c57f8&quot;,&quot;name&quot;:&quot;&quot;,&quot;field&quot;:&quot;payload&quot;,&quot;format&quot;:&quot;handlebars&quot;,&quot;template&quot;:&quot;1&quot;,&quot;x&quot;:973,&quot;y&quot;:514,&quot;wires&quot;:[[&quot;42a2eb3c.3c6578&quot;]]},{&quot;id&quot;:&quot;76275f8.c795ca&quot;,&quot;type&quot;:&quot;switch&quot;,&quot;z&quot;:&quot;bbadf73d.4c57f8&quot;,&quot;name&quot;:&quot;&quot;,&quot;property&quot;:&quot;payload&quot;,&quot;rules&quot;:[{&quot;t&quot;:&quot;lt&quot;,&quot;v&quot;:&quot;1&quot;},{&quot;t&quot;:&quot;gt&quot;,&quot;v&quot;:&quot;0&quot;}],&quot;checkall&quot;:&quot;true&quot;,&quot;outputs&quot;:2,&quot;x&quot;:774,&quot;y&quot;:500,&quot;wires&quot;:[[&quot;830fedae.c692&quot;],[&quot;9b5b4dec.514a5&quot;]]},{&quot;id&quot;:&quot;1a74170e.c52085&quot;,&quot;type&quot;:&quot;rbe&quot;,&quot;z&quot;:&quot;bbadf73d.4c57f8&quot;,&quot;name&quot;:&quot;&quot;,&quot;func&quot;:&quot;rbe&quot;,&quot;gap&quot;:&quot;&quot;,&quot;x&quot;:622,&quot;y&quot;:501,&quot;wires&quot;:[[&quot;76275f8.c795ca&quot;]]},{&quot;id&quot;:&quot;ef0ddc67.dff1a8&quot;,&quot;type&quot;:&quot;emoncms in&quot;,&quot;z&quot;:&quot;bbadf73d.4c57f8&quot;,&quot;name&quot;:&quot;Emoncms&quot;,&quot;emonServer&quot;:&quot;73bf269f.f3eff8&quot;,&quot;feedid&quot;:&quot;129&quot;,&quot;x&quot;:446,&quot;y&quot;:295,&quot;wires&quot;:[[&quot;d3e38c9f.01cf8&quot;,&quot;1a74170e.c52085&quot;]]},{&quot;id&quot;:&quot;d3e38c9f.01cf8&quot;,&quot;type&quot;:&quot;debug&quot;,&quot;z&quot;:&quot;bbadf73d.4c57f8&quot;,&quot;name&quot;:&quot;&quot;,&quot;active&quot;:false,&quot;console&quot;:&quot;false&quot;,&quot;complete&quot;:&quot;false&quot;,&quot;x&quot;:772,&quot;y&quot;:294,&quot;wires&quot;:[]},{&quot;id&quot;:&quot;f65cdd82.a5dd5&quot;,&quot;type&quot;:&quot;inject&quot;,&quot;z&quot;:&quot;bbadf73d.4c57f8&quot;,&quot;name&quot;:&quot;&quot;,&quot;topic&quot;:&quot;&quot;,&quot;payload&quot;:&quot;&quot;,&quot;payloadType&quot;:&quot;date&quot;,&quot;repeat&quot;:&quot;1&quot;,&quot;crontab&quot;:&quot;&quot;,&quot;once&quot;:true,&quot;x&quot;:223,&quot;y&quot;:294,&quot;wires&quot;:[[&quot;ef0ddc67.dff1a8&quot;]]}]</p>
<p abp="794">&nbsp;</p>
<p abp="794">&nbsp;</p>
<p abp="794">the only problem it&#39;s having is that emoncms does not detect if i switch off my light / wemo manually (so without using the button switch), i&#39;m going to try and see if i can edit my flow to check for this first and then change the value of the feed accordingly</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36667"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8839.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="joyrider3774&#039;s picture" title="joyrider3774&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: how does the button widget work ?</h3>

    <div class="submitted">Submitted by <a href="../user/8839.html" title="View user profile.">joyrider3774</a> on Thu, 03/12/2015 - 21:29.</div>
    <div class="content">
     <p abp="718">if you add this flow the status is updated on the button widget in emoncms so when i turn of my light using the wemo&nbsp;node red posts the value to emoncms, emoncms then logs this input value to the feed that the button is using. i even noticed the color changing on the button when i externally switch off my wemo insight either by my app on smartphone or manually change wemo state by clicking on the button on the wemo switch so using this flow as well as the flow i posted earlier everything gets updated and i can control the wemo insight from within emoncms</p>
<p abp="719">&nbsp;</p>
<p abp="721">[{&quot;id&quot;:&quot;73bf269f.f3eff8&quot;,&quot;type&quot;:&quot;emoncms-server&quot;,&quot;z&quot;:&quot;bbadf73d.4c57f8&quot;,&quot;server&quot;:&quot;http://localhost:8083/emoncmsnew&quot;,&quot;name&quot;:&quot;wamp emoncms&quot;},{&quot;id&quot;:&quot;3b4434ed.dcbce4&quot;,&quot;type&quot;:&quot;emoncms&quot;,&quot;z&quot;:&quot;bbadf73d.4c57f8&quot;,&quot;name&quot;:&quot;Emoncms&quot;,&quot;emonServer&quot;:&quot;73bf269f.f3eff8&quot;,&quot;nodegroup&quot;:&quot;15&quot;,&quot;x&quot;:773,&quot;y&quot;:68,&quot;wires&quot;:[]},{&quot;id&quot;:&quot;d67b323f.d1c408&quot;,&quot;type&quot;:&quot;template&quot;,&quot;z&quot;:&quot;bbadf73d.4c57f8&quot;,&quot;name&quot;:&quot;&quot;,&quot;field&quot;:&quot;payload&quot;,&quot;format&quot;:&quot;handlebars&quot;,&quot;template&quot;:&quot;lampcontrol:0&quot;,&quot;x&quot;:527,&quot;y&quot;:37,&quot;wires&quot;:[[&quot;3b4434ed.dcbce4&quot;]]},{&quot;id&quot;:&quot;9fee3a4c.7e9c18&quot;,&quot;type&quot;:&quot;template&quot;,&quot;z&quot;:&quot;bbadf73d.4c57f8&quot;,&quot;name&quot;:&quot;&quot;,&quot;field&quot;:&quot;payload&quot;,&quot;format&quot;:&quot;handlebars&quot;,&quot;template&quot;:&quot;lampcontrol:1&quot;,&quot;x&quot;:524,&quot;y&quot;:86,&quot;wires&quot;:[[&quot;3b4434ed.dcbce4&quot;]]},{&quot;id&quot;:&quot;e2c5e277.565c58&quot;,&quot;type&quot;:&quot;switch&quot;,&quot;z&quot;:&quot;bbadf73d.4c57f8&quot;,&quot;name&quot;:&quot;&quot;,&quot;property&quot;:&quot;payload&quot;,&quot;rules&quot;:[{&quot;t&quot;:&quot;eq&quot;,&quot;v&quot;:&quot;0&quot;},{&quot;t&quot;:&quot;eq&quot;,&quot;v&quot;:&quot;1&quot;}],&quot;checkall&quot;:&quot;true&quot;,&quot;outputs&quot;:2,&quot;x&quot;:308,&quot;y&quot;:73,&quot;wires&quot;:[[&quot;d67b323f.d1c408&quot;],[&quot;9fee3a4c.7e9c18&quot;]]},{&quot;id&quot;:&quot;be396fdb.75952&quot;,&quot;type&quot;:&quot;wemo in&quot;,&quot;z&quot;:&quot;bbadf73d.4c57f8&quot;,&quot;ipaddr&quot;:&quot;192.168.0.114&quot;,&quot;name&quot;:&quot;&quot;,&quot;x&quot;:110,&quot;y&quot;:76,&quot;wires&quot;:[[&quot;e2c5e277.565c58&quot;]]}]</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37811"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/689.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-689.jpg" alt="tgmaxx&#039;s picture" title="tgmaxx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: how does the button widget work ?</h3>

    <div class="submitted">Submitted by <a href="../user/689.html" title="View user profile.">tgmaxx</a> on Sun, 03/01/2016 - 19:42.</div>
    <div class="content">
     <p>joyrider3774,</p>
<p>I modified the&nbsp;two files with your changes (button_render.js and feed.js). The button widget now&nbsp;works as expected.</p>
<p>We should get the two files changed&nbsp;in&nbsp;the code for everyone.</p>
<p>Thanks,</p>
<p>Tom</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37817"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/689.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-689.jpg" alt="tgmaxx&#039;s picture" title="tgmaxx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: how does the button widget work ?</h3>

    <div class="submitted">Submitted by <a href="../user/689.html" title="View user profile.">tgmaxx</a> on Sun, 03/01/2016 - 22:19.</div>
    <div class="content">
     <p>I did some more testing and found that if not logged in, the button widget changes noted above do not work. Apparently due to the inability to update the data&nbsp;in the feed.&nbsp;I added&nbsp;the apikeystr (as in other functions in feed.js), but that doesn&#39;t&nbsp;work. How can I get/add the api write keyin&nbsp;feed.js?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37818"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8839.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="joyrider3774&#039;s picture" title="joyrider3774&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: how does the button widget work ?</h3>

    <div class="submitted">Submitted by <a href="../user/8839.html" title="View user profile.">joyrider3774</a> on Sun, 03/01/2016 - 22:32.</div>
    <div class="content">
     <p abp="898">i&#39;m confused how would you be able to click the button widget if you are not logged in ? unless you perhaps use the &quot;public&quot; dashboards thing ? i&#39;m not actually using that and whenever i might click the button i&#39;m logged in so for my needs it works. Just wondering how your using it then ?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37819"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/689.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-689.jpg" alt="tgmaxx&#039;s picture" title="tgmaxx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: how does the button widget work ?</h3>

    <div class="submitted">Submitted by <a href="../user/689.html" title="View user profile.">tgmaxx</a> on Sun, 03/01/2016 - 22:42.</div>
    <div class="content">
     <p>My&nbsp;emoncms&nbsp;is local, running&nbsp;on a Raspberry Pi.&nbsp;I can view dashboards and click the button when not logged in -&nbsp;it changes to the first color, but then reverts back to the original, because there is no feedback from the update function. Anyway, the more I thought about it, that is probably a good thing, because you don&#39;t want to control things if not logged in. It&#39;s a feature!</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37820"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8839.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="joyrider3774&#039;s picture" title="joyrider3774&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: how does the button widget work ?</h3>

    <div class="submitted">Submitted by <a href="../user/8839.html" title="View user profile.">joyrider3774</a> on Sun, 03/01/2016 - 23:01.</div>
    <div class="content">
     <p abp="928">ah i&#39;m also running a local version although on windows, never knew you could access the dashboards when not logged in i thought they had to be set to public or something. Anyway i was think the same thing, my emoncms installation is accessible from to internet and don&#39;t want anyone that might find out a way to display the dashboards to be able to press the button. So i think it&#39;s indeed safer if you need to be logged in, in order to be able to change the feed value</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37822"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/689.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-689.jpg" alt="tgmaxx&#039;s picture" title="tgmaxx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: how does the button widget work ?</h3>

    <div class="submitted">Submitted by <a href="../user/689.html" title="View user profile.">tgmaxx</a> on Mon, 04/01/2016 - 01:21.</div>
    <div class="content">
     <p>All,</p>
<p>I tried to publish&nbsp;a MQTT message to a Node-Red flow&nbsp;when a button press causes the input to change. That makes more sense than always polling the feed for a change from Node-Red.&nbsp;But, I found the input never changes value, even though the feed does change (0 to 1 to 0....).</p>
<p>Since the input doesn&#39;t change, it never sends a MQTT message. Does anyone have an&nbsp;idea why the input doesn&#39;t change on a button press? That&#39;s what needs to happen so we can publish to&nbsp;MQTT on press.</p>
<p>Thanks,</p>
<p>Tom</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37832"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8839.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="joyrider3774&#039;s picture" title="joyrider3774&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: how does the button widget work ?</h3>

    <div class="submitted">Submitted by <a href="../user/8839.html" title="View user profile.">joyrider3774</a> on Mon, 04/01/2016 - 12:49.</div>
    <div class="content">
     <p>tgmax, the reason is that the update function uses the feed api to change the feed value if you want have the input changed use the input api insead in the update function but i don&#39;t think that&#39;s possible since you don&#39;t actually know the input id you only know the feed id thus the reason it&#39;s using the feed api and not the input api&nbsp; and why the input never changes nor a mqtt message is send. I don&#39;t think you can get the input id based on a feed id</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37833"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/689.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-689.jpg" alt="tgmaxx&#039;s picture" title="tgmaxx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: how does the button widget work ?</h3>

    <div class="submitted">Submitted by <a href="../user/689.html" title="View user profile.">tgmaxx</a> on Mon, 04/01/2016 - 13:06.</div>
    <div class="content">
     <p>I found a solution to get MQTT&nbsp;messages -- I used a virtual feed, with a &quot;Source Feed&quot; of the button feed,&nbsp;and &quot;Publish to MQTT&quot; in the virtual feed&#39;s Process list.</p>
<p>I get MQTT messages about every 2 to&nbsp;5&nbsp;seconds,&nbsp;regardless if the button has been pressed. But when pressed, the state updates and I get the correct value, 0 or 1, in the message.</p>
<p>I created the initial feed using a Node-Red flow, having a Emoncms node configured with the node number I wanted.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11728"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-8-jB7HgsF47V15PFSyr7mLcf2W7eAKPAdQ7H3RzlI54" value="form-8-jB7HgsF47V15PFSyr7mLcf2W7eAKPAdQ7H3RzlI54"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
