<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/1103 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:07:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Fusion of the MK2 controller with the emonGLCD  | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/3.html">Archived: General Discussion</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Fusion of the MK2 controller with the emonGLCD </h3>
        <span class="submitted">Submitted by <a href="../user/1399.html" title="View user profile.">Series530</a> on Sun, 30/09/2012 - 08:55</span>
        <div class="content"><p>The MK2 controller and a bit more</p>
<p>My initial goal was to devise a PV dump controller as I already have several energy monitors. I stumbled across open energy monitor by accident and got rather interested in the fact that it is possible to measure the actual system export and not just the import (a failing of many systems that I already have). Having never played about with micro controllers but being familiar with real time programming and system control I saw a fusion of a PV dump controller with an energy monitor as an interesting project.<br />
	I decided to base my work upon calypso rae&#39;s (AKA Robin) energy bucket principle. My starting point was Robin&#39;s mark 2 software and I have added additional capability to it for energy monitoring and remote display.&nbsp; My circuit uses the emonTX kit (arduino) with a few LED&#39;s.</p>
<p><img alt="" src="../../../i36.photobucket.com/albums/e28/fmfm20j/P9087480.jpg" /></p>
<p><strong>The emonTX&nbsp;showing the LED&#39;s and the monitoring jacks. I&#39;ve since added a port extender so that the it can be programmed without unscrewing the front panel from the case.</strong></p>
<p>I use the high voltage control circuit that Robin has in his design and I have added connectivity to the EmonGLCD. The emonGLCD is the stock kit without modification. As you will be able to see in the pictures I have installed both units in plastic enclosures. The emonTX, which sits in the garage, is more a functional presentation than an elegant unit.</p>
<p>&nbsp;</p>
<p><img alt="" src="../../../i36.photobucket.com/albums/e28/fmfm20j/P9307566.jpg" /></p>
<p><strong>The emonTX&nbsp;wall mounted in the garage. The 3.5mm jack at the front is the triac fire feed</strong></p>
<p>I decided to&nbsp; isolate the high voltage section from the emonTX enclosure. A 3.5mm jack plug takes the 3.3V power and control trigger along a 15 metre or so cable to the airing cupboard. The high voltage circuit is mounted within a large section of aluminium extrusion which acts both as a heat sink and as protection from small fingers. I&#39;ve added an isolating switch in series with the feed to the immersion heater. As we never use the immersion heater aside from PV dump there is no bypass arrangement. The whole extrusion is mounted upon a hardwood board and then screwed to the wall. The hardwood has flame retardant properties and acts as an additional safe guard.</p>
<p><img alt="" src="../../../i36.photobucket.com/albums/e28/fmfm20j/P9087484.jpg" style="width: 800px; height: 600px; " /></p>
<p>I&#39;ve made more effort with the emonGLCD as this unit sits in my home office and is seen by the family and friends.</p>
<p><img alt="" src="../../../i36.photobucket.com/albums/e28/fmfm20j/P9077475.jpg" /></p>
<p><strong>The emonGLCD showing the system heating the hot water. The mains voltage isn&#39;t quite as high as indicated. That error has since been addressed</strong></p>
<p>
	In Robin&#39;s design he focuses upon the energy bucket. While I use that software to control the PV dump I also measure the power generated or consumed at the point of measurement.&nbsp; Measured&nbsp; information is transmitted by the RF12 wireless interface on the emonTX to the emonGLCD every four seconds where this information is displayed. With a view to trying to get an accurate representation of the power used or exported a certain amount of calibration of the current and voltage sensors is performed when the system first boots.<br />
	The emonGLCD displays the power that the system sees, the energy bucket level, the number of triac fires taking place during the measurement interval and the unit temperature. The GLCD LED&#39;s are programmed to shine green when exporting and red when importing from the grid. The unit senses the ambient light and brightens the screen when the light levels are high and dims the screen and inhibits the LED&#39;s when the light level is low. Both the TX and the GLCD maintain a heart beat feature to show when a hand shake transmission has taken between the two units irrespective of ambient light level.</p>
<p>&nbsp;</p>
<p><img alt="" src="../../../i36.photobucket.com/albums/e28/fmfm20j/P9077477.jpg" style="width: 800px; height: 600px; " /></p>
<p><strong>This is the emonGLCD&nbsp;when importing. The soft focus isn&#39;t for romantic effect. One of my enviR monitors is sitting next to it. This one monitors PV generation and wont correlate with the GLCD</strong></p>
<p>The emonTX has LED&#39;s which indicate when the system is exporting, importing and a signal is being sent to fire the triac as well as the heart beat already mentioned. Strictly speaking, these LEd&#39;s are not required but they do act as a decent visual indicator with regard to operation. As the dumper is close to the electricity supply meter, I can visually correlate import, export and triac fire with the supply meter LED going green without having to turn on the serial monitor and read the data being sent. Given that a serial monitor transmission takes a little time from the loop, just running with the LED&#39;s and periodically checking the GLCD display is a more representative account of the system under normal operating conditions than with a serial monitor which is sometimes enabled or otherwise disabled when debugging is not taking place.</p>
<p>&nbsp;</p>
<p>Limitations:</p>
<p>&nbsp;</p>
<p>As with any project, there are always improvements to be made. Rather than continuing forever I thought it better to offer the design and the sketch so that others can use or learn from it.</p>
<p>
	The key areas where improvements could be made are in the accuracy of the power monitor. As many have demonstrated, it&#39;s actually quite difficult to measure the power accurately with a vanilla design of the emonTX. I didn&#39;t want to get too heavily involved in instrumentation electronics as this is too much like my day job. I feel that the huge range of current measurement required together with the design of the kit and the relatively poor resolution of the arduino makes really accurate measurement over the whole usage range a pretty tough ask. This is in no way a criticism of the design of the kit or the choice of components. It&#39;s simply a function of cost against performance. With this in mind I decided to take a different tack with regard to accuracy: One of my other monitors consists of an enviR display with an optismart pulse reader. I&#39;ve found this unit to correlate well with my PV meter and I have extensively scatter plotted this against the emon and applied a curve fit algorithm in my code. The emon correlates to within about 20W of the optismart from 250w right through to about 4Kw.</p>
<p>&nbsp;</p>
<p>As I sit here now, the emon is measuring 396W and the enviR is measuring 407W. If I turn on the electric grill the emon reads 2364 and the enviR is on 2380.</p>
<p>&nbsp;</p>
<p>As the pictures show, my emonTX has some voltage and current monitoring jacks on the front. Measurement of quiescent current in our house is pretty difficult as the signal is both low in amplitude and pretty noisy.</p>
<p><img alt="" src="../../../i36.photobucket.com/albums/e28/fmfm20j/P8257432.jpg" /></p>
<p><strong>Low household load showing voltage transformer monitor with current superimposed. Noise dominates and the current is barely sinusoidal and pretty difficult to accurately measure</strong></p>
<p>With a low nyquist sampling frequency there is huge opportunity for loss of information and aliasing. I&#39;ve added nothing to the circuit to deal with this so it&#39;s asking a lot for the arduino to do a good job with just an amp or two of incoming current. Much easier, I feel, for it to deal with a higher resistive load such as a toaster, a grill or an oven where the background noise is far less than the fundamental of the current waveform.</p>
<p>&nbsp;</p>
<p><img alt="" src="../../../i36.photobucket.com/albums/e28/fmfm20j/P8257438.jpg" style="width: 800px; height: 600px; " /></p>
<p>Huge thanks go to calypso_rae for not only providing the foundation of one of the sketches (and the concept which fuels it) but also for being patient in answering the many questions that I asked him during the development.</p>
<p>They are still a little bit work in progress but here are the sketches as they stand (if I don&#39;t publish them now, they will never get uploaded!)</p>
<p>&nbsp;</p>
<p>Here&#39;s the modifications to the emonTX kit, the high voltage circuitry and the cabling. The emonGLCD kit doesn&#39;t need modification. The plastic enclosures came from Maplin.</p>
<p>Note, there is a minor error in the schematic below, the IO lines for the red and green LED&#39;s should be swapped over.</p>
<p><img alt="" src="../../../i36.photobucket.com/albums/e28/fmfm20j/Schematic.png" /></p>
  <div class="forum-topic-navigation clear-block">
          <a href="1595.html" class="topic-previous" title="Go to previous forum topic">‹ New to emonCMS</a>
              <a href="1561.html" class="topic-next" title="Go to next forum topic">VOTE for OpenEnergyMonitor in Postscapes best Internet of Things Project 2012 ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-6452"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/317.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-317.jpg" alt="Sergegsx&#039;s picture" title="Sergegsx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/317.html" title="View user profile.">Sergegsx</a> on Sun, 30/09/2012 - 15:39.</div>
    <div class="content">
     <p>Amazing setup !! Congrats !</p>
<p>Thanks for sharing info and pictures.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6456"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/450.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="stuart&#039;s picture" title="stuart&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/450.html" title="View user profile.">stuart</a> on Mon, 01/10/2012 - 08:36.</div>
    <div class="content">
     <p>I&#39;ve been working on a similar setup, links over here...</p>
<p><a href="1002.html" title="http://openenergymonitor.org/emon/node/1002">http://openenergymonitor.org/emon/node/1002</a></p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6479"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Sleepwalker&#039;s picture" title="Sleepwalker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by Sleepwalker (not verified) on Tue, 02/10/2012 - 19:06.</div>
    <div class="content">
     <p>This is really good especially as it uses the existing kit. yet seems to have slipped by the forum un-noticed. I&#39;m running this as my sketch at the moment but without the switching circuit added yet, i&#39;ll do that later in the week.</p>
<p>a couple of minor issues, I&#39;m not too keen on the display preferring the layout of the old one, particulary as it had the accumulated readings for the day and the current time. could you not adapt that and add the energy bucket &amp; firing pulses where the min &amp; max temp used to be.</p>
<p>Do you intend including the Emonbase code in the sketch for sending the data over the interweb?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6483"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1399.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1399.jpg" alt="Series530&#039;s picture" title="Series530&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1399.html" title="View user profile.">Series530</a> on Wed, 03/10/2012 - 05:01.</div>
    <div class="content">
     <p>&nbsp;</p>
<p>Thanks for the positive comments. The thread didn&#39;t seem to catch many people&#39;s eye and I am pleased that a few people like what I have done.</p>
<p>I&#39;d be happy to add any features that people request if they are possible with the existing hardware. As I already upload usage data using the enviR I haven&#39;t really considered integrating a bridge to the web using this system. If there is a way to get date and time using what I have I will be pleased to introduce it. If there isn&#39;t and I have to buy an emonbase ii will need to think about it a little bit before taking the plunge. If there is sufficient interest there&#39;s a more than reasonable chance that I could &nbsp;spending more money and getting my soldering iron out again.</p>
<p>Does anybody know of a way to get time and date information with just the TX and GLCD units.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6484"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1095.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="nbown&#039;s picture" title="nbown&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1095.html" title="View user profile.">nbown</a> on Wed, 03/10/2012 - 07:54.</div>
    <div class="content">
     <p>very good work, i&nbsp;see that you can a get an arduino rtc shield from ebay for fiver, it may be worth a look.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6760"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Sleepwalker&#039;s picture" title="Sleepwalker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by Sleepwalker (not verified) on Thu, 18/10/2012 - 16:03.</div>
    <div class="content">
     <p>Hi,</p>
<p>	Back again - Circuit made and in place, but without the LEDs. I just need to ask a few simple questions before I commit myself to switch on.</p>
<p>	Firstly I&#39;m new to c++ and am finding it strange trying to follow, let alone alter so some of the questions may seem basic.</p>
<p>	Where (on the emonTx board) are you picking up your trigger pulse from, looking at the circuit schematic i&#39;m thinking that pin 15 IO9 of the chip goes to SPI/ISP pin 8 for the output. But this is also the onboard LED so what happens to that? 3v3 from pin 1 of the same SPI/ISP</p>
<p>	Does it matter if I have a type 1 or type 2 PV installation</p>
<p>	Which Channels do you have you CT&#39;s Connected to. I&#39;m 1 consumption, 2 PV generation, yours in the photo are 1 &amp; 2 yet you are using 1 &amp; 3 in the sketch or have i got that completely wrong.</p>
<p>	As I haven&#39;t been running the sketch with the firing cct connected, should I ever see the energy bucket reduce.<br />
	It remains at 3600j, the display always shows grid (is this because of line 326) and the red led always on, never green apart from at boot up.</p>
<p>&nbsp;</p>
<p>Thanks</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6784"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1095.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="nbown&#039;s picture" title="nbown&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1095.html" title="View user profile.">nbown</a> on Fri, 19/10/2012 - 10:08.</div>
    <div class="content">
     <p>My understanding is that you need DIO5 for this setup.&nbsp;I asked Ian the same question only a few days ago.</p>
<p>it&#39;s the purple wire close to the AC jack in the above images&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6788"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1399.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1399.jpg" alt="Series530&#039;s picture" title="Series530&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1399.html" title="View user profile.">Series530</a> on Fri, 19/10/2012 - 18:55.</div>
    <div class="content">
     <p>Sorry, I&#39;ve been away on another business trip and just noticed your questions:</p>
<p><em>Where (on the emonTx board) are you picking up your trigger pulse from, looking at the circuit schematic i&#39;m thinking that pin 15 IO9 of the chip goes to SPI/ISP pin 8 for the output. But this is also the onboard LED so what happens to that? 3v3 from pin 1 of the same SPI/ISP</em></p>
<p>&nbsp;</p>
<p>It&#39;s a little confusing because my code tries to retain compatibility with the hardware that Robin is using. In Robins design he uses a different trigger to mine. If you use DIO5 as Nigel suggested it should work fine.</p>
<p><em>Does it matter if I have a type 1 or type 2 PV installation</em></p>
<p>I&#39;m&nbsp;sorry, I don&#39;t know the difference between the two. If it&#39;s of any help, my system is a 3.5KWp installation using micro inverters. As far as any current transformers are concerned, they simply sit on an AC tail.</p>
<p><em>Which Channels do you have you CT&#39;s Connected to. I&#39;m 1 consumption, 2 PV generation, yours in the photo are 1 &amp; 2 yet you are using 1 &amp; 3 in the sketch or have i got that completely wrong.</em></p>
<p>Sorry to confuse you again. Initially, I was planning to build an energy monitor which monitored incoming as well as generation data and, in addition, provided the PV dump control. So I purchased two current transformers with this in mind. Having spent many a while conversing with Robin I became concerned that reading three ADC inputs per loop was going to dilute the accuracy of the energy bucket far more than just reading a single voltage and a single current reading. In any case, I have EnviR monitors which can monitor my solar generation. Thus, one of the clamps does nothing and hasn&#39;t been coded. You can use which ever input you like. You simply need to re-assign the ADC number in the variables CT1, CT2 and CT3.</p>
<p><em>As I haven&#39;t been running the sketch with the firing cct connected, should I ever see the energy bucket reduce.<br />
	It remains at 3600j, the display always shows grid (is this because of line 326) and the red led always on, never green apart from at boot up.</em></p>
<p>I very much doubt that the energy bucket value will drop because it needs a dump load connected in order for the loop to work. I&#39;ve seen that when the system is firing and power is being dumped the energy bucket value will drop and hover around 1800 joules. Once you reach a point where the immersion heater has charged the tank fully and no more current is taken by it, the energy bucket will climb to 3600 again.</p>
<p>The unit will always show grid because this is the only measurement that the unit makes. The plan was to monitor the solar generation as I said earlier but, so far at least, I haven&#39;t implemented it. Having the enviR, I doubt if I ever will.</p>
<p>The momentary turning on of the lights in sequence in boot up is deliberate. It provides a visual diagnostic as the system monitors anc calibrates each of the sensor inputs.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6800"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1095.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="nbown&#039;s picture" title="nbown&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1095.html" title="View user profile.">nbown</a> on Sat, 20/10/2012 - 20:32.</div>
    <div class="content">
     <p>sleepwalker are up and running?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6801"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1399.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1399.jpg" alt="Series530&#039;s picture" title="Series530&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1399.html" title="View user profile.">Series530</a> on Sat, 20/10/2012 - 20:37.</div>
    <div class="content">
     <p>I&#39;ve found a problem with the sketch that I have posted for the emonTX. I&#39;m in the process of fixing it and also addressing some other shortfalls that I have noticed with the calibration.</p>
<p>I plan to have a fixed and, hopefully, improved version very soon.</p>
<p>Ian</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6812"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Sleepwalker&#039;s picture" title="Sleepwalker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by Sleepwalker (not verified) on Sun, 21/10/2012 - 20:27.</div>
    <div class="content">
     <p>Hi, nbown not up and running yet - been out and running instead, weather too good to spend indoors. Might take a look tomorrow</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6813"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Sleepwalker&#039;s picture" title="Sleepwalker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by Sleepwalker (not verified) on Sun, 21/10/2012 - 20:45.</div>
    <div class="content">
     <p>Thanks series 530,&nbsp; I&#39;ll take a look again tomorrow.</p>
<p>Type 1 or 2 PV&nbsp; are shown on this page <a href="../applications/solarpv.html" title="http://openenergymonitor.org/emon/applications/solarpv">http://openenergymonitor.org/emon/applications/solarpv</a> but i&#39;ve since realised&nbsp; you use neither but just monitor the incoming power.</p>
<p>the rest are just confusion on my part&nbsp; I thought you were using 2 CT clamps so that you could monitor PV and that green LED&#39;s would show excess generation. I&#39;ll have to look to add that myself sometime or look to using the energy monitor sketch.</p>
<p>Ta</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6816"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1399.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1399.jpg" alt="Series530&#039;s picture" title="Series530&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1399.html" title="View user profile.">Series530</a> on Mon, 22/10/2012 - 06:51.</div>
    <div class="content">
     <p><em>I thought you were using 2 CT clamps so that you could monitor PV and that green LED&#39;s would show excess generation. I&#39;ll have to look to add that myself sometime or look to using the energy monitor sketch.</em></p>
<p>&nbsp;</p>
<p>I&#39;m working on an addition that allows dual measurement with two clamps. It&#39;s functional but I&#39;m not especially happy with the error against my reference monitor at this point in time.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6818"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1095.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="nbown&#039;s picture" title="nbown&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1095.html" title="View user profile.">nbown</a> on Mon, 22/10/2012 - 12:06.</div>
    <div class="content">
     <p>How difficult would it be to add the facility of when the tank is up to temp. (open circuit) to divert to another source such as a heater for example?</p>
<p>Nigel</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6819"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1927.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="divad&#039;s picture" title="divad&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1927.html" title="View user profile.">divad</a> on Mon, 22/10/2012 - 11:05.</div>
    <div class="content">
     <p>Hi I am new to this forum.&nbsp;</p>
<p>I have had my PV system for about 18 months and been looking at ways of monitoring with meaningful displays and using the spare electricity. Upto now none of the systems on the market have done all that I want. Looking at this thread Ian,s system seems to be ideal. I am capable of soldering PCBs etc and understand mains wiring but the electronics and computing that I understand are well out of date.</p>
<p>So the first question is do you think I will be able to build and program these.</p>
<p>My system has a max generation of 3.6 KW, Sunny Boy 4000 Inverter south west facing most productive time in afternoon.</p>
<p>I have an Economy seven Tank with two immersion heaters bottom and 2/3 up and also an indirect loop to gas boiler for topping up. At the moment I use the cheap rate economy seven electricity to heat the tank from the bottom immersion overnight this works without having to top up during the day.</p>
<p>My idea would be to use spare solar on bottom immersion and cheap rate at night on top immersion and if possible do what Nigel is asking divert to a storage heater any spare surplus. Unless people who read this have any other ideas.</p>
<p>My PV system is wired through a spare in my consumer unit making it a type 2 system.</p>
<p>David&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6820"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1095.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="nbown&#039;s picture" title="nbown&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1095.html" title="View user profile.">nbown</a> on Mon, 22/10/2012 - 21:08.</div>
    <div class="content">
     <p>David,</p>
<p>Firstly welcome to the forum.</p>
<p>Until a few months ago in had not done any programming or soldiering for 20 years, it&rsquo;s not that difficult, and there is plenty of help here. Loading the software is pretty straight forward.</p>
<p>The route that I have gone down is to buy the emon kit, I bought all 3 units, emontx (that&rsquo;s the part that sit next to the fuse box and gathers the data) the second is emon GLCD to display the data sent wirelessly and thirdly the emonbase which I have not used to its full.<br />
	I have all this up and running as an energy monitor system with no problems. My next step is to use what I&rsquo;ve got we some mods to divert the energy that I&rsquo;m exporting to heat my hot water.</p>
<p>Robin&rsquo;s mk2 controller dose just that very well but, does not use the emon bits. And some people have added a display on top of that. My understanding is that the MK2 works with type 1 or 2 systems.</p>
<p>With Ian&rsquo;s system this uses the emon kit as the main source of the hardware, which I already have. but you don&#39;t need the emonbase. The software is based on the mk2 . I&rsquo;ve have not got my system up and running yet but&nbsp;I&#39;m very close.</p>
<p>Whichever route you choose to go down you will need to consider.&nbsp; How to connect to your immersion? Wireless is to slow (but not impossible), you will need a cable. I ran a cat5 cable smaller and easier to route, you can run twin and earth so that you have a separate supply, or if you luckily you got that installed already.</p>
<p>Nigel</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6822"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1927.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="divad&#039;s picture" title="divad&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1927.html" title="View user profile.">divad</a> on Mon, 22/10/2012 - 15:27.</div>
    <div class="content">
     <p>Thanks for the quick response&nbsp;Nigel&nbsp;</p>
<p>I have been sorting out my soldering iron station and tools. (They where resting in the Attic)</p>
<p>Looking at the shop am I best purchasing&nbsp;Solar PV Monitor Kit Bundle 868Mhz (Europe only) UK plug which seems to have all in it to do Ian&#39;s&nbsp;system and then purchasing locally CPC the Triac&nbsp;etc after I have got the Emon&nbsp;kit working.</p>
<p>I already have 2 separate 2.5s going to the immersions.&nbsp;</p>
<p>David</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6826"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1095.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="nbown&#039;s picture" title="nbown&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1095.html" title="View user profile.">nbown</a> on Mon, 22/10/2012 - 21:15.</div>
    <div class="content">
     <p>David,</p>
<p>Looks good don&#39;t forget to buy the&nbsp;USB to UART programmer, for uploading Arduino software sketches and reading serial data</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6831"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1399.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1399.jpg" alt="Series530&#039;s picture" title="Series530&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1399.html" title="View user profile.">Series530</a> on Tue, 23/10/2012 - 11:48.</div>
    <div class="content">
     <p>Welcome David,</p>
<p>&nbsp;</p>
<p>although my background is in electronics and control its all to do with low power stuff. Controlling power electronics and programming micro controllers has been alien to me. It isn&#39;t difficult though and is well worth the effort. Why spend several hundred pounds on a system that a third party designs and forbids you to customise when you can spend substantially less, learn a lot and still have the ability to adapt as you see fit?</p>
<p>&nbsp;</p>
<p>Just to give followers of this thread an update: I have fixed the problems that I had with the calibration of my rig and have added a few additional features. I now have a secondary monitor functioning but have yet to successfully calibrate this second channel against my reference. The ultimate plan is to be able to monitor grid and solar power reasonably accurately, display the results on the emonGLCD&nbsp;and control a PV dump at the same time. Testing of what I have so far corrected and improved is in progress.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6832"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1399.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1399.jpg" alt="Series530&#039;s picture" title="Series530&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1399.html" title="View user profile.">Series530</a> on Tue, 23/10/2012 - 11:56.</div>
    <div class="content">
     <p>On the issue of the divert, in principle, its quite easy: if the software detects and excess of PV which would ordinarily dump power to the immersion heater but, over a monitoring interval, the energy bucket remained full, it would indicate that the dump load is open circuit. That being the case another IO line could be used to switch a different triac so as to route the power elsewhere and the process would then be repeated.</p>
<p>It isn&#39;t something that I&#39;m planning to add to my design because I don&#39;t need a secondary source into which to dump power.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6835"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1927.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="divad&#039;s picture" title="divad&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1927.html" title="View user profile.">divad</a> on Tue, 23/10/2012 - 16:13.</div>
    <div class="content">
     <p>Thanks Ian</p>
<p>I am purchasing the Kit&nbsp;Solar PV Monitor Kit Bundle 868Mhz (Europe only) UK plug along with a&nbsp;USB to UART programmer as Nigel reminded me. CPC is close to where I live so getting the other items shouldn&#39;t be difficult but can wait until I have the monitoring system working.</p>
<p>My background has been in Telecoms but always an interest in automating processes so they work in the background without intervention. However it has been a long time since I did any PCB work but am looking forward to doing this project. Your system seems to match all what I want to see to control and display a PV system using all or nearly all of the electricity generated.</p>
<p>&nbsp; &nbsp;David</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6856"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Thu, 25/10/2012 - 20:45.</div>
    <div class="content">
     <p><em>Nigel: How difficult would it be to add the facility of when the tank is up to temp. (open circuit) to divert to another source such as a heater for example?</em></p>
<p>As posted, my Mk2 circuit diverts power to the dump load whenever the level in the energy accumulator gets to 1800J.&nbsp; If the thermostat were to open, then the energy level would rapidly rise because there is no longer any load to consume any surplus power.&nbsp;</p>
<p>A secondary load could easily be included by defining a second threshold (e.g. 2200J)&nbsp; at which point surplus energy would be sent to the second circuit, via a second trigger and triac.</p>
<p>By this means, the priority of the two loads is maintained.&nbsp; If some DHW is run off and the primary stat opens, then surplus power will once more be sent in that direction.</p>
<p>Sadly, this is summer talk, it&#39;s been several days since we had any hot water worth speaking of :(</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7066"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1399.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1399.jpg" alt="Series530&#039;s picture" title="Series530&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1399.html" title="View user profile.">Series530</a> on Wed, 07/11/2012 - 05:13.</div>
    <div class="content">
     <p>It&#39;s been a while since I posted on this topic. I want to assure anyone who is following this topic that work is still on going. A few of us are running trials with a new version of the software and the results are encouraging.</p>
<p>&nbsp;</p>
<p>i hope to post new sketches for both the emonTX and the emonGLCD in the coming week or so.</p>
<p>If any one else would like to participate in the beta trials, please send me a private message which includes an email address and I will send them the sketches.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7263"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="jeffreyross25&#039;s picture" title="jeffreyross25&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by jeffreyross25 (not verified) on Wed, 14/11/2012 - 12:07.</div>
    <div class="content">
     <p>SPAM POST partly dealt with, account blocked. <em>[RW]</em></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7265"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1774.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1774.jpg" alt="PaulOckenden&#039;s picture" title="PaulOckenden&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1774.html" title="View user profile.">PaulOckenden</a> on Wed, 14/11/2012 - 12:48.</div>
    <div class="content">
     <p>Grr...</p>
<p>So annoying when you get excited because you&#39;re waiting for an update on a topic. You see &nbsp;a new message - AT LAST.&nbsp;</p>
<p>&nbsp;</p>
<p>And then it turns out to be spam.</p>
<p>&nbsp;</p>
<p>P.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7266"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Wed, 14/11/2012 - 13:05.</div>
    <div class="content">
     <p>If you&#39;re referring to the message at 12:07, at least someone is paying an intelligent interest in the construction details.&nbsp; Some maverick postings are a lot less on-topic!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7267"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1095.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="nbown&#039;s picture" title="nbown&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1095.html" title="View user profile.">nbown</a> on Wed, 14/11/2012 - 14:16.</div>
    <div class="content">
     <p>and the mailing at 13:07</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7273"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Wed, 14/11/2012 - 16:56.</div>
    <div class="content">
     <p>I think there&#39;s a problem with the time-stamping.&nbsp; My screen shows:&nbsp;</p>
<p>Submitted by <a href="../user/2220.html" title="View user profile.">jeffreyross25</a> on Wed, 14/11/2012 - 12:07.</p>
<p>Submitted by <a href="../user/1774.html" title="View user profile.">PaulOckenden</a> on Wed, 14/11/2012 - 12:48.</p>
<p>Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Wed, 14/11/2012 - 13:05.</p>
<p>Submitted by <a href="../user/1095.html" title="View user profile.">nbown</a> on Wed, 14/11/2012 - 14:16.</p>
<p>The system doesn&#39;t deal with time-changes automatically, the +/- 1hr shift has to be entered manually in one&#39;s Profile.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7275"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1774.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1774.jpg" alt="PaulOckenden&#039;s picture" title="PaulOckenden&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1774.html" title="View user profile.">PaulOckenden</a> on Wed, 14/11/2012 - 17:47.</div>
    <div class="content">
     <p>I suspect nbrown&#39;s time zone isn&#39;t set correctly in his/her profile.</p>
<p>Actually, I reckon probably half of the people here are on the wrong TZ, as the site doesn&#39;t have an auto DST. You can probably tell whether people first joined in the summer or winter by checking whether they are an hour out or not!&nbsp;</p>
<p>P.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7276"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1095.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="nbown&#039;s picture" title="nbown&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1095.html" title="View user profile.">nbown</a> on Wed, 14/11/2012 - 18:37.</div>
    <div class="content">
     <p>I&nbsp;stand corrected, and have changed my profile settings.</p>
<p>for all those waiting to see something on this tread, i have uploaded my data on to cms. here&#39;s the link. it&#39;s only basic but you can see when the sun is out and triac is firing.</p>
<p><a href="http://www.emoncms.org/nbown/">http://www.emoncms.org/nbown/</a>&nbsp; it dose not work well in IE, i use Chrome</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7279"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1399.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1399.jpg" alt="Series530&#039;s picture" title="Series530&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1399.html" title="View user profile.">Series530</a> on Wed, 14/11/2012 - 19:08.</div>
    <div class="content">
     <p>The sketches are still work in progress but, as Nigel has had success with the latest ones and as I know that they work on my rig I&#39;ll post up the latest ones.</p>
<p>The area where there is still some issue is in the calibration of the power measurements vs. a known reference. I have published in the sketch some calibration constants (line fits) which bring the measurements into line with what I see on my enviR pulse monitors. They may or may not be suitable for everyone. What I did with mine was to compare what the enviR pulse monitor saw as steady state power under 45 conditions of varying grid load and solar generation (90 in total) with what the emonTX measured. I loaded these values into excel (enviR on X axis and emon on Y) and produced a scatter plot. From there I produced a line fit and have implemented this in my sketch. So, what the emon reads is transformed with a Y=mX+c into something closer to the enviR. The enviR, I know, is pretty accurate based upon previous correlation exercises.</p>
<p>&nbsp;</p>
<p>On Monday evening I tried cross correlating these curve fits with a wire loop/light bulb measurement technique that many others have used. The results were less than flattering. My line fits against the enviR proved to be much closer than using 7 sets of coiled wire and a 100W light bulb.&nbsp;</p>
<p>&nbsp;</p>
<p>I&#39;m not saying that my approach is better. Simply that it gives different results. In many respects the sketches give the wrapper to control the emonTX, transmit the data and for the emonGLCD to display them them.</p>
<p>&nbsp;</p>
<p>Please feel free to having a try with the latest ones and see how you get on... you may need to play about with the calibration though!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7280"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1399.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1399.jpg" alt="Series530&#039;s picture" title="Series530&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1399.html" title="View user profile.">Series530</a> on Wed, 14/11/2012 - 19:10.</div>
    <div class="content">
     <p>Some files would be useful ...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7288"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 15/11/2012 - 00:15.</div>
    <div class="content">
     <p>Attention All,</p>
<p>Please make sure you don&#39;t <strong><em>reply</em></strong> to a spam post. If anyone does, when I put on my moderator&#39;s hat and delete it, all subsequent replies will be deleted too. I can&#39;t help that.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8012"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1399.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1399.jpg" alt="Series530&#039;s picture" title="Series530&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1399.html" title="View user profile.">Series530</a> on Thu, 06/12/2012 - 18:23.</div>
    <div class="content">
     <p>I feel its time to provide the forum with an update. I have been working on these sketches in the background. The issue has been spare time.</p>
<p>I had wanted to include the Elster AC100 read routines in my sketches. Try as I did I failed to get that running. I was able to read the meter successfully but as soon as I added code to detach the interrupt and later re-attach it, the readings no longer came through. In the end, for now at least, I gave up on that idea. So, if you were holding out for that, my sincere apologies but I failed miserably on that score (but I haven&#39;t given up hope completely!)</p>
<p>&nbsp;</p>
<p>So, I would like to offer what I have to the forum again. The code is heavily revised and has a few additional features:</p>
<ul>
<li>
		It is still a fusion of Robins PV software with and energy monitor and a GLCD display but I have also added remote temperature sensing. The software senses a single input on the emonTX and displays the temperature on the GLCD. It also displays the temperature of the senor on the GCLD as well. It will deal properly with sub zero temperatures and there is space on the display to add additional sensor readings as well. The code doesn&#39;t support more than one remote sensor but its pretty easy for people to add additional ones. The software will only read temperature when the energy bucket isn&#39;t in operation because the PV dump needs to take priority.</li>
</ul>
<ul>
<li>
		I&#39;ve also added routines so that users can run phase cal sweeps on both the grid and the solar channels. This is especially useful if you have a plug in energy monitor and wish to correlate your unit with this external reference. I have used this approach quite successfully to tune my software and hardware.</li>
</ul>
<ul>
<li>
		There is a feature to run the software on the emonTX&nbsp;is simulation mode. It will generate and measure simulation waveforms with variable amplitudes and phase offsets. The default condition gives certain solar and grid channel power values (detailed as comments in the program). These can be changed and the effects monitored using the serial monitor or the GLCD display.</li>
</ul>
<ul>
<li>
		I have also totally rewritten the measurement algorithms. They now very closely resemble the algorithms on the OEM site but with the difference being that they work in tandem with Robins PV code. I now get pretty close correlation with plug in energy monitors and with my enviR&nbsp;and Optismart&nbsp;units. The final part of the jig saw was finding that my grid channel CT had a slight airgap and this was causing all end of correlation problems.</li>
</ul>
<ul>
<li>
		The GLCD sketch has a visually different interface now. I display the grid and the solar channels on the left hand side of the screen (the grid channel being a larger font). On the right hand side of the screen I display the temperature monitor channels and the state of the energy bucket. I have an additional icon which is a black circle if the house is consuming power from the grid, shows a tank and a heating element if in PV dump mode or is a white circle if the the system is only exporting. Similarly, the LED&#39;s are Red, combined red and green together or green if just exporting. They still turn off in low light and pulse each time a packet is received from the emonTX.</li>
</ul>
<p>A few of us have been playing with these sketches as I have worked on them in the past few weeks. Thanks to you (you know who you are!).&nbsp;</p>
<p><img alt="" src="../../../i36.photobucket.com/albums/e28/fmfm20j/PC067590_resize.jpg" style="width: 1024px; height: 768px;" /></p>
<p>Feel free to having a play... and I&#39;ll put some effort now into understanding why the interrupt detach is screwing up the Elster section of my code.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8013"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1399.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1399.jpg" alt="Series530&#039;s picture" title="Series530&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1399.html" title="View user profile.">Series530</a> on Thu, 06/12/2012 - 18:32.</div>
    <div class="content">
     <p>Please also note that there is a minor modification to the schematics -The green LED on the emonTX should connect to IO7 and the red LED to IO6 (and not visa versa as in the original schematics).</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-8014"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1399.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1399.jpg" alt="Series530&#039;s picture" title="Series530&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Fusion of the MK2 controller with the emonGLCD </h3>

    <div class="submitted">Submitted by <a href="../user/1399.html" title="View user profile.">Series530</a> on Thu, 06/12/2012 - 18:33.</div>
    <div class="content">
     <p>Files :</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/1103"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-p-tZXaUHIrXahXpdRm03vVznmA8d6pl5cTy7b_fWG8k" value="form-p-tZXaUHIrXahXpdRm03vVznmA8d6pl5cTy7b_fWG8k"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/1103 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:07:58 GMT -->
</html>
