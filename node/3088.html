<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/3088 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:08:40 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Phase Angle Output question | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Phase Angle Output question</h3>
        <span class="submitted">Submitted by <a href="../user/4470.html" title="View user profile.">alpha</a> on Sat, 02/11/2013 - 19:10</span>
        <div class="content"><p>I just completed assembling a Mk2 controller and, after calibrating the current, voltage and power for the Phase Angle sketch I decided to run it through some tests. I configured the wiring as Robin so kindly posted to simulate solar sourcing while operating only with mains power.<br />
Anyway, everything appeared to be operating as I expected... the energy bucket filled up to 1300 and began firing the triac until reaching stability at 1438. I am using 120 volts 60Hz for this test and the load is merely 300 watts. I decided to look at the output waveform to see if my snubber was operating satisfactorily so I pulled out the oscilloscope.<br />
Here's the question: I was expecting to see an AC waveform activated at varying degrees of phase angle into each cycle. Instead, I observed merely skipped cycles. I do have the triac firing from digital pin 10 and the Opto Isolator is an MOC-3021 as per Robin's schematic. What am I doing wrong?</p>
<p>Waveforms attached</p>
  <div class="forum-topic-navigation clear-block">
          <a href="3134.html" class="topic-previous" title="Go to previous forum topic">‹ Help with problem with Histogram data on hosted Emoncms?</a>
              <a href="3091.html" class="topic-next" title="Go to next forum topic">CT clamp data output? ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-16110"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Phase Angle Output question</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 02/11/2013 - 20:00.</div>
    <div class="content">
     <p>What you saw is correct (even though the photo appears mangled) for &quot;burst fire&quot; mode. Phase angle control generates large amounts of harmonics and requires heavy and expensive filtering components. Burst fire, because switching occurs at or very near zero voltage, does not generate harmonics and thus does not require a filter.&nbsp; Burst mode can however, if you are on a weak supply, generate flicker. If you read the documentation, you will find the two modes explained.</p>
<p>If you require phase angle control, you need to change the sketch and of course the trigger i.c. You&#39;ll also need a filter and to find what limits apply, you&#39;ll have to check the local regulations where you live.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16111"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4470.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="alpha&#039;s picture" title="alpha&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Phase Angle Output question</h3>

    <div class="submitted">Submitted by <a href="../user/4470.html" title="View user profile.">alpha</a> on Sat, 02/11/2013 - 20:24.</div>
    <div class="content">
     <p>Thanks Robert, It was configured with Robin's PA sketch and so I thought it would be using phase angle control. I guess I'll have to go through the code to see why it was firing at zero crossing in burst mode instead.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16113"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4470.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="alpha&#039;s picture" title="alpha&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Phase Angle Output question</h3>

    <div class="submitted">Submitted by <a href="../user/4470.html" title="View user profile.">alpha</a> on Sat, 02/11/2013 - 20:36.</div>
    <div class="content">
     <p>Here's another attempt to post pictures... My wonderful Windows 8 machine is terribly unhappy with the latest version of Adobe Flash and lets me hear about it in unpleasant ways.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16114"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Phase Angle Output question</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 02/11/2013 - 20:43.</div>
    <div class="content">
     <p>In Europe, we always use burst fire because of the problems with harmonic generation. I need to remember the part numbers! You have indeed got the random phase opto-trigger, but have you got the correct output pin? Two are in use, one for burst fire and one for phase angle. See the top of the sketch for the pin allocations.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16115"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Phase Angle Output question</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 02/11/2013 - 20:49.</div>
    <div class="content">
     <p><em>&quot;Here&#39;s another attempt to post pictures...</em>&quot; Yikes! large quantities of rectification. That&#39;s not good!</p>
<p>&quot;<em>My wonderful Windows 8 machine</em>&quot;&nbsp; Most of the informed comment I&#39;ve read is - shall we say - not enthusiastic about W8. I guess it&#39;s Linux beckoning when I come to replace this XP machine.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16116"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Phase Angle Output question</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 02/11/2013 - 20:56.</div>
    <div class="content">
     <p>You might also have a timing problem as the sketch was designed for a 50 Hz system. So our firing delay is 0 - 10 ms (I think that&#39;s the 10000 (&micro;s) in line 238), whereas yours needs to go from 0 - 8333.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16117"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4470.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="alpha&#039;s picture" title="alpha&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Phase Angle Output question</h3>

    <div class="submitted">Submitted by <a href="../user/4470.html" title="View user profile.">alpha</a> on Sat, 02/11/2013 - 20:58.</div>
    <div class="content">
     <p>I hope that my expression regarding Windows 8 doesn't persuade anyone to (upgrade???) to it. I'll be polite by saying that it was pure sarcasm! Long live XP</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16118"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4470.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="alpha&#039;s picture" title="alpha&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Phase Angle Output question</h3>

    <div class="submitted">Submitted by <a href="../user/4470.html" title="View user profile.">alpha</a> on Sat, 02/11/2013 - 21:05.</div>
    <div class="content">
     <p>Thanks Robert, I'll give that a go tomorrow. I want to review the entire sketch for little things like that so it may take me a while.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16137"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4470.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="alpha&#039;s picture" title="alpha&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Phase Angle Output question</h3>

    <div class="submitted">Submitted by <a href="../user/4470.html" title="View user profile.">alpha</a> on Sun, 03/11/2013 - 22:14.</div>
    <div class="content">
     <p>Thank you again Robert... after making several appropriate changes to accommodate 60 Hz operation, the phase angle firing appears to be what I expect to see. It appears that my snubber is also functioning properly since there&#39;s no apparent ringing or harmonic distortion. The fuzzy picture is an indication that I had the screen intensity too high lol!</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16139"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Phase Angle Output question</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 03/11/2013 - 23:59.</div>
    <div class="content">
     <p>(Hmm - can&#39;t look at the pictures - I think the hash character in the file name is causing a problem)</p>
<p>That looks (from the thumbnail) OK. Have you checked what the limits for harmonic currents are in your part of the world? You might need to add some filtering.</p>
<p>I presume you needed to change the line I mentioned and the associated limits. I couldn&#39;t see anything else that might have affected it - was I right?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16143"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4470.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="alpha&#039;s picture" title="alpha&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Phase Angle Output question</h3>

    <div class="submitted">Submitted by <a href="../user/4470.html" title="View user profile.">alpha</a> on Mon, 04/11/2013 - 02:02.</div>
    <div class="content">
     <p>Yes Robert, your line definitely needed to change as did the cutoff points for min and max firing delays in microseconds. As for harmonic currents, my application merges a grid inter-tied solar system with an off-grid solar system through a 5 kw transformer. The Mk2 controls how much of the 5 kw/hr solar generated power is allowed to feed back to the exciting inverter in the off-grid system. It can handle a maximum of about 1,500 watts but since the backfed power causes all kinds of other problems with the batteries etc., I decided to avoid backfeed issues entirely by diverting excess power to a hot water heater instead. Between the inductance posed by the transformer and the snubber network, I think I can control harmonic generation satisfactorily. Time and experimentation will tell...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/3088"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-1okSix2QV2PzbPP_WiFFYKOO0wq-sbVduL5hpVciBZI" value="form-1okSix2QV2PzbPP_WiFFYKOO0wq-sbVduL5hpVciBZI"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
