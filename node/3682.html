<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/3682 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:23:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>PacketGen | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/3.html">Archived: General Discussion</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">PacketGen</h3>
        <span class="submitted">Submitted by <a href="../user/4253.html" title="View user profile.">charliemic</a> on Mon, 20/01/2014 - 14:12</span>
        <div class="content"><p>Trystan, Glyn,</p>
<p>I&#39;m watching the development of PacketGen with great interest, as I would like the ability to start controlling things in my house including radiators, and the boiler. I am considering switching from the Rock Solid Gateway approach to the Harddrive RPi method.</p>
<p>I&#39;m not sure where this has got to, but can you advise on the possibility of doing the following;</p>
<p>1. Time clock control. E.g., to be able to switch radiators on/off at certain times, in different rooms.</p>
<p>2. Remote access control- I note you have included packetgen for the &quot;Raspberry Pi + Harddrive + Emoncms&quot; option, which doesn&#39;t allow remote access from the web. As you say, it is good to have the control &#39;brains&#39; local to the hardware in case the internet connection dropped out. But on the other hand it would be really useful to be able to change settings from somewhere else in the world- e.g., to switch the boiler/heating/hot water on or off if I plan to stay late at work!</p>
<p>3. Respond to sensed values in field devices. Generally I think it is good to have distributed intelligence in the system i.e., each field device (be it an emonTX or some modified version thereof) being programmed to drive actuators (e.g., heating valves) according to sensed values. But it might also be appropriate sometimes to have these calculations done by emoncms. For example, if I detect low external temperatures from an externally location sensor node, I might want to fire my boiler earlier, and thus send a control signal to a different device (i.e., the one next to the boiler).</p>
<p>On 3, as I understand it is possible to broadcast from one device (e.g., emonTX) to ALL other devices. So I could get external temp data sent from one node to another without having to go through emoncms. Is there mileage here?</p>
<p>Interested to hear your thoughts (or to discover that the above is possible already!)</p>
<p>Chris</p>
  <div class="forum-topic-navigation clear-block">
          <a href="3718.html" class="topic-previous" title="Go to previous forum topic">‹ Retired Android phone as Base Station and Display</a>
              <a href="3651.html" class="topic-next" title="Go to next forum topic">Be able to display a map of an OEM network in EmonCMS ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-17790"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PacketGen</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Mon, 20/01/2014 - 23:34.</div>
    <div class="content">
     <p>Hello Chris</p>
<p>Thanks for the interest, yes time clock control would be great to do or maybe temperature curve based control? you could draw using a series of sliders the temperature you want in the room at different hours of the day?</p>
<p>Remote access can be done by using port forwarding on your router, this wikihow here covers it pretty well <a href="http://www.wikihow.com/Set-Up-Port-Forwarding-on-a-Router" title="http://www.wikihow.com/Set-Up-Port-Forwarding-on-a-Router">http://www.wikihow.com/Set-Up-Port-Forwarding-on-a-Router</a></p>
<p>Point 3 also needs some work but yes agreed it would be good and also I agree on distributed intelligence for most of it and emoncms for the things that cant be done on the nodes themselves as you say.</p>
<p>At the moment there are these basic examples built on top of packetgen <a href="http://openenergymonitor.blogspot.co.uk/2013/12/emoncms-control-developments-and-demos.html" title="http://openenergymonitor.blogspot.co.uk/2013/12/emoncms-control-developments-and-demos.html">http://openenergymonitor.blogspot.co.uk/2013/12/emoncms-control-developm...</a> the more advanced things need to be added.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-17805"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4253.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="charliemic&#039;s picture" title="charliemic&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PacketGen</h3>

    <div class="submitted">Submitted by <a href="../user/4253.html" title="View user profile.">charliemic</a> on Tue, 21/01/2014 - 13:46.</div>
    <div class="content">
     <p>Hi Trystan,</p>
<p>Yes, you&#39;re right, you&#39;d want to be able to control the setpoint to vary across the day, with a &#39;setback&#39; temperature (or off if you want) when the heating not required.</p>
<p>By the way, I&#39;ve been using one of these actuators to control a radiator from an Arduino;</p>
<p><a href="http://www.heatingcontrolsonline.co.uk/emmeti-m-20.html/normally-open-thermal-actuator-p-801.html" title="http://www.heatingcontrolsonline.co.uk/emmeti-m-20.html/normally-open-thermal-actuator-p-801.html">http://www.heatingcontrolsonline.co.uk/emmeti-m-20.html/normally-open-th...</a></p>
<p>I have the normally closed version (24V=valve opened). Saves the trouble of using motorised valves (=noise and positional feedback issues). You would need a relay with 5V input to switch the supply to the valve (I&#39;ve actually used an h-bridge motor driver, as the current is small). I&#39;ll soon be logging room temps to see how well the valve controls temperature.</p>
<p>Thanks for the info on port forwarding, I will take a look.</p>
<p>Chris</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-17808"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PacketGen</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Tue, 21/01/2014 - 17:36.</div>
    <div class="content">
     <p>The actuator looks interesting, how do you install it, I checked the manufacturer&#39;s website but it wasn&#39;t clear how it works.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-17814"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4253.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="charliemic&#039;s picture" title="charliemic&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PacketGen</h3>

    <div class="submitted">Submitted by <a href="../user/4253.html" title="View user profile.">charliemic</a> on Wed, 22/01/2014 - 07:15.</div>
    <div class="content">
     <p>Hi there,<br />
You fit it like a normal TRV head, it just screws on. You have to have the right type of valve or use an adapter. Best to check with them.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-17819"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5190.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-5190.jpg" alt="Schism&#039;s picture" title="Schism&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PacketGen</h3>

    <div class="submitted">Submitted by <a href="../user/5190.html" title="View user profile.">Schism</a> on Wed, 22/01/2014 - 08:52.</div>
    <div class="content">
     <p>I assume the loss from running some kind of transformer and powering the radiators is more than offset by the gains in not heating when you don&#39;t need to. Ultimately something I&#39;d quite like to do... how do you power at 24V?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-17821"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PacketGen</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Wed, 22/01/2014 - 09:19.</div>
    <div class="content">
     <p>OK thanks, I don&#39;t have any TRVs&nbsp;here just standard on/off valves so probably not an option for me.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-17837"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4253.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="charliemic&#039;s picture" title="charliemic&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PacketGen</h3>

    <div class="submitted">Submitted by <a href="../user/4253.html" title="View user profile.">charliemic</a> on Wed, 22/01/2014 - 16:06.</div>
    <div class="content">
     <p>Yes, the numbers are pretty good. The device uses 3W, I expect the transformer uses a similar amount, but need to test this. For a 1000W radiator you're looking at less than 1% extra energy use. You're right though, don't want this on all day.- hence why I want to be able to switch the system on or off according to time of day.</p>
<p>To control the 24V supply you can used an arduino compatible relay which uses a 5V signal to switch 24V. I'm actually using a h-bridge motor driver which I built onto a prototype board. I'll post some details soon.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-17838"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PacketGen</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 22/01/2014 - 17:39.</div>
    <div class="content">
     <p>As a basic concept of time clock control I&#39;ve put together a script that updates packetgen with the desired heating state and setpoint for a given day of the week and time of day. No GUI yet but fairly easy to change the settings in the script.<br />
	I have attached it below:</p>
<p>To run it just run $ php scheduler.php</p>
<p>Here&#39;s the main logic:</p>
<pre>
    $heatingstate = false;
&nbsp;&nbsp;&nbsp; $heatingsetpoint = 5;

    if ($dayofweek&gt;=1 &amp;&amp; $dayofweek&lt;=5) // Week days
    {
      // Heating period A: 6am to 8am
      if ($hourofday&gt;=6 &amp;&amp; $hourofday&lt;=8)
      {
        print &quot;- Weekday heating period A\n&quot;;
        $heatingstate = true;
        $heatingsetpoint = 18.0;
      }
     
      // Heating period B: 5pm to 23pm
      if ($hourofday&gt;=18 &amp;&amp; $hourofday&lt;=23)
      {
        print &quot;- Weekday heating period B\n&quot;;
        $heatingstate = true;
        $heatingsetpoint = 18.0;
      }
    }
   
    if ($dayofweek==0 || $dayofweek==6) // Saturday and Sunday
    {
      // Heating period A: 6am to 8am
      if ($hourofday&gt;=7 &amp;&amp; $hourofday&lt;=23)
      {
        print &quot;- Weekend heating period A\n&quot;;
        $heatingstate = true;
        $heatingsetpoint = 18.0;
      }
    }</pre><p>The script needs to run all the time and would be something ran as a service script. Another approach would be to run it as cron but then your limited to 1 minute updates.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-17842"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4253.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="charliemic&#039;s picture" title="charliemic&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PacketGen</h3>

    <div class="submitted">Submitted by <a href="../user/4253.html" title="View user profile.">charliemic</a> on Thu, 23/01/2014 - 08:00.</div>
    <div class="content">
     <p>Trystan,</p>
<p>I&#39;m not familiar with PHP yet, but makes sense.</p>
<p>The next step would be to set up separate schedules for each room (times and temps), which I guess could be done by adding more variables to the above.<br />
	&nbsp;</p>
<p>Going back to Schism&#39;s comment- it would be quite easy to set up monitoring of the boiler flow pipe as a means of determining when the heating is on (e.g., if it rises above 40deg&nbsp;or so). This could then be broadcast to any radiator controllers to tell them to switch on, and would save the actuators being needlessly on when there was no heat in the system.&nbsp;</p>
<p>Obviously if the script above can be developed that will provide the required function anyway.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/3682"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-DcWLZO1Qvm5y-EFaPcjspzm_t6eKn2D_p3ps5iDCjeQ" value="form-DcWLZO1Qvm5y-EFaPcjspzm_t6eKn2D_p3ps5iDCjeQ"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
