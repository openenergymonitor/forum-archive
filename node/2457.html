<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/2457 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:54:02 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>setting the start value for a meter using &quot;editrealtime&quot; | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">setting the start value for a meter using &quot;editrealtime&quot;</h3>
        <span class="submitted">Submitted by <a href="../user/3082.html" title="View user profile.">gloorung</a> on Tue, 11/06/2013 - 11:58</span>
        <div class="content"><p>I would like to create a feed that mimics my electricity/gas/solar panel meter at home. This work well with the power to Kwh processor, but I cannot set the &#39;initial&#39; value. I tried updating the most recent (or the two most recent) data point&nbsp;using the editrealtime&nbsp;function on emoncms.org, but in some cases this stops the feed from updating. Eg when updating the feed value to 8000, the feed value keeps on increasing, but when I set the value to 10000, the feed value remains fixed.&nbsp;</p>
<p>Any idea what I may be doing wrong ?</p>
<p>Regards,</p>
<p>Roel</p>
  <div class="forum-topic-navigation clear-block">
          <a href="2007.html" class="topic-previous" title="Go to previous forum topic">‹ Emoncms timestamp problem</a>
              <a href="2529.html" class="topic-next" title="Go to next forum topic">Feeds not updating ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-12879"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3149.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3149.jpg" alt="boelle&#039;s picture" title="boelle&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: setting the start value for a meter using "editrealtime"</h3>

    <div class="submitted">Submitted by <a href="../user/3149.html" title="View user profile.">boelle</a> on Tue, 11/06/2013 - 19:37.</div>
    <div class="content">
     <p>Hi... i had the same problem with my water meter...</p>
<p>&nbsp;</p>
<p>on the input page i simply start the list of processing with + &quot;whatsneedtobeadded&quot; and then log to feed.</p>
<p>&nbsp;</p>
<p>how to do it? clik on input.. find the right node and clik the tool icon next to right input... rest should explain itself</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12950"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3082.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="gloorung&#039;s picture" title="gloorung&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: setting the start value for a meter using "editrealtime"</h3>

    <div class="submitted">Submitted by <a href="../user/3082.html" title="View user profile.">gloorung</a> on Thu, 13/06/2013 - 12:00.</div>
    <div class="content">
     <p>Hi Boelle,</p>
<p>Thanks for the reply. I tried your suggestion but it does not solve my problem. I guess the solution you propose works in case the kwh&nbsp;is logged (ie sent by the emontx) and therefor in your input list, ie for water and gas consumption.&nbsp;</p>
<p>In my case, I log the power from my solar panels and compute the kwh&nbsp;from the &#39;power to kwh&#39; processor. Adding the &nbsp;+ &quot;whatsneedtobeadded&quot; before this processor would add it to the power so that doesn&#39;t make sense; adding it after makes that the value is not included.&nbsp;</p>
<p>correct or am I still seeing it the wrong way ?</p>
<p>Roel</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12975"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ngbod&#039;s picture" title="ngbod&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: setting the start value for a meter using "editrealtime"</h3>

    <div class="submitted">Submitted by <a href="../user/3824.html" title="View user profile.">ngbod</a> on Fri, 14/06/2013 - 05:58.</div>
    <div class="content">
     <p>I&#39;m having the same problem and like you can&#39;t find a way round it. I add my current meter reading to my PV KW to KWh feed in the Vis page. The &#39;tab&#39; key needs to be pressed on mine to reveal the save button. Pressing this saves the addition to the feed but from then on the feed stops incrementing and remains static at whatever value the addition was.&nbsp;</p>
<p>Seems like it&#39;s a bug in the code unless editrealtime is not meant for this.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-12985"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ngbod&#039;s picture" title="ngbod&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: setting the start value for a meter using "editrealtime"</h3>

    <div class="submitted">Submitted by <a href="../user/3824.html" title="View user profile.">ngbod</a> on Fri, 14/06/2013 - 10:53.</div>
    <div class="content">
     <p>I seem to have got this to work with the editrealtime Vis at least for cumulative KWh figures that I need to match my PV export meter, grid import meter and cumulative PV diverted to immersion KWh feeds on my system.</p>
<p>It seems to me like the only way it would accept the offset to the feed and carry on counting up was if I quickly clicked on the latest time on the editrealtime vis graph and very quickly enter the new offset value and save before the next feed value arrives from the sensor. Each feed I updated took a few attempts to get the offset to stick.</p>
<p>It&#39;s been working all morning now and the values seem to be tracking the meter readings so far.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13067"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3082.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="gloorung&#039;s picture" title="gloorung&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: setting the start value for a meter using "editrealtime"</h3>

    <div class="submitted">Submitted by <a href="../user/3082.html" title="View user profile.">gloorung</a> on Tue, 18/06/2013 - 13:23.</div>
    <div class="content">
     <p>Earlier this week I have debugged the power_to_kwh process and found that the problem is not the code but rather the mysql&nbsp;database.</p>
<p><span style="font-size: 12px;">The problem I had was that whenever my incremental kwh counter would exceed 10000 kwh, it would stop incrementing. This is caused by the float datatype that is used in the feeds table and that of the feed storing the kwh&nbsp;values. An entry value of 10000.1003 is stored as 10000.1 in the database. As the kwh increments are usualy fairly small, the kwh counter never increases in case a value of 6 digits is reached.&nbsp;</span></p>
<p>I was able to solve this by changing the datatype of both the value column in the feeds table as well as the data column in the feed table from float to double using:</p>
<p>alter table feeds modify value double;</p>
<p>As the precision increases (and database size), the value is now stored correctly in the database and the kwh&nbsp;counter keeps on working. What I&#39;m not sure of though is if double is the correct datatype to use. I briefly experimented with the decimal type but could not get a working result yet.&nbsp;</p>
<p>Regards,<br />
	<span style="font-size: 12px;">Roel</span></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13123"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ngbod&#039;s picture" title="ngbod&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: setting the start value for a meter using "editrealtime"</h3>

    <div class="submitted">Submitted by <a href="../user/3824.html" title="View user profile.">ngbod</a> on Fri, 21/06/2013 - 06:09.</div>
    <div class="content">
     <p>I thought&nbsp;my system was incrementing correctly after using editrealtime but now a week on I can see it&#39;s not.</p>
<p>I have three feeds that I adjusted with editrealtime&nbsp;a week ago: &nbsp;f1 is 58.5 KWh at the moment and incrementing correctly. F2 is 4252 KWh and is incrementing unreliably at about half of actual production. F3&nbsp;is 46647 KWh and has effectively stopped incrementing.</p>
<p>Roel, where would I find the database you mentioned and how would I change the data type like you did? I&#39;m using Raspberry pi as base.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13144"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3082.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="gloorung&#039;s picture" title="gloorung&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: setting the start value for a meter using "editrealtime"</h3>

    <div class="submitted">Submitted by <a href="../user/3082.html" title="View user profile.">gloorung</a> on Sat, 22/06/2013 - 10:36.</div>
    <div class="content">
     <p>Hi,</p>
<p>Assuming you have logged on to the raspberry, you can enter the following command:</p>
<pre>
mysql -u root -p emoncms   (The default password is &#39;raspberry&#39;)</pre><p>In mysql, you can:</p>
<pre>
mysql&gt; describe feeds;</pre><p>The Type of Field value should be float; to alter it to a double datatype, enter:</p>
<pre>
alter table feeds modify value double;</pre><p>You can do the same for the feeds table that stores the counter data i.e. instead of table &#39;feeds&#39; use &#39;feed_xx&#39;; &nbsp;I&#39;m not yet 100% sure this needs to be done.&nbsp;</p>
<p>For you information: I altered my table earlier this week, the counter value was then 10500 kWh and it has been incrementing correctly since then.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13148"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ngbod&#039;s picture" title="ngbod&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: setting the start value for a meter using "editrealtime"</h3>

    <div class="submitted">Submitted by <a href="../user/3824.html" title="View user profile.">ngbod</a> on Sat, 22/06/2013 - 22:32.</div>
    <div class="content">
     <p>Thanks for the guidance Roel.</p>
<p>I&#39;ve applied the changes to my db and hopefully this will cure the problem.</p>
<p>I&#39;m not sure but I think loading of some of the vis graphs like realtime and editrealtime has slowed down since applying the changes.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13210"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ngbod&#039;s picture" title="ngbod&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: setting the start value for a meter using "editrealtime"</h3>

    <div class="submitted">Submitted by <a href="../user/3824.html" title="View user profile.">ngbod</a> on Tue, 25/06/2013 - 16:01.</div>
    <div class="content">
     <p>Changing the datatypes hasn&#39;t worked on my setup. I carried out all the mods Roel described but still the total cumulative figures are not incrementing correctly. PV is currently about 4237 and the daily addition is varying around 70 - 80% of the KWhd figure. The grid import total cumulative figure has been stuck at about 46693 for a few days now despite 5 - 7 KWhd usage being measured.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13343"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ngbod&#039;s picture" title="ngbod&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: setting the start value for a meter using "editrealtime"</h3>

    <div class="submitted">Submitted by <a href="../user/3824.html" title="View user profile.">ngbod</a> on Mon, 01/07/2013 - 19:26.</div>
    <div class="content">
     <p>I figured out why the table mods didn&#39;t work on my setup. I updated the database after doing the mods with Admin updater in emoncms and it altered the feeds table back to float data type without me noticing.</p>
<p>When I went through it again today I noticed it change it back this time. The answer is to edit /var/emoncms/Modules/feed/feed_schema.php and change the feed data type from &#39;float&#39; to &#39;double&#39; . This stops the database updater reverting the first change Roel described.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13466"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ngbod&#039;s picture" title="ngbod&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: setting the start value for a meter using "editrealtime"</h3>

    <div class="submitted">Submitted by <a href="../user/3824.html" title="View user profile.">ngbod</a> on Sat, 06/07/2013 - 19:31.</div>
    <div class="content">
     <p>The local version of my database is now working very well with the double data type but the web version of my database is still using the float data type.</p>
<p>Can anyone tell me which files I need to alter to make the web version the same as my local database instance, assuming it is possible.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/2457"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-_qF6kUmF64diicmbg9j1MFaNOm_mAws6Yv3wYFax11Y" value="form-_qF6kUmF64diicmbg9j1MFaNOm_mAws6Yv3wYFax11Y"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/2457 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:54:02 GMT -->
</html>
