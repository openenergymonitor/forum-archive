<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11867 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:49:22 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Can No Longer Login to Emoncms | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Can No Longer Login to Emoncms</h3>
        <span class="submitted">Submitted by <a href="../user/689.html" title="View user profile.">tgmaxx</a> on Fri, 25/12/2015 - 00:51</span>
        <div class="content"><p>I can no longer login after latest updates to emoncms. I am running&nbsp;emoncms 9.2, 2015.12.11 on a local Raspberry Pi. I&nbsp;am up-to-date on all code. I believe this happened in the last 2 days. The message I get is:</p>
<p>&quot;Incorrect password, if your sure its correct try clearing your browser cache&quot;</p>
<p>I tried creating a new user and I also can&#39;t login with the new user. I can get in using phpMyAdmin after creating a new user, then copied the PW and Salt, but no luck.Any ideas what else to do or&nbsp;check?</p>
<p>Thanks and Happy Holidays to everyone!</p>
<p>Tom</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11851.html" class="topic-previous" title="Go to previous forum topic">‹ emonhub rc1.2 &#039;non-numerical content&#039;</a>
              <a href="11877.html" class="topic-next" title="Go to next forum topic">&quot;Incorrect password&quot; after update - how to fix. ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-37492"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can No Longer Login to Emoncms</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Fri, 25/12/2015 - 18:51.</div>
    <div class="content">
     <p>A bit confusing Tom;</p>
<p><em><strong>I can get in</strong> using phpMyAdmin after creating a new user, then copied the PW and Salt, <strong>but no luck</strong>.</em></p>
<p>Can you clarify if this worked (I can get in) or didn&#39;t (but no luck)</p>
<p>&nbsp;</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37493"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/689.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-689.jpg" alt="tgmaxx&#039;s picture" title="tgmaxx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can No Longer Login to Emoncms</h3>

    <div class="submitted">Submitted by <a href="../user/689.html" title="View user profile.">tgmaxx</a> on Fri, 25/12/2015 - 19:29.</div>
    <div class="content">
     <p>Hi Paul,</p>
<p>I meant I can run phpMyAdmin and look at the emoncms database and&nbsp;see data accumulating in my tables. So I went to the opening emoncms login screen and registered a new user with the password I want. Then I try to login and it fails.</p>
<p>I also went back to&nbsp;phpMyAdmin, in the users table, copied the password and salt fields from the new user into the original user. Then when I try to login, it still gives me a password error.</p>
<p>Regards,</p>
<p>Tom</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37495"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can No Longer Login to Emoncms</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Fri, 25/12/2015 - 21:02.</div>
    <div class="content">
     <p>Are you using special/localised characters in your password?&nbsp;<br />
Some changes were made a few days ago - <a href="https://github.com/emoncms/emoncms/commit/49d415915b78d5f5535f2a9eeb00443769c9e8ea">see this commit</a>, to increase system security, which has resulted in special characters in passwords not being modified by the MYSQL update.</p>
<p>If so, can you create a new user using a password with no special characters, and using phpMyAdmin&nbsp;, copy the password &amp; salt to your primary password account.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37496"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/689.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-689.jpg" alt="tgmaxx&#039;s picture" title="tgmaxx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can No Longer Login to Emoncms</h3>

    <div class="submitted">Submitted by <a href="../user/689.html" title="View user profile.">tgmaxx</a> on Fri, 25/12/2015 - 21:07.</div>
    <div class="content">
     <p>I was able to get in by going to a previous version backup I had, created a new user, then went back to the newest version and went in with that new user. Then I copied the original password, api read, api write and salt fields to the new user fields in the users table. Then I deleted the original username and then renamed the new user to the name of the original username&nbsp;(a little crazy, but it worked).</p>
<p>When I got in with the original username, I ran a database check and it said the Salt field had to be changed to 32 characters. Maybe that was the problem? I don&#39;t know, but at least I am back to working again.</p>
<p>I am still wondering though if it would be possible to run a emoncms database update/check from the command line, without have to be logged into emoncms?</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37497"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can No Longer Login to Emoncms</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Fri, 25/12/2015 - 21:12.</div>
    <div class="content">
     <p>I posted about the same time as you, but if you check my last post, I think that it is the issue I described.<br />
The recent update increased the DB password field to 250 characters.</p>
<p>You should be able to run a db update from within your local network via&nbsp;http://SERVERIP/emoncms/admin/db?apply=true</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37498"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/689.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-689.jpg" alt="tgmaxx&#039;s picture" title="tgmaxx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can No Longer Login to Emoncms</h3>

    <div class="submitted">Submitted by <a href="../user/689.html" title="View user profile.">tgmaxx</a> on Fri, 25/12/2015 - 21:24.</div>
    <div class="content">
     <p>Ok thanks Paul. But, I tried to run the db update from my browser as you noted;&nbsp;it gave me an authentication error (in other words it was telling me I was not logged in). That&#39;s why I was wondering if there was a way to do the update from a SSH Putty or MobaXterm command line, or inside MySQL with a query?</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37499"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can No Longer Login to Emoncms</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Fri, 25/12/2015 - 21:34.</div>
    <div class="content">
     <p>What if you add your api key?</p>
<p><a href="http://serverip/emoncms/admin/db?apply=true&amp;apikey=i337eg3e737e3e7etqei" title="http://SERVERIP/emoncms/admin/db?apply=true&amp;apikey=i337eg3e737e3e7etqei">http://SERVERIP/emoncms/admin/db?apply=true&amp;apikey=i337eg3e737e3e7etqei</a></p>
<p>​Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37501"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/689.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-689.jpg" alt="tgmaxx&#039;s picture" title="tgmaxx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can No Longer Login to Emoncms</h3>

    <div class="submitted">Submitted by <a href="../user/689.html" title="View user profile.">tgmaxx</a> on Fri, 25/12/2015 - 23:47.</div>
    <div class="content">
     <p>I tried with r/w API key, but still get the same message:</p>
<p>Admin re-authentication required</p>
<p>Regards,</p>
<p>Tom</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37502"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/238.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-238.jpg" alt="Paul Reed&#039;s picture" title="Paul Reed&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can No Longer Login to Emoncms</h3>

    <div class="submitted">Submitted by <a href="../user/238.html" title="View user profile.">Paul Reed</a> on Fri, 25/12/2015 - 23:53.</div>
    <div class="content">
     <p>OK Tom, I&#39;ve already <a href="https://github.com/emoncms/emoncms/issues/430">logged this as an issue</a>, enjoy Christmas, and hopefully a developer will be back in touch after the Christmas&nbsp;break.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37521"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can No Longer Login to Emoncms</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Sat, 26/12/2015 - 18:44.</div>
    <div class="content">
     <p>Hello Tom, very sorry for the issue with the password login glad to hear you managed to access your account ok in the end.</p>
<p>For anyone else using passwords with special characters I have created a small tool that applies the mysql real escape string modification that has now been removed from emoncms so that its possible to login again:</p>
<p>The tool is here and runs locally in your browser using javascript and so is safe, nothing is sent to a remote server, you can check it for yourself with a test string and the browser&#39;s network tab.</p>
<p><a href="http://openenergymonitor.org/tools/realescapestring">http://openenergymonitor.org/tools/realescapestring</a></p>
<p><em>Note: The reason for this change is using MySQL real escape string is not best practice, is deprecated and removed from php in v7.0.0. Using prepared statements is recommended instead, which is part of the reason for this change. It also helps ensure the string length is not expanded beyond the maximum limit.</em></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37522"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can No Longer Login to Emoncms</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Sat, 26/12/2015 - 18:48.</div>
    <div class="content">
     <p>For your second question, To update the database without being logged in, add the line</p>
<p>$updatelogin = true;</p>
<p>to settings.php</p>
<p>Then run:</p>
<p><a href="http://localhost/emoncms/admin/db?apply=true" title="http://localhost/emoncms/admin/db?apply=true">http://localhost/emoncms/admin/db?apply=true</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-37536"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/689.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-689.jpg" alt="tgmaxx&#039;s picture" title="tgmaxx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Can No Longer Login to Emoncms</h3>

    <div class="submitted">Submitted by <a href="../user/689.html" title="View user profile.">tgmaxx</a> on Sun, 27/12/2015 - 01:30.</div>
    <div class="content">
     <p>Thanks Trystan. The update database function works now&nbsp;as you described and my login is fine.&nbsp;</p>
<p>Best Regards,</p>
<p>Tom</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11867"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form--It-UD-D3-Zc0ojQg7hic_20nOIyrKwZeN6zLvqi4jc" value="form--It-UD-D3-Zc0ojQg7hic_20nOIyrKwZeN6zLvqi4jc"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/11867 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:49:22 GMT -->
</html>
