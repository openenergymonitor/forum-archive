<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/3287 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:27:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Is switch 2 (emonGLCD) &quot;slow&quot;? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Is switch 2 (emonGLCD) &quot;slow&quot;?</h3>
        <span class="submitted">Submitted by Guest on Fri, 06/12/2013 - 10:56</span>
        <div class="content"><p>Is Switch 2 on the emonGLCD supposed to be slow to change back from the on to off state? Technically this may be a software or a hardware question, I don&#39;t know at the moment.</p>
<p>On my unit it seems to take between 5 and 6 seconds to go back from on to off (after I&#39;ve released the button).&nbsp; Pressing the button initially changes the state pretty much immediately.</p>
<p>But switches 1 and 3 are pretty much instant to register the release.</p>
<p>I had been mucking about with the code to change the backlight status from being time based to using one of the switches to toggle it.&nbsp;</p>
<p>Initially I used switch 2, but I had lots of issues and when I put a diagnostic routine in it was apparent that when I clicked the switch and set it HIGH, it took ages to go back LOW again after I released it.&nbsp; Typically between 5 and 6 seconds to revert.</p>
<p>Eventually I tried using switch 3 instead, it toggled immediately.&nbsp; Similarly when I monitored switch 1 it toggled immediately.</p>
<p>Is this normal, or do I have a &quot;mutant&quot;?</p>
<p>&nbsp;</p>
<p>BTW, I have switch 3 doing the toggle backlight thing quite well now.</p>
<p>&nbsp;</p>
<p>Thanks</p>
<p>David</p>
  <div class="forum-topic-navigation clear-block">
          <a href="3311.html" class="topic-previous" title="Go to previous forum topic">‹ emoncms Substract value of today with yesterday</a>
              <a href="3286.html" class="topic-next" title="Go to next forum topic">emoncms WAMP ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-16593"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Is switch 2 (emonGLCD) "slow"?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Fri, 06/12/2013 - 21:50.</div>
    <div class="content">
     <p>I have not noticed a problem. Are you using the &#39;tester&#39; sketch - that has minimal code behind the switch operation and should help you to distinguish between the code taking time to change the display and any problem with the input.</p>
<p>Is anything connected to the Jeeport?</p>
<p>Have you checked the value of the pull-down resistor (R8 - 10 k) and the soldering of the switch, resistor and input pin?</p>
<p>Does the switch sound and feel the same as the other two when you operate it?</p>
<p>If you have an oscilloscope, can you see if the voltage switches cleanly as the switch is pressed and released?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16598"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="baileydau&#039;s picture" title="baileydau&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Is switch 2 (emonGLCD) "slow"?</h3>

    <div class="submitted">Submitted by baileydau (not verified) on Sat, 07/12/2013 - 07:30.</div>
    <div class="content">
     <p>I was using the SolarPV sketch. &nbsp;But I&#39;ve now tried the Tester sketch as well and it seems to have the same results. &nbsp;It takes several seconds for the &quot;UP&quot; do disappear after I release the button, whereas &quot;Enter&quot; and &quot;Down&quot; go away fairly soon after release.</p>
<p>No, I haven&#39;t added anything to my unit. &nbsp;It&#39;s pretty much bog standard.</p>
<p>R8 measures 9.9 k in-situ. &nbsp;The soldering seems OK. &nbsp;The switch is at a bit of a Jaunty angle (not watching that it had moved before I soldered it), but apart from that it looks good.</p>
<p>The switch itself feels the same as the other two.</p>
<p>I don&#39;t have an oscilloscope, but I have checked with a multi meter. &nbsp;With all 3 switches the resistance across the 2 pins is a few ohms with the button pressed and it jumps back up to &quot;big numbers&quot; as soon as it&#39;s released (typically 4 M Ohm or so if it&#39;s going to show anything other than OL). &nbsp;The numbers do bounce quite a bit, but I *think* that&#39;s my DMM and me trying to make contact with the pins.</p>
<p>To me it seems strange that it stays &quot;on&quot; for a long time. &nbsp;I would have thought if I&#39;d done anything wrong in the assembly, it would be more likely not to make contact / come on easily or at all, rather than stick on. &nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16599"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/317.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-317.jpg" alt="Sergegsx&#039;s picture" title="Sergegsx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Is switch 2 (emonGLCD) "slow"?</h3>

    <div class="submitted">Submitted by <a href="../user/317.html" title="View user profile.">Sergegsx</a> on Sat, 07/12/2013 - 08:52.</div>
    <div class="content">
     <p>maybe try to use a small wire to open and close the circuit instead of the pushbutton, just to discard the pushbutton.</p>
<p>I havent looked at the tester sketch, but why not just use the simplest possible code, just a Serial.println(DigitalRead(x));</p>
<p>maybe remove the pushbutton, and measure between solder points</p>
<p>good luck</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16604"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Is switch 2 (emonGLCD) "slow"?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 07/12/2013 - 12:33.</div>
    <div class="content">
     <p>That has ruled out all the obvious things. As a final test, if you have a suitable switch you could try tacking that in parallel, or even just short across the contacts with your screwdriver. If it responds correctly, I think it&#39;s either contamination inside the switch or a mechanical problem. It&#39;s Rapid Electronics part 78-1154, or you could try emailing the shop and they might send you a replacement.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16614"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="baileydau&#039;s picture" title="baileydau&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Is switch 2 (emonGLCD) "slow"?</h3>

    <div class="submitted">Submitted by baileydau (not verified) on Sat, 07/12/2013 - 23:55.</div>
    <div class="content">
     <p>The screwdriver trick is a good idea.</p>
<p>I&#39;ve just tried it. &nbsp;Same results. &nbsp;It appears the switch definitely isn&#39;t the cause. &nbsp;</p>
<p>Could it be the chip, or its connections or something?</p>
<p>Again, I&#39;m having trouble comprehending how it can stick on rather than not work.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16620"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Is switch 2 (emonGLCD) "slow"?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 08/12/2013 - 01:38.</div>
    <div class="content">
     <p>This is weird. When you press the switch, it connects the digital input to the supply rail. When you release it, the 10 K resistor pulls the input down to ground. The obvious way for that to take a long time is for there to be a capacitor holding a charge that takes time to leak away. There&#39;s only one problem with that idea - there isn&#39;t a capacitor on the board big enough to account for a 5 or more seconds delay. What voltages do you measure on the input pin (or the switch for that matter) when it&#39;s pressed and not pressed? It should be a solid V<sub>cc</sub> (3.3 V give or take the regulator tolerance) pressed and a solid 0 V not pressed.</p>
<p>One final thought: is the PCB faulty and there&#39;s a bridge to an adjacent track somewhere? I can&#39;t see that giving these symptoms, but I&#39;m running out of ideas.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16624"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="baileydau&#039;s picture" title="baileydau&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Is switch 2 (emonGLCD) "slow"?</h3>

    <div class="submitted">Submitted by baileydau (not verified) on Sun, 08/12/2013 - 02:41.</div>
    <div class="content">
     <p>Ah, now we might be onto something.</p>
<p>When I measure the voltages across the switches I get:</p>
<p>S1 Open: 3.3 V, Closed: 0 V</p>
<p>S2: Open: &lt; 0.25 V, Closed: 0 V (Sometimes as low as 1.7 V Open)</p>
<p>S3 Open: 3.3 V, Closed: 0 V</p>
<p>So it looks like it may be a dodgy connection. &nbsp;Unfortunately, I have fully assembled my unit, so the LCD is in the way of doing pretty much anything. &nbsp;About the only thing I can try is giving the pins of the switch itself a bit of a touch up (even though the *look* OK).</p>
<p>I&#39;ve tried touching the PCB pads rather than just the switch legs, but same result. &nbsp;To me, that would indicate the issue is &quot;upstream&quot;.</p>
<p>NB. &nbsp;I tried mucking about with the SolarPV sketch and I set the&nbsp;emonGLCDV1.3 define. &nbsp;That caused S2 to be &quot;on&quot; all the time. &nbsp;From what I can tell that was from the digitalWrite(switch2, HIGH) statement.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16627"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Is switch 2 (emonGLCD) "slow"?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 08/12/2013 - 03:24.</div>
    <div class="content">
     <p><em>&quot;S2: Open: &lt; 0.25 V, Closed: 0 V (Sometimes as low as 1.7 V Open)&quot;</em></p>
<p>That&#39;s definitely showing the problem. What sort of meter are you using? I presume a high impedance DMM?</p>
<p>Referred to ground then, you&#39;re seeing Open: 1.6 V to 3.05 V (should be 0 V); Closed, 3.3 V (corrrect).&nbsp;</p>
<p>As far as I can see, the 3.3 V doesn&#39;t go particularly close to that track except at the switch and the Jeeport. Those areas are worth a very careful look before you do anything drastic.</p>
<p>It still leaves the switch as a suspect. If the contacts are not parting, that would give these symptoms. Is it possible for you to remove it without damaging the pcb? You will probably need to melt all 4 pads simultaneously. If you think the risk of damaging the board is too great, you could cut the track between the switch and R8 on the basis that it&#39;s easily repairable with a fine wire between those pads. If a wire then between Vcc and R8 works cleanly, it&#39;s the switch. (And you&#39;ve still got to get it out.)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16628"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="baileydau&#039;s picture" title="baileydau&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Is switch 2 (emonGLCD) "slow"?</h3>

    <div class="submitted">Submitted by baileydau (not verified) on Sun, 08/12/2013 - 04:38.</div>
    <div class="content">
     <p>Yes the DMM is a decent quality, but old one (a very old Fluke 25 unit)</p>
<p>Actually my measurements were across the switch pins. &nbsp;So the opposite of the way you described.</p>
<p>(NB. &nbsp;The lower figure was actually 0.17 V, not my typo of 1.7 V)</p>
<p>I&#39;ve done some other measurements from the various pins to GND (on the JeePort)</p>
<p>+ve on S2&nbsp;3.3 V (open or closed)</p>
<p>-ve on S2&nbsp;Open 0.17 V Closed 3.3 V</p>
<p>So it definitely looks like the switch is always making a partial connection.</p>
<p>Unfortunately as my unit is fully assembled, I don&#39;t think I&#39;d be able to remove the switch. &nbsp;The back two stabiliser pins are under the Backlight / LCD. &nbsp;The switch pins are *just* accessible. &nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16629"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="baileydau&#039;s picture" title="baileydau&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Is switch 2 (emonGLCD) "slow"?</h3>

    <div class="submitted">Submitted by baileydau (not verified) on Sun, 08/12/2013 - 04:55.</div>
    <div class="content">
     <p>Whoo hoo! &nbsp;</p>
<p>Don&#39;t know what I did, but it seems &quot;fixed&quot; (for variable definitions of fixed). &nbsp;I was just fiddling around in the area. &nbsp;Not doing anything in particular.</p>
<p>It now releases immediately. &nbsp;Although it now sometimes takes a couple of goes at detecting the initial press, but it&#39;s mostly OK.</p>
<p>Checking the voltages, they are now 3.3 V / 0 V as they should be.</p>
<p>I do have my switch status display area on all of the screens, so I can see if it has detected the press or not.</p>
<p>Thank you for your assistance.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16635"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Is switch 2 (emonGLCD) "slow"?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 08/12/2013 - 12:40.</div>
    <div class="content">
     <p>I don&#39;t like that! It really sounds like a faulty switch. My money would be on it coming back sooner or later. (The clue is &quot;Although it now sometimes takes a couple of goes at detecting the initial press&quot;.)</p>
<p>Anyway, I&#39;m glad it&#39;s sorted for now and you know where to look if it does misbehave in the future.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/3287"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-50v3yrs5VnHN5jlx-wy_Z2Qtlg8JmguTcISim2cogeY" value="form-50v3yrs5VnHN5jlx-wy_Z2Qtlg8JmguTcISim2cogeY"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
