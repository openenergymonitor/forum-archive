<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/3921 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:07:15 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>EMONCMS shown data lagging behind reality | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/3.html">Archived: General Discussion</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">EMONCMS shown data lagging behind reality</h3>
        <span class="submitted">Submitted by <a href="../user/1332.html" title="View user profile.">JBecker</a> on Tue, 25/02/2014 - 08:38</span>
        <div class="content"><p>I am running Emoncms on a Raspberry Pi with RFM12Pi since more than one year now. Everything worked like a charm until some weeks (not really sure) ago.</p>
<p>Now I have a very strange effect. If I look at the data (e.g. outside temperature graph), I can see that the curve does not follow the expected line, it starts to increase around noon and drops around midnight. Even if I touch the temperature sensor, I do not see any change in temperature (not in the graph, nor in the realtime value).</p>
<p>I think that the data is just lagging the reality by some 5-8 hours!?! This is for the graphs and also for the realtime values shown in the feed data. The Feed updates every ~30s (temperature log) but shows a very &#39;old&#39; value. How can this happen?</p>
<p>After a reboot everything is (seems) ok again. But after ~3-4 days I have the same effect again.</p>
<p>I have to say that I have another bad effect since some time. There are a lot of RFM12Bs transmitting data, because I am testing a few 30-cell lithium batteries in my house for PV energy storage. And every cell has its own RFM12B for monitoring. This leads to a lot of bad data points (unreasonable values) in my Emoncms power and temperature loggings. This is also strange because I always thought that evaluation of the CRC would prevent this.</p>
<p>But, could this also have an effect like described above? I see that I loose a lot of data points in the temperature log, possibly to parallel transmissions by one of the other RFM12s. But how can this sort of &#39;stretch&#39; the time scale?</p>
<p>Any hint very much appreciated,</p>
<p>BR, J&ouml;rg.</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="3946.html" class="topic-previous" title="Go to previous forum topic">‹ Thoughts from the Open Source Awards</a>
              <a href="3927.html" class="topic-next" title="Go to next forum topic">OEM in big building: RF reach? long-term maintainability? etc. ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-18765"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EMONCMS shown data lagging behind reality</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Tue, 25/02/2014 - 14:51.</div>
    <div class="content">
     <p>If its works ok after a reset it sounds like a system time issue? Could that be possible? do you lose power often?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-18769"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1332.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1332.jpg" alt="JBecker&#039;s picture" title="JBecker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EMONCMS shown data lagging behind reality</h3>

    <div class="submitted">Submitted by <a href="../user/1332.html" title="View user profile.">JBecker</a> on Tue, 25/02/2014 - 16:26.</div>
    <div class="content">
     <p>Not really (==never). And system time is absolutely correct if I log into the Raspberry Pi (date command).</p>
<p>The graphs in Emoncms also show the correct &#39;time&#39; means that the last data point shown is always at the current time (but the data itself is 6 hours old).</p>
<p>&nbsp;</p>
<p>PS: if I look into the data, I think I can see that the &#39;shifting&#39; began at the same time when I also see the first &#39;bad&#39; data points appear. This was around start of February when I moved an 8-cell Lithium battery block from the cellar into my office (where the raspi is also located). So I think it has something to do with destroyed data packets (?). But how can this affect the time when the data is stored in the data base?&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-18770"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1332.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1332.jpg" alt="JBecker&#039;s picture" title="JBecker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EMONCMS shown data lagging behind reality</h3>

    <div class="submitted">Submitted by <a href="../user/1332.html" title="View user profile.">JBecker</a> on Tue, 25/02/2014 - 16:59.</div>
    <div class="content">
     <p>Could it possibly be, that the serial receive buffer size (on the rasbpi) is increasing because more data is put into the buffer than what is read from it (maybe due to bad length information)? Is this buffer dynamically allocated?</p>
<p>I can remember that free memory on the rasbpi was very much down before I rebooted last time. It was showing only ~20MB left (I looked into this because the rasbpi appeared very slow to me). After reboot I can now see more than 300MB free memory (slowly but monotonously decreasing!). Or is this pure nonsense (I have absolutely no experience with Linux!)?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-18791"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1332.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1332.jpg" alt="JBecker&#039;s picture" title="JBecker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EMONCMS shown data lagging behind reality</h3>

    <div class="submitted">Submitted by <a href="../user/1332.html" title="View user profile.">JBecker</a> on Wed, 26/02/2014 - 08:49.</div>
    <div class="content">
     <p>I would very much like to have a look into the receiving code on the rasbpi. Could someone please point me into the right direction (where exactly do I find this code)? I am using an RFM12PI V1 (with ATTiny),</p>
<p>BR, J&ouml;rg.</p>
<p>PS: since reboot yesterday evening, temperature is already &#39;lagging&#39; by more than one hour now! How I tested:</p>
<p>The temperature graph shows 19.2&deg;C at 8:36 (the correct time). The feed data also shows 19.2&deg;C (updated 9s ago). I then put the sensor between my fingers (&gt;30&deg;C) for a few minutes. All the feeds are continuously updating in the normal time intervals (AC power every 10s, temperatures ~every 50s). But the &#39;finger effect&#39; shows up only after more than one hour!?!&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-18806"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EMONCMS shown data lagging behind reality</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 26/02/2014 - 17:35.</div>
    <div class="content">
     <p>if your using raspberrypi_run.php to recieve packets from the rfm12pi adapter board then you could try restarting the rfm12piphp service with logging turned on</p>
<p>sudo /etc/init.d/rfm12piphp restart log</p>
<p>the log should then be here:</p>
<p>/var/log/rfm12piphp.log</p>
<p>can can be viewed with</p>
<p>tail -f /var/log/rfm12piphp.log</p>
<p>Alternatively you can run the script manually:</p>
<p>sudo /etc/init.d/rfm12piphp stop</p>
<p>then:</p>
<p>cd /var/www/emoncms/Modules/raspberrypi</p>
<p>sudo php raspberrypi_run.php</p>
<p>What feed engines are you using?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-18839"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1332.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1332.jpg" alt="JBecker&#039;s picture" title="JBecker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EMONCMS shown data lagging behind reality</h3>

    <div class="submitted">Submitted by <a href="../user/1332.html" title="View user profile.">JBecker</a> on Thu, 27/02/2014 - 13:31.</div>
    <div class="content">
     <p>Hmmm, possibly due to all this playing around with reboots and also some power OFF/ONs, i finally managed to kill something on the SD-Card. It is not booting any more. That&#39;s it for the moment!</p>
<p>During more than one year I never had a problem with SD card corruption, only contact problems between the micro SD card and the card adapter (had to move the card a bit in all directions until it would finally boot). I tried three adapters (Samsung) and only one worked at all in the Raspi. Why didn&#39;t they use a micro SD card socket instead?</p>
<p>Sorry that I cannot test anything anymore. I still think that there might be a potential problem in an environment with many RF transmissions in the same band.&nbsp; &nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/3921"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-8DgyTfzsVZRTEGCite4DSnfxMw13T8pxQuS1KuFVWT8" value="form-8DgyTfzsVZRTEGCite4DSnfxMw13T8pxQuS1KuFVWT8"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
