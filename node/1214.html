<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/1214 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:36:28 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Measuring Air-to-Air Heatpump RPM - pulse counting ... ??? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Measuring Air-to-Air Heatpump RPM - pulse counting ... ???</h3>
        <span class="submitted">Submitted by <a href="../user/1747.html" title="View user profile.">Petrik</a> on Sun, 21/10/2012 - 17:58</span>
        <div class="content"><p>The output of modern heatpump can be measured fairly easily with temperature difference between inlet and outlet and multiplied with fan speed.</p>
<p>heat output = dT (out - in) * rpm * airflow constant</p>
<p>In many of the&nbsp;air-to-air heatpumps the&nbsp;fan speed is controlled internally to keep the fan output constant. for that purpose the motor has two wires that output the rpm. this is used internally used by the heatpump to keep the speed constant but its also handy for us who want to measure the heat produced.</p>
<p>I have succesfully used an one wire counter circuit but now when moving the one wire network to open energy monitor environment I have started to look for different possibilities. (The old circuit was just isolating the output from heatpump with an optocoupler: <a href="../../../macmadigan.com/ilp/kierrosnopeus2.jpg">http://macmadigan.com/ilp/kierrosnopeus2.jpg</a>).</p>
<p>Questions popping into the mind are e.g. :</p>
<p>- There is a pulse input on the circuit board, but as the rpm varies between 700-1400rpm the amount of interrupts may interefere with the power calculation logic ? (recall vaguely that the pulse output is 4 x rpm in my heatpump, but may remember incorrectly)</p>
<p>- Could I use arduino frequency measurement library, e.g. [url]http://www.pjrc.com/teensy/td_libs_FreqMeasure.html[/url]?</p>
<p>- Does the 1-wire library support pulse counter if can not use the pulse input of emonTX ?</p>
<p>... so ...</p>
<p><strong>Has anyone else implemented a heatpump&nbsp;RPM counter on emonTX board or anyting alike to measure frequencies in the range of 700-6000Hz ? ... any recommendations for this ... ?</strong></p>
<p>&nbsp;</p>
<p>Edit - just fixed a broken link as referenced this text on another forum.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="1269.html" class="topic-previous" title="Go to previous forum topic">‹ EmonGLCD Backlight</a>
              <a href="1270.html" class="topic-next" title="Go to next forum topic">Where can I get a RFM12Pi ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-6810"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/450.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="stuart&#039;s picture" title="stuart&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Measuring Air-to-Air Heatpump RPM - pulse counting ... ???</h3>

    <div class="submitted">Submitted by <a href="../user/450.html" title="View user profile.">stuart</a> on Sun, 21/10/2012 - 19:30.</div>
    <div class="content">
     <p>You could use a binary counter chip on the pulse to reduce/scale down the number of times it calls the interrupt, down by 16 and it would be called about 44 times a minute, easily readable by the chip without delaying the readings to much.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7018"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1747.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1747.jpg" alt="Petrik&#039;s picture" title="Petrik&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Measuring Air-to-Air Heatpump RPM - pulse counting ... ???</h3>

    <div class="submitted">Submitted by <a href="../user/1747.html" title="View user profile.">Petrik</a> on Fri, 02/11/2012 - 17:48.</div>
    <div class="content">
     <pre>
Implemented the rpm pulse counter using the following algo, seems to be working 
at desktop without a need for pulse divider. Shall see when connect it to the 
heatpump fan, either using a hal sensor or direct output from the DC motor 
speed control pulse.


...
void onPulse() {rpmcount++;}
...


void loop() {
...
    //
    // Calculate rpm by using how many times the interrupt has been called
    //
    if ((rpmcount &gt;= rpm_resolution) || (rpmcount == rpmcountold))                                                                                     // then calculate the rpm
    {
     timenew=millis();
     rpm = ((rpmcount * 1200)/(timenew - timeold)) * 50; // milliseconds to RPM with 50rpm resolution
     timeold = timenew;
     emontx.rpmhp = rpm;
     rpmcount=0;
    }
    rpmcountold = rpmcount;
...
}</pre>         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/1214"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-XRol6I92-gMLO7fkmbUMYg9SlFNAKqm51PnBIMqfn4M" value="form-XRol6I92-gMLO7fkmbUMYg9SlFNAKqm51PnBIMqfn4M"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/1214 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:36:49 GMT -->
</html>
