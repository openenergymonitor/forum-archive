<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/4064 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:43:39 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>[[Success!]] Dutch Smart meters | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">[[Success!]] Dutch Smart meters</h3>
        <span class="submitted">Submitted by <a href="../user/5417.html" title="View user profile.">Hertog</a> on Fri, 14/03/2014 - 23:25</span>
        <div class="content"><p>Hi all,</p>
<p>New to all this, so please be gentle ;)</p>
<p>I am currently in the process of writing some PHP code that hopefully make OEM/EmonCMS more useful for Dutch users. Since it has recently be decided by our government that everybody should have one in their homes, the coming few years will see a big influx of possible users of EmonCMS (less so of OEM users, I think).</p>
<p>However, one of the demands the government had was that the smart meter had to be user readable, I believe we have some benefit here over other countries where this was not mandatory, but correct me if I am wrong in that department.</p>
<p>This demand resulted in all smartmeters having a so called P1-port, which is a serial port that has the ability to transmit the available data every 5 seconds (available data consists of: High/Low Tarif Import/Export (updated every 5 seconds) and&nbsp;gas usage (updated every hour), sadly the water companies are somehow not involved in all this, alhough technically they could have been.</p>
<p>This is where EmonCMS comes in. My plan is to write a plugin to EmonCMS which is capable of reading the data from the P1-Port, and enter it into EmonCMS.&nbsp;</p>
<p>Possible blocking issues are:</p>
<p>My very basic knowledge of PHP (hey, that&#39;s half the fun, but am more of a perl guy:))</p>
<p>And that&#39;s about it. I&#39;ve been a UNIX sysadmin for almost all of my professional career, so the computer knowledge is there, challenge accepted ;)</p>
<p>&nbsp;</p>
<p>First steps are taken btw, here is the output of a PHP script that reads and prints the meter output:</p>
<p>/ISk5\2ME382-1003<br />
	0-0:96.1.1(XXXXXXXXXXXXXXXXXXXXXXXXXXXX)<br />
	1-0:1.8.1(01774.500*kWh)<br />
	1-0:1.8.2(01259.416*kWh)<br />
	1-0:2.8.1(00443.464*kWh)<br />
	1-0:2.8.2(00400.373*kWh)<br />
	0-0:96.14.0(0001)<br />
	1-0:1.7.0(0000.61*kW)<br />
	1-0:2.7.0(0000.00*kW)<br />
	0-0:17.0.0(0999.00*kW)<br />
	0-0:96.3.10(1)<br />
	0-0:96.13.1()<br />
	0-0:96.13.0()<br />
	0-1:24.1.0(3)<br />
	0-1:96.1.0(XXXXXXXXXXXXXXXXXXXXXXXXXXXXX)<br />
	0-1:24.3.0(140315000000)(00)(60)(1)(0-1:24.2.1)(m3)<br />
	0-1:24.4.0(1)<br />
	!</p>
<p>Definitions of the message:&nbsp;http://goo.gl/MjpuYe&nbsp;(lengthy document, Appendix A contains the definitions)</p>
<p>&nbsp;</p>
<p>Wish me luck! :)</p>
  <div class="forum-topic-navigation clear-block">
          <a href="10908.html" class="topic-previous" title="Go to previous forum topic">‹ Emonhub: problem with Apache server on shared host linux</a>
              <a href="10904.html" class="topic-next" title="Go to next forum topic">Activate MQTT emonHub ? ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-19257"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5417.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-5417.jpg" alt="Hertog&#039;s picture" title="Hertog&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: [[Success!]] Dutch Smart meters</h3>

    <div class="submitted">Submitted by <a href="../user/5417.html" title="View user profile.">Hertog</a> on Sat, 15/03/2014 - 03:19.</div>
    <div class="content">
     <p>Some progress, most of the time is in looking up the PHP equivalent of PHP functions ;).</p>
<p>I now have the needed data in an array that I can use to make calls to EmonCMS. But that&#39;s something to figure out tomorrow ;)</p>
<p>Something weird happens now and then though, for some reason the logic can&#39;t &#39;lock in&#39; at the right place in the serial data stream, and the message as send by the smart meter comes in al garbled. I guess I&#39;m trying to read too fast, or something like that.</p>
<p>&nbsp;</p>
<p>Anyhow, this is what I have to process further and to send via the right API calls to EmonCMS:</p>
<p>Array<br />
	(<br />
	&nbsp;&nbsp;&nbsp; [Grid_Import_LowTarif] =&gt; 01776.784<br />
	&nbsp;&nbsp;&nbsp; [Grid_Import_HighTarif] =&gt; 01259.416<br />
	&nbsp;&nbsp;&nbsp; [Grid_Export_LowTarif] =&gt; 00443.464<br />
	&nbsp;&nbsp;&nbsp; [Grid_Export_HighTarif] =&gt; 00400.373<br />
	&nbsp;&nbsp;&nbsp; [Actual_Usage_LowTarif] =&gt; 0000.68<br />
	&nbsp;&nbsp;&nbsp; [Actual_Usage_HighTarif] =&gt; 0000.00<br />
	&nbsp;&nbsp;&nbsp; [ActualTarif] =&gt; Low<br />
	&nbsp;&nbsp;&nbsp; [Gas] =&gt; 00845.893<br />
	)</p>
<p>When submitting to EmonCMS I&#39;ll have to do some logic with the Actuall_Tarif&nbsp;to see which of the Actual_Usage_(High|Low)Tarif values I&#39;ll send.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-19352"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/5417.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-5417.jpg" alt="Hertog&#039;s picture" title="Hertog&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: [[Success!]] Dutch Smart meters</h3>

    <div class="submitted">Submitted by <a href="../user/5417.html" title="View user profile.">Hertog</a> on Mon, 17/03/2014 - 21:29.</div>
    <div class="content">
     <p>Success!</p>
<p>Although there are still a few kinks to work out (the reader of the serial data loses track now and then) I can now read all the values out of the SmartMeter.</p>
<p><a href="http://emoncms.org/hertog/SmartM" title="http://emoncms.org/hertog/SmartM">http://emoncms.org/hertog/SmartM</a></p>
<p>Only the value of the gasmeter (not actual usage, but total usage), high or low tariff and Actual Power Usage are shown in the dashboard above (and the measurements from the EmonTXv3 for comparison).</p>
<p>now some code cleaning is required ;)&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31606"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8335.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="gerbrand&#039;s picture" title="gerbrand&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: [[Success!]] Dutch Smart meters</h3>

    <div class="submitted">Submitted by <a href="../user/8335.html" title="View user profile.">gerbrand</a> on Mon, 22/06/2015 - 15:31.</div>
    <div class="content">
     <p>Hi Hertog,</p>
<p>your project sounds incredibly interesting. My shipment of&nbsp;emonTx&nbsp;and emonPi are under way and I have requested priority installation of a smart meter. Would you be willing to share your code? How did you interface physically with the smart meter?&nbsp;</p>
<p>Thanks!<br />
Gerbrand<br />
(based in Amsterdam)</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-31784"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3818.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3818.png" alt="fversteegen&#039;s picture" title="fversteegen&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: [[Success!]] Dutch Smart meters</h3>

    <div class="submitted">Submitted by <a href="../user/3818.html" title="View user profile.">fversteegen</a> on Mon, 29/06/2015 - 11:24.</div>
    <div class="content">
     <p>Really looking forward to your implementation! I do not (yet) have a smartmeter, but I guess it will be just a matter of time before I will.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/4064"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-NLY6fWlTCaPvKfU22UFLH04UOBEYTqRCMtVjt72-YnQ" value="form-NLY6fWlTCaPvKfU22UFLH04UOBEYTqRCMtVjt72-YnQ"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
