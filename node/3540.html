<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/3540 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:28:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>New inputs not showing/heavily delayed | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">New inputs not showing/heavily delayed</h3>
        <span class="submitted">Submitted by <a href="../user/3862.html" title="View user profile.">GJPickard</a> on Mon, 06/01/2014 - 18:24</span>
        <div class="content"><p>I have been adding some room temperature sensors over the weekend to my emoncms (v6) and RPi set up [4 existing room sensors and an emonTXv3] with some very odd results.</p>
<p>I am using moteinos (lowpowerlab.com) with RFM12Bs @ 433 mhz for these and have made a few little shields on protoboard to tidy up the sensor wiring (a DS18B20 with a DHT11 for some) and to add a voltage divider for battery monitoring.&nbsp;</p>
<p>A big thanks to the oem crew for their emonTH code which was a great start and seems to handle upgrading temp nodes from one to two sensors very well - although the serial debug output can be oddly temperamental - maybe down to my cheep ebay FTDI cable.</p>
<p>I was tearing my hair out on Saturday evening/Sunday morning as I just could not get the inputs recognized - I was left wondering if it was a software or hardware issue.&nbsp; I also seemed to have issues with the existing nodes dropping out (or some of them any way) when I fired up a new sensor.</p>
<p>Just in case I left one of the new nodes switched on in case I had some sort of network stability issues that needed to settle down.</p>
<p>I checked again in the evening and suddenly I had various new inputs flagged for the nodes I had tried in the morning and the new node was being recognized.&nbsp; I also seemed to have some discrepancies with new nodes in the local and emoncms.org instances.</p>
<p>Is there a known issue with adding nodes to an existing emoncms/Jeelib network?&nbsp;</p>
<p>Is there a recommended process for adding new nodes, e.g. switch on the new node and wait a while for things to stabilize?</p>
<p>Many thanks</p>
  <div class="forum-topic-navigation clear-block">
          <a href="3602.html" class="topic-previous" title="Go to previous forum topic">‹ Time Categories for the Input/Feeds</a>
              <a href="3528.html" class="topic-next" title="Go to next forum topic">how to use redis? ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-17425"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New inputs not showing/heavily delayed</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Thu, 09/01/2014 - 10:19.</div>
    <div class="content">
     <p>I too have had this problem with my recently upgraded HDD + Raspberry Pi install, it was/is fine on my older &nbsp;SD Card system. One thing I did find (and time will tell if this was the actual&nbsp;problem) was that the recent install was flashing the RFM12PI&#39;s&nbsp;green led continually and further investigation revealed the new&nbsp;RFM12b Packet Generator module already had an example set up which was set to send data every 5 seconds. I assume it was flashing more frequently than this as nothing was receiving the packets thus no acks and frequent retries. Having cleared out the Packet Generator example the LED now only flashes as before when receiving a packet from a node so I hope I&#39;ve found the problem.</p>
<p>I assume the delay in seeing inputs (and the missing data from existing inputs I was also seeing) was due to the RFM12Pi being busy and not receiving/acknowledging the node&#39;s packets until they eventually found a non busy slot after many retries.</p>
<p>Additionally I couldn&#39;t get into the Packet Generator web page until I deleted duplicate copies of the packetgen*.php files from the emoncms&nbsp;directory (they already exist in the emoncms/Modules/packetgen directory)</p>
<p>Hope this helps.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-17507"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3464.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3464.jpg" alt="Bra1n&#039;s picture" title="Bra1n&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New inputs not showing/heavily delayed</h3>

    <div class="submitted">Submitted by <a href="../user/3464.html" title="View user profile.">Bra1n</a> on Tue, 14/01/2014 - 10:53.</div>
    <div class="content">
     <p>Further to the above it looks like my new RFM12Pi V2 is not quite up to the mark of my previous V1 when it comes to reception and is marginal with my furthest node, shutting the door to the room where the Pi resides is enough to lose communication (as I found out last night)</p>
<p>A correction to the above it would seem the problem was reduced transmit power from that node when the battery dropped to 2.85 V, a new battery has solved the issue for now but I am investigating using a repeater.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-17630"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New inputs not showing/heavily delayed</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 15/01/2014 - 15:24.</div>
    <div class="content">
     <p>Il add a limit to the packetgen update frequency, I wonder if it got stuck just transmitting with no delay, that may well be the same issue that oem06 had here:http://openenergymonitor.org/emon/node/3583</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-17631"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New inputs not showing/heavily delayed</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 15/01/2014 - 15:26.</div>
    <div class="content">
     <p>To manually fix, adding the following line should do it:</p>
<p><strong>if ($controlinterval&lt;5) $controlinterval = 5;</strong></p>
<p>if ((time()-$controltime) &gt; $controlinterval)<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $controltime = time();<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $str = $packetgen-&gt;getrfm12packet($session[&#39;userid&#39;]);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fprintf($f,$str.&quot;s&quot;);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; usleep(100);<br />
	}</p>
<p>line 321 here: <a href="https://github.com/emoncms/packetgen/blob/master/copyto_raspberrpi_module/raspberrypi_run.php#L321" title="https://github.com/emoncms/packetgen/blob/master/copyto_raspberrpi_module/raspberrypi_run.php#L321">https://github.com/emoncms/packetgen/blob/master/copyto_raspberrpi_modul...</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/3540"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-B_JLpTrQV70Hnpa_PX2wSD7Czsp_Mx0dadYKp2ZuqSM" value="form-B_JLpTrQV70Hnpa_PX2wSD7Czsp_Mx0dadYKp2ZuqSM"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/3540 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:28:35 GMT -->
</html>
