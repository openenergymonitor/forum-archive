<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/1267 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:05:51 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Current Sensor Utility line | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/3.html">Archived: General Discussion</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Current Sensor Utility line</h3>
        <span class="submitted">Submitted by Guest on Wed, 31/10/2012 - 23:58</span>
        <div class="content"><p>I&#39;m looking to build a simple current sensor. I don&#39;t need to actually see how much current is flowing through the line but rather if its flowing. I&#39;m looking to put it on one of the utlity legs coming into my house. When the power comes back on the device would sense and light something up or send a message.</p>
<p>Help getting started....</p>
<p>1. I have a 200amp service, do I need a current sensor rated for 200amp if all I want to do is know if there is power on the line?</p>
<p>2. Which current sensor would work best to interface with an arduino?</p>
<p>I think at first I&#39;ll just right the code to light a led or something when voltage is detected. Possibly move to sending a message or email when it&#39;s detected.</p>
<p>Thanks for the help!</p>
  <div class="forum-topic-navigation clear-block">
          <a href="1310.html" class="topic-previous" title="Go to previous forum topic">‹ Interested in using the Open EnergyMonitor in Canada</a>
              <a href="1216.html" class="topic-next" title="Go to next forum topic">Newbie question emoncms run mode ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-6987"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 01/11/2012 - 00:53.</div>
    <div class="content">
     <p>Do you want to detect the presence of voltage, or the fact that current is being drawn? These are two entirely different things. You can have a voltage and draw no current, but not vice versa.</p>
<p>If you want an indication of current, it&#39;s a rather tricky problem because as you suggest, whatever you install will need to detect the smallest useful load - say 10 W or 40 mA, whilst being able to withstand 200 A. I would suggest a 200 A split core current transformer, but with a non-linear burden, say 4.7 V zener diodes. This arrangement would give you essentially a square wave of constant amplitude for a wide range of current, but what the minimum is that you could detect would be hard to predict. This voltage would need to be rectified and fed into a digital input of the processor.</p>
<p>If all you are interested in is an indication of the presence of a voltage, the situation is somewhat simpler. If you want a non-contact method, I would suggest a capacitive pickup - nothing more than a length of well-insulated wire wrapped around the outside of the incoming line conductor, feeding into an operational amplifier, the rectified output of which will drive a digital input of the processor.&nbsp; If you are prepared to make a connection to the electricity supply (and you have the knowledge and experience to do it safely and your local regulations allow it), then you could do something as simple as connect a neon lamp and detect the light output with a photo-resistor, which would be very simple.</p>
<p>There&#39;s a possible third way: do you have a meter provided by your electricity supplier that is capable of indicating what you want to know? If so, detecting that - a rotating disk or a flashing LED, might be easier.</p>
<p>I can&#39;t really take this any further without knowing a bit more about what you are prepared to build.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7003"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rc3477&#039;s picture" title="rc3477&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by rc3477 (not verified) on Thu, 01/11/2012 - 20:14.</div>
    <div class="content">
     <p>Thanks for the response. What I&#39;m looking for is just to see the presence of voltage. The main breaker would be off in this situation so there shouldn&#39;t be current flowing right? I just need to be notified when that line is &quot;hot&quot; so to speak. Tapping into the line is definitely something I don&#39;t want to get into, something non invasive is what I&#39;m aiming for. I was looking into possibly something like a voltage tester for outlets. I&#39;m not entirely sure of the tech behind it, but its a non contact sensor and beeps when its comes near a line that is hot. This would obviously be stationary though.</p>
<p>Thanks again</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7008"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Fri, 02/11/2012 - 00:35.</div>
    <div class="content">
     <p>You obviously need to get at the supply cable upstream of your main breaker if you want to detect that a supply is available. What I&#39;m suggesting depends on there being separate line and neutral conductors.</p>
<p>I&#39;ve never taken a voltage tester apart (I wouldn&#39;t own one - I prefer to rely for my safety on something a lot simpler that doesn&#39;t depend on batteries, a neon screwdriver!) but the operating principle has to be similar to my non-contact voltage method.</p>
<p>I&#39;ll try an experiment in the next day or two to see if the analogue input of the processor itself is sensitive enough to pick up a reliable voltage without any additional electronics - it&#39;s worth a try.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7017"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Fri, 02/11/2012 - 17:04.</div>
    <div class="content">
     <p><em>I&#39;ll try an experiment in the next day or two to see if the analogue input of the processor itself is sensitive enough to pick up a reliable voltage without any additional electronics - it&#39;s worth a try.</em></p>
<p>Using a spare analogue input on an emonTx, I wrote a quick sketch to read the input 200 times and record the max and min count. With no connection, the swing (max - min) was fairly consistently in the 250-300 region. With a length of wire held onto the input pin, the swing was consistently 1023. That was working just on pickup. The experiment was rudimentary to say the least, and further experimentation is clearly needed. But it seems that the principle is sound.</p>
<p>Just one thought: this is all going to be battery powered, isn&#39;t it?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7036"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rc3477&#039;s picture" title="rc3477&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by rc3477 (not verified) on Sat, 03/11/2012 - 19:10.</div>
    <div class="content">
     <p>Yes most likely battery powered. Running off of a car battery, it would only be turned on once the utility power goes out. Something like this is what I&#39;m aiming for&nbsp;http://www.nooutage.com/thp108.htm which is no longer made due to not being loud enough. Or like this&nbsp;http://measure-current.com/&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7039"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 03/11/2012 - 23:04.</div>
    <div class="content">
     <p>What you are looking at there are two totally different concepts. <a href="http://measure-current.com/" title="http://measure-current.com/">http://measure-current.com/</a> is a Hall effect current transducer, sensing the magnetic field arising from flowing current and carrying out the same function as a current transformer, and it measures current.&nbsp; As you rightly point out, with your incoming breaker open, it will read nothing irrespective of whether the supply is present or not. It will read current when you close the breaker and start to draw a load - by which time you know the supply is on because things will start to work!</p>
<p>The first device <a href="http://www.nooutage.com/thp108.htm" title="http://www.nooutage.com/thp108.htm">http://www.nooutage.com/thp108.htm</a> is much more like what I think you want and what I described, with an insulated wire picking up the electric field that will be present when the main conductor is energised, whether or not a current is flowing.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7041"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rc3477&#039;s picture" title="rc3477&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by rc3477 (not verified) on Sat, 03/11/2012 - 23:55.</div>
    <div class="content">
     <p>I realized that after posting lol thanks for clarifying though. I&#39;m new to monitoring these types of things. The first device is definitely what I&#39;m looking for though. I only need to know if there is power there not whether current is flowing.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7042"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="jstoaks&#039;s picture" title="jstoaks&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by <a href="../user/1016.html" title="View user profile.">jstoaks</a> on Sun, 04/11/2012 - 00:14.</div>
    <div class="content">
     <p>I believe you could simply use a 5Vdc&nbsp;wall wart to supply a 5v input, If the pin input is high = Voltage present. If low = No Voltage present.</p>
<p>OR</p>
<p>Use a Normally open-high coil voltage relay or contactor. I dont know what power system you use. But say a 110 volt relay energized from the 110 volt closing the switched circuit supplying 3.3v or 5v&nbsp;to the input and signaling a TRUE condition</p>
<p>Thinking more of a electro/mechanical logic function.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7043"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rc3477&#039;s picture" title="rc3477&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by rc3477 (not verified) on Sun, 04/11/2012 - 00:19.</div>
    <div class="content">
     <p>The main breaker would be off when this device is on. So plugging something into an outlet wouldn&#39;t work. The sensor would have to be on one of the utility legs coming into the panel before the main breaker.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7044"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="jstoaks&#039;s picture" title="jstoaks&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by <a href="../user/1016.html" title="View user profile.">jstoaks</a> on Sun, 04/11/2012 - 00:43.</div>
    <div class="content">
     <p>I&#39;m not sure why the main breaker would be off, in your first post you stated ..</p>
<p>&quot;I&#39;m looking to put it on one of the utlity legs coming into my house. When the power comes back on the device would sense and light something up or send a message.&quot;</p>
<p>When you say &quot;when the power comes back on - send a message&quot;</p>
<p>&nbsp;</p>
<p>Sorry if I misunderstood, But it seemed to me you wanted to indicate a TRUE condition statement.</p>
<p>&nbsp;</p>
<p>best regards</p>
<p>&nbsp;</p>
<p>J</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7049"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 04/11/2012 - 13:28.</div>
    <div class="content">
     <p><a href="../user/1016.html" title="View user profile.">jstoaks</a>&nbsp;</p>
<p>In his post of Thu, 01/11/2012 - 20:14, <a href="../user/2064.html" title="View user profile.">rc3477</a> clearly stated that the main breaker would be off and he required a non-contact means of sensing.&nbsp; Please read <u>all</u> the thread before you confuse the issue. The main breaker may be off for a number of very good reasons. The one that readily springs to mind is because he has a backup supply (just like a PV installation) that cannot&nbsp; be allowed to backfeed into the mains.</p>
<p>I agree that a relay or contactor connected on the incoming side of the main breaker would be much simpler and probably more reliable, there are however obvious safety and possibly regulatory requirements that are likely to make that a non-viable option.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7050"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rc3477&#039;s picture" title="rc3477&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by rc3477 (not verified) on Sun, 04/11/2012 - 18:09.</div>
    <div class="content">
     <p>thanks for clearing that up robert&nbsp;thats exactly the case. I have an arduino that I&#39;m not currently using so I might try what you had done as your test. Could you send me that sketch you created? Also did you use any specific type of wire on the analog input ?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7053"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 04/11/2012 - 22:53.</div>
    <div class="content">
     <p>You&#39;re in luck - I hadn&#39;t thrown it away!</p>
<pre>
//Set input pins
int inPin5 = 4;
int inPin6 = 5;

int max5, max6;
int min5, min6;

int adc;

void setup(void)
{
    Serial.begin(115200);
}

void loop(void)
{
    min5 = 1024;
    max5 = 0;
    min6 = 1024;
    max6 = 0;

    for (int n = 0; n&lt;200; n++)
    {
        adc = analogRead(inPin5);
        if (max5 &lt; adc)
            max5 = adc;
        if (min5 &gt; adc)
            min5 = adc;
            
        adc = analogRead(inPin6);
        if (max6 &lt; adc)
            max6 = adc;
        if (min6 &gt; adc)
            min6 = adc;
    }
    Serial.print(max5 - min5); Serial.print(&quot; &quot;);Serial.print(max6 - min6); 
    delay(1000);
}    </pre><p>The wire was actually a multimeter test lead without the multimeter on the end.&nbsp; You should use wire insulated to at least the peak value of your mains - you&#39;ll probably use ordinary 600 V equipment wire, and you must make sure there&#39;s no conductor sticking out at the end that could contact the live line. My laptop supply is unearthed and floats at around 80 V, it was picking up the field from that. You need to get the Arduino quite close (under 1m) and you should use the minimum length wrapped around the incoming line (not neutral) cable consistent with it working, because you are relying on the built-in protection diodes in the chip to prevent damage to the input (although realistically you will never get enough current to overload them with just a few turns wrapped around the cable - unless you suffer a lightning strike).</p>
<p>I was using a standard emonTx (cct diagram is available elsewhere on this site) and the free analogue inputs are 4 &amp; 5 (zero-based). You only need one of them, of course. All that sketch does is show the swing on the input every second. If your Arduino is battery powered, to extend the battery life you might want to copy the emonTx code where it sleeps between readings, thus minimising current drain. Then of course you need to detect a swing greater than an appropriate threshold (which you will need to determine when you get it into position with your &#39;aerial&#39;) and drive an output to do something useful. Looking at your profile, I assume you&#39;re happy with coding that.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7054"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rc3477&#039;s picture" title="rc3477&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by rc3477 (not verified) on Sun, 04/11/2012 - 23:03.</div>
    <div class="content">
     <p>very cool !! thanks for the help, when I get this up and running I&#39;ll post back.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7647"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rc3477&#039;s picture" title="rc3477&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by rc3477 (not verified) on Sun, 25/11/2012 - 19:03.</div>
    <div class="content">
     <p>Ok so here we have my implemented code. It&#39;s still rough but it works pretty well. I&#39;ll be testing a few different &quot;calibration&quot; methods I have found, one actually on the arduino.cc site using a five second calibration period on boot up. The code writes the sensorvalue to the lcd screen, helpful for trying to pin point the value at which you want the on or off leds to fire up when its not plugged into a laptop. sensor value changes when running off of usb vs. battery pack or wall wart. I checked the values while in its permanent location and enclosure before setting it.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><code><br />
//inclue lcdLibrary<br />
#include <LiquidCrystal.h></p>
<p>//intialize the library with the numbers of the interface pins<br />
LiquidCrystal lcd(7, 8, 9, 10, 11, 12);</p>
<p>//set input pin</p>
<p>int sensorPin = A4;</p>
<p>int ledPowerOn = 3;<br />
int ledPowerOff = 2;</p>
<p>int sensorMax;<br />
int sensorMin;<br />
int sensorValue;</p>
<p>void setup(void) {</p>
<p>  //set up the LCD<br />
  lcd.begin(16, 2);</p>
<p>  //Serial.begin(9600);<br />
  //set ledPin as an output<br />
  pinMode(ledPowerOff, OUTPUT);<br />
  pinMode(ledPowerOn, OUTPUT);<br />
}</p>
<p>void loop(void) {</p>
<p>  sensorMin = 1023;<br />
  sensorMax = 0;<br />
  sensorValue = 0;</p>
<p>  for (int n = 0; n<200; n++)<br />
  {<br />
    sensorValue = analogRead(sensorPin);<br />
    if (sensorMax < sensorValue)<br />
    sensorMax = sensorValue;<br />
    if (sensorMin > sensorValue)<br />
    sensorMin = sensorValue;</p>
<p>  }</p>
<p>  if (sensorMax - sensorMin < 100)<br />
  {<br />
    digitalWrite(ledPowerOff, HIGH);<br />
    digitalWrite(ledPowerOn, LOW);</p>
<p>    //write to lcd<br />
    lcd.clear();<br />
    lcd.print(sensorMax - sensorMin);</p>
<p>  //Serial.print(max5 - min5);<br />
  //Serial.print(" ");<br />
  delay(1000);<br />
  }<br />
  else<br />
  {<br />
    digitalWrite(ledPowerOn, HIGH);<br />
    digitalWrite(ledPowerOff, LOW);</p>
<p>    //write to lcd<br />
    lcd.clear();<br />
    lcd.print(sensorMax - sensorMin);</p>
<p>   //Serial.print(max5 - min5);<br />
   //Serial.print(" ");<br />
   delay(1000);<br />
  }<br />
}<br />
</code></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7653"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 25/11/2012 - 22:04.</div>
    <div class="content">
     <p>Congratulations, well done.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-7661"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rc3477&#039;s picture" title="rc3477&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Current Sensor Utility line</h3>

    <div class="submitted">Submitted by rc3477 (not verified) on Mon, 26/11/2012 - 00:05.</div>
    <div class="content">
     <p>thanks rob, couldn&#39;t have done it without you. I&#39;ve ordered up a 100db piezo&nbsp;buzzer, the dog should love that hah.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/1267"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-0RvwEvMxvt2ln1L2uW3xR-ZLXO32kZlPnUViEnTBwNE" value="form-0RvwEvMxvt2ln1L2uW3xR-ZLXO32kZlPnUViEnTBwNE"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/1267 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:05:51 GMT -->
</html>
