<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/11490 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:57:14 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Problem with optical sensor | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Problem with optical sensor</h3>
        <span class="submitted">Submitted by <a href="../user/8002.html" title="View user profile.">tasminracer</a> on Wed, 28/10/2015 - 17:46</span>
        <div class="content"><p>Hi, all I;ve got the optical sensor plugged into my emonpi, and connected to teh led output on my 3 phase &nbsp;A1100</p>
<p>&nbsp;</p>
<p>meter... &nbsp;during the day it all seems fine ( although i need to get the scale right) but at night &nbsp;the led stays solid red but the pulse counter is still going up. it goes up by a consistent&nbsp;amount &nbsp;so i get a nice line at about &nbsp;60 degrees and then starts working properly in the morning when the led starts pulsing... obviously the kwh accumulator is then massively out as its counted 170kwh over night !!!</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Please help</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11616.html" class="topic-previous" title="Go to previous forum topic">‹ emoncms documentation and definitions</a>
              <a href="11608.html" class="topic-next" title="Go to next forum topic">Problems with emonhub after updating ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-35458"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 28/10/2015 - 22:34.</div>
    <div class="content">
     <p>I don't think it should do that! The solid on LED means the meter is in anti-creep mode, so by some means the sensor or the Pi is seeing pulses.</p>
<p>What do you mean by 60&deg;, i.e, what is the actual pulse rate that you are seeing?  (Could it be that the LED is being strobed by the software inside the meter and the sensor is reading that?)</p>
<p>How have you connected the sensor?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35460"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8002.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="tasminracer&#039;s picture" title="tasminracer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8002.html" title="View user profile.">tasminracer</a> on Wed, 28/10/2015 - 23:11.</div>
    <div class="content">
     <p>This is the screen grab from the pulse accumulator raw data visualisation. you can see the day time and then the night when it shoots up</p>
<p>&nbsp;</p>
<p><img alt="" src="../../../eco2solar.co.uk/hq-eco/wp-content/uploads/2015/10/Screen-Shot-2015-10-28-at-23.02.57.png" style="width: 700px;" /></p>
<p>&nbsp;</p>
<p>and this is the kwh to pwr trace of the same data, you can see the generation rise and fall during the day and then the massive and consistant&nbsp;jump at night.</p>
<p><img alt="" src="../../../eco2solar.co.uk/hq-eco/wp-content/uploads/2015/10/Screen-Shot-2015-10-28-at-23.03.25.png" style="width: 700px;" /></p>
<p>&nbsp;</p>
<p>Im using the Open energy optical sensor and its mounted over the red led on the elster a1100 meter using the supplied polo shaped velcro.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>ta</p>
<p>G</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35461"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 29/10/2015 - 00:03.</div>
    <div class="content">
     <p>I did believe you, but I can only get a very rough rate from those screen grabs. Can you answer the question and give the actual pulse rate as a number?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35467"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8002.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="tasminracer&#039;s picture" title="tasminracer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8002.html" title="View user profile.">tasminracer</a> on Thu, 29/10/2015 - 09:44.</div>
    <div class="content">
     <p>Ok working from the graph and expanding it</p>
<p>from the raw pulse im getting approx&nbsp;32467 pulses an hour or approx 541 a minute or around 9 a second.</p>
<p>I&#39;ve checked that for two separate hours and it seems to come to the same amount.</p>
<p>&nbsp;</p>
<p>also exporting an hours data i get the same result of about 540 per minute &nbsp;( which corresponds to a kwh per min on the pulse count)</p>
<p><span style="line-height: 1.6;">Count &nbsp; &nbsp;, difference per min</span></p>
<p><span style="line-height: 1.6;">6777552</span></p>
<p>6778093 541<br />
6778633 540<br />
6779174 541<br />
6779707 533<br />
6780217.5 510.5<br />
6780796 578.5<br />
6781336 540<br />
6781877 541<br />
6782417.5 540.5<br />
6782958 540.5<br />
6783499 541<br />
6784039.5 540.5<br />
6784580 540.5<br />
6785120.5 540.5<br />
6785661 540.5<br />
6786202 541<br />
6786719.5 517.5<br />
6787283 563.5<br />
6787824 541<br />
6788364 540<br />
6788905 541<br />
6789445.5 540.5<br />
6789986 540.5<br />
6790527 541<br />
6791067 540<br />
6791585.5 518.5<br />
6792148.5 563<br />
6792689 540.5<br />
6793230 541<br />
6793770 540<br />
6794311 541<br />
6794851.5 540.5<br />
6795392 540.5<br />
6795933 541<br />
6796466 533<br />
6796999 533<br />
6797554.5 555.5<br />
6798095 540.5<br />
6798636 541<br />
6799176.5 540.5<br />
6799717 540.5<br />
6800257.5 540.5<br />
6800798 540.5<br />
6801339 541<br />
6801879.5 540.5<br />
6802420 540.5<br />
6802960.5 540.5<br />
6803478.5 518<br />
6804012 533.5<br />
6804560 548<br />
6805093 533<br />
6805626.5 533.5<br />
6806159 532.5<br />
6806700 541<br />
6807240.5 540.5<br />
6807781 540.5</p>
<p>&nbsp;</p>
<p>Thanks for looking im stumped&nbsp;</p>
<p>&nbsp;</p>
<p>G</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35469"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 29/10/2015 - 10:28.</div>
    <div class="content">
     <p>That agrees with the rough figure I'd got, but I wasn't sure of the scaling applied (if any). 9 per second ties in uncomfortably closely with the minimum pulse duration set in the sketch, so I do wonder whether the LED in the meter is indeed strobed and it's seeing the first flash after the timeout as a pulse. Is there any way you can check that - possibly with a long exposure photograph whilst panning the camera? If the LED is strobed, you should see a line of red dashes rather than a continuous steak.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35472"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8002.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="tasminracer&#039;s picture" title="tasminracer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8002.html" title="View user profile.">tasminracer</a> on Thu, 29/10/2015 - 10:54.</div>
    <div class="content">
     <p>Its difficult to get access to the meter as its on a different site. Is there a tweek to the sketch i could try? its hosted on our server not the main emoncms site.</p>
<p>&nbsp;</p>
<p>G</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35473"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8002.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="tasminracer&#039;s picture" title="tasminracer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8002.html" title="View user profile.">tasminracer</a> on Thu, 29/10/2015 - 11:13.</div>
    <div class="content">
     <p>mmm i think we might have another issue to , as a quick back of a fag packet calculation&nbsp;of a 50kwp system and 500 pulses per kwh gives me a max pulse of 6.944&nbsp;</p>
<p>&nbsp;</p>
<p>what is the max pulses per sec we can get away with</p>
<p>G</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35483"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 29/10/2015 - 17:01.</div>
    <div class="content">
     <p>The falling edge of the pulse generates an interrupt, and it's handled thus:</p>
<pre>
// The interrupt routine - runs each time a falling edge of a pulse is detected
void onPulse()                  
{  
  if ( (millis() - pulsetime) > min_pulsewidth) {
    pulseCount++;			//calculate wh elapsed from time between pulses
    pulsetime=millis(); 
  }	
}
</pre><p>
min_pulsewidth is therefore actually the minimum period, and it's set to 110 ms. 541 per minute = 0.1109 s period, and it's that which rang the alarm bells. So if I'm right and the LED is strobed, the first falling edge after 110 ms will be counted, and restart the 110 ms timer...</p>
<p>I don't know that I'm on the right track here, but I can't see another mechanism to explain it.</p>
<p>I'll get Trystan involved. I don't know the spec for the sensor, but as the output is TTL, I'm betting it will see kiloherz pulses with no difficulty.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35517"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 30/10/2015 - 13:21.</div>
    <div class="content">
     <p>Hi&nbsp;Graham,</p>
<p>I have just updated the emonPi&nbsp;firmware (V1.8) to turn on internal pull-up resistors on the emonPi pulse counting pin. Please update your emonPi by going to admin&gt;update in local emoncms. More info on how to update here:</p>
<p><a href="https://guide.openenergymonitor.org/#update">http://openenergymonitor.org/emon/modules/emonpi#update</a></p>
<p>The LCD should display V1.8 on boot. Please let me know if this makes a difference.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35541"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8002.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="tasminracer&#039;s picture" title="tasminracer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8002.html" title="View user profile.">tasminracer</a> on Sat, 31/10/2015 - 11:46.</div>
    <div class="content">
     <p>Brilliant, I&#39;ll go over and try this first thing on monday and post back</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Cheers</p>
<p>&nbsp;</p>
<p>G</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35583"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8002.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="tasminracer&#039;s picture" title="tasminracer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8002.html" title="View user profile.">tasminracer</a> on Mon, 02/11/2015 - 12:15.</div>
    <div class="content">
     <p>Right i&#39;ve run the update and it now displays firmware v1.8 on boot ok, although i only got a blank screen when looking at the log file ?</p>
<p>I&#39;ll report back with data tomorrow morning after we&#39;ve run through a day and a night, although with this thick fog my own 3.5k system is running at 200 watts!!! still a 50k system should have a bit more to show</p>
<p>G</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35605"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8002.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="tasminracer&#039;s picture" title="tasminracer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8002.html" title="View user profile.">tasminracer</a> on Tue, 03/11/2015 - 10:21.</div>
    <div class="content">
     <p>Initial results not looking like any change :-( &nbsp;will report back when more data. hardly generating during the day due to fog but big spike over night</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35606"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Tue, 03/11/2015 - 10:24.</div>
    <div class="content">
     <p><em>.... with this thick fog my own 3.5k system is running at 200 watts!!!</em></p>
<p>Yep, this weather is no good for solar power, none of the thermal energy can get through.&nbsp;</p>
<p>My 2.8 kWp PV system is currently generating 60W, and our diverted energy total for today is just 0.003 kWh.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35607"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8002.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="tasminracer&#039;s picture" title="tasminracer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8002.html" title="View user profile.">tasminracer</a> on Tue, 03/11/2015 - 10:30.</div>
    <div class="content">
     <p>58 watts here now !!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35610"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 03/11/2015 - 11:31.</div>
    <div class="content">
     <p><i>"Initial results not looking like any change :-( "</i></p>
<p>Do you mean no change from the overnight "generation" that far exceeds the capacity of your array? ;-)  To be honest, that doesn't surprise me as the sensor output is said to be TTL, and if it is, that shouldn't need a pull-up and giving it one shouldn't make any difference. </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35612"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3016.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dBC&#039;s picture" title="dBC&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/3016.html" title="View user profile.">dBC</a> on Tue, 03/11/2015 - 12:01.</div>
    <div class="content">
     <p><em>none of the thermal energy can get through</em></p>
<p>I think that&#39;s a good thing in the case of PV.... the hotter those panels get the less they produce. &nbsp;They operate off light, not heat... although it sounds like your fog is so thick you&#39;re not getting much of that either.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35613"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Tue, 03/11/2015 - 17:49.</div>
    <div class="content">
     <p>I will setup a test here in the lab to try and re-create the issue and work on a fix</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35631"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Wed, 04/11/2015 - 12:33.</div>
    <div class="content">
     <p>What is the make and model of your meter? We have not experienced this issue when using the sensor on common pulse output meters such as the Elster&nbsp;A100c and&nbsp;Landis &amp; Gyr E110. As mentioned earlier in this thread, I wonder if there is something different about how the LED in your meter is driven when it&#39;s continuously on. Are you sure the sensor is making proper contact with the meter LED?&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35648"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8002.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="tasminracer&#039;s picture" title="tasminracer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8002.html" title="View user profile.">tasminracer</a> on Wed, 04/11/2015 - 20:21.</div>
    <div class="content">
     <p>Its an elster A1100 &nbsp;3 phase meter... markings next to the LED say 500impulses per kwh so 2 per wh</p>
<p>sensor is attatched to the meter over the led using the supplied vercro patch. Meter and sensor are inside an adaptable box so no external light</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Cheers</p>
<p>&nbsp;</p>
<p>G</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35661"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Thu, 05/11/2015 - 10:42.</div>
    <div class="content">
     <p>Does the LED when it&#39;s illuminated static overnight look any different to you from other utility meter LED&#39;s when they are no static? I&#39;m just trying to determine if there could be something different with the meter. We will send you another optical sensor just to make sure there is nothing different or faulty with the sensor.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35691"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Fri, 06/11/2015 - 00:28.</div>
    <div class="content">
     <p>500 impulses per kWh so <strike>2 per wh</strike> 1 per 2 Wh </p>
<p>Oops! That would make your calibration spectacularly wrong.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35725"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8002.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="tasminracer&#039;s picture" title="tasminracer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8002.html" title="View user profile.">tasminracer</a> on Sat, 07/11/2015 - 16:25.</div>
    <div class="content">
     <p>Received the replacement sensor today, I&#39;ll install on monday.</p>
<p>&nbsp;</p>
<p>quick pic of current install shown. sensor mounted over the red led on the meter.</p>
<p>&nbsp;</p>
<p>The meter and emon pi etc is mounted in a closed box so no external light&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35726"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8002.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="tasminracer&#039;s picture" title="tasminracer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8002.html" title="View user profile.">tasminracer</a> on Sat, 07/11/2015 - 16:26.</div>
    <div class="content">
     <p>lol yes typo</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35729"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 07/11/2015 - 17:55.</div>
    <div class="content">
     <p>Do you have an analogue moving coil multimeter, or a digital multimeter that doesn't have a super-fast response? If you have, when you have the sensor installed on the meter and when the meter LED is on continuously, measure some voltages on the dc range. Can you measure and report both Vcc and the sensor output voltage? Vcc should be 3.3 V, if the LED is strobed and the sensor is following it, the output voltage should be much less, probably less than and certainly not much more than 1 V even (because this will be the average value of a pulse waveform that swings from about 0.7 V to 2.6 V with a fairly low m/s ratio). But if it's near to 3.3 V (say above 2.6 V), the LED is not strobed and my theory is probably wrong.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35833"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8002.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="tasminracer&#039;s picture" title="tasminracer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8002.html" title="View user profile.">tasminracer</a> on Thu, 12/11/2015 - 12:56.</div>
    <div class="content">
     <p>mm i seem to have&nbsp;lost a post.</p>
<p>&nbsp;</p>
<p>Changed the sensor and no change to the data. :-)</p>
<p>&nbsp;</p>
<p>any other ideas.</p>
<p>&nbsp;</p>
<p>The A1100 does have a wired pulse feed option. is there a way i can wire that up ( i do&nbsp;have access to that part of the meter)&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35840"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 12/11/2015 - 17:08.</div>
    <div class="content">
     <p><i>"mm i seem to have lost a post."</i><br />
It's not awaiting moderation, so I don't know. </p>
<p>What you must be absolutely certain of is the wired pulse feed is "volt-free", i.e. it is completely isolated from the electricity supply, before you can think of using it. I can't find any specification or connection details, so I can't tell exactly what might be inside, but I would guess it's the receiving part of an opto-coupler.</p>
<p>The leaflet also says that your meter has an IrDA output. It may be that this is the same as <a href="626.html">this thread</a>.</p>
<p>But surely the first problem is to find out what the problem actually is? All that has happened so far is we appear to have ruled out a faulty sensor. That doesn't mean that the sensor is or is not suitable for use with your meter. But it might mean that the software had made unjustifiable assumptions.</p>
<p>Were you able to try reading voltages that the sensor is giving you?  The theory was that if the LED is on continuously - really continuously and not just appearing to be continuous as our eyes cannot perceive flicker faster than about 20 Hz - then you would read nearly the same voltage as the sensor's supply voltage. But if the LED was flashing faster than that and the sensor was sending a stream of pulses, you would perceive the LED to be on continuously but a multimeter would read the average voltage that might be only a small fraction of the sensor's supply voltage. That would hopefully give us a better idea of what the A1100 is actually doing.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35841"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8002.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="tasminracer&#039;s picture" title="tasminracer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8002.html" title="View user profile.">tasminracer</a> on Thu, 12/11/2015 - 18:12.</div>
    <div class="content">
     <p>From the elster&nbsp;documentation &nbsp;:-&nbsp;Pulse Output An opto-isolated pulse output can provide the basis for an energy management system or AMR. These pulses are output via the meter&rsquo;s auxiliary terminals. The output conforms to IEC 62053-31.&nbsp;</p>
<p>Single rate meter - The output is connected to the meter&#39;s two auxiliary terminals and is fully isolated.&nbsp;</p>
<p>&nbsp;</p>
<p>we frequently use them to feed pulse driven display units. its a 2 wire connection so would need some electronics to drive the emonpi via the rj45 port ?</p>
<p>&nbsp;</p>
<p>But ideally yes I&#39;d like to solve the issue with the optical sensor. although i do have an issue with access and an &nbsp;end user getting fed up lol..</p>
<p>If i can find a suitable meter how can i measure the voltages from the sender? plug it into the emonpi via some sort &nbsp;of breakout board and measure it from the exposed connections, measure across vcc and gnd?</p>
<p>&nbsp;</p>
<p>ta&nbsp;</p>
<p>g</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35845"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 12/11/2015 - 19:49.</div>
    <div class="content">
     <p><i>"plug it into the emonpi via some sort  of breakout board and measure it from the exposed connections, measure across vcc and gnd?"</i></p>
<p>Exactly.</p>
<p>As regards the SO output, then I would wire that between RJ45-5 (GND) and RJ45-6 (D3) and have a 4.7 k&Omega; pull-up between RJ45-6 (D3) and RJ45-2 (+5 V).</p>
<p>I'd love to say there's a software solution. There may well be but without knowing that the problem is what I think it is, there's no reason to suspect that anything that we do concerning the LED will work properly.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35924"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 15/11/2015 - 01:07.</div>
    <div class="content">
     <p>I have worked out how to test to see whether the meter LED is strobed or not. It's very simple:</p>
<p>View the meter through a small hand-held mirror. Rapidly wobble the mirror. If the LED appears as a series of bright dashes, the LED is strobed. If it is one continuous strip of light, it is not.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35971"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Mon, 16/11/2015 - 18:41.</div>
    <div class="content">
     <p>I believe we have fixed this&nbsp;issue for the emonPi,&nbsp;</p>
<p>See&nbsp;commit:<a href="https://github.com/openenergymonitor/emonpi/commit/56ac3bbf7ed07787b12eb6396e15f36081eb626a">&nbsp;https://github.com/openenergymonitor/emonpi/commit/56ac3bbf7ed07787b12eb6396e15f36081eb626a</a>. The issue was caused by pulse&nbsp;time variable not being reset correctly.&nbsp;</p>
<p>​Please could you try updating the emonPi firmware following the same update procedure as before admin&gt;update. The new firmware should display V1.9 at startup.&nbsp;</p>
<p>​</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35974"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8002.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="tasminracer&#039;s picture" title="tasminracer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8002.html" title="View user profile.">tasminracer</a> on Mon, 16/11/2015 - 20:06.</div>
    <div class="content">
     <p>Cool I&#39;ll try and get on site to do this tomorrow, would be really great if this sorts it.</p>
<p>&nbsp;</p>
<p>Cheers</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Graham</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36120"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 20/11/2015 - 13:00.</div>
    <div class="content">
     <p>Any joy?&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36192"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8002.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="tasminracer&#039;s picture" title="tasminracer&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/8002.html" title="View user profile.">tasminracer</a> on Sat, 21/11/2015 - 14:08.</div>
    <div class="content">
     <p>Hi, only got access to the site yesterday morning to do the update&nbsp;so only one nights data &nbsp;but it s looking good so far :-)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-36225"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Problem with optical sensor</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Sun, 22/11/2015 - 18:40.</div>
    <div class="content">
     <p>Great :-)&nbsp;</p>
<p>Good to hear.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/11490"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-NZuGDc5YQn9iwNyyhp9RSX-d_PJNEAVP2T5Xbfwg9ng" value="form-NZuGDc5YQn9iwNyyhp9RSX-d_PJNEAVP2T5Xbfwg9ng"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/11490 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:57:24 GMT -->
</html>
