<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/5995 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:50:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>emoncms.org kwhd php feeds playing up | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">emoncms.org kwhd php feeds playing up</h3>
        <span class="submitted">Submitted by <a href="../user/7094.html" title="View user profile.">robpeel@icloud.com</a> on Sun, 26/10/2014 - 02:40</span>
        <div class="content"><p>Just noticed that the kwhd&nbsp;feeds have played up. &nbsp;Showing large negative values such as -200&nbsp;and -3000. &nbsp;</p>
<p>it seems to be the php feeds. &nbsp;I have another system running also on emoncms.org and the mysql feeds are correct but the php ones have also played up.&nbsp;</p>
<p>​The inputs and feeds into emoncms seem to be ok as graphs and gauges are ok The inputs page are showing the correct values too.</p>
<p>​Has this happened to anyone else?</p>
<p>&nbsp;</p>
<p>Edit: seemed&nbsp;to be something to do with daylight savings time at the server. &nbsp;Today&nbsp;has been ok, but as others have pointed out it seems like it will be stuck in the history.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="6158.html" class="topic-previous" title="Go to previous forum topic">‹ Editing  PHPtimeseries Data</a>
              <a href="6150.html" class="topic-next" title="Go to next forum topic">Own goal... can I recover from a silly mistake? ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-24798"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6952.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bond79&#039;s picture" title="bond79&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6952.html" title="View user profile.">bond79</a> on Sun, 26/10/2014 - 08:15.</div>
    <div class="content">
     <p>I was about to post my own topic, but this seems to be the same problem that I have in my local emoncms installation. In my case it is clearly due to the summer time change at 4:00 am. The time from 3:00 to 4:00 is repeated two times (as it was the case, I don&#39;t know what could be done about this) and the second time the kWh feeds are dropping rapidly, as you can see in the screenshot attached.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24805"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6336.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Atte&#039;s picture" title="Atte&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6336.html" title="View user profile.">Atte</a> on Sun, 26/10/2014 - 10:50.</div>
    <div class="content">
     <p>Hi All,</p>
<p>I have experienced exactly the same by this morning and i am wondering if there is a way to remove those negative peaks from the data, as they are completely ruined my consumption summary values. My system is also running on emoncms.org</p>
<p>I searched through the forum and found only one post, about some plans of the improvement on how to handle the DST changes (<a href="4008.html" title="http://openenergymonitor.org/emon/node/4008">http://openenergymonitor.org/emon/node/4008</a>).<br />
So according to this, the DST change caused problems in the past also.</p>
<p>I am quite new here to remember those problems, and also those problems could be different ones, but i did not find any older posts about DST related problems,so i would be very grateful if someone could help me on this.</p>
<p>Thank you<br />
Regards<br />
Attila</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24809"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6709.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="stureid&#039;s picture" title="stureid&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6709.html" title="View user profile.">stureid</a> on Sun, 26/10/2014 - 12:21.</div>
    <div class="content">
     <p>Just to confirm I have observed this too on my emoncms.org kwhd feeds</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24810"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6952.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="bond79&#039;s picture" title="bond79&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6952.html" title="View user profile.">bond79</a> on Sun, 26/10/2014 - 13:06.</div>
    <div class="content">
     <p>The problem is that we are not talking about a instanteneous peak that can be removed. If that was the case there is a script here on the forums called remove_spike.php that can be used to fix this (on local installations at least).</p>
<p>The problem here is that for a whole hour the the kwh were dropping and all values since then are wrong. I am more happy it was an once in a year bug and not something else, but I really don&#39;t believe there is a way right now to fix the feeds and restore the normal values.</p>
<p>I really love emoncms and I understand the need to move the data storage engine from mysql to the current system. But the problem is we are severely limited to accessing and manipulating the raw data. We need a better system of editing, or at least a system to export the data and import them again, after corrections.<br />
Software and hardware bugs, will always happen especially in an evolving project like this. It&#39;s really a pity for data to be permanently corrupted by them. It also prevents us for experimenting more in fear of corrupting the data.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24827"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Mon, 27/10/2014 - 10:23.</div>
    <div class="content">
     <p>any idea how you re-edit the data ?&nbsp;</p>
<p>I&#39;d like to fix it as the graphs are messed up.</p>
<p>if it were in a database it would be rather trivial with a simple add this to that after that date. But with the time data I don&#39;t know where it is / how to do it.</p>
<p>As its &quot;only&quot; the calculated kwh &amp; kwhd&nbsp;values that are affected is there anyway to re-generate that data?</p>
<p>If we could re-generate that the issue would be resolved no?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24832"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Mon, 27/10/2014 - 12:22.</div>
    <div class="content">
     <p>Thanks for heads up on this. I can see the error in the kwhd feeds. I need to look at what would be involved to get the realtime and bargraph editor working again, now that the storage engine development is stable, it would be a good time to look at it again. Il update on how I get on.</p>
<p>For anyone interested in how the storage engines work I&#39;ve written some documentation on it here: <a href="https://github.com/openenergymonitor/documentation/tree/master/BuildingBlocks/TimeSeries" title="https://github.com/openenergymonitor/documentation/tree/master/BuildingBlocks/TimeSeries">https://github.com/openenergymonitor/documentation/tree/master/BuildingB...</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24836"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/349.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-349.jpg" alt="EnergyRnR&#039;s picture" title="EnergyRnR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/349.html" title="View user profile.">EnergyRnR</a> on Mon, 27/10/2014 - 15:41.</div>
    <div class="content">
     <p>Could this have anything to do with summer time ending? We &#39;put back&#39; our clocks on Saturday evening..... That&#39;s when my kwhd&nbsp;visualisation went negative, though the power readings were correct.</p>
<p>My negative spikes started at&nbsp;Sat, 25 Oct 2014 23:00:00 GMT (unix time of&nbsp;1414278000)&nbsp;and in one case it was a completely new bar ; i.e. the normal positive values we produced correctly.&nbsp;</p>
<p>Eamonn</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24837"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 27/10/2014 - 16:16.</div>
    <div class="content">
     <p>I think Robpeel had decided that!  For my two penn'orth, there's only one way to do this: convert to or get the times in UTC before storing in the database, and convert back to local when labelling the graph. Anything else is bound to screw up when DST starts/ends.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24886"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Thu, 30/10/2014 - 12:05.</div>
    <div class="content">
     <p>Hi Trystan</p>
<p>Any update on getting the kwh feeds fixed? At the moment all my graphs are weird due to the very strange numbers.</p>
<p>Using the editdaily&nbsp;view it looks like there are 2 readings for the day of the time change.&nbsp;</p>
<p>When does the calculation of the &quot;daily&quot; data run? I would guess at 1am or&nbsp;around then - hence the double numbers. I would imagine in spring it will be ok as there will only be one 1am!</p>
<p>Thanks</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24887"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Thu, 30/10/2014 - 13:57.</div>
    <div class="content">
     <p>A little progress, thankyou for waiting:</p>
<p>editrealtime and editdaily accessible from Vis then &#39;select visualisation&#39; are now re-enabled on the emoncms.org server. However the support for editing is currently dependent on the feed engine:</p>
<p>- Editing of historical data is supported by PHPFina, PHPTimeSeries, MYSQL &amp; PHPTimeStore</p>
<p>- New data points older than the latest data point can be added in PHPFina but not in PHPTimeSeries.</p>
<p>- PHPFiwa does not yet support editing of historical data.</p>
<p>I&#39;ve disabled the &#39;delete data in window&#39; button and &#39;scale data in window&#39; feature as both where only supported by the timestore engine. It would be good to reintroduce them in the future with more work to the feed engines.</p>
<p>At the moment its not possible to delete the double reading - only to resize it/change the value. Il try and look further into making it possible to delete the reading.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24889"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Thu, 30/10/2014 - 18:21.</div>
    <div class="content">
     <p>Hi Trystan,</p>
<p>How do you re-generate that data in its entirety?</p>
<p>The edits are available on the locally hosted install but i don&#39;t know what the &quot;correct&quot; numbers would be. Also all the future records are incorrect - one of the graphs now has its upwards trajectory &quot;reset&quot; (the kwh data) ie the data goes :</p>
<p>Time - reading.</p>
<p>00:50 - 509</p>
<p>01:00 - 509</p>
<p>01:10 - 506</p>
<p>01:50 - 495</p>
<p>01:00 - 368 &nbsp; &lt;&lt;&lt;&lt; &nbsp;BST -&gt; GMT&nbsp;</p>
<p>01:10 - 368&nbsp;</p>
<p>07:00 - 370&nbsp;</p>
<p>why the data was going downwards during that time I don&#39;t know. its an accumalator ...</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24891"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Thu, 30/10/2014 - 23:31.</div>
    <div class="content">
     <p>@octagon are you using the wh_accumulator or just the plain accumulator input processor? The plain accumulator can result in descending trends if the value that is being accumulated is negative. I dont think what your seeing is related to the BST-&gt;GMT change, can you see this happen at any other point in your data? Could the negative input be generated outside of emoncms somehow?</p>
<p>Do you have a power feed that you could use to regenerate the kwh data? What feed engine is the power feed?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24892"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Fri, 31/10/2014 - 08:00.</div>
    <div class="content">
     <p>it goes :&nbsp;</p>
<p>input -&gt; log-&gt;kwh-&gt;kwhd-&gt;hist</p>
<p>its recording the power used on one circuit that has no generation on it at all !</p>
<p>this negative thing has never happened before.</p>
<p>Its the data feed from the emontxv3&nbsp;don&#39;t know how it would make negative data?</p>
<p>its a&nbsp;PHPTIMESERIES&nbsp;data feed&nbsp;</p>
<p>How do i get it to regenerate the data from the log into the kwh / kwhd&nbsp;&amp; hist ?&nbsp;</p>
<p>Thanks</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24897"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Fri, 31/10/2014 - 14:35.</div>
    <div class="content">
     <p>There isn&#39;t an in-built mechanism for regenerating feeds at the moment so we would need to write a script to do this. is your power feed PHPTIMESERIES? I would have thought it would be PHPFiwa or PHPFina, or older timestore? phptimestore?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24899"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Fri, 31/10/2014 - 14:54.</div>
    <div class="content">
     <p>Here&#39;s an example of how to read from a phptimeseries feed directly using php:<br />
<a href="https://github.com/emoncms/usefulscripts/blob/master/enginereaders/phptimeseries.php" title="https://github.com/emoncms/usefulscripts/blob/master/enginereaders/phptimeseries.php">https://github.com/emoncms/usefulscripts/blob/master/enginereaders/phpti...</a></p>
<pre>
&lt;?php
// Directory of phptimeseries feeds, see: settings.php
$dir = &quot;/var/lib/phptimeseries&quot;;
// Feed id to read:
$feedid = 1;
//----------------------------------------------------
$fh = fopen($dir.&quot;feed_$feedid.MYD&quot;, &#39;rb&#39;);
$filesize = filesize($dir.&quot;feed_$feedid.MYD&quot;);
$npoints = floor($filesize / 9.0);

for ($i=0; $i&lt;$npoints; $i++)
{
    // Read next datapoint
    $d = fread($fh,9);
    // Itime = unsigned integer (I) assign to &#39;time&#39;
    // fvalue = float (f) assign to &#39;value&#39;
    $array = unpack(&quot;x/Itime/fvalue&quot;,$d);
    $time = $array[&#39;time&#39;];
    $value = $array[&#39;value&#39;];
    print $time.&quot; &quot;.$value.&quot;\n&quot;;
}

</pre><p>The next step is to run each datapoint through the math&#39;s that calculates accumulating kwh and then write the resultant datapoints to a feed.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24900"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Fri, 31/10/2014 - 15:10.</div>
    <div class="content">
     <p>This is how to do the same in python:</p>
<pre>
import struct, os

# Directory of phptimeseries feeds, see: settings.php
datadir = &quot;/var/lib/phptimeseries/&quot;
# Feed id to read:
feedid = 1
#----------------------------------------------------
    
fh = open(datadir+&quot;feed_&quot;+str(feedid)+&quot;.MYD&quot;, &#39;rb&#39;)
bytesize = os.stat(datadir+&quot;feed_&quot;+str(feedid)+&quot;.MYD&quot;).st_size
npoints = int(bytesize/9.0)
    
for i in range(npoints):

    array = struct.unpack(&#39;&lt;cIf&#39;,fh.read(9))
   
    time = array[1]
    value = array[2]

    print str(time)+&quot; &quot;+str(value);</pre>         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24901"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Fri, 31/10/2014 - 15:55.</div>
    <div class="content">
     <p>Heres a complete script for converting phptimeseries power data to phpfina kwh data:</p>
<p><a href="https://github.com/emoncms/usefulscripts/blob/master/process/phptimeseries_power_to_phpfina_kwh.php" title="https://github.com/emoncms/usefulscripts/blob/master/process/phptimeseries_power_to_phpfina_kwh.php">https://github.com/emoncms/usefulscripts/blob/master/process/phptimeseri...</a></p>
<p>The phpfina feed will need to have been created in emoncms already with the interval set. The source and target feed id&#39;s and feed engine locations as well as installed emoncms location needs to be set in the script. Then the script can be run using sudo with:</p>
<p>sudo php phptimeseries_power_to_phpfina_kwh.php</p>
<p>After completing this, its probably best to reset redis with</p>
<p>$ redis-cli</p>
<p>flushall</p>
<p>That should&nbsp; do it. I havent been able to test it as I dont have a phptimeseries power feed here yet althought I might create another script so that I can generate one for testing</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24902"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Fri, 31/10/2014 - 16:43.</div>
    <div class="content">
     <p>I&#39;ve tested it and it works a treat! Might be useful for anyone who has a power feed and kwh per day data but would also like to generate accumulating kwh data to use with the new myelectric dashboard or the new bargraph visualisation.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24904"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Fri, 31/10/2014 - 17:17.</div>
    <div class="content">
     <p>phpfina power to phpfina kwh data:<br />
<a href="https://github.com/emoncms/usefulscripts/blob/master/process/phpfina_power_to_phpfina_kwh.php" title="https://github.com/emoncms/usefulscripts/blob/master/process/phpfina_power_to_phpfina_kwh.php">https://github.com/emoncms/usefulscripts/blob/master/process/phpfina_pow...</a></p>
<p>phpfiwa power to phpfina kwh data:<br />
<a href="https://github.com/emoncms/usefulscripts/blob/master/process/phpfiwa_power_to_phpfina_kwh.php" title="https://github.com/emoncms/usefulscripts/blob/master/process/phpfiwa_power_to_phpfina_kwh.php">https://github.com/emoncms/usefulscripts/blob/master/process/phpfiwa_pow...</a></p>
<p>An important thing to note is that its important to double check that the target phpfina feed is empty otherwise it will overwrite the target phpfina feed and so could result in data loss.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24906"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Fri, 31/10/2014 - 18:01.</div>
    <div class="content">
     <p>hi&nbsp;</p>
<p>all the calculated kwh &amp; kwhd are all&nbsp;PHPTIMESERIES only the histograms are PHPfwia&nbsp;</p>
<p>Could you include into the emoncms distro a &quot;recalc&quot; button?&nbsp;</p>
<p>Some of my inputs have multiple process steps to get to the correct numbers. and so re-doing them (kwh &amp; kwhd &amp; histo) isn&#39;t going to be easy.</p>
<p>I&#39;m on version 8.3.5 - dunno how out of date that is...</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24917"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Sat, 01/11/2014 - 18:46.</div>
    <div class="content">
     <p>@octagon emoncms isnt unfortunately set up in a way to make this kind of batch conversion process easy to do at the moment&nbsp; Having a recalculate button would be amazing I agree but to implement its really a complex bit of development.</p>
<p>I&#39;ve further improved on the conversion scripts above they now run 4x faster and I&#39;ve merged the three different scripts into one:</p>
<p><a href="https://github.com/emoncms/usefulscripts/blob/master/process/power_to_kwh.php" title="https://github.com/emoncms/usefulscripts/blob/master/process/power_to_kwh.php">https://github.com/emoncms/usefulscripts/blob/master/process/power_to_kw...</a></p>
<p>To use this script download the usefulscripts to the machine emoncms is running on and open power_to_kwh.php in an editor.</p>
<p>If your emoncms installation is located in a location other than /var/www/emoncms then change the line: chdir(&quot;/var/www/emoncms&quot;); to point to your emoncms location.</p>
<p>Under the settings section set your source power feed feed id and set the engine manually. Create a new PHPFina feed in emoncms with a suitable time interval then set the $target setting to this newly created feed:</p>
<p>$source = 27;<br />
$source_engine = Engine::PHPFINA; // or: Engine::PHPFINA, Engine::PHPTIMESERIES<br />
$target = 50484; // must be a PHPFINA feed</p>
<p>Save the script and exit.</p>
<p>Run with:</p>
<p>$ sudo php power_to_kwh.php</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24918"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Sun, 02/11/2014 - 08:29.</div>
    <div class="content">
     <p>amusingly (?) these lines&nbsp;</p>
<p>&nbsp; &nbsp; require &quot;Lib/PHPFina.php&quot;;<br />
&nbsp; &nbsp; require &quot;Lib/PHPFiwa.php&quot;;<br />
&nbsp; &nbsp; require &quot;Lib/PHPTimeSeries.php&quot;;</p>
<p>don&#39;t work. as they don&#39;t exist in my install.&nbsp;</p>
<p>Should i change the path to Modules/feed/engine/.......</p>
<p>Or just download yours?</p>
<p>Thanks</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24920"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Sun, 02/11/2014 - 09:51.</div>
    <div class="content">
     <p>@octagon, you will need to download the full &#39;usefulscripts&#39; repository/folder with all those files in there. They will all then be in the right location and it should run ok.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24922"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Sun, 02/11/2014 - 09:59.</div>
    <div class="content">
     <p>@octagon I noticed you mention your histograms use the PHPFiwa engine above, they should be using MYSQL, if they are using PHPFiwa then they may have got created incorrectly and probably dont have any data in them?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24923"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6336.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Atte&#039;s picture" title="Atte&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6336.html" title="View user profile.">Atte</a> on Sun, 02/11/2014 - 16:41.</div>
    <div class="content">
     <p>Hi Trystan,</p>
<p>I don&#39;t have local emoncms installed, but I am using emoncms.org to store my data. I do have 2 feeds affected with this problem. Both are kwh/d and are PHPTIMESERIES. (Below an example on the invalid values.)</p>
<p>Is there a way to fix these for non-locally installed emoncms as well somehow?</p>
<p>&nbsp;</p>
<p>DataType: DAILY<br />
Engine: PHPTIMESERIES<br />
ID:55280</p>
<p>Data<br />
1414191600,31.18<br />
1414278000,-469.44<br />
1414281600,-440.37<br />
1414368000,19.90</p>
<p>
DataType: DAILY<br />
Engine: PHPTIMESERIES<br />
ID:55284</p>
<p>Data</p>
<p>1414191600,25.28<br />
1414278000,-440.05<br />
1414281600,-418.20<br />
1414368000,12.94</p>
<p>&nbsp;</p>
<p>Many thanks<br />
Kind Regards,<br />
Attila</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24949"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Mon, 03/11/2014 - 15:21.</div>
    <div class="content">
     <p>Hi Trystan</p>
<p>I&#39;ve got a type2 PV system. I&#39;m recording 2 data points to allow me to track the combination of consumption, generation, flow to the grid and flow from the grid and the combined to/from the grid. This way I can see what i&#39;m exporting/importing/generating/consuming. so the set of log-&gt;kwh-&gt;kwhd-&gt;histogram happens&nbsp;</p>
<p>All my histograms a PHPFIWA.</p>
<p>​All my data feeds are from a REALTIME::TIMESTORE&nbsp;data log.&nbsp;</p>
<p>Can you convert from them ?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24953"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Mon, 03/11/2014 - 18:29.</div>
    <div class="content">
     <p>Hello @octagon, I&#39;ve added the ability to process Timestore feeds via the PHPTimestore reader. That should allow you to at least recalculate the kwh data which will mean you can use the bargraph as configured at the bottom of this blog post to show daily kwh value: <a href="http://openenergymonitor.blogspot.co.uk/2014/08/monitoring-solarpv-heatpump-and-house.html" title="http://openenergymonitor.blogspot.co.uk/2014/08/monitoring-solarpv-heatpump-and-house.html">http://openenergymonitor.blogspot.co.uk/2014/08/monitoring-solarpv-heatp...</a></p>
<p>Il create a processor for kwh/d data next. Im still confused as to why your historgram data is labeled as PHPFiwa, can you share a screen shot of what you see there, and the historgram data?</p>
<p>@Attila Can you edit the values manually via Vis &gt; editdaily to get them in the expected region? Realistically Im still quite some way from having an automated system that could recalculate on emoncms.org.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24956"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Mon, 03/11/2014 - 20:00.</div>
    <div class="content">
     <p>screenshots of my feed list and the generation histogram.&nbsp;</p>
<p>I&#39;ll re-generate the kwh data later !</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24958"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6336.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Atte&#039;s picture" title="Atte&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6336.html" title="View user profile.">Atte</a> on Mon, 03/11/2014 - 20:29.</div>
    <div class="content">
     <p>Hi Trystan,</p>
<p>&nbsp;</p>
<p>Many-many thanks for the hint!&nbsp; Basically by changing those two values, did the trick, and the graphs and values are now in synch with the real consumption.</p>
<p>Thank you again!</p>
<p>Regards,<br />
Attila</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24972"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Tue, 04/11/2014 - 18:44.</div>
    <div class="content">
     <p>Hi Trystan,</p>
<p>I need the output to be a PHPTIMESERIES&nbsp;as they do the variable interval with no averaging.</p>
<p>or should i be using the fixed interval with no averaging (FINA) ?</p>
<p>What should make me choose one or the other? I had gone for the variable interval as some of my inputs only give 5 min feeds.</p>
<p>Thanks!</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24983"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 05/11/2014 - 11:14.</div>
    <div class="content">
     <p>Hello @octagon, fixed interval no averaging is the best to use for accumulating kwh data, phptimeseries is needed for daily data as the midnight time changes at summer time hour changes but kwh data is at a much more regular time interval ie 10s so phpfina is more suitable. The added benefit is that phpfina is much faster to search to kwh per day data generated from kwh data is extracted and calculated much faster than if the feed was stored in phptimeseries data.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24989"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Wed, 05/11/2014 - 16:20.</div>
    <div class="content">
     <p>Hi Trystan,&nbsp;</p>
<p>The recalculated FINA data seems to have fixed the BST/GMT issue.&nbsp;</p>
<p>To extract the correct data types for each scenario would you suggest then</p>
<p>REALTIME::TIMESTORE &nbsp;for the &quot;raw&quot; data</p>
<p>FINA for the kwh data</p>
<p>MYSQL for the histogram data</p>
<p>What for the kwhd and any others?</p>
<p>Any reason for not using mysql for them all?</p>
<p>Thanks!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24990"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 05/11/2014 - 18:12.</div>
    <div class="content">
     <p>Great good to hear you&#39;ve got a kwh feed recalculated, brilliant!</p>
<p>I would recommend REALTIME PHPFIWA or PHPFIWA for &quot;raw&quot;/power data. PHPFINA for kwh data, PHPTIMESERIES for daily data and MYSQL for histogram data. There are good reasons for all these feed engines, I wrote a history of emoncms feed engine development here <a href="https://github.com/openenergymonitor/documentation/blob/master/BuildingBlocks/TimeSeries/history.md" title="https://github.com/openenergymonitor/documentation/blob/master/BuildingBlocks/TimeSeries/history.md">https://github.com/openenergymonitor/documentation/blob/master/BuildingB...</a></p>
<p>Im going to extend this feed processor to allow conversion of any engine to any other engine, so you could convert your timestore feeds to phpfiwa.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25034"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Sat, 08/11/2014 - 09:34.</div>
    <div class="content">
     <p>Hi Trystan</p>
<p>If you could finish those converters i would imagine a few others will be very interested&nbsp;</p>
<p>obviously with the kwhD and histogram ones. Then i can recalculate all my data. Think it will be best done with emoncms not running. sadly each feed will take about an hour!</p>
<p>FYI telling the system to save every 1000 records shaved a bit of time - only 3 mins but every helps.</p>
<p>Could you update the emonCMS with more text as to which you should choose when adding a feed. When i saw &quot;With averaging&quot; i thought oh no it will remove the peaks of the data, rather than Oh goody it will add a second or third data set comprising of the averaged data *in* addition to the raw data.</p>
<p>Thanks</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25067"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6891.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="octagon&#039;s picture" title="octagon&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6891.html" title="View user profile.">octagon</a> on Mon, 10/11/2014 - 09:25.</div>
    <div class="content">
     <p>If i move my feed to use a new FINA data set for the KWH data - can i recalculate into that data set in real time - ie both the conversion and &quot;now&quot; use the same target data set? or would that make things explode?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25253"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6566.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="zag&#039;s picture" title="zag&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/6566.html" title="View user profile.">zag</a> on Thu, 20/11/2014 - 21:52.</div>
    <div class="content">
     <p>Is it a question of telling the RPi running my copy of EmonCMS&nbsp;to ignore daylight saving and&nbsp;just stick to Zulu or GMT+0 to avoid this situation in the future?</p>
<p>I only started logging more complicated stuff since the last hour change, but if I can avoid it happening to/impacting 6 months of data in the future by telling it to avoid time changes then that should make things simpler.</p>
<p>z</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-25256"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms.org kwhd php feeds playing up</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 20/11/2014 - 23:04.</div>
    <div class="content">
     <p>Having fought this problem a long time before the Internet (in relation to logging the running hours of motors!), I believe there's only one solution, and that is that the database must only keep time as UTC. Incoming times must be converted to UTC, and outgoing times must be labelled as Local<sup>note</sup> according to the offset in force at the time, which in turn implies that a record of when DST is in force needs to be referenced. Of course, I recognise that this means that 'days' and larger units do not start at 00:00 database time, which complicates data retrieval. And that's why the change to or from DST never touches or crosses midnight, so that there is at least no confusion over the day.</p>
<p>Zag, I think your proposal will make things consistent. Whether it will make everything simpler is a totally different question.</p>
<p>(Note) By 'labelled', I mean the graph or histogram is <u>plotted</u> using UTC but the time axis <i>labels</i> are local. Therefore in the UK around midnight on 25/26th October, the hours would be shown correctly as ... 23:00 0:00 01:00 01:00 02:00 03:00 ...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/5995"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-ui9Zj496B962qFR_40tc6cwqk1AZaX3GPOJrFqEzx5M" value="form-ui9Zj496B962qFR_40tc6cwqk1AZaX3GPOJrFqEzx5M"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
