<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/12249 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:47:58 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>emonpi avrdude update failure - sync | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">emonpi avrdude update failure - sync</h3>
        <span class="submitted">Submitted by <a href="../user/9456.html" title="View user profile.">fubar</a> on Fri, 26/02/2016 - 03:48</span>
        <div class="content"><p>I&#39;m seeing vrms stuck at 230v&nbsp;despite the screen at startup confirming that I have a 9v ac supply plugged in. I saw that the 2.20 firmware might have been buggy and it seems that&#39;s what I&#39;ve got.&nbsp;</p>
<p>Running minicom, pressing v shows</p>
<p><strong><em>Welcome to minicom 2.6.1</em></strong></p>
<p><strong><em>OPTIONS: I18n&nbsp;<br />
Compiled on Apr 28 2012, 19:24:31.<br />
Port /dev/ttyAMA0</em></strong></p>
<p><strong><em>Press CTRL-A Z for help on special keys</em></strong></p>
<p><strong><em>OK 5 217 1 0 0 217 1 216 89 10 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 (-0)<br />
[emonPi.2.20] E i5 g210 @ 433 MHz USA 0&nbsp;</em></strong></p>
<p>Since I&#39;d just run the&nbsp;update script, this made me suspicious that I was stuck on 2.2 - it seems&nbsp;that my nice shiny new emonpi&nbsp;does not seem to be able to update the firmware - when I run</p>
<p><em><strong>sudo service emonhub stop</strong></em></p>
<p><em><strong>avrdude -v -c arduino -p ATMEGA328P -P /dev/ttyAMA0 -b 115200 -U flash:w:/home/pi/emonpi/Atmega328/emonPi_RFM69CW_RF12Demo_DiscreteSampling/compiled/emonPi_V2.3.hex</strong></em></p>
<p>I see:</p>
<p><em><strong>avrdude: Version 6.1, compiled on Jul &nbsp;7 2015 at 13:18:47<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Copyright (c) 2000-2005 Brian Dean, <a href="http://www.bdmicro.com/" title="http://www.bdmicro.com/">http://www.bdmicro.com/</a><br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Copyright (c) 2007-2014 Joerg Wunsch</strong></em></p>
<p><em><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;System wide configuration file is &quot;/etc/avrdude.conf&quot;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;User configuration file is &quot;/home/pi/.avrduderc&quot;<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;User configuration file does not exist or is not a regular file, skipping</strong></em></p>
<p><em><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Using Port &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: /dev/ttyAMA0<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Using Programmer &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: arduino<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Overriding Baud Rate &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: 115200<br />
avrdude: stk500_getsync() attempt 1 of 10: not in sync: resp=0xfc<br />
avrdude: stk500_getsync() attempt 2 of 10: not in sync: resp=0xe0<br />
avrdude: stk500_getsync() attempt 3 of 10: not in sync: resp=0x8e<br />
avrdude: stk500_getsync() attempt 4 of 10: not in sync: resp=0x1c<br />
avrdude: stk500_getsync() attempt 5 of 10: not in sync: resp=0x8e<br />
avrdude: stk500_getsync() attempt 6 of 10: not in sync: resp=0xe0<br />
avrdude: stk500_getsync() attempt 7 of 10: not in sync: resp=0x8e<br />
avrdude: stk500_getsync() attempt 8 of 10: not in sync: resp=0xfc<br />
avrdude: stk500_getsync() attempt 9 of 10: not in sync: resp=0x70<br />
avrdude: stk500_getsync() attempt 10 of 10: not in sync: resp=0xe0</strong></em></p>
<p><em><strong>avrdude done. &nbsp;Thank you.</strong></em></p>
<p>&nbsp;</p>
<p>I searched and don&#39;t see any (obvious) way to fix this - suggestions welcomed..</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="12234.html" class="topic-previous" title="Go to previous forum topic">‹ Dashboard faults</a>
              <a href="12254.html" class="topic-next" title="Go to next forum topic">EmonCMS Configure Visualisation Header Improvement ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-39833"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/9456.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-9456.jpg" alt="fubar&#039;s picture" title="fubar&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonpi avrdude update failure - sync</h3>

    <div class="submitted">Submitted by <a href="../user/9456.html" title="View user profile.">fubar</a> on Fri, 26/02/2016 - 07:51.</div>
    <div class="content">
     <p><em>update:</em></p>
<p><em>changed the scale and now see around&nbsp;245v which seems more consistent with the ups</em></p>
<p><em>[[5]]<br />
&nbsp; &nbsp; nodename = emonpi<br />
&nbsp; &nbsp; [[[rx]]]<br />
&nbsp; &nbsp; &nbsp; &nbsp; names = power1,power2,power1pluspower2,vrms,t1,t2,t3,t4,t5,t6,pulsecount<br />
&nbsp; &nbsp; &nbsp; &nbsp; datacodes = h, h, h, h, h, h, h, h, h, h, L<br />
&nbsp; &nbsp; &nbsp; &nbsp; scales = 1,1,1,0.0116,0.1,0.1,0.1,0.1,0.1,0.1,1<br />
&nbsp; &nbsp; &nbsp; &nbsp; units = W,W,W,V,C,C,C,C,C,C,p</em></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Ah. Wetware error I suspect. Fixed with a proper reinstall of avrdude-autoreset enabled me to get to the updated firmware. vrms is at last working.</p>
<p>Wrong but working. &nbsp;I&#39;m in Australia so our nominal vrms is 240 - my ups says 247v right now but my emonpi says about 212v so about 16% low.</p>
<p>Can I just change the scale factor&nbsp;</p>
<p>All the calibration docs&nbsp;I&#39;ve seen refer&nbsp;to the tx but I&#39;m running an&nbsp;emonpi&nbsp;- do I need to do calibration?</p>
<p>Advice appreciated...</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39846"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonpi avrdude update failure - sync</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 26/02/2016 - 12:07.</div>
    <div class="content">
     <p>Glad you managed to get the update working. I&#39;m assuming you saw <a href="12188.html">this thread</a> regarding the bug in V2.2. An V2.3 firmware fixed this.</p>
<p>What do you mean by &#39;changed the scale&#39;? No calibration should be needed. Are you using a UK / Euro plug AC-AC adapter bought through the shop? If you do want to calibrate the emonPi firmware can be found here:</p>
<p><a href="https://github.com/openenergymonitor/emonpi/tree/master/Atmega328/emonPi_RFM69CW_RF12Demo_DiscreteSampling " title="https://github.com/openenergymonitor/emonpi/tree/master/Atmega328/emonPi_RFM69CW_RF12Demo_DiscreteSampling ">https://github.com/openenergymonitor/emonpi/tree/master/Atmega328/emonPi...</a></p>
<p>How did you re installed avr dude autoreset? This should not have been necessary, if it is I would be interested to find the root cause of the issue.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39851"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/9456.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-9456.jpg" alt="fubar&#039;s picture" title="fubar&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonpi avrdude update failure - sync</h3>

    <div class="submitted">Submitted by <a href="../user/9456.html" title="View user profile.">fubar</a> on Fri, 26/02/2016 - 13:00.</div>
    <div class="content">
     <p>I think I reinstalled avrdude&nbsp;at some point without thinking it might have been, ahem, adjusted :)</p>
<p>So, I did a clean reinstall and then&nbsp;updated the avrdude-rpi git repo and reran install</p>
<p>It really did work finally.</p>
<p>On the odd voltages, unfortunately, I ordered a us plug so got a&nbsp;110 v to 9v - doh! Shoulda got a 240v uk one.</p>
<p>I&nbsp;found one in my spares box that claimed to have 9vac output which I measured as 9.6vac under no load.&nbsp;</p>
<p>I&#39;ve got one of these coming next week..http://www.altronics.com.au/p/m9233-powertran-9v-ac-1.33a-appliance-powerpack/ which should do the trick.</p>
<p>Meanwhile the updated scale does what passes for the trick. I&#39;m guessing that the actual voltage scale doesn&#39;t matter for&nbsp;real power calculation - it&#39;s in both numerator and denominator although measured different ways - scale is same?&nbsp;</p>
<p>Thanks for caring!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39852"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonpi avrdude update failure - sync</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 26/02/2016 - 13:09.</div>
    <div class="content">
     <p>emonPi has been calibrated to work with the power adapters we stock in the shop. You will probably need to calibrate to use a different adapter</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39858"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonpi avrdude update failure - sync</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Fri, 26/02/2016 - 13:54.</div>
    <div class="content">
     <p><em>&quot;I&#39;m guessing that the actual voltage scale doesn&#39;t matter for&nbsp;real power calculation - it&#39;s in both numerator and denominator although measured different ways - scale is same? &quot;</em></p>
<p>I don&#39;t know where you got that idea from, but I&#39;m afraid you&#39;re quite wrong. Power is proportional to V&sup2;.</p>
<p>Your adapter output of 9.6 V on no-load is indeed responsible for the low readings - the &#39;Shop&#39; adapter gives 11.6 V &plusmn;3%&nbsp;on no-load at 240 V input, so that, given a bit for tolerances, accounts for your error. If you wish to reprogram the sketch, how to calculate the calibration coefficient is in Resources &gt; Building Blocks.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/12249"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-Vgb2p6cTn0corgucnOPZxFURMW8rc3yaGsFeaaBzr8o" value="form-Vgb2p6cTn0corgucnOPZxFURMW8rc3yaGsFeaaBzr8o"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
