<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/4822 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:43:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Questions about the current sensor and emon library | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Questions about the current sensor and emon library</h3>
        <span class="submitted">Submitted by Guest on Mon, 31/03/2014 - 09:53</span>
        <div class="content"><p>Hello</p>
<p>I&#39;m just trying to try out a bunch of current transducers that I have received. &nbsp;they are all 100A&nbsp;versions without the burden resistor.</p>
<p>Questions (please)</p>
<p>1. I am using two 470k resistors as voltage dividers. &nbsp;However at the midpoint the arduino is recording 506/1024. &nbsp;Is it fair to assume that the 1% discrepancy (it should say 512) is down to resistor tolerance making the two unequal? &nbsp;The readings are 0 and 1023 at either side of the voltage divider, as you would expect.</p>
<p>2. using the emon library without any current through the CT, I am getting readings of 200mA or so. &nbsp;In fact these readings are present whether or not the CT is attached at all. So the device is reporting a power drain of 30W or so when there is none. &nbsp;Is this simply the tolerance/accuracyof the device? &nbsp;I&#39;ve read results elsewhere that suggests that the device can be more accurate than this. &nbsp;If so, what can I do to improve the accuracy?</p>
<p>FWIW&nbsp;these are the parameters I am using</p>
<p>CT: &nbsp;100A &nbsp;- 50mA</p>
<p>voltage dividers @ 470k</p>
<p>burden @ 33Ohm</p>
<p>cap @ 10uF (polarised)</p>
<p>arduino nano clone running on USB. &nbsp;input voltage is c. 4.7V as reported by readVCC()</p>
<p>calibration constant used is 60.6 &nbsp;((100/0.05) * 33)</p>
<p>&nbsp;</p>
<p>any help would be gratefully received.</p>
<p>thanks</p>
<p>Justin</p>
  <div class="forum-topic-navigation clear-block">
          <a href="4953.html" class="topic-previous" title="Go to previous forum topic">‹ Nanode RF - DS1307 RTC</a>
              <a href="2755.html" class="topic-next" title="Go to next forum topic">RFM12Pi pinout for connecting to beaglebone black ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-20260"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Questions about the current sensor and emon library</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 31/03/2014 - 13:05.</div>
    <div class="content">
     <p>HI Justin, welcome.</p>
<p>1. Yes. In effect, it reduces the maximum that you can read by that much - assuming the current/voltage wave is symmetrical!</p>
<p>2. No. We believe it is pickup from the digital circuits inside the processor leaking in to the analogue side. A lot of effort went in to the layout and filtering on the emonTx V3, and it is significantly better in this respect than the V2, which is (anecdotally) broadly similar to the Arduino boards. Also, the rms calculation rectifies the signal so any noise is rectified too and added to the wanted measurement. If you also measure voltage and use the real power method, you will find the &#39;noise&#39; power is significantly lower because the current noise samples that give a negative power average with the positive ones and tend to cancel.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20515"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6125.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="myckie&#039;s picture" title="myckie&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Questions about the current sensor and emon library</h3>

    <div class="submitted">Submitted by <a href="../user/6125.html" title="View user profile.">myckie</a> on Sun, 06/04/2014 - 10:08.</div>
    <div class="content">
     <p>Hi,</p>
<p>I&#39;m trying with other current sensors (SCT-013-030) and have the same problem with Arduino Yun .</p>
<p>I have done the current and voltage circuit and readings are reasonable good.</p>
<p>My calibration with this sensor :</p>
<p>emon1.voltage(2, 224.26, 1.35);&nbsp; // Voltage: input pin, calibration, phase_shift<br />
	emon1.current(1,30);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Current: input pin, calibration.</p>
<p>Without any current connected to CT, i get this values like this:</p>
<p>3.21 18.87 227.92 0.08 0.17<br />
	2.10 18.42 228.94 0.08 0.11</p>
<p>But...I put away to do last reading the capacitor (10 uf) on the current side</p>
<p>With capacitor connected i get this readings, i think capacitor introduce noise (but it should not..i dont understand):</p>
<p>-1.13 56.68 229.00 0.25 -0.02<br />
	11.34 55.79 228.56 0.24 0.20<br />
	-3.09 55.12 229.29 0.24 -0.06</p>
<p>Readings for pure resistance load without capacitor are fine i think:</p>
<p>759.09 759.74 225.29 3.37 1.00<br />
	757.43 758.02 225.04 3.37 1.00<br />
	754.65 755.23 224.69 3.36 1.00</p>
<p>With capacitor:</p>
<p>769.72 770.67 225.48 3.42 1.00<br />
	762.58 763.75 226.06 3.38 1.00<br />
	765.69 767.76 225.40 3.41 1.00<br />
	769.03 770.10 225.55 3.41 1.00</p>
<p>Multimeter/amperimeter give me this values:</p>
<p>225 volt, 3.27 A</p>
<p>What do you think about not using capacitor on the current side and this readings?</p>
<p>Thanks !</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20519"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Questions about the current sensor and emon library</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 06/04/2014 - 11:36.</div>
    <div class="content">
     <p><em>&quot;With capacitor connected...&quot;</em>&nbsp;&nbsp;&nbsp; Where is the capacitor connected? The correct input connections are shown <a href="https://learn.openenergymonitor.org/?redirect=ct-sensors-interface">here</a>.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20521"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6125.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="myckie&#039;s picture" title="myckie&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Questions about the current sensor and emon library</h3>

    <div class="submitted">Submitted by <a href="../user/6125.html" title="View user profile.">myckie</a> on Sun, 06/04/2014 - 15:35.</div>
    <div class="content">
     <p>Hi,first thanks for your comments.<br />
The capacitor is connected 3equal that in the link you posted .I use 10k resistors.</p>
<p>But as i comment,if i disconnect capacitor there is less noise in readings.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20536"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Questions about the current sensor and emon library</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 06/04/2014 - 20:46.</div>
    <div class="content">
     <p>There are two possible explanations, that I can think of, for extra noise when the capacitor is connected:</p>
<p>1. The capacitor itself is &quot;noisy&quot; and is generating noise. This is not likely if it is a new capacitor and you have connected it with the correct polarity.</p>
<p>2. The layout of the circuit means that the &quot;GND&quot; at the point where the capacitor is connected is not a true ground and it has a noise voltage superimposed on it, which the capacitor couples into the input. I think this is more likely. I do not know the Arduino Yun, but I understand it has a full Linux processor on-board as well as the Arduino, therefore there will be heavier currents flowing carrying digital noise. Unless the supply and GND for the digital circuits is carefully filtered, I think it is quite possible that noise from there will get into the analogue input. It may be that there is very little that you can do to reduce the problem. You could try feeding the power supply first to your analogue input, then feed the Arduino board from that through a ferrite bead inductor - like Fig. 1.2<a href="http://www.atmel.com/images/atmel-2521-avr-hardware-design-considerations_application-note_avr042.pdf"> here.</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20542"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6125.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="myckie&#039;s picture" title="myckie&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Questions about the current sensor and emon library</h3>

    <div class="submitted">Submitted by <a href="../user/6125.html" title="View user profile.">myckie</a> on Sun, 06/04/2014 - 21:51.</div>
    <div class="content">
     <p>Thanks Robert,</p>
<p>I will try with a ferrite bead inductor.</p>
<p>If it doesn&#39;t reduce the problem, What do you think about leave the circuit without the capacitor?</p>
<p>As i said, without it , the noise is really low (0.08 A versus 0.20 A) at cero load in the sensor and i think readings at diferents loads are stable and really close to my amperimeter .</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-20544"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Questions about the current sensor and emon library</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 06/04/2014 - 22:36.</div>
    <div class="content">
     <p>I think the capacitor really should be there. Without it, the resistors have a Th&eacute;venin equivalent resistance of 5 k&Omega; in series with the current transformer output. With the capacitor, there as an additional low impedance ( 318 &Omega; ) path in parallel with the resistors that better &quot;anchors&quot; one side of the input to ground at ac. Leaving the capacitor out will have very little effect on the signal because the impedance is smaller than the maximum&nbsp; impedance recommended by ATmel. But it does mean that the current transformer is more likely to pick up mains-borne interference by capacitive coupling and inject it into the input.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/4822"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-YyggFmw1wILnhb-0w6xBZaI26wNCc5RJF2oaZobC3Ys" value="form-YyggFmw1wILnhb-0w6xBZaI26wNCc5RJF2oaZobC3Ys"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
