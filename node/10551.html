<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/10551 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:32:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>How to detect broken/disconnected clamp ? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">How to detect broken/disconnected clamp ?</h3>
        <span class="submitted">Submitted by <a href="../user/8077.html" title="View user profile.">svalent</a> on Thu, 30/04/2015 - 21:58</span>
        <div class="content"><p>Hi,</p>
<p>&nbsp;do you have any idea how to /with no or minimum hardware adds -&nbsp; only by software&nbsp;in arduino scetch/ detect if clamp (with built-in sampling resistor) si disconnected ?</p>
<p>&nbsp;</p>
<p>&nbsp;thanks</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;Stanislav</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="10522.html" class="topic-previous" title="Go to previous forum topic">‹ RFM69Pi GPIO access</a>
              <a href="10558.html" class="topic-next" title="Go to next forum topic">Emonhub Raspberry Pi setup problems ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-30005"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to detect broken/disconnected clamp ?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 30/04/2015 - 22:35.</div>
    <div class="content">
     <p>I think you cannot do that reliably. If the analogue input has absolutely no connection to anywhere, it will float to an unknown voltage. It will probably be far enough away from 512 (which is what you expect with our standard bias circuit) for you to be able to be able to say it is disconnected, but there is no guarantee that will be the case. </p>
<p>However, if you put a high value resistor (e.g. 4.7 M&Omega;) between the analogue input and GND, then I would expect the input to go sufficiently close to 0, and of course there would be no current signal superimposed, for you to say with some confidence that the CT had become disconnected. That resistor will slightly reduce the maximum current that you can measure because the quiescent point is no longer mid-way at 512 counts.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30006"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8077.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="svalent&#039;s picture" title="svalent&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to detect broken/disconnected clamp ?</h3>

    <div class="submitted">Submitted by <a href="../user/8077.html" title="View user profile.">svalent</a> on Thu, 30/04/2015 - 23:00.</div>
    <div class="content">
     <p>many thanks for your opinion, of course -&nbsp; &quot;pull down&quot; is some resolution, but....<br />
what about periodicaly switch pin to output to short time and charge capacitor <a href="../../../www.homautomation.org/wp-content/uploads/2013/09/step41.jpg">http://www.homautomation.org/wp-content/uploads/2013/09/step41.jpg</a>&nbsp; and next measure rate of speed drop voltage to 0 (or measure float values if the input is disconnected)&nbsp; .... (my be most different if clamp is connected or not)</p>
<p>PS: only theory at this time....</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30007"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to detect broken/disconnected clamp ?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 30/04/2015 - 23:01.</div>
    <div class="content">
     <p>I do not understand "speed drop voltage to 0". What is to say the voltage will drop to 0?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30052"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8077.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="svalent&#039;s picture" title="svalent&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to detect broken/disconnected clamp ?</h3>

    <div class="submitted">Submitted by <a href="../user/8077.html" title="View user profile.">svalent</a> on Sun, 03/05/2015 - 13:03.</div>
    <div class="content">
     <p>use Capacitor is wrong way....</p>
<p>Now I testing easier detecting by average input voltage on pin (input pin is pull down via 10Mohm) :</p>
<p>
<em>boolean broken_CT(unsigned int inPinI)<br />
{<br />
&nbsp; long in2=0;<br />
&nbsp; for (unsigned int n = 0; n &lt; 1480; n++)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; in2 += analogRead(inPinI);<br />
&nbsp; }<br />
&nbsp; in2=in2/1480;<br />
&nbsp; if (in2&lt;100)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; return false;&nbsp;&nbsp; //is broken/unconected<br />
&nbsp; }<br />
&nbsp; else<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; return true;&nbsp; //is OK<br />
&nbsp; }<br />
}</em></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30053"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to detect broken/disconnected clamp ?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 03/05/2015 - 13:26.</div>
    <div class="content">
     <p>I think you might not need to calculate the average!</p>
<p>If the CT is broken, there will be no alternating voltage (or only a very small alternating voltage) superimposed on the dc level. So if, over a period of 1 cycle of mains, you read one sample > 100 (say), you know the CT is good. If you read < 100 for a whole cycle, you are certain that the CT is bad. If you read < 100 for less than one half-cycle, you might have a large current flowing!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30079"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to detect broken/disconnected clamp ?</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Mon, 04/05/2015 - 08:50.</div>
    <div class="content">
     <p>If a CT were to &quot;drop off&quot; the cable around which it is supposed to be clipped, there would be virtually no AC signal from it.&nbsp; This would be indistinguishable from a situation where the CT is properly connected, but no primary current is flowing.&nbsp;</p>
<p>This is a genuine concern for the PV Router project.&nbsp; If the output stage happens to be &#39;on&#39; when&nbsp;the CT is disconnected, it is likely to remain on indefinitely because the control loop has been broken.&nbsp; I&#39;ve demonstrated this situation&nbsp;at <a href="https://www.youtube.com/watch?v=oF8HACCsK4M">https://www.youtube.com/watch?v=oF8HACCsK4M</a>&nbsp;&nbsp; In the case of an immersion heater, there&nbsp;will normally be two mechanisms to prevent overheating.&nbsp; The situation is no worse than if the heater had been turned on manually and left unattended.</p>
<p>I can&#39;t see any way of auto-detecting whether a CT is correctly in place or not.&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-30090"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: How to detect broken/disconnected clamp ?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 04/05/2015 - 11:53.</div>
    <div class="content">
     <p>That's fair comment, but the original specification was "detect if clamp (with built-in sampling resistor) si disconnected".</p>
<p>Your PV Router <i>might</i> detect if the CT had physically fallen off the cable whilst still remaining connected, if you knew how long the tank took to cool and presumed that there was no other source of heating: if the CT didn't show current after this time had expired and the triac was on, you could infer that there was a problem, though you could not tell whether the heater was tripped out or isolated, the triac blown, or indeed the CT had fallen off. Personally, I'd have thought any of the others was more likely than the CT falling off.</p>
<p>For what it's worth, we <u>always</u> used spring-loaded terminals and hook crimps for all feedback connections in closed-loop control systems, precisely for the reason that if the feedback disappears, maloperation (at best) and danger to personnel is almost guaranteed. </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/10551"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-qu3E3CQB8mUvemfkCOa1_W4F4XCP4eV7vwBzfQQ464A" value="form-qu3E3CQB8mUvemfkCOa1_W4F4XCP4eV7vwBzfQQ464A"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/10551 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:32:02 GMT -->
</html>
