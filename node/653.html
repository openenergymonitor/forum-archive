<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/653 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:47:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>calibration | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">calibration</h3>
        <span class="submitted">Submitted by Guest on Sat, 05/05/2012 - 07:22</span>
        <div class="content"><p>&nbsp;</p>
<pre style="width: 700px; background-color: rgb(238, 238, 238); padding-top: 0.75em; padding-right: 1.5em; padding-bottom: 0.75em; padding-left: 1.5em; font-size: 14px; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: rgb(221, 221, 221); border-right-color: rgb(221, 221, 221); border-bottom-color: rgb(221, 221, 221); border-left-color: rgb(221, 221, 221); border-image: initial; color: rgb(0, 0, 0); line-height: 17px; text-align: left; ">
voltage constant = 230 * 11 / (9+20%) = 234.26</pre><p>&nbsp;</p>
<p>&nbsp;</p>
<pre style="width: 700px; background-color: rgb(238, 238, 238); padding-top: 0.75em; padding-right: 1.5em; padding-bottom: 0.75em; padding-left: 1.5em; font-size: 14px; border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: rgb(221, 221, 221); border-right-color: rgb(221, 221, 221); border-bottom-color: rgb(221, 221, 221); border-left-color: rgb(221, 221, 221); border-image: initial; color: rgb(0, 0, 0); line-height: 17px; text-align: left; ">
current constant = (100 / 0.050) / 18 = 111.11</pre><p>&nbsp;</p>
<p>this are the equations used to find I cal and V cal theoretically &nbsp;and I cal and V cal&nbsp;and PF cal why they are actually used</p>
<p>also the shifted v is there in order to eliminate any distortion that may have rose due to the transformer and other components in the circuit??</p>
<p>&nbsp;</p>
<p>thanks</p>
  <div class="forum-topic-navigation clear-block">
          <a href="644.html" class="topic-previous" title="Go to previous forum topic">‹ emoncms</a>
              <a href="661.html" class="topic-next" title="Go to next forum topic">emoncms dashboard ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-4232"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: calibration</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 05/05/2012 - 11:57.</div>
    <div class="content">
     <blockquote><p>&quot;this are the equations used to find I cal and V cal theoretically &quot;</p>
</blockquote>
<p>Correct.</p>
<blockquote><p>&quot;and I cal and V cal&nbsp;and PF cal why they are actually used&quot;</p>
</blockquote>
<p>ICAL and VCAL are there because (1) you want to read normal units, Amps and Volts (not counts) on your display and (2) because the relationship between counts and those real units changes according to the actual value of the components you have. (Example, your burden resistor is 18 Ohms +/- 1%, so it could be 17.82 Ohms, 18.18 Ohms or anywhere between these values).</p>
<p>PFcal (PHASECAL) is there because voltage and current are measured one after the other, so there is a short time delay between the readings, which is the same as a phase shift.&nbsp; The a.c. adapter also contributes a phase shift (see <a href="https://learn.openenergymonitor.org/?redirect=report-mascot-9v-acac-adaptor" title="http://openenergymonitor.org/emon/buildingblocks/report-mascot-9v-acac-adaptor">http://openenergymonitor.org/emon/buildingblocks/report-mascot-9v-acac-a...</a>). PHASECAL corrects both those errors.</p>
<blockquote><p>&quot;also the shifted v is there in order to eliminate any distortion that may have rose due to the transformer and other components in the circuit??&quot;</p>
</blockquote>
<p>&quot;phaseShiftedV&quot; is the result of that correction.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4247"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Polidano&#039;s picture" title="Polidano&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: calibration</h3>

    <div class="submitted">Submitted by Polidano (not verified) on Sun, 06/05/2012 - 15:21.</div>
    <div class="content">
     <p>for shifted v only i still cant understand the reason behind the equation please</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4251"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: calibration</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 06/05/2012 - 16:36.</div>
    <div class="content">
     <p>Do you mean you understand why it is necessary to correct for phase shift, but you do not understand how the equation does that?</p>
<p>A agree it is difficult to understand the equation. You must draw on paper a sine wave, mark on it where it is sampled each time (about every 7 degrees in practice, but you need not choose that value to understand what happens; try every 15 degrees). Then you need to pick a number for PHASECAL (say 1.5), choose the first two samples - call the first &quot;lastfiltered&quot; and the second &quot;filtered&quot;.&nbsp; Calculate using the equation and draw on the paper where the point &quot;phaseShifted&quot; comes. Then repeat this, the old &quot;filtered&quot; (sample 2) becomes &quot;lastfiltered&quot; and the next sample (sample 3) becomes &quot;filtered&quot;. Repeat this for a number of samples, and join up the new points you have marked with a smooth curve. Then choose a different number for PHASECAL and repeat the procedure.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4262"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Polidano&#039;s picture" title="Polidano&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: calibration</h3>

    <div class="submitted">Submitted by Polidano (not verified) on Mon, 07/05/2012 - 11:24.</div>
    <div class="content">
     <p>thanks a lot.. i didnt understand actually the reason behind it this :</p>
<p>&nbsp;</p>
<div>
	&nbsp;//Phase calibration goes here.</div>
<div>
	&nbsp; &nbsp;shiftedV = lastFilteredV + PHASECAL * (filteredV - lastFilteredV);</div>
<div>
	&nbsp;</div>
<div>
	how can I come up with that</div>
<div>
	&nbsp;</div>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4266"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: calibration</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 07/05/2012 - 12:31.</div>
    <div class="content">
     <p>Do you understand now?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4270"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Polidano&#039;s picture" title="Polidano&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: calibration</h3>

    <div class="submitted">Submitted by Polidano (not verified) on Mon, 07/05/2012 - 16:10.</div>
    <div class="content">
     <p>ok I understood what you mean.. so with that equation your doing a smoother sine wave. However the phase cal&nbsp;only needs to be set once. your just trying different in order to get the smoothest possible</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4285"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: calibration</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 07/05/2012 - 21:09.</div>
    <div class="content">
     <p>I told you to join up the <strong>new</strong> points, to give a new wave. The new wave that you have drawn should be shifted in angle = shifted in time = shifted in phase,&nbsp; in relation to the original!</p>
<p>So, if your original wave was phase shifted before you measured it, or you measured it late (in time), you can make a new wave that is shifted to where the original SHOULD have been. Then you use that to calculate power.</p>
<p>[Edit]</p>
<p>Your diagram should look like this.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4292"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Polidano&#039;s picture" title="Polidano&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: calibration</h3>

    <div class="submitted">Submitted by Polidano (not verified) on Tue, 08/05/2012 - 07:52.</div>
    <div class="content">
     <p>ahh ok I understood. because now I did it personally :) thanks a lot&nbsp;</p>
<p>I wrote this part like this:</p>
<p>&nbsp;</p>
<div>
	&nbsp;</div>
<div>
	xbeeSerial.print(Real_Power);</div>
<div>
	xbeeSerial.print(&#39; &#39;);</div>
<div>
	&nbsp;</div>
<div>
	xbeeSerial.print(Apparent_Power);</div>
<div>
	xbeeSerial.print(&#39; &#39;);</div>
<div>
	&nbsp;</div>
<div>
	xbeeSerial.print(PF);</div>
<div>
	xbeeSerial.print(&#39; &#39;);</div>
<div>
	&nbsp;</div>
<div>
	xbeeSerial.print(RMS_V);</div>
<div>
	xbeeSerial.print(&#39; &#39;);</div>
<div>
	&nbsp;</div>
<div>
	xbeeSerial.print(RMS_I);</div>
<div>
	xbeeSerial.print(&#39; &#39;);</div>
<div>
	&nbsp;</div>
<div>
	is it good or do I have to write the letters A, B in the blank here&nbsp;xbeeSerial.print(&#39; &#39;); &nbsp; between the inverted commas??</div>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4299"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: calibration</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 08/05/2012 - 11:42.</div>
    <div class="content">
     <p>It is your installation, you can do whatever you like. But there are many advantages in following what other people have used before and proven to work. So take a look at the program that receives the data and see what it expects.</p>
<p>If you choose not to use something that is known to work, you can change it and write whatever you like and send whatever you like. At the receiving end, you then have write the program to interpret what comes in over the link, convert the strings if necessary and assign the results to right variables.</p>
<p>It is generally easier to write a string than to interpret a string. So it makes sense to <strong>keep it simple</strong> and easy to interpret.</p>
<p>I say &quot;1234.2 1563.2 0.79 234.5 6.65&quot; is much easier to interpret (by a program) than &quot;1234.2A1563.2B0.79C234.5D6.65&quot; because you know that a space &#39;&nbsp; &#39; always separates the two numbers, and it is easier to always look for a space rather than a different symbol each time.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4300"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Polidano&#039;s picture" title="Polidano&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: calibration</h3>

    <div class="submitted">Submitted by Polidano (not verified) on Tue, 08/05/2012 - 12:20.</div>
    <div class="content">
     <p>Im saying so becuase&nbsp;in the main sketch it is written like this:</p>
<p>&nbsp;</p>
<div>
	&nbsp;</div>
<div>
	void sendDataToXbee()</div>
<div>
	{</div>
<div>
	&nbsp; //----------XBEE SERIAL LINK - SEND DATA---------- &nbsp; &nbsp; &nbsp;</div>
<div>
	&nbsp; //Send data via xbee link to ethernet unit</div>
<div>
	&nbsp; xbeeSerial.print(realPower);</div>
<div>
	&nbsp; xbeeSerial.print(&#39;A&#39;);</div>
<div>
	&nbsp; xbeeSerial.print(apparentPower);</div>
<div>
	&nbsp; xbeeSerial.print(&#39;B&#39;);</div>
<div>
	&nbsp; xbeeSerial.print(powerFactor);</div>
<div>
	&nbsp; xbeeSerial.print(&#39;C&#39;);</div>
<div>
	&nbsp; xbeeSerial.print(Vrms);</div>
<div>
	&nbsp; xbeeSerial.print(&#39;D&#39;);</div>
<div>
	&nbsp; xbeeSerial.print(Irms);</div>
<div>
	&nbsp; xbeeSerial.print(&#39;E&#39;);</div>
<div>
	&nbsp; xbeeSerial.print(freq);</div>
<div>
	&nbsp; xbeeSerial.print(&#39;F&#39;);</div>
<div>
	&nbsp; xbeeSerial.print(kwhTotal);</div>
<div>
	&nbsp; xbeeSerial.print(&#39;G&#39;);</div>
<div>
	//------------------------------------------------</div>
<div>
	}</div>
<div>
	&nbsp; &nbsp;&nbsp;</div>
<div>
	Infact than on the Ethernet side it uses an array to converts the characters into float.. so if leave them as a space as I did them.. I wont need that array??&nbsp;</div>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4336"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: calibration</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Thu, 10/05/2012 - 09:06.</div>
    <div class="content">
     <p>A yes, this is old code, the reason I used characters as identifiers was that it made it easy to identify a particular variable by the character, so for example A is always real power or whatever. This way you can add and remove variables relatively easily, anyway this is another topic.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/653"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-LQVfM9cybnCLBFAcasLf1Jqb9VAIlV9vQjjJXigZUto" value="form-LQVfM9cybnCLBFAcasLf1Jqb9VAIlV9vQjjJXigZUto"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
