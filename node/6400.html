<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/6400 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:48:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>emonhub error: &quot;ERROR Unable to create &#039;RFM2Pi&#039; interfacer: Attempting to use a port that is not open&quot; | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">emonhub error: &quot;ERROR Unable to create &#039;RFM2Pi&#039; interfacer: Attempting to use a port that is not open&quot;</h3>
        <span class="submitted">Submitted by <a href="../user/7456.html" title="View user profile.">jvda</a> on Thu, 01/01/2015 - 15:47</span>
        <div class="content"><p>Hi</p>
<p>I have installed emonhub on my raspberry pi running raspbmc:</p>
<blockquote><p>​pi@raspbmc:/var/log/emonhub$ uname -a<br />
Linux raspbmc 3.12.31 #2 PREEMPT Wed Oct 29 09:24:56 UTC 2014 armv6l GNU/Linux</p>
</blockquote>
<p>I get following error when I started emonhub in the emonhub.log file:</p>
<blockquote><p>2015-01-01 16:17:53,186 INFO EmonHub Pre-Release Development Version (rc1.2)<br />
2015-01-01 16:17:53,188 INFO Opening hub...<br />
2015-01-01 16:17:53,194 INFO Logging level set to DEBUG<br />
2015-01-01 16:17:53,196 INFO Creating EmonHubEmoncmsReporter &#39;emonCMS&#39;<br />
2015-01-01 16:17:53,201 INFO Set up reporter &#39;emonCMS&#39; (buffer: memory | size: 1000)<br />
2015-01-01 16:17:53,204 INFO Setting emonCMS url: <a href="http://emoncms.org/" title="http://emoncms.org">http://emoncms.org</a><br />
2015-01-01 16:17:53,207 INFO Setting emonCMS apikey: set<br />
2015-01-01 16:17:53,209 INFO Creating EmonHubJeeInterfacer &#39;RFM2Pi&#39;<br />
2015-01-01 16:17:53,215 DEBUG Opening serial port: /dev/ttyAMA0 @ 38400 bits/s<br />
2015-01-01 16:17:55,221 DEBUG Opening serial port: /dev/ttyAMA0 @ 9600 bits/s<br />
2015-01-01 16:17:57,226 <strong>ERROR Unable to create &#39;RFM2Pi&#39; interfacer: Attempting to use a port that is not open</strong></p>
</blockquote>
<p>Do you have any idea why I am having this problem ?</p>
<p>Note that I have checked it and there is no process that is using ttyAMA0&nbsp;:</p>
<blockquote><p>pi@raspbmc:~$ ps -ef | grep tty<br />
root &nbsp; &nbsp; &nbsp;1018 &nbsp; &nbsp; 1 &nbsp;0 16:04 tty2 &nbsp; &nbsp; 00:00:00 /sbin/getty -8 38400 tty2<br />
root &nbsp; &nbsp; &nbsp;1019 &nbsp; &nbsp; 1 &nbsp;0 16:04 tty3 &nbsp; &nbsp; 00:00:00 /sbin/getty -8 38400 tty3<br />
pi &nbsp; &nbsp; &nbsp; &nbsp;2558 &nbsp;1416 &nbsp;0 16:36 pts/1 &nbsp; &nbsp;00:00:00 grep tty<br />
pi@raspbmc:~$</p>
</blockquote>
<p>Note also that raspbmc is a bit different compared to&nbsp;raspbian as inittab and cmdline.txt didn&#39;t make any reference to ttyAMA0. &nbsp;Instead I have out commented the last 2 lines of the file /etc/init/ttyAMA0.conf:</p>
<blockquote><p># ttyAMA0 - getty<br />
#<br />
# This service maintains a getty on tty2 from the point the system is<br />
# started until it is shut down again.</p>
<p>description &nbsp; &nbsp; &quot;Start getty on ttyAMA0&quot;<br />
author &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;Scott James Remnant &lt;scott@netsplit.com&gt;&quot;</p>
<p>start on ((xbmc-started FIRST_RUN!=no or started delay-start-20) and runlevel [23])</p>
<p>stop on runlevel [01456]</p>
<p><strong>#</strong>respawn<br />
<strong>#</strong>exec /sbin/getty -L ttyAMA0 115200 vt100</p>
</blockquote>
<p>​FYI my emonhub.conf &nbsp;(note that I have deleted most of&nbsp;my API wite key):</p>
<blockquote><p>...</p>
<p># All lines beginning with a &#39;#&#39; are comments and can be safely removed.</p>
<p>#######################################################################<br />
####################### &nbsp; &nbsp;emonHub &nbsp;settings &nbsp; &nbsp;#######################<br />
#######################################################################<br />
[hub]</p>
<p># loglevel must be one of DEBUG, INFO, WARNING, ERROR, and CRITICAL<br />
# see here : <a href="http://docs.python.org/2/library/logging.html" title="http://docs.python.org/2/library/logging.html">http://docs.python.org/2/library/logging.html</a><br />
loglevel = DEBUG</p>
<p>
#######################################################################<br />
####################### &nbsp; &nbsp; &nbsp; &nbsp;Reporters &nbsp; &nbsp; &nbsp; &nbsp;#######################<br />
#######################################################################<br />
[reporters]</p>
<p># This reporter sends data to emonCMS<br />
[[emonCMS]]<br />
&nbsp; &nbsp; Type = EmonHubEmoncmsReporter<br />
&nbsp; &nbsp; [[[init_settings]]]<br />
&nbsp; &nbsp; [[[runtimesettings]]]<br />
&nbsp; &nbsp; &nbsp; &nbsp; url = <a href="http://emoncms.org/" title="http://emoncms.org">http://emoncms.org</a><br />
&nbsp; &nbsp; &nbsp; &nbsp; apikey = 5..deleted...3</p>
<p>
#######################################################################<br />
####################### &nbsp; &nbsp; &nbsp; Interfacers &nbsp; &nbsp; &nbsp; #######################<br />
#######################################################################<br />
[interfacers]</p>
<p># This interfacer manages the RFM2Pi module<br />
[[RFM2Pi]]<br />
&nbsp; &nbsp; Type = EmonHubJeeInterfacer<br />
&nbsp; &nbsp; [[[init_settings]]]<br />
&nbsp; &nbsp; &nbsp; &nbsp; com_port = /dev/ttyAMA0<br />
&nbsp; &nbsp; [[[runtimesettings]]]<br />
&nbsp; &nbsp; &nbsp; &nbsp; group = 210<br />
&nbsp; &nbsp; &nbsp; &nbsp; frequency = 433<br />
&nbsp; &nbsp; &nbsp; &nbsp; baseid = 15</p>
<p>
#######################################################################<br />
####################### &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Nodes &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#######################<br />
#######################################################################<br />
[nodes]</p>
<p># List of nodes by node ID<br />
# &#39;datacode&#39; is default for node and &#39;datacodes&#39; are per value data codes.<br />
# if both are present &#39;datacode&#39; is ignored in favour of &#39;datacodes&#39;<br />
[[10]]<br />
&nbsp; &nbsp; &nbsp; &nbsp; datacode = h<br />
&nbsp; &nbsp; &nbsp; &nbsp; datacodes = l, h, h, h,<br />
(END)</p>
</blockquote>
<p>Any help would be greatly appreciated and of course a happy 2015 for you all.</p>
<p>Jan.</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="12124.html" class="topic-previous" title="Go to previous forum topic">‹ Guide: How to enable Samba server on the Pi&#039;s read only file system</a>
              <a href="11259.html" class="topic-next" title="Go to next forum topic">Upload old data to emoncms.org ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-26318"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 01/01/2015 - 17:06.</div>
    <div class="content">
     <p>Hi Jan,</p>
<p>When did you purchase RFM2Pi&nbsp;? If recently&nbsp;do you know if it is an RFM12 or RFM69&nbsp;based board ?</p>
<p>I think if&nbsp;you can see&nbsp;<span style="font-size: 12.7272720336914px; line-height: 18.9090900421143px;">a &quot;larger&quot; metal crys</span><span style="font-size: 12.7272720336914px; line-height: 18.9090900421143px;">tal can on&nbsp;</span><span style="font-size: 13px; line-height: 1.6;">the small RF sub-board <a href="../../../cdn2.bigcommerce.com/server4400/98a75/products/76/images/173/RFM12B_large__61954.1405403920.1280.12804847.jpg?c=2">(as seen here)</a>&nbsp;it&#39;s an RFM12&nbsp;or if not <a href="../../../cdn2.bigcommerce.com/server4400/98a75/products/158/images/565/RFM69CW_fullfrontal_large__34066.1417538825.1280.12804847.jpg?c=2">(as seen here)</a> it&#39;s an RFM69.&nbsp;</span></p>
<p><span style="font-size: 13px; line-height: 1.6;">If it&#39;s an rfm69&nbsp;and not an &quot;extremely&quot; recent build it may use a baud of 57600, easily tested for&nbsp;and accommodated&nbsp;by adding a line to the [[RFM2Pi]] [[[init_settings]]] in the&nbsp;emonhub.conf below&nbsp;the com_port setting</span></p>
<blockquote><p>[[[init_settings]]]<br />
&nbsp; &nbsp; &nbsp; &nbsp; com_port = /dev/ttyAMA0​<br />
&nbsp; &nbsp; &nbsp; &nbsp;<strong>&nbsp;com_baud = 57600</strong></p>
</blockquote>
<p>You can find more on this on the <a href="6244.html">&quot;RFM12Pi with RFM69CW&quot;</a> thread.</p>
<p>Otherwise it maybe a permission or console issue which is unfamiliar territory for me on&nbsp;raspbmc but I did find this&nbsp;<a href="http://www.raspberrypi.org/forums/viewtopic.php?&amp;t=33715">http://www.raspberrypi.org/forums/viewtopic.php?&amp;t=33715</a>&nbsp;which seems to suggest moving the ttyAMA0.conf file or editing the files &quot;start&quot; line.&nbsp;</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26320"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7456.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="jvda&#039;s picture" title="jvda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/7456.html" title="View user profile.">jvda</a> on Thu, 01/01/2015 - 18:39.</div>
    <div class="content">
     <p>Hi Paul,</p>
<p>Thanks for the fast response.</p>
<p>I have checked it and it is a RFM12.</p>
<p>Regarding&nbsp;<a href="http://www.raspberrypi.org/forums/viewtopic.php?&amp;t=33715">http://www.raspberrypi.org/forums/viewtopic.php?&amp;t=33715</a>&nbsp;: I have already checked this and updated&nbsp;ttyAMA0.conf.</p>
<p>FYI: I can &quot;echo&quot; things to /dev/ttyAMA0 without getting errors:</p>
<blockquote><p>pi@raspbmc:~$ echo -en &quot;\x02*pof\x03&quot; &gt; /dev/ttyAMA0<br />
pi@raspbmc:~$ echo &quot;^B**pof^C&quot; &gt; /dev/ttyAMA0<br />
pi@raspbmc:~$ ls -l /dev/ttyAMA0<br />
crw-rw---T 1 root dialout 204, 64 Jan &nbsp;1 19:26 /dev/ttyAMA0<br />
pi@raspbmc:~$ ps aux | grep ttyAMA0<br />
pi &nbsp; &nbsp; &nbsp; &nbsp;8581 &nbsp;0.0 &nbsp;0.1 &nbsp; 1976 &nbsp; 616 pts/0 &nbsp; &nbsp;S+ &nbsp; 19:27 &nbsp; 0:00 grep ttyAMA0<br />
pi@raspbmc:~$</p>
</blockquote>
<p>kr</p>
<p>Jan.</p>
<p><i>[Duplicate post deleted - Moderator (RW)]</i></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26327"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7456.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="jvda&#039;s picture" title="jvda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/7456.html" title="View user profile.">jvda</a> on Thu, 01/01/2015 - 21:35.</div>
    <div class="content">
     <p>This problem is solved now (output emonhub.log)</p>
<blockquote><p>2015-01-01 19:44:12,494 INFO Creating EmonHubJeeInterfacer &#39;RFM2Pi&#39;<br />
2015-01-01 19:44:12,509 DEBUG Opening serial port: /dev/ttyAMA0 @ 38400 bits/s<br />
2015-01-01 19:44:14,518 DEBUG Opening serial port: /dev/ttyAMA0 @ 9600 bits/s<br />
2015-01-01 19:44:16,525 ERROR Unable to create &#39;RFM2Pi&#39; interfacer: Attempting to use a port that is not open<br />
<strong>2015-01-01 16:03:40,428</strong> INFO EmonHub Pre-Release Development Version (rc1.2)<br />
2015-01-01 16:03:40,434 INFO Opening hub...<br />
2015-01-01 16:03:40,436 INFO Logging level set to DEBUG<br />
2015-01-01 16:03:40,438 INFO Creating EmonHubEmoncmsReporter &#39;emonCMS&#39;<br />
2015-01-01 16:03:40,445 INFO Set up reporter &#39;emonCMS&#39; (buffer: memory | size: 1000)<br />
2015-01-01 16:03:40,449 INFO Setting emonCMS url: <a href="http://emoncms.org/" title="http://emoncms.org">http://emoncms.org</a><br />
2015-01-01 16:03:40,451 INFO Setting emonCMS apikey: set<br />
2015-01-01 16:03:40,459 INFO Creating EmonHubJeeInterfacer &#39;RFM2Pi&#39;<br />
2015-01-01 16:03:40,489 DEBUG Opening serial port: /dev/ttyAMA0 @ 38400 bits/s<br />
2015-01-01 16:03:42,511 DEBUG Opening serial port: /dev/ttyAMA0 @ 9600 bits/s<br />
<strong>2015-01-01 21:50:16,091 INFO RFM2Pi device firmware version &amp; configuration: not available<br />
2015-01-01 21:50:16,098 INFO Setting RFM2Pi frequency: 433 (4b)<br />
2015-01-01 21:50:17,101 INFO Setting RFM2Pi group: 210 (210g)<br />
2015-01-01 21:50:18,105 INFO Setting RFM2Pi quiet: 1 (1q)<br />
2015-01-01 21:50:19,108 INFO Setting RFM2Pi baseid: 15 (15i)<br />
2015-01-01 21:50:20,135 DEBUG RFM2Pi acknowledged command: &gt; 4b<br />
2015-01-01 21:50:21,760 DEBUG RFM2Pi acknowledged command: &gt; 210g<br />
2015-01-01 21:50:22,204 DEBUG RFM2Pi acknowledged command: &gt; 1q<br />
2015-01-01 21:50:22,418 DEBUG RFM2Pi acknowledged command: &gt; 15i</strong></p>
</blockquote>
<p>&nbsp;</p>
<p>I have no idea what I did to fix the problem.</p>
<p>Is it because I have installed&nbsp;<a href="https://github.com/lurch/rpi-serial-console">https://github.com/lurch/rpi-serial-console</a>&nbsp;and ran it once to enable the serial and once to disable the serial console:</p>
<blockquote><p>sudo rpi-serial-console enable<br />
sudo rpi-serial-console disable<br />
&nbsp;</p>
</blockquote>
<p>Or was it because I did a hard shutdown (just pulled the power) instead of doing a &quot;reboot&quot;.</p>
<p>FYI my /boot/cmdline.txt now looks like:</p>
<blockquote><p>pi@raspbmc:/var/log/emonhub$ cat /boot/cmdline.txt<br />
dwc_otg.lpm_enable=0 root=/dev/mmcblk0p2 rootfstype=f2fs noatime quiet rootwait loglevel=1 sdhci-bcm2708.enable_llm=1 dwc_otg.microframe_schedule=1 dwc_otg.fiq_fix_enable=0 dwc_otg.fiq_split_enable=0<br />
pi@raspbmc:/var/log/emonhub$</p>
</blockquote>
<p>&nbsp;</p>
<p>kr</p>
<p>Jan.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26354"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Fri, 02/01/2015 - 15:55.</div>
    <div class="content">
     <p>Glad you got it going, I wonder did you originally reboot the Pi for the initial changes to take effect ?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26355"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7456.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="jvda&#039;s picture" title="jvda&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/7456.html" title="View user profile.">jvda</a> on Fri, 02/01/2015 - 16:35.</div>
    <div class="content">
     <p>Hi Paul, &nbsp;I certainly rebooted it originally using the &quot;reboot&quot; command.</p>
<p>kr<br />
Jan.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26462"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Mon, 05/01/2015 - 09:32.</div>
    <div class="content">
     <p>I don&#39;t know why this happened to you and why it got solved, but for the record, and as a note to Paul, I had the same mysterious message the other night when I plugged my new RF69 (which was flashed with an old firmware).</p>
<p>At baud rate detection, in the for</p>
<pre>
com_baud in (38400, 9600):</pre><p>loop, if both baud rate give no answer, the loop is exited with self._ser not None but closed.</p>
<p>Then</p>
<pre>
self._ser.write(&quot;v&quot;)</pre><p>tries to write in a closed serial port.</p>
<p>In my case, the firmware was probably set to 57600. In I jvda&#39;s case, I don&#39;t know.</p>
<p>We may want to rework the baud rate detection, at least to yield a more explicit error message.</p>
<p>While we&#39;re at it, I&#39;m not sure the continue statement is needed here, is it ?</p>
<p>And maybe replace</p>
<pre>
self._rx_buf = self._rx_buf + self._ser.readline()</pre><p>by</p>
<pre>
self._rx_buf = self._ser.readline()</pre><p>?</p>
<p>Maybe I&#39;ll find the time to submit something...</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26466"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 05/01/2015 - 13:50.</div>
    <div class="content">
     <p>Hi&nbsp;J&eacute;r&ocirc;me, Thanks for the pointers, I have opened a&nbsp;<a href="https://github.com/emonhub/emonhub/issues/135">Rework serial port read() and auto-baud selection</a>&nbsp;<span style="font-size: 12.7272720336914px; line-height: 18.9090900421143px;">issue on&nbsp;</span>emonHub&#39;s<span style="font-size: 12.7272720336914px; line-height: 18.9090900421143px;">&nbsp;repo as this does indeed need some attention.</span></p>
<p><span style="font-size: 12.7272720336914px; line-height: 18.9090900421143px;">The baud selection does need to be more robust or at least more informative if an error occurs, I wasn&#39;t aware of the &quot;loop is exited with self._ser not None but closed&quot; status and the &quot;continue&quot; probably can be removed, I think it was accidently left when the &quot;Display device firmware version and current settings&quot; code was removed from the auto-baud code so it could be reached when a&nbsp;baud was manually set in the conf.</span></p>
<p>The &quot;self._rx_buf = self._rx_buf + self._ser.readline()&quot; was copied over from the existing read() code, as I thought it was to ensure the line read remained a string and couldn&#39;t be accidently&nbsp;cast&nbsp;if for example, a purely numeric value was read and assumed to be an int etc.</p>
<p>I have occasionally encountered this same issue, but when cold booting a Pi with the RFM2Pi&nbsp;v2 (rfm12) and I believed it maybe due to the extended &quot;help text&quot; printed&nbsp;at power up or the extra newline&nbsp;with no CR in the sketches setup().</p>
<p>Sorry about the 57600 baud, but I think it only effects a handful of us and was for the greater good to drop it as discussed in the <a href="6244.html">&quot;RFM12Pi with RFM69CW&quot;</a>&nbsp;thread.</p>
<p>Paul</p>
<p>Paul</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26494"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Tue, 06/01/2015 - 14:24.</div>
    <div class="content">
     <p>&gt; The &quot;self._rx_buf = self._rx_buf + self._ser.readline()&quot; was copied over from the existing read() code, as I thought it was to ensure the line read remained a string and couldn&#39;t be accidently&nbsp;cast&nbsp;if for example, a purely numeric value was read and assumed to be an int etc.</p>
<p>The only reason I did this was because the readline() method is used with timeout 0 to avoid blocking the execution, and it might get executed before the frame is received in its entirety. Therefore, the received frame is checked for &quot;end of frame&quot; and if incomplete, it is completed at next readline() execution.</p>
<p>I never thought about potential cast issues.</p>
<p>Apart from the read() method occurence, all occurences of self._rx_buf = self._rx_buf + self._ser.readline() are useless but harmful, although they can be misleading, for instance</p>
<pre>
    self._rx_buf = &quot;&quot;
    info = self._rx_buf + self._ser.readline()[:-2]</pre><p>We can safely simplify this. (I can do it soon, don&#39;t bother.)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26497"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 06/01/2015 - 15:20.</div>
    <div class="content">
     <blockquote><p><em>Apart from the read() method occurence, all occurences of self._rx_buf = self._rx_buf + self._ser.readline() are useless but harmful, although they can be misleading, for instance</em></p>
</blockquote>
<p>Ideally, the &quot;auto baud detection&quot; and the &quot;firmware and settings retrieval&quot; code should use the existing read() method and just act on the results rather than reading the port directly.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26498"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Tue, 06/01/2015 - 15:47.</div>
    <div class="content">
     <p>Hmmm, good point. I was modifying the file step by step by small modifications first but I shall move back, stop and think. This is a nice way of improvement. I&#39;ll have that in mind.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26500"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 06/01/2015 - 16:50.</div>
    <div class="content">
     <p>Another point it may be worth keeping in mind with regard to the bigger picture is the&nbsp;need to implement threading to the intefacers.</p>
<p>This is needed to assist implementing subscription to&nbsp;mqtt topics, return multiple payloads from &quot;one read event&quot; using&nbsp;I&sup2;C and also sending (routing) data out from interfacers, including http requests eg interfacing with packetgen. Not only as this would be&nbsp;a lot of work for the main&nbsp;thread but also to prevent blocking.</p>
<p>The experimental branch has a working version of threaded interfacers and routed data to get the gist of the idea. So in the (not so distant) future it may be that the interfacers are threads looping a read_to_rx_queue() method unless interrupted to execute&nbsp;a<span style="line-height: 1.6;">&nbsp;</span><span style="line-height: 20.7999992370605px;">send_from_tx_queue().</span></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26502"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 06/01/2015 - 20:49.</div>
    <div class="content">
     <p>Additionally it has now occurred to me that the configuration commands may need to be considered as well. In the experimental branch there is a send() method used to write to the serial port by the &quot;glcd&nbsp;time update&quot;, &quot;rfm2piListenerRepeater&quot; and &quot;packetgen&quot;, it does&nbsp;not&nbsp;however currently handle the &quot;jee configuration commands&quot;,&nbsp;the &quot;auto baud detection&quot; or&nbsp;determining&nbsp;the&nbsp;&quot;firmware revision and current settings&quot;. This may lead to clashes over serial port access within emonHub possibly, although I haven&#39;t experienced this yet.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-26509"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Wed, 07/01/2015 - 08:30.</div>
    <div class="content">
     <p>I haven&#39;t look at the experimental branch yet, but indeed, if several threads are to send data over the serial port, they should send it first to a common buffer managed in a specific thread to prevent clashes.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-28548"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1332.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1332.jpg" alt="JBecker&#039;s picture" title="JBecker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/1332.html" title="View user profile.">JBecker</a> on Tue, 10/03/2015 - 15:18.</div>
    <div class="content">
     <p>Same error here: ERROR Unable to create &#39;RFM2Pi&#39; interfacer: Attempting to use a port that is not open</p>
<p>Can I bypass the whole baud rate detection by specifying the baud rate explicitly with &#39;com_baud = 9600&#39;?</p>
<p>I am asking because I am not using the RFM2Pi but my RS485 adapter which does not respond to any serial commands.</p>
<p>J&ouml;rg.</p>
<p>PS: or would it be possible to use the &#39;EmonHubSerialInterfacer&#39; instead? And then com_baud has to be specified, too?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-28552"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 10/03/2015 - 17:02.</div>
    <div class="content">
     <p>Hi&nbsp;J&ouml;rg.</p>
<p>The auto-baud detection is only on the &quot;JeeInterfacer&quot; for RFM devices as we can invoke&nbsp;a response to confirm a connection is successful or not. It can be over-ruled by setting &#39;com_baud = 9600&#39; in the [[RFM2Pi]][[[init_settings]]], However the &quot;JeeInterfacer&quot; is just a &quot;SerialInterfacer&quot; heavy customised for the &quot;Jee&quot; family of devices so there is a&nbsp;lot&nbsp;of baggage and attempts to make settings that you just don&#39;t need.</p>
<p>I would recommend using a SerialInterfacer and if needed tune it to your needs. I&#39;m sure you got it&nbsp;covered but if you search for terms like &quot;emonhub serial direct&quot; you&#39;ll find a couple of examples or just holla&nbsp;if you need any pointers :-)</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-28555"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1332.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1332.jpg" alt="JBecker&#039;s picture" title="JBecker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/1332.html" title="View user profile.">JBecker</a> on Tue, 10/03/2015 - 19:55.</div>
    <div class="content">
     <p>Thank you very much for the info, Paul!</p>
<p>Then I will go with the SerialInterfacer. I have gone through the sources in the meantime and this is what I thought already. Just wanted to be sure because I gave one of my RS485 Pcbs to a friend and he had a lot of problems with it and the newest &#39;Low-Write&#39; Emoncms version. Most of the problems came from typing errors (but which were based on documentation errors! There are examples with [runtimesettings] and [runtime_settings] and &#39;type&#39; instead of &#39;Type&#39;). Hope we get it fixed tomorrow. He is some 500km away, so it always takes some time between &#39;iterations&#39; :-)) (and a lot of guessing what is happening there).</p>
<p>BR, J&ouml;rg.</p>
<p>PS: just found it again (the wrong documentation):</p>
<p><a href="https://github.com/emoncms/emoncms/blob/bufferedwrite/docs/setup.md" title="https://github.com/emoncms/emoncms/blob/bufferedwrite/docs/setup.md">https://github.com/emoncms/emoncms/blob/bufferedwrite/docs/setup.md</a></p>
<p>&quot;</p>
<p>Emonhub reporters config example for posting data to both the local buffered write installation and emoncms.org</p>
<p>[reporters] [[emonCMS_local]] type = EmonHubEmoncmsReporter [[[init_settings]]] [[[<strong>runtime_settings]</strong>]] url = <a href="http://localhost/emoncms" title="http://localhost/emoncms">http://localhost/emoncms</a> apikey = xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx [[emonCMS_remote]]<strong> t</strong>ype = EmonHubEmoncmsReporter [[[init_settings]]] [[[<strong>runtime_settings</strong>]]] url = <a href="http://emoncms.org/" title="http://emoncms.org">http://emoncms.org</a> apikey = xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</p>
<p>&quot;</p>
<p>Is there somebody out there who could correct this, please? Just cost me and my friend a few hours of our precious time :-))))</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-28561"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 10/03/2015 - 20:26.</div>
    <div class="content">
     <p>Hi&nbsp;J&ouml;rg.</p>
<p>I&#39;ve submitted a pull request for the corrections. not quite sure how they slipped though the net. They are very early references from the days of listeners and dispatchers.</p>
<p>It&#39;s alittle late now but for future ref Type Is CamelCase As Per The EmonHubInterfacerTypes, all_the init_settings have_underscores&nbsp;and runtimesettingsarelowercasenobreaks&nbsp;(indicating settings&nbsp;that can be changed &#39;<em>withoutstopping&#39;).</em></p>
<p>I am around on and off tomorrow so post if you have any issues.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29023"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rao_pi&#039;s picture" title="rao_pi&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by rao_pi (not verified) on Thu, 26/03/2015 - 11:29.</div>
    <div class="content">
     <p>Hello,</p>
<p>I still could&#39;nt figure out a way to solve this error.</p>
<p>Please help me</p>
<p>I am getting error:</p>
<p>ERROR Unable to create &#39;RFM2Pi&#39; interfacer: Attempting to use a port that is not open</p>
<p>thank you</p>
<p>Rao</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-29049"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 26/03/2015 - 20:53.</div>
    <div class="content">
     <p>You will need to tell us more to be able to help you.&nbsp;</p>
<p>Are you using Raspbian or raspmc? are you using a pre-built image, guide or self build?</p>
<p>Have you made the serial port available by editing cmdline.txt and inittab?</p>
<p>Which<span style="line-height: 20.7999992370605px;">&nbsp;</span><span style="line-height: 20.7999992370605px;">rfm2pi</span><span style="line-height: 1.6;">&nbsp;board are you using ? has it ever worked (ie has it stopped working or is this 1st install)?</span></p>
<p><span style="line-height: 1.6;">Paul</span></p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-38971"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6548.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="billvolz&#039;s picture" title="billvolz&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/6548.html" title="View user profile.">billvolz</a> on Mon, 01/02/2016 - 15:18.</div>
    <div class="content">
     <p>I&#39;m starting to get this message. I&#39;m using Raspian with a self build and self install, recent. I added the RFM69PI and it didn&#39;t work at first, then ran the disable/enable serial port and it started to work. It worked until last night when it stopped with this message:</p>
<p>2016-01-31 23:59:11,891 INFO emonCMS sending: http://localhost/emoncms/input/bulk.json?apikey=E-M-O-N-C-M-S-A-P-I-K-E-Y&amp;data=[[1454302750.63,8,4,20,0,0,12530,3000,3000,3000,3000,3000,3000,1,0,-58]]&amp;sentat=1454302751<br />
2016-01-31 23:59:13,086 DEBUG SIGINT received.<br />
2016-01-31 23:59:13,282 WARNING emonCMS couldn&#39;t send to server, Exception: Traceback (most recent call last):<br />
&nbsp; File &quot;/home/pi/emonhub/src/emonhub_reporter.py&quot;, line 227, in _send_post<br />
&nbsp; &nbsp; response = urllib2.urlopen(request, timeout=60)<br />
&nbsp; File &quot;/usr/lib/python2.7/urllib2.py&quot;, line 127, in urlopen<br />
&nbsp; &nbsp; return _opener.open(url, data, timeout)<br />
&nbsp; File &quot;/usr/lib/python2.7/urllib2.py&quot;, line 401, in open<br />
&nbsp; &nbsp; response = self._open(req, data)<br />
&nbsp; File &quot;/usr/lib/python2.7/urllib2.py&quot;, line 419, in _open<br />
&nbsp; &nbsp; &#39;_open&#39;, req)<br />
&nbsp; File &quot;/usr/lib/python2.7/urllib2.py&quot;, line 379, in _call_chain<br />
&nbsp; &nbsp; result = func(*args)<br />
&nbsp; File &quot;/usr/lib/python2.7/urllib2.py&quot;, line 1211, in http_open<br />
&nbsp; &nbsp; return self.do_open(httplib.HTTPConnection, req)<br />
&nbsp; File &quot;/usr/lib/python2.7/urllib2.py&quot;, line 1184, in do_open<br />
&nbsp; &nbsp; r = h.getresponse(buffering=True)</p>
<p>&nbsp; File &quot;/usr/lib/python2.7/httplib.py&quot;, line 1034, in getresponse<br />
&nbsp; &nbsp; response.begin()<br />
&nbsp; File &quot;/usr/lib/python2.7/httplib.py&quot;, line 407, in begin<br />
&nbsp; &nbsp; version, status, reason = self._read_status()<br />
&nbsp; File &quot;/usr/lib/python2.7/httplib.py&quot;, line 365, in _read_status<br />
&nbsp; &nbsp; line = self.fp.readline()<br />
&nbsp; File &quot;/usr/lib/python2.7/socket.py&quot;, line 447, in readline<br />
&nbsp; &nbsp; data = self._sock.recv(self._rbufsize)<br />
error: [Errno 104] Connection reset by peer</p>
<p>2016-01-31 23:59:13,286 WARNING emonCMS send failure: wanted &#39;ok&#39; but got &#39;&#39;<br />
2016-01-31 23:59:13,319 INFO Exiting hub...<br />
2016-01-31 23:59:13,321 DEBUG Closing serial port<br />
2016-01-31 23:59:13,390 INFO emonCMS sending: http://localhost/emoncms/input/bulk.json?apikey=E-M-O-N-C-M-S-A-P-I-K-E-Y&amp;data=[[1454302750.63,8,4,20,0,0,12530,3000,3000,3000,3000,3000,3000,1,0,-58]]&amp;sentat=1454302753<br />
2016-01-31 23:59:13,433 WARNING emonCMS couldn&#39;t send to server, URLError: [Errno 97] Address family not supported by protocol<br />
2016-01-31 23:59:13,436 WARNING emonCMS send failure: wanted &#39;ok&#39; but got &#39;&#39;</p>
<p>2016-01-31 23:59:13,442 INFO Exit completed<br />
2016-01-31 23:59:42,534 INFO EmonHub Pre-Release Development Version (rc1.2)<br />
2016-01-31 23:59:42,592 INFO Opening hub...<br />
2016-01-31 23:59:42,595 INFO Logging level set to DEBUG<br />
2016-01-31 23:59:42,598 INFO Creating EmonHubEmoncmsReporter &#39;emonCMS&#39;<br />
2016-01-31 23:59:42,604 INFO Set up reporter &#39;emonCMS&#39; (buffer: memory | size: 1000)<br />
2016-01-31 23:59:42,608 INFO Setting emonCMS url: <a href="http://localhost/emoncms" title="http://localhost/emoncms">http://localhost/emoncms</a><br />
2016-01-31 23:59:42,611 INFO Setting emonCMS apikey: set<br />
2016-01-31 23:59:42,616 INFO Creating EmonHubJeeInterfacer &#39;RFM2Pi&#39;<br />
2016-01-31 23:59:42,621 DEBUG Opening serial port: /dev/ttyAMA0 @ 38400 bits/s<br />
2016-01-31 23:59:44,630 DEBUG Opening serial port: /dev/ttyAMA0 @ 9600 bits/s<br />
2016-01-31 23:59:46,636 ERROR Unable to create &#39;RFM2Pi&#39; interfacer: Attempting to use a port that is not open</p>
<p>&nbsp;</p>
<p>And then nothing from then on. I rebooted and same thing. rpi_serial_console status says ttyAMAo is disabled and it&#39;s set to do that in inittab and cmdline.txt</p>
<p>I added the line COM_BAUD=57600 and got a slight different message: ( I also tried 38400 and got the same message)</p>
<p>...</p>
<p>2016-02-01 09:57:07,650 INFO Creating EmonHubEmoncmsReporter &#39;emonCMS&#39;<br />
2016-02-01 09:57:07,655 INFO Set up reporter &#39;emonCMS&#39; (buffer: memory | size: 1000)<br />
2016-02-01 09:57:07,660 INFO Setting emonCMS url: <a href="http://localhost/emoncms" title="http://localhost/emoncms">http://localhost/emoncms</a><br />
2016-02-01 09:57:07,662 INFO Setting emonCMS apikey: set<br />
2016-02-01 09:57:07,665 INFO Creating EmonHubJeeInterfacer &#39;RFM2Pi&#39;<br />
2016-02-01 09:57:07,670 DEBUG Opening serial port: /dev/ttyAMA0 @ 57600 bits/s<br />
2016-02-01 09:57:09,676 WARNING Device communication error - check settings<br />
2016-02-01 09:57:09,683 INFO Setting RFM2Pi frequency: 433 (4b)<br />
2016-02-01 09:57:10,687 INFO Setting RFM2Pi group: 210 (210g)<br />
2016-02-01 09:57:11,691 INFO Setting RFM2Pi quiet: 1 (1q)<br />
2016-02-01 09:57:12,696 INFO Setting RFM2Pi baseid: 15 (15i)<br />
2016-02-01 09:57:13,700 DEBUG Setting RFM2Pi interval: 300<br />
2016-02-01 09:57:13,717 DEBUG RFM2Pi broadcasting time: 09:57</p>
<p>&nbsp;</p>
<p>I don&#39;t know why it would be working and then suddenly stop.&nbsp;</p>
<p>Any ideas?</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39000"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Mon, 01/02/2016 - 22:35.</div>
    <div class="content">
     <p>I cannot figure out the order of events from the logs since the second item in the log is&nbsp;</p>
<p>2016-01-31 23:59:13,086 DEBUG SIGINT received</p>
<p>which is a &quot;ctrl-C&quot; issued from the command line which is odd as emonhub should be running as a service not from the command-line. The next lines seem to suggest emoncms&nbsp;is not responding, but that could be due to some sort of shutdown being issued???</p>
<p>However the first line of the logs included show a packet recieved&nbsp;into emonhub&nbsp;1s before the attempt to pass it to emoncms which would suggest at the time the SIGINT was issued all was ok.</p>
<p>Is there any log from prior to this? it&#39;s difficult to establish the root cause since&nbsp;the log seems to start at the&nbsp;response to those&nbsp;events.</p>
<p>Did you update anything? change anything? why was the SIGINT issued? could it be that you have more than one instance running somehow?</p>
<p>What baud is your rfm2pi? setting 9600, 38400 or 57600 is to match the device only one will work and emonhub has no control over which, it just needs to use the correct one for your device.</p>
<p>What happens if you just restart emonhub&nbsp;without rebooting the pi using &quot;&nbsp;sudo service emonhub restart &quot;</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39005"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6548.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="billvolz&#039;s picture" title="billvolz&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/6548.html" title="View user profile.">billvolz</a> on Tue, 02/02/2016 - 00:37.</div>
    <div class="content">
     <p>Here&#39;s the log prior to the DEBUG SIGINT:</p>
<p>2016-01-31 23:59:10,627 DEBUG 8393 NEW FRAME : 1454302750.63 OK 8 4 0 20 0 0 0 0 0 242 48 184 11 184 11 184 11 184 11 184 11 184 11 1 0 0 0 (-58)<br />
2016-01-31 23:59:10,645 DEBUG 8393 Timestamp : 1454302750.63<br />
2016-01-31 23:59:10,647 DEBUG 8393 &nbsp; &nbsp; &nbsp;Node : 8<br />
2016-01-31 23:59:10,657 DEBUG 8393 &nbsp; &nbsp;Values : [4, 20, 0, 0, 12530, 3000, 3000, 3000, 3000, 3000, 3000, 1, 0]<br />
2016-01-31 23:59:10,665 DEBUG 8393 &nbsp; &nbsp; &nbsp;RSSI : -58<br />
2016-01-31 23:59:10,757 DEBUG 8393 Append to &#39;emonCMS&#39; buffer =&gt; time: 1454302750.63, data: [8, 4, 20, 0, 0, 12530, 3000, 3000, 3000, 3000, 3000, 3000, 1, 0, -58], ref: 8393<br />
2016-01-31 23:59:10,861 INFO emonCMS sending: http://localhost/emoncms/input/bulk.json?apikey=E-M-O-N-C-M-S-A-P-I-K-E-Y&amp;data=[[1454302750.63,8,4,20,0,0,12530,3000,3000,3000,3000,3000,3000,1,0,-58]]&amp;sentat=1454302750<br />
2016-01-31 23:59:11,769 WARNING emonCMS couldn&#39;t send to server, HTTPException<br />
2016-01-31 23:59:11,779 WARNING emonCMS send failure: wanted &#39;ok&#39; but got &#39;&#39;<br />
2016-01-31 23:59:11,891 INFO emonCMS sending: http://localhost/emoncms/input/bulk.json?apikey=E-M-O-N-C-M-S-A-P-I-K-E-Y&amp;data=[[1454302750.63,8,4,20,0,0,12530,3000,3000,3000,3000,3000,3000,1,0,-58]]&amp;sentat=1454302751<br />
2016-01-31 23:59:13,086 DEBUG SIGINT received<br />
2016-01-31 23:59:13,282 WARNING emonCMS couldn&#39;t send to server, Exception: Traceback (most recent call last):</p>
<p>The Raspberry is rebooted at midnight daily. It&#39;s been doing running emonyx&nbsp;for several days and the Raspberry is&nbsp;going through the shutdown cycle so not sure if that&#39;s causing the issue. Why it doesn&#39;t restart upon reboot I don&#39;t know. I have not done&nbsp;a power reset, just a &quot;reboot&#39; command.</p>
<p>I have not done any updates or changes since I installed the RFM69PI board. It&#39;s been running fine for several days and going through the reboot cycle. I was letting it run standalone for a few days prior to installing the emontx.&nbsp;</p>
<p>When this started I did not have a COM_BAUD line in the config&nbsp;file. I&#39;ve tried setting it with&nbsp;all three values with the same result. The RFM69PI&nbsp;is a brand new board so it should be using the latest, but I don&#39;t know what it is.</p>
<p>When I comment out the COM_BAUD line, it seems to be trying 38400 and 9600, both fail and I get no connection. When I specify 57600 (or any value) I get this:</p>
<p>2016-02-01 19:32:07,759 DEBUG Opening serial port: /dev/ttyAMA0 @ 57600 bits/s<br />
2016-02-01 19:32:09,765 WARNING Device communication error - check settings</p>
<p>I&#39;ve restarted emonhub service several times when dealing with the baud issue.&nbsp;</p>
<p>Thanks</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39008"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 02/02/2016 - 01:12.</div>
    <div class="content">
     <p>if it&#39;s a recent rfm69pi&nbsp;the baud will be 38400 so setting &quot; com_baud = 38400 &quot; in [[RFM2Pi]] [[[init_settings]]] in emonhub.conf will remove that possible issue, note &quot;com_baud&quot; is all lowercase, I haven&#39;t tried all uppercase so cannot say if it will or won&#39;t work but it is not intended to be written that way so could get broken in future development.</p>
<p>Personally, I do not like the idea of rebooting at midnight, the most stressful time and the most likely time to experience an issue is at boot time. There should be no reason to do it and I can only see it causing problems and at a time when you are least likely to notice for several hours.</p>
<p>The http posting errors will be where emoncms&nbsp;is still trying to find it&#39;s legs following the reboot.</p>
<p>can you post the content of /boot/cmdline.txt and confirm if you are using wheezy or jessie?</p>
<p>Can you also confirm you have not installed emoncms&#39;s&nbsp;retired&nbsp;raspberrypi module?</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39013"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6548.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="billvolz&#039;s picture" title="billvolz&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/6548.html" title="View user profile.">billvolz</a> on Tue, 02/02/2016 - 01:33.</div>
    <div class="content">
     <p>I have com_baud in lower case. And I tried 38400 and got this: This is the entire log from when I restarted emonhub:</p>
<p>2016-02-01 20:22:06,403 DEBUG Closing serial port<br />
2016-02-01 20:22:06,405 INFO Deleting interfacer &#39;RFM2Pi&#39;<br />
2016-02-01 20:22:06,408 INFO Creating EmonHubJeeInterfacer &#39;RFM2Pi&#39;<br />
2016-02-01 20:22:06,413 DEBUG Opening serial port: /dev/ttyAMA0 @ 38400 bits/s<br />
2016-02-01 20:22:08,418 WARNING Device communication error - check settings<br />
2016-02-01 20:22:08,422 INFO Setting RFM2Pi frequency: 433 (4b)<br />
2016-02-01 20:22:09,425 INFO Setting RFM2Pi group: 210 (210g)<br />
2016-02-01 20:22:10,429 INFO Setting RFM2Pi quiet: 1 (1q)<br />
2016-02-01 20:22:11,433 INFO Setting RFM2Pi baseid: 15 (15i)<br />
2016-02-01 20:22:12,440 DEBUG Setting RFM2Pi interval: 300<br />
2016-02-01 20:22:12,444 DEBUG RFM2Pi broadcasting time: 20:22<br />
2016-02-01 20:22:12,498 DEBUG SIGINT received.<br />
2016-02-01 20:22:12,501 INFO Exiting hub...<br />
2016-02-01 20:22:12,503 DEBUG Closing serial port<br />
2016-02-01 20:22:12,571 INFO Exit completed<br />
2016-02-01 20:22:15,327 INFO EmonHub Pre-Release Development Version (rc1.2)<br />
2016-02-01 20:22:15,329 INFO Opening hub...<br />
2016-02-01 20:22:15,333 INFO Logging level set to DEBUG<br />
2016-02-01 20:22:15,335 INFO Creating EmonHubEmoncmsReporter &#39;emonCMS&#39;</p>
<p>2016-02-01 20:22:15,341 INFO Set up reporter &#39;emonCMS&#39; (buffer: memory | size: 1000)<br />
2016-02-01 20:22:15,346 INFO Setting emonCMS url: <a href="http://localhost/emoncms" title="http://localhost/emoncms">http://localhost/emoncms</a><br />
2016-02-01 20:22:15,348 INFO Setting emonCMS apikey: set<br />
2016-02-01 20:22:15,351 INFO Creating EmonHubJeeInterfacer &#39;RFM2Pi&#39;<br />
2016-02-01 20:22:15,356 DEBUG Opening serial port: /dev/ttyAMA0 @ 38400 bits/s<br />
2016-02-01 20:22:17,363 WARNING Device communication error - check settings<br />
2016-02-01 20:22:17,366 INFO Setting RFM2Pi frequency: 433 (4b)<br />
2016-02-01 20:22:18,369 INFO Setting RFM2Pi group: 210 (210g)<br />
2016-02-01 20:22:19,373 INFO Setting RFM2Pi quiet: 1 (1q)<br />
2016-02-01 20:22:20,378 INFO Setting RFM2Pi baseid: 15 (15i)<br />
2016-02-01 20:22:21,381 DEBUG Setting RFM2Pi interval: 300<br />
2016-02-01 20:22:21,399 DEBUG RFM2Pi broadcasting time: 20:22</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>cmdline.txt:</p>
<p>dwc_otg.lpm_enable=0 console=tty1 root=/dev/sda1 rootfstype=ext4 elevator=deadline rootwait rootdelay=5</p>
<p>And contents of /etc/os-release:</p>
<p>PRETTY_NAME=&quot;Raspbian GNU/Linux 7 (wheezy)&quot;<br />
NAME=&quot;Raspbian GNU/Linux&quot;<br />
VERSION_ID=&quot;7&quot;<br />
VERSION=&quot;7 (wheezy)&quot;<br />
ID=raspbian<br />
ID_LIKE=debian<br />
ANSI_COLOR=&quot;1;31&quot;<br />
HOME_URL=&quot;http://www.raspbian.org/&quot;<br />
SUPPORT_URL=&quot;http://www.raspbian.org/RaspbianForums&quot;<br />
BUG_REPORT_URL=&quot;http://www.raspbian.org/RaspbianBugs&quot;</p>
<p>How would I know which version of the Raspberry module I have loaded?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39016"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6548.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="billvolz&#039;s picture" title="billvolz&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/6548.html" title="View user profile.">billvolz</a> on Tue, 02/02/2016 - 06:05.</div>
    <div class="content">
     <p>I got it working but not sure why it wasn&#39;t. I installed avrdude as mentioned in this post:</p>
<p><a href="http://openenergymonitor.net/emon/node/10055?page=1" title="http://openenergymonitor.net/emon/node/10055?page=1">http://openenergymonitor.net/emon/node/10055?page=1</a> on 7/2/2015</p>
<p>When I restarted emonhub, it was working. Perhaps a power cycle might have worked.</p>
<p>What does the command &quot;avrdude&nbsp;-v -c&nbsp;arduino&nbsp;-p&nbsp;ATMEGA328P&nbsp;-P /dev/ttyAMA0&nbsp;-b 38400&quot; do?</p>
<p>Thanks for your help</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39031"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 02/02/2016 - 14:14.</div>
    <div class="content">
     <p>That command is used to just &quot;test the waters&quot; before trying to upload a sketch, it just tries to communicate with the rfm2pi without actually doing anything.&nbsp;</p>
<p>Just have to keep an eye on it and see what happens, especially around midnight :-)</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39045"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6548.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="billvolz&#039;s picture" title="billvolz&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonhub error: "ERROR Unable to create 'RFM2Pi' interfacer: Attempting to use a port that is not open"</h3>

    <div class="submitted">Submitted by <a href="../user/6548.html" title="View user profile.">billvolz</a> on Tue, 02/02/2016 - 22:50.</div>
    <div class="content">
     <p>Thanks, I stopped the nightly reboots. I started doing it because I was having trouble with the Ethernet. It would go catatonic and require a power cycle to fix. Not sure what the issue was but it appeared when I started using the Raspberry as an FTP server to save captured images (lots of them - 8 images&nbsp;every 15 seconds 24/7). I did a system upgrade and that fixed the Ethernet problem but I never stopped the reboot. Prior to that the system stayed up for over 1/2 a year.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/6400"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-CJdnJnS9dMcQXqDB4WH2TGVR7d6YgcU1NU2VmijAlkg" value="form-CJdnJnS9dMcQXqDB4WH2TGVR7d6YgcU1NU2VmijAlkg"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
