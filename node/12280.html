<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/12280 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:44:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>New emoncms data viewer: Graph | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">New emoncms data viewer: Graph</h3>
        <span class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 02/03/2016 - 14:59</span>
        <div class="content"><p>This is a new multigraph data viewer for emoncms, on emoncms.org for testing now and github <a href="https://github.com/emoncms/graph" title="https://github.com/emoncms/graph">https://github.com/emoncms/graph</a></p>
<p><strong>Preamble</strong><br />
Last December I built a minimal data viewer for emoncms data called phpfinaview <a href="11717.html">here.</a> It featured amongst other things a multigraph data viewer with one click add remove feed left/right axis control and a list of the stats of each feed below the graph view. I used it a lot to explore data from my heatpump, the combination of the easy feed addition/removal and the stats at the bottom meant I could get at COP figures at mean outside temperatures and flow temperatures much faster. I also added a feature to create a histogram of the data in the view to see at which power levels the heatpump used more energy over time without needing to create histogram feeds which are not supported on the low write mode of emoncms anyway.</p>
<p>In order to make it possible to have this functionality from within emoncms I have put this together as a new module called graph which can replace the default feed data viewer in emoncms. So that when you click on the view/eye icon on a feed it goes straight into this multigraph style environment.&nbsp; This is up and running now on emoncms.org to test and the module is available on github here <a href="https://github.com/emoncms/graph" title="https://github.com/emoncms/graph">https://github.com/emoncms/graph</a></p>
<p>Here are a few screenshots of what it can do:</p>
<p>Main view:</p>
<p>The feed selection pane on the left is responsive and disappears when the screen size is less than 1024px wide.</p>
<p><img alt="" src="../sites/default/files/emoncms_graph_0.png" style="width: 650px; height: 470px;" /></p>
<p><strong>Histogram</strong></p>
<p>View any feed as a histogram of the amount of time spent at the range of values in the view or in the case of power feeds the amount of kWh consumed at a given power level. The resolution of the histogram can be selected in the view.</p>
<p><img alt="" src="../sites/default/files/emoncms_graph_histogram.png" style="width: 650px; height: 467px;" /></p>
<p><strong>Smoothing</strong></p>
<p>Useful where data is noisy and its hard to make out a pattern, this is a moving average the number of points to average can be selected on a per feed basis:</p>
<p><img alt="" src="../sites/default/files/emoncms_graph_smooth.png" style="width: 650px; height: 231px;" /></p>
<p><strong>Export view as CSV</strong></p>
<p>Choose the time format: unix timestamp, seconds since start or date time string<br />
Choose what to do if missing values are present: show, remove, use last valid value</p>
<p><img alt="" src="../sites/default/files/emoncms_graph_csvout.png" style="width: 650px; height: 330px;" /></p>
<p><strong>Further development</strong></p>
<ul>
<li>Ability to save and load saved graph&#39;s (uses same json structure as multigraphs)</li>
<li>Import graph built using graph into dashboards</li>
<li>Tooltips</li>
<li>Datapoint editor</li>
<li>Selectable line or bar graph form on a per feed basis</li>
<li>Selectable line color and fill.</li>
<li>Realtime data view</li>
</ul>
<p>Im thinking that saved graphs produced with this module could ultimately replace vis module visualisations: realtime, rawdata, bargraph, graph, multigraph. In-built data editing could replace edit daily and edit realtime. The histogram calculation on the fly can replace the need for the histogram input processor, feed engine and visualisations and on the fly averaging could replace the need for the PHPFiwa feed engine.</p>
<p>I imagine there will be some bugs in this for a bit so please let me know if you see anything that&#39;s not quite right or ideas for improvement.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11774.html" class="topic-previous" title="Go to previous forum topic">‹ emoncms 9.2 - power to kwh feed stopped incrementing</a>
              <a href="11339.html" class="topic-next" title="Go to next forum topic">WIFI Hotspot configuration for the next emonpi image ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-40047"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emoncms data viewer: Graph</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 02/03/2016 - 15:14.</div>
    <div class="content">
     <p><strong>Data quality indicator</strong><br />
The module also calculates an indication of the data quality present for each feed by dividing the expected number of data points made in the request by the number of valid data points present. This is there to help notify of radio or internet connection issues early and feeds in the discussion here about radio reliability testing <a href="11390.html" title="https://openenergymonitor.org/emon/node/11390">https://openenergymonitor.org/emon/node/11390</a></p>
<p><strong>Fixable data interval</strong><br />
This can be quite a useful option to use alongside the csv export if you wish to select a view and keep the data interval at say 30s, set the interval to 30 and then tick fix to lock. There is a request limit of 3000 datapoints, (8000 on emoncms v9 running locally)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40048"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8066.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="firefox7518&#039;s picture" title="firefox7518&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emoncms data viewer: Graph</h3>

    <div class="submitted">Submitted by <a href="../user/8066.html" title="View user profile.">firefox7518</a> on Wed, 02/03/2016 - 15:23.</div>
    <div class="content">
     <p>That&#39;s really great Trystan!!! I will definately check this out.</p>
<p>Does it need something special like Redis etc. or can I still use it on my windows machine running it?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40049"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emoncms data viewer: Graph</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 02/03/2016 - 15:33.</div>
    <div class="content">
     <p>Thanks! no special requirements, its all client side browser based. To launch it without changing the feed module on a self hosted install the URL is</p>
<p>emoncms/graph</p>
<p>or to launch from the feed view change this line:</p>
<p><a href="https://github.com/emoncms/emoncms/blob/master/Modules/feed/Views/feedlist_view.php#L193" title="https://github.com/emoncms/emoncms/blob/master/Modules/feed/Views/feedlist_view.php#L193">https://github.com/emoncms/emoncms/blob/master/Modules/feed/Views/feedli...</a></p>
<pre>
&#39;view-action&#39;:{&#39;title&#39;:&#39;&#39;, &#39;type&#39;:&quot;iconlink&quot;, &#39;link&#39;:path+&quot;vis/auto?feedid=&quot;},</pre><p>to</p>
<pre>
&#39;view-action&#39;:{&#39;title&#39;:&#39;&#39;, &#39;type&#39;:&quot;iconlink&quot;, &#39;link&#39;:path+&quot;graph/&quot;},</pre>         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40050"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/8066.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="firefox7518&#039;s picture" title="firefox7518&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emoncms data viewer: Graph</h3>

    <div class="submitted">Submitted by <a href="../user/8066.html" title="View user profile.">firefox7518</a> on Wed, 02/03/2016 - 15:44.</div>
    <div class="content">
     <p>Cool stuff. it&#39;s working :-)</p>
<p><img alt="" src="../sites/default/files/emoncms%20graph%20module.jpg" style="width: 500px; height: 277px;" /></p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-40166"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/9147.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="dafyddhirst&#039;s picture" title="dafyddhirst&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emoncms data viewer: Graph</h3>

    <div class="submitted">Submitted by <a href="../user/9147.html" title="View user profile.">dafyddhirst</a> on Tue, 08/03/2016 - 09:01.</div>
    <div class="content">
     <p>Very nice addition thanks :)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/12280"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-sErLxlAlu0x7tqxNR1NQi-c_cwB08v6wsbOOm85hyTI" value="form-sErLxlAlu0x7tqxNR1NQi-c_cwB08v6wsbOOm85hyTI"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/12280 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:44:55 GMT -->
</html>
