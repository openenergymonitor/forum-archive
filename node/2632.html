<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/2632 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:54:38 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>New emonBase standalone gateway | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">New emonBase standalone gateway</h3>
        <span class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Sat, 27/07/2013 - 17:28</span>
        <div class="content"><p>Hi all.</p>
<p>I&#39;ve been working on a standalone gateway to add a few features to the current setup.</p>
<p>It seems complete enough for me to be published, although I&#39;d rather have a little feedback before recommending it.</p>
<p><a href="https://github.com/Jerome-github/oem_gateway">https://github.com/Jerome-github/oem_gateway</a></p>
<p>It contains the features of the current python or php&nbsp; gateway, plus new features:</p>
<ul>
<li>
<p>It can be parameterized either via emoncms GUI (with current limitations of the interface) or through a configuration file. Useful for those who don&#39;t want to install a local emoncms just for the configuration of their gateway. This also allows to add features without the need for complex GUI edition.</p>
</li>
<li>
<p>It can read inputs from the RFM2Pi, but also inputs from the serial port of the form &quot;NodeID val1 val2 ...&quot;, or even from a socket. This socket possibility means any application on the same machine or on the network can send data to the gateway. This even solves the inter-applications issue. It is better than writing to a file, in my opinion.</p>
</li>
<li>
<p>Extensibility. By design, it should be easy to create new inputs (data sources) or outputs (another server&#39;s API). It uses classes, so a new input (listener) or output (buffer) can be created through inheritance/overriding.</p>
</li>
</ul>
<p>See readme file for more explanations.</p>
<p>I should add a socket use sample, but it&#39;s pretty basic and require very few code. Here&#39;s a python example:</p>
<pre>
<code>import socket
HOST = &#39;raspberrypi&#39;    # The remote host, can be &#39;localhost&#39; just the same
PORT = 50011            # The port chosen in the gateway config
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST, PORT))
s.send(&#39;14 15 26\r\n&#39;)
s.close()
</code></pre><p>Currently, each buffer instantiated in the gateway buffers a given amount of data when network is down. This is limited (we don&#39;t want to eat up all memory). Next step could be to add the possibility to buffer samples in a file (with care for SD card wearout).</p>
<p>I should be gone for a few weeks. Feel free to send feedback about the design, the documentation, bugs, etc.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="11446.html" class="topic-previous" title="Go to previous forum topic">‹ Emoncms.org dashboard navigation buttons have gone?</a>
              <a href="11429.html" class="topic-next" title="Go to next forum topic">Nodes Inactive and &#039;unreliable&#039; content.  ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-13878"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emonBase standalone gateway</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 27/07/2013 - 18:28.</div>
    <div class="content">
     <p>What hardware is required?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-13883"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emonBase standalone gateway</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Sat, 27/07/2013 - 20:08.</div>
    <div class="content">
     <p>Forgot to mention that. It runs on my Pi.</p>
<p>Technically, it could run on any device that runs python. The RFM2Pi part is designed to work with Martin&#39;s card.</p>
<p>It would be useful in particular for people who use the Pi as a base but fulfill any of the following</p>
<p>- don&#39;t want to host emoncms on the Pi</p>
<p>- don&#39;t want to use the radio but ethernet</p>
<p>- want to use sensors on the Pi itself rather than only on emonTX</p>
<p>I&#39;ve seen people here with this kind of requirements.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-14531"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4162.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="modenet&#039;s picture" title="modenet&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emonBase standalone gateway</h3>

    <div class="submitted">Submitted by <a href="../user/4162.html" title="View user profile.">modenet</a> on Fri, 23/08/2013 - 13:58.</div>
    <div class="content">
     <p>HI, thanks for your works! I&#39;m using oemgateway after another sd crash.</p>
<p>I use oemgateway to upload data to my local data and to emoncms.org: yesterday I observed (when emoncms.org was down) that oemgateway&nbsp;stopped sending data even to my local server; I had to modify conf to stop upload to emoncms.org to resume pushing data to my local server.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-14732"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2765.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="casestudies&#039;s picture" title="casestudies&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emonBase standalone gateway</h3>

    <div class="submitted">Submitted by <a href="../user/2765.html" title="View user profile.">casestudies</a> on Sun, 01/09/2013 - 14:11.</div>
    <div class="content">
     <p>I&#39;ve been working on using this gateway to push data from a Tweet-A-Watt to emoncms. I&#39;ve uploaded the main script &quot;wattcher.py&quot; to Github. The other files to make it work can be found at <a href="https://github.com/adafruit/Tweet-a-Watt" title="https://github.com/adafruit/Tweet-a-Watt">https://github.com/adafruit/Tweet-a-Watt</a>.</p>
<p><a href="https://github.com/casestudies/tweetawatt" title="https://github.com/casestudies/tweetawatt">https://github.com/casestudies/tweetawatt</a></p>
<p>The gateway script is running on a Raspberry Pi at the moment. Originally, I tried another computer, but data logging would stop after 6-12 hours. It appeared that wattcher.py would lock up. I had been using this computer in a data logging system I developed a couple years ago. However, wattcher.py has been running on the Pi for over 24 hours now, so I believe the first computer has issues and the problem isn&#39;t related to the gateway script.</p>
<p>I had a bit of trouble at first figuring out the data format. Perhaps it&#39;s because I&#39;m new to this, but it might help to mention that data should be formatted as an integer (i.e. no decimals) in the socket sendall string. Once I figured out that the data should be sent as an integer and converted back into a float using emoncms, it worked very well. I guess I should have realized this sooner as the data sent from emonTx comes in as an integer as well.</p>
<p>At some point, I&#39;d like to clean up the wattcher script as I&#39;ve added features to it over time. The ability to easily change the logging rate would be helpful too.</p>
<p>I have noticed the wattcher.py script fails if oem_gateway.py isn&#39;t running. I&#39;m going to add some try/except lines in wattcher.py to try to solve that problem soon.</p>
<p>If anyone else is logging data to emoncms using the Tweet-A-Watt project, I&#39;d love to hear more about it!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-14933"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4248.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="WindyBoy&#039;s picture" title="WindyBoy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emonBase standalone gateway</h3>

    <div class="submitted">Submitted by <a href="../user/4248.html" title="View user profile.">WindyBoy</a> on Fri, 06/09/2013 - 16:21.</div>
    <div class="content">
     <p>Just getting my head around things,</p>
<p>Is the oemGateway a replacement for the existing/default one ? i.e rfm2pigateway.py ?</p>
<p>I wanted to additionally get rfm2pigateway.py to read a csv&nbsp;file at intervals parse the data and create/insert the data as being from another node. Modified/added some code in&nbsp;rfm2pigateway.py, just hacking away trying to see how it would work, dosn&#39;t yet and perhaps I&#39;m going about this all wrong ? Heres the code&nbsp;</p>
<blockquote><p># Read csv file created by modcache periodically by cron job<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.log.debug(&quot;NAD NAD *********&quot;)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (int(self._settings[&#39;sendtimeinterval&#39;])):<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( 1 == 1) :<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try :<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cr = csv.reader(open(&quot;/home/pi/engclassic.csv&quot;,&quot;rb&quot;))</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Recombine transmitted chars into signed int<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; values = []<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for row in cr:<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #print (row[1])<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # ignore the &quot;success&quot; entry in csv for now<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if row[1] != &quot;Success&quot;:<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value = int(re.sub(&#39;[!.]&#39;,&quot;&quot;, row[1])) # remove . char<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print value<br />
		#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value = int(row[1])<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if value &gt; 32768:<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value -= 65536<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; values.append(value)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; node = 21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # identify the source of data... used later inside emoncms to identify the incomming info<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.log.debug(&quot;NAD NAD *********&quot;)<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.log.debug(&quot;Node: &quot; + str(node))<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.log.debug(&quot;Values: &quot; + str(values))</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Add data to send buffers<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; values.insert(0,node)<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for server_buf in self._server_buffers.itervalues():<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; server_buf.add_data(values)<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; except:<br />
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print &quot;Windy bosy new code crashed:&quot;, sys.exc_info()[0]</p>
</blockquote>
<p>I put that inside the run function</p>
<p>I&#39;m not sure yet if this new modified version is even being called, I restarted&nbsp;</p>
<blockquote><p>sudo&nbsp; /etc/init.d/rfm12piphp restart log</p>
</blockquote>
<p>but I&#39;m not sure that is enough ? Anyway I thought I&#39;d ask before I head too much more in the wrong direction.</p>
<p>Thanks</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-14935"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4248.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="WindyBoy&#039;s picture" title="WindyBoy&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emonBase standalone gateway</h3>

    <div class="submitted">Submitted by <a href="../user/4248.html" title="View user profile.">WindyBoy</a> on Fri, 06/09/2013 - 21:11.</div>
    <div class="content">
     <p>So the way to really do this is with modules right :)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16163"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4611.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="deeaitch&#039;s picture" title="deeaitch&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emonBase standalone gateway</h3>

    <div class="submitted">Submitted by <a href="../user/4611.html" title="View user profile.">deeaitch</a> on Mon, 04/11/2013 - 22:07.</div>
    <div class="content">
     <p>Awesome, just awesome. &nbsp;I&#39;ve been running oemgateway for a couple of weeks now and it is working well. &nbsp;I changed the code a little to get it to work with a Jeelink and also a little code to send data over a socket to another python program I have running that controls my central heating and hot water using the sensors&#39; data as feedback.</p>
<p>up to now I&#39;ve been starting it manually just by typing into a terminal window:</p>
<p>python&nbsp;python /home/pi/oem_gateway/oemgateway.py</p>
<p>Now my problem is that I&#39;m going away on business for a whole month and I need to make sure oemgateway&nbsp;starts if the pi reboots due to a power failure so my wife and kids don&#39;t freeze! &nbsp;The trouble is I can&#39;t seem to get it to work. &nbsp;I&#39;ve got a cron job that says:</p>
<p>@reboot python /home/pi/oem_gateway/oemgateway.py</p>
<p>but it doesn&#39;t seem to work.</p>
<p>the next line in crontab:</p>
<p>@reboot python /home/pi/oem_gateway/HeatingTimer.py</p>
<p>works just fine. &nbsp;Can anyone offer any advice? &nbsp;I&#39;m no expert but file permissions seem OK. &nbsp;I&#39;m not sure that I want to go down the route of using Jerome&#39;s &#39;daemon&#39; solution as what I have works fine apart from the auto start on boot.</p>
<p>Cheers.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16165"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4611.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="deeaitch&#039;s picture" title="deeaitch&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emonBase standalone gateway</h3>

    <div class="submitted">Submitted by <a href="../user/4611.html" title="View user profile.">deeaitch</a> on Mon, 04/11/2013 - 22:20.</div>
    <div class="content">
     <p>I figured it out :) &nbsp;For anyone else interested it should have been:</p>
<p>@reboot python python /home/pi/oem_gateway/oemgateway.py --config-file&nbsp;/home/pi/oem_gateway/oemgateway.conf</p>
<p>Doh!! &nbsp;I am a total newb but loving it :)</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16184"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emonBase standalone gateway</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Tue, 05/11/2013 - 21:44.</div>
    <div class="content">
     <p>@deeaitch: I like the daemon solution, with its cool features (start/restart/stop/status) but your solution will do just as well, I believe.</p>
<p>@WindyBoy: Sorry, I didn&#39;t see your message. I&#39;ve been and still am a bit busy, and I don&#39;t have the time to look into this right now. I wanted to add a feature to get data from a text file. I ended up not doing it not only because of my sloppiness, but because of the SD Card wearing off when written on too much. I preferred a socket input.</p>
<p>You can do what you want several ways:</p>
<p>- create a Listener that can read your file (have it inherit from another listener and override read and process_frame methods)</p>
<p>- create a third party program that reads your file and sends to a listener via a socket</p>
<p>- modify your program creating the csv file to have it write to a socket instead (my favorite choice)</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-17647"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="attila&#039;s picture" title="attila&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: New emonBase standalone gateway</h3>

    <div class="submitted">Submitted by attila (not verified) on Thu, 16/01/2014 - 08:19.</div>
    <div class="content">
     <p>This Gateway looks great! It might solve my problem to load data from PVI AEC PRO (Meteocontrol&nbsp;datalogger) to EmonCMS,</p>
<p>&nbsp;</p>
<p>is there any news about this project?</p>
<p>&nbsp;</p>
<p>thanks</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-17649"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1531.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1531.gif" alt="Jérôme&#039;s picture" title="Jérôme&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emonBase standalone gateway</h3>

    <div class="submitted">Submitted by <a href="../user/1531.html" title="View user profile.">Jérôme</a> on Thu, 16/01/2014 - 08:39.</div>
    <div class="content">
     <p>See the <a href="https://github.com/Jerome-github/oem_gateway">github page</a>. And the bug list for known issues and feature requests.</p>
<p>It is working and distributed on a ready-to-go SD Card in the solution known as &quot;rock solid gateway&quot;.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34948"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4611.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="deeaitch&#039;s picture" title="deeaitch&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emonBase standalone gateway</h3>

    <div class="submitted">Submitted by <a href="../user/4611.html" title="View user profile.">deeaitch</a> on Thu, 15/10/2015 - 13:25.</div>
    <div class="content">
     <p>I want to send data to a socket and have it transmitted by my Jeelink. &nbsp;I&#39;ve been using code similar to&nbsp;OemGatewayRFM2PiListenerRepeater_client.py to send the data on port 50012.</p>
<p>I was expecting this data to be transmitted by the Jeelink. &nbsp;But it doesn&#39;t seem to work. &nbsp;I think that port 50012 is not open in the gateway. &nbsp;Jerome can you confirm?</p>
<p>In my conf file there is no mention of a repeater</p>
<blockquote><p># This listener manages the RFM2Pi module<br />
[[RFM2Pi]]<br />
type = OemGatewayRFM2PiListener<br />
[[[init_settings]]]<br />
com_port = /dev/ttyAMA0<br />
[[[runtime_settings]]]<br />
sgroup = 210<br />
frequency = 4<br />
baseid = 15<br />
sendtimeinterval = 0<br />
# This listener gets data from a socket<br />
[[Socket]]<br />
type = OemGatewaySocketListener<br />
[[[init_settings]]]<br />
port_nb = 50011<br />
[[[runtime_settings]]]</p>
</blockquote>
<p>How do I add to my config file to send data from socket 50012 to my Jeelink??</p>
<p>Cheers.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-34972"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emonBase standalone gateway</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 15/10/2015 - 23:36.</div>
    <div class="content">
     <p>You need to replace your existing&nbsp;&nbsp;&quot;OemGatewayRFM2PiListener&quot; with the &quot;OemGatewayRFM2PiListenerRepeater&quot; only one instance can exist and have access to the rfm2pi, unless you are adding a second device ie jeelink and a rfm2pi.In the &quot;OemGatewayRFM2PiListenerRepeater&quot; settings is where you specify (open) the port 50012.</p>
<p>If you have a firewall installed (eg UFW) you will need to allow it there too.</p>
<p>Paul</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-35108"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4611.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="deeaitch&#039;s picture" title="deeaitch&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: New emonBase standalone gateway</h3>

    <div class="submitted">Submitted by <a href="../user/4611.html" title="View user profile.">deeaitch</a> on Mon, 19/10/2015 - 21:42.</div>
    <div class="content">
     <p>Thanks for the advice.</p>
<p>I was running an old version of the gateway so had to download the new version then replicate all the customisations I&#39;d made to the code. But the repeater is&nbsp;now&nbsp;working.&nbsp;</p>
<p>Next i built a little jeenode plug to interface to the electric gates on my driveway. Now I can open the gates using my phone using UDP. I also&nbsp;provided inputs so i can see if the gates are open/closed and a push button to act as a doorbell. The inputs need work but on the whole I&#39;m very pleased. I might use another digital input to notify me if theres any post in the box.</p>
<p>Next on the agenda is a Tasker app to automatically open the gates as i approach.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/2632"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-SitS680oEa89RKriZPogzSPi4pn75IrFO2SAVZprV8Q" value="form-SitS680oEa89RKriZPogzSPi4pn75IrFO2SAVZprV8Q"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
