<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/12122 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 14:55:51 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>emonBase OR emonTxv3.4 no longer sending data to emoncms.org *resolved by installing newer emonBase firmware* | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">emonBase OR emonTxv3.4 no longer sending data to emoncms.org *resolved by installing newer emonBase firmware*</h3>
        <span class="submitted">Submitted by <a href="../user/7978.html" title="View user profile.">Bbaass_TMH</a> on Tue, 02/02/2016 - 14:46</span>
        <div class="content"><p>Early last year, we bought an emonBase and 2 emonTx v3.4&#39;s to build a voltage and current logger for temporary monitoring.</p>
<p>We got everything working, with some effort to correctly show voltage.</p>
<p>We use 3 identical 230 to 12 volt transformers, one for each phase, with resistors on the secondary side, connected to one emonTx v3.4.</p>
<p>The other emonTx v3.4 has the screws holding the front panel in place removed. They are replaced with longer screw that also fix it to our enclosure.</p>
<p>The emonBase (Raspberry Pi B+) is mounted sideways on a bracket, with a cutout in our enclosure for the LAN port.</p>
<p>&nbsp;</p>
<p>The emonTx&nbsp;v3.4&#39;s antennae are both removed because they didn&#39;t fit in the enclosure.</p>
<p>Maybe not all data is received by the emonBase, but enough of it is for what we need.</p>
<p><img alt="" src="../../../i.imgur.com/FsU72nw.jpg" style="width: 700px; height: 933px;" /></p>
<p>&nbsp;</p>
<p>We have since used this several times to monitor mainly current of an entire building&#39;s electrical installation.</p>
<p>Up until yesterday, that is.</p>
<p>Last week is was working fine. Yesterday is was removed from a client&#39;s building and installed at another client&#39;s building, where it proceeded to not show any data on emoncms.org anymore.</p>
<p>The Pi&#39;s LAN port has lights flashing indicating it is connected.</p>
<p>Using the microUSB to UART adapter I confirmed that the emonTx&#39;s are working.</p>
<p>With a lot of research online I manage to remotely access the Raspberry Pi B+ through SSH, but I don&#39;t know enough about it to see what&#39;s wrong.</p>
<p>Can someone&nbsp;help me figure out why it doesn&#39;t work, even though it worked fine a couple days earlier?</p>
<p>&nbsp;</p>
<p>Bbaass_TMH</p>
<p>Electrician in the Netherlands, Europe.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="10317.html" class="topic-previous" title="Go to previous forum topic">‹ EmonGLCD with Alternative Radio</a>
              <a href="12111.html" class="topic-next" title="Go to next forum topic">Voltage divider and Capacitor in the Current sensor circuit... ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-39083"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7978.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-7978.png" alt="Bbaass_TMH&#039;s picture" title="Bbaass_TMH&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonBase OR emonTxv3.4 no longer sending data to emoncms.org *resolved by installing newer emonBase firmware*</h3>

    <div class="submitted">Submitted by <a href="../user/7978.html" title="View user profile.">Bbaass_TMH</a> on Wed, 03/02/2016 - 15:05.</div>
    <div class="content">
     <p>Been looking into this more, and found out that the readings the emonTx&#39;s&nbsp;give out over the UART header also make it to the emonBase&nbsp;over RF.</p>
<p>I ran the&nbsp;$ minicom -D /dev/ttyAMA0 -b 38400 command I found on&nbsp;http://openenergymonitor.org/emon/modules/emonpi#ssh</p>
<p>In looking through the forums here, I learned that other people are having problems with the latest (?) version of emonhub.</p>
<p>Does the emonBase auto-update when connected to the internet?</p>
<p>How can I update the emonBase as mentioned here:&nbsp;http://openenergymonitor.org/emon/modules/emonpi#update ?</p>
<p>I can&#39;t seem to access my emonBase&nbsp;from my browser by just entering it&#39;s LAN IP address, just by using SSH.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39084"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonBase OR emonTxv3.4 no longer sending data to emoncms.org *resolved by installing newer emonBase firmware*</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 03/02/2016 - 15:14.</div>
    <div class="content">
     <p>I don&#39;t believe the emonBase&nbsp;does update automatically, but hopefully Paul (pb66) will be able to answer the emonHub questions.</p>
<p>One point about your assembly requires a warning: The RFM69CW&nbsp;radio modules must not be operated at full power without an antenna (that warning is in the data sheet), so it would be advisable to have some sort of antenna, if only a long wire, to reduce the power reflected back into and therefore dissipated in the output stage of the transmitter.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39090"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7978.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-7978.png" alt="Bbaass_TMH&#039;s picture" title="Bbaass_TMH&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonBase OR emonTxv3.4 no longer sending data to emoncms.org *resolved by installing newer emonBase firmware*</h3>

    <div class="submitted">Submitted by <a href="../user/7978.html" title="View user profile.">Bbaass_TMH</a> on Wed, 03/02/2016 - 17:54.</div>
    <div class="content">
     <p>Thanks for the warning about not using any antenna, I will add a wire to it.</p>
<p>Another thing I just found by reading the emonPi/emonBase setup guide: &quot;The emonBase&nbsp;will need to be shut down by logging in via SSH and entering&nbsp;$ sudo halt.&quot;</p>
<p>&quot;CAUTION<br />
Unplugging power from the emonPi without properly&nbsp;shutting down can result in a corrupted SD card.&quot;</p>
<p>&nbsp;</p>
<p>Until now we&#39;ve just unplugged it without doing this. How do power outages affect the SD card?</p>
<p>(we have it send data to emoncms.org, not keep it locally on the SD card)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39092"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonBase OR emonTxv3.4 no longer sending data to emoncms.org *resolved by installing newer emonBase firmware*</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 03/02/2016 - 19:09.</div>
    <div class="content">
     <p>I believe that there&#39;s no journaling etc in the OS that is used, so if there&#39;s a write in progress as the power dies, the card might be corrupted. Others here know the details better than I do.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39108"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonBase OR emonTxv3.4 no longer sending data to emoncms.org *resolved by installing newer emonBase firmware*</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 04/02/2016 - 11:36.</div>
    <div class="content">
     <p>Can you provide some emonhub.log?</p>
<p>you can open the whole existing log with</p>
<blockquote><p>cat /var/log/emonhub/emonhub.log</p>
</blockquote>
<p>as a static file or you can see and active version if you use</p>
<blockquote><p>tail -f /var/log/emonhub/emonhub.log</p>
</blockquote>
<p>to see the last 10 entries and any new ones as they are added.</p>
<p>The log level will probally have shipped as &quot;WARNING&quot; so the logs may not be very informative until you set&nbsp;&quot;<strong>loglevel = DEBUG</strong>&quot; in emonhub.conf. To edit the conf&nbsp;you will need to switch the OS to &quot;write&quot; mode and then open the conf file in a text editor using</p>
<blockquote><p>rpi-rw</p>
<p>sudo nano&nbsp;/etc/emonhub/emonhub.conf</p>
</blockquote>
<p>Once edited you can save the file with ctrl-x&nbsp;=&gt; y =&gt; enter.</p>
<p>You may find once you have found your way around or set the loglevel&nbsp;it is easier to reboot to get a completely fresh log (the gets reset every reboot on a read only&nbsp;OS) or at least restart emonhub using</p>
<blockquote><p>sudo service emonhub&nbsp;restart&nbsp;</p>
</blockquote>
<p>to capture the starting up phase as this will show if there are any initialisation issues.</p>
<p>The methods above should work on all systems regardless of era or version, but there are other ways too, using emonhub&nbsp;commands eg emonhub -c to open the <strong>c</strong>onfiguration for editing or later versions have a webpage in emoncms.</p>
<p>Without knowing what your image comprises of it&#39;s a little tricky to be specific, but I expect if you purchased it within the last year the odds are it&#39;s the &quot;emon-pi&quot; variant of emonhub, emoncms&nbsp;(possibly v8.5)&nbsp;is installed&nbsp;&nbsp;and the OS is configured as Read-only with a writable partition.&nbsp;</p>
<p>Generally speaking it is considered bad practice to &quot;just pull the plug&quot;&nbsp;on any OS but most OEM images (certainly all last year) are configured as read-only BUT many are then given a writable partition to enable some stuff to be persisted. Although much more resiliant than a non read only OS the writable partition is a weakness as it couls cause failure and a failure takes down the whole card not just the partition.</p>
<p>However I have been running&nbsp;fully Read-only images for several years and deliberately stress test them by never shutting them down gracefully. They have survived many power cuts and &quot;plug pulling&quot; without any issues of any kind.&nbsp;These images however are not the OEM images, they are very simple, but extremely reliable emonhub&nbsp;v1.2 and a fully read-only OS with no writable partition or other OEM&nbsp;software such as emonCMS running.</p>
<p>Most of the &quot;emonhub&quot; issues you will have read about will be the &quot;emon-pi&quot; variant. The genuine emonhub code has not needed any bugfixes&nbsp;for well over a year. The auto baud detection is a little iffy but that can be easily over ridden as is recommended (it is only needed if you do not know the devices baud).</p>
<p>emonhub doesn&#39;t automatically update itself but if you do use the emoncms update function in later images it will also update emonhub.</p>
<p>I think it&#39;s unlikely any thing has &quot;updated&quot; unless someone has instigated it, if you can provide some emonhub.log we can go from there, if the log doesn&#39;t include the start up can you confirm the version? it is included in the first couple of messages following emonhub being started.&nbsp;</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39109"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7978.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-7978.png" alt="Bbaass_TMH&#039;s picture" title="Bbaass_TMH&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonBase OR emonTxv3.4 no longer sending data to emoncms.org *resolved by installing newer emonBase firmware*</h3>

    <div class="submitted">Submitted by <a href="../user/7978.html" title="View user profile.">Bbaass_TMH</a> on Thu, 04/02/2016 - 12:28.</div>
    <div class="content">
     <p>We bought it sometime in April 2015.</p>
<p>I have been trying to install a (somewhat) newer on the SD card using the info here&nbsp;http://openenergymonitor.org/emon/guide but so far my PC bluescreened twice while trying to write the image file to the SD card using Win32DiskImager.</p>
<p>This PC is running Win7, I&#39;m currently trying to write to the SD card on a Win XP laptop.</p>
<p>Hasn&#39;t crashed (yet) but all this probably means I can&#39;t use the old version to get a logfile.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39111"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonBase OR emonTxv3.4 no longer sending data to emoncms.org *resolved by installing newer emonBase firmware*</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Thu, 04/02/2016 - 13:10.</div>
    <div class="content">
     <p>Oh! that doesn&#39;t sound good at all! I have no recollection of any &quot;blue screens&quot; being previously reported.</p>
<p>If you have partially over-written the sdcard&nbsp;or corrupted it then there is no going back. But if I were you I would try the card in the Pi again and if it boots then do not attempt any further overwrites until you sort the win32imager out. If you have another card, test&nbsp;with that until you are able to successfully write each time, if you are using a usb sdcard reader you could also use the Pi to write your image to the 2nd card rather than a PC if all else fails (and the first sdcard is intact).</p>
<p>I wouldn&#39;t bother with a later image they are&nbsp;becoming more suited to the home IoT enthusiast rather than a&nbsp;robust professional solution.&nbsp;If we are unable to access the old image and debug / fix, then I would strongly recommend a custom &quot;rock solid&quot; image. I can help you with that if you wish.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-39114"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/7978.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-7978.png" alt="Bbaass_TMH&#039;s picture" title="Bbaass_TMH&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emonBase OR emonTxv3.4 no longer sending data to emoncms.org *resolved by installing newer emonBase firmware*</h3>

    <div class="submitted">Submitted by <a href="../user/7978.html" title="View user profile.">Bbaass_TMH</a> on Thu, 04/02/2016 - 14:58.</div>
    <div class="content">
     <p>It works!</p>
<p>&nbsp;</p>
<p>I thought I posted this an hour and a half ago, but I guess I didn&#39;t click &quot;save&quot; on the forum post correctly.</p>
<p>This PC has been derpy sometimes. I also noticed after the first bluescreen that there was 74GB out of 76GB&nbsp;used on the HDD, so that might be problem when working with a ~4GB image file.</p>
<p>&nbsp;</p>
<p>The PC has a multi-card reader on the front, the&nbsp;laptop has just an SD card reader.</p>
<p>I did get Win32DiskImager to succesfully&nbsp;write the image file to the SD card. Then I put it in the emonBase, powered it up, connected it to LAN, and navigated to <a href="http://emonpi/" title="http://emonpi/">http://emonpi/</a>, registered an account and entered the write api key from my emoncms.org account.</p>
<p>We&#39;ve just installed it at the client we intended to install it at a couple days ago, and it&#39;s been updating the graphs on emoncms.org since then.</p>
<p>(new grocery store in old building, we intend to find out how much smaller the building&#39;s main fuses can be. You pay less monthly for having smaller values)</p>
<p>&nbsp;</p>
<p>The old image that suddenly didn&#39;t work anymore is now gone too cause it&#39;s overwritten, so we can&#39;t find the actual cause of the problem.</p>
<p>&nbsp;</p>
<p>I should write up a post about our logger, which is what we call it. Curious what others would think about our solution for measuring 3 phase voltages with a single emonTx V3.4.</p>
<p>&nbsp;</p>
<blockquote><p>--- your image &nbsp;-- if you purchased it within the last year the odds are it&#39;s the &quot;emon-pi&quot; variant of emonhub, emoncms&nbsp;(possibly v8.5) --</p>
</blockquote>
<p>The image I installed now IS V8.5, meaning our original image predates that. I looked up the invoice, we ordered it on April 13th, 2015.</p>
<p>&nbsp;</p>
<p>Regardless, thank you both for trying to help, Robert and Paul!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/12122"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-luVCLrk09DU87W-pO54SZ68sv0fpZAIRS9AeeBuNCdc" value="form-luVCLrk09DU87W-pO54SZ68sv0fpZAIRS9AeeBuNCdc"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
