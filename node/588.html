<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/588 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 16:07:06 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Unix timestamp saving and flot graphs | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/6.html">Archived: Questions and support </a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Unix timestamp saving and flot graphs</h3>
        <span class="submitted">Submitted by <a href="../user/317.html" title="View user profile.">Sergegsx</a> on Sun, 15/04/2012 - 09:10</span>
        <div class="content"><p>Hi, I am really stuck with using unix timestamp. I am using emoncms3 but also saving all my data to another mysql table to have all values in one row every 10 seconds.</p>
<p>I am using unix timestamp to store the time of the recording and then just read it to create the flot graphs.&nbsp;</p>
<p>however I have a &quot;concept&quot; question about how should i use Unix timestamp, specially because my online server is -8 hours from my location.</p>
<p>I would like to know what is the correct way of storing an Unix timestamp in terms of GMT, UTC, winter, summer, server vs client time difference.</p>
<p><span style="background-color: rgb(250, 250, 250); color: rgb(51, 51, 51); font-family: Verdana, Arial, Tahoma, Calibri, Geneva, sans-serif; font-size: 13px; ">For example if I am in Spain and want to save a Unix Timestamp, should I take into consideration that its +</span>2hours<span style="background-color: rgb(250, 250, 250); color: rgb(51, 51, 51); font-family: Verdana, Arial, Tahoma, Calibri, Geneva, sans-serif; font-size: 13px; "> when saving the value? or +</span>1hours<span style="background-color: rgb(250, 250, 250); color: rgb(51, 51, 51); font-family: Verdana, Arial, Tahoma, Calibri, Geneva, sans-serif; font-size: 13px; "> in winter?</span></p>
<p><span style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Tahoma, Calibri, Geneva, sans-serif; font-size: 13px; background-color: rgb(250, 250, 250); ">Or should I save it in a certain neutral way, and then convert the value when reading it?</span><br style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Tahoma, Calibri, Geneva, sans-serif; font-size: 13px; background-color: rgb(250, 250, 250); " /><br />
	<span style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Tahoma, Calibri, Geneva, sans-serif; font-size: 13px; background-color: rgb(250, 250, 250); ">this problem has also been killing me in php so a solution will help me for two issues.</span></p>
<p>Ive read about&nbsp;date_default_timezone_set but really dont know how to put everything together.</p>
<p><br style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Tahoma, Calibri, Geneva, sans-serif; font-size: 13px; background-color: rgb(250, 250, 250); " /><br />
	<span style="color: rgb(51, 51, 51); font-family: Verdana, Arial, Tahoma, Calibri, Geneva, sans-serif; font-size: 13px; background-color: rgb(250, 250, 250); ">Thank you very much for your time &nbsp;and I really appreciate any help.</span></p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="633.html" class="topic-previous" title="Go to previous forum topic">‹ Add environmental sensors to emon</a>
              <a href="629.html" class="topic-next" title="Go to next forum topic">Energy Monitor - emon ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-3837"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Unix timestamp saving and flot graphs</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 15/04/2012 - 10:29.</div>
    <div class="content">
     <p>Unix time is Unix time - it is the same wherever you are in the world. It does not change with daylight savings time. I would save all times as Unix times, then apply the correction for local time (including daylight savings time when appropriate) when you extract and use the data. Bear in mind that when you are analysing and displaying the data, you need to use the time offset for the place and time the data was saved, not for the place and time that you are displaying the data. So if you are looking at this summer&#39;s data next winter, you need to offset by 2 hours. And if I (in the UK) am looking at the same data next winter, I apply the same 2 hours offset even though my local time is then the same as Unix time. If you save as local time, you might have a problem with missing and duplicate times when daylight savings time starts and ends.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-3841"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/317.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-317.jpg" alt="Sergegsx&#039;s picture" title="Sergegsx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Unix timestamp saving and flot graphs</h3>

    <div class="submitted">Submitted by <a href="../user/317.html" title="View user profile.">Sergegsx</a> on Sun, 15/04/2012 - 12:59.</div>
    <div class="content">
     <p>thank you robert for your answer.</p>
<p>What I have seen is that if i call time() in php it give me unix timestamp, however this value is different in case I have set previously a&nbsp;<span style="color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13px; line-height: 17px; text-align: left; ">date_default_timezone_set. So I dont know if the time() i get before doing the timezoneset is also affected by the servers location.</span></p>
<p><span style="color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13px; line-height: 17px; text-align: left; ">I</span><span style="color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13px; line-height: 17px; text-align: left; "> dont know if i am making myself clear, sorry.</span></p>
<p><span style="color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13px; line-height: 17px; text-align: left; ">​So&nbsp;the thing is, how can I get a true unix timestamp without problems of where the server is located, or any specified&nbsp;</span><span style="color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13px; line-height: 17px; text-align: left; ">date_default_timezone_set in the server?</span></p>
<p><span style="color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13px; line-height: 17px; text-align: left; ">​Once i save that value, I guess I need to consider when calling the data back from mysql, that i need to go 2 hours back, right?&nbsp;</span></p>
<p>&nbsp;</p>
<p><span style="color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 13px; line-height: 17px; text-align: left; ">​thank&nbsp;you so much Robert</span></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-3845"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Unix timestamp saving and flot graphs</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 15/04/2012 - 20:13.</div>
    <div class="content">
     <p>The way I read the PHP manual <a href="http://www.php.net/manual/en/function.time.php">http://www.php.net/manual/en/function.time.php,</a> time( ) does not return a value that has been offset by the locale. And that is exactly how it works for me:</p>
<p>The web page:</p>
<blockquote><p>&lt;html&gt;<br />
		&lt;head&gt;<br />
		&lt;/head&gt;<br />
		&lt;body&gt;<br />
		&lt;p&gt;<br />
		Unix timestamp now is<br />
		&lt;?php<br />
		$timenow = time();<br />
		echo $timenow;<br />
		echo (&quot;&lt;br&gt;&quot;);<br />
		echo strftime(&quot;%c&quot;, $timenow);<br />
		?&gt;<br />
		&lt;/p&gt;<br />
		&lt;p&gt;<br />
		Setting date_default_timezone_set(&#39;America/Los_Angeles&#39;)<br />
		&lt;?php<br />
		$result = date_default_timezone_set(&#39;America/Los_Angeles&#39;);<br />
		echo (&quot;&lt;br&gt;tzs returns $result&quot;);<br />
		?&gt;<br />
		&lt;/p&gt;<br />
		&lt;p&gt;<br />
		Unix timestamp now is<br />
		&lt;?php<br />
		$timenow = time();<br />
		echo $timenow;<br />
		echo (&quot;&lt;br&gt;&quot;);<br />
		echo strftime(&quot;%c&quot;, $timenow);<br />
		?&gt;<br />
		&lt;/p&gt;<br />
		&lt;/body&gt;<br />
		&lt;/html&gt;</p>
</blockquote>
<p>And the result:</p>
<blockquote><p>Unix timestamp now is 1334520588<br />
		Sun Apr 15 21:09:48 2012</p>
<p>Setting date_default_timezone_set(&#39;America/Los_Angeles&#39;)<br />
		tzs returns 1</p>
<p>Unix timestamp now is 1334520588<br />
		Sun Apr 15 13:09:48 2012</p>
</blockquote>
<p>Are you interpreting the value returned by time( ) - as in strftime( ) above? If so that is where the offset is being applied.</p>
<p>Yes, you do need to apply the correct offset when you extract the time from mysql.</p>
<p>[Edited to add date &amp; time as string]</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-4103"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/317.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-317.jpg" alt="Sergegsx&#039;s picture" title="Sergegsx&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Unix timestamp saving and flot graphs</h3>

    <div class="submitted">Submitted by <a href="../user/317.html" title="View user profile.">Sergegsx</a> on Sun, 29/04/2012 - 19:33.</div>
    <div class="content">
     <p>hello Robert, I am really sorry for having taken so long to answer.</p>
<p>Just wanted to thank you a lot for your time on answering my question, with your code and explanation I completely understood unix timestamp at last !!</p>
<p>My database is not storing the correct timestamp and my website is plotting everything correctly thanks also to this...</p>
<p><a href="https://github.com/openenergymonitor/emoncms3/pull/10">https://github.com/openenergymonitor/emoncms3/pull/10</a></p>
<p>&nbsp;</p>
<p>Once again, thank you Robert !</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/588"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-szilpe3VOf4w4bvpJCY4L116dJmersrZHGATyzImbdA" value="form-szilpe3VOf4w4bvpJCY4L116dJmersrZHGATyzImbdA"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
