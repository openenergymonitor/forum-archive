<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/1995 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:46:16 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Measuring DC voltage? | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Measuring DC voltage?</h3>
        <span class="submitted">Submitted by <a href="../user/2128.html" title="View user profile.">jb79</a> on Tue, 05/02/2013 - 21:21</span>
        <div class="content"><p>Hello!</p>
<p>Could anybody please post me a short example script for DC voltage measurement (maybe taking some samples to reduce noise) with the EmonTX?</p>
<p>Of cause I know that I have to modify the schematic, but that&#39;s no problem for me. I only need a software example to understand how to do it.</p>
  <div class="forum-topic-navigation clear-block">
          <a href="2005.html" class="topic-previous" title="Go to previous forum topic">‹ convert 9vac port into a &quot;ct4&quot; port </a>
              <a href="1903.html" class="topic-next" title="Go to next forum topic">3G Forward data to remote emoncms ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-9622"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Measuring DC voltage?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 05/02/2013 - 21:33.</div>
    <div class="content">
     <p>What d.c. voltage are you trying to measure?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9624"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2128.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="jb79&#039;s picture" title="jb79&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Measuring DC voltage?</h3>

    <div class="submitted">Submitted by <a href="../user/2128.html" title="View user profile.">jb79</a> on Tue, 05/02/2013 - 21:51.</div>
    <div class="content">
     <p>Hello Robert!</p>
<p>I want to measure the voltage of a 255W solar panel, maximum voltage will be about 40V. The panel is mounted on my garden shed.</p>
<p>When the voltage measuring works I will add a current sensor (ACS712) on a second channel, but first I have to understand the software part. The hardware is no problem, I allready did this using a PIC, but not with an ATMEL.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9627"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Measuring DC voltage?</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 06/02/2013 - 00:21.</div>
    <div class="content">
     <p>I was concerned that without isolation - both on the voltage side and the current side - that you would be at great risk, because direct voltages can be much more harmful than alternating. Do please be aware of the potential dangers and treat the panel as being live at all times.</p>
<p>I assume you will probably be using an op-amp with a differential input so that you don&#39;t need to tie the common rail to either of the d.c. connections, neither of which need to be at or even near earth potential. You&#39;ll need to make sure you have minimal d.c drift, because this will have a direct effect on accuracy.</p>
<p>I&#39;ve not seen a sketch mentioned for measuring the direct output from the panels, though I understand some have decoded the data output from their inverter, to obtain the same information.</p>
<p>Basically, you can use the sketch here <a href="31.html" title="http://openenergymonitor.org/emon/node/31">http://openenergymonitor.org/emon/node/31</a> as a strarting point, because once the input has been digitised, you treat voltage exactly the same as you treat current. The library has a filter built-in to smooth the values, but obviously you&#39;ll need to understand and change the calibration.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9632"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Measuring DC voltage?</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Wed, 06/02/2013 - 09:47.</div>
    <div class="content">
     <p>I keep meaning to remove the dc shunt page and replacing it with what I found to work better in the end when I was doing DC sensing which was these nice little&nbsp;modules from cool components:&nbsp;</p>
<p>Voltage and current monitoring:</p>
<p><a href="http://www.coolcomponents.co.uk/catalog/attopilot-voltage-current-sense-breakout-p-433.html" title="http://www.coolcomponents.co.uk/catalog/attopilot-voltage-current-sense-breakout-p-433.html">http://www.coolcomponents.co.uk/catalog/attopilot-voltage-current-sense-...</a></p>
<p>Current only</p>
<p><a href="http://www.coolcomponents.co.uk/catalog/acs715-current-sensor-breakout-p-474.html" title="http://www.coolcomponents.co.uk/catalog/acs715-current-sensor-breakout-p-474.html">http://www.coolcomponents.co.uk/catalog/acs715-current-sensor-breakout-p...</a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9633"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1332.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1332.jpg" alt="JBecker&#039;s picture" title="JBecker&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Measuring DC voltage?</h3>

    <div class="submitted">Submitted by <a href="../user/1332.html" title="View user profile.">JBecker</a> on Wed, 06/02/2013 - 10:22.</div>
    <div class="content">
     <p>Hallo J&uuml;rgen :-),</p>
<p>it would also be possible to use this board (shunt missing) :</p>
<p><a href="http://jeelabs.com/products/analog-plug">http://jeelabs.com/products/analog-plug</a></p>
<p>for bi-directional current measurement with very high accuracy. The emontx provides &#39;Jeelab ports&#39;, so it should be possible to use the software routines provided by the jeelib library (/examples/ports/analog_demo).</p>
<p>I have already used the same chip (4 channel MCP3424) for other purposes and found it to be very nice and accurate (and quite cheap also). There are also one and two channel versions.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9634"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2128.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="jb79&#039;s picture" title="jb79&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Measuring DC voltage?</h3>

    <div class="submitted">Submitted by <a href="../user/2128.html" title="View user profile.">jb79</a> on Wed, 06/02/2013 - 10:54.</div>
    <div class="content">
     <p>Hello Robert!</p>
<p>I&#39;m aware of the special danger with direct voltages and currents, I attended a school for electrical engineeering. So I know about the dangers and risks in theory and practice.</p>
<p>I will use a box where I put all compoents and the EmonTX into, so there will be only two wires going into from the panel and two wires leaving the box to the inverter. (I&#39;ll measure the AC current too with a CT).</p>
<p>For the current measurement I will use a ACS712 that allready isolates between the current and the voltage output.</p>
<p>As the ACS712 uses 5V and can measure currents bidirectional (-20 to +20A) the output is centered around 2,5V. Higher voltage means positive current, lower means negative current. If I connect the current path in reverse direction I&#39;ll get 2,5V (0A) to 0,5V (20A), so no problem for the ATMEL 3,3V inputs, only a litte bit of mathematics for the ATMEL.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9636"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/450.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="stuart&#039;s picture" title="stuart&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Measuring DC voltage?</h3>

    <div class="submitted">Submitted by <a href="../user/450.html" title="View user profile.">stuart</a> on Wed, 06/02/2013 - 11:12.</div>
    <div class="content">
     <p>Are you wiring this panel into an inverter?&nbsp; If so that may be the best place to get the readings from?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9642"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/2128.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="jb79&#039;s picture" title="jb79&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Measuring DC voltage?</h3>

    <div class="submitted">Submitted by <a href="../user/2128.html" title="View user profile.">jb79</a> on Wed, 06/02/2013 - 20:34.</div>
    <div class="content">
     <p>Ok I found the function in the /examples/ports/analog_demo file. That&#39;s really simple. I only had to multiply the value by 3,225 to get the correct value in milivolts.</p>
<p>Udc = analogRead(A0)*3.226;&nbsp;&nbsp;&nbsp; // Read input from Analog Pin 0=CT2. Pin 1=CT3.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/1995"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-XXqykjeEiOaguRTZL6lsdQe-WTHXu_WRmQmLrUGbLPY" value="form-XXqykjeEiOaguRTZL6lsdQe-WTHXu_WRmQmLrUGbLPY"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/1995 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:46:16 GMT -->
</html>
