<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/1236 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:07:15 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>emoncms onto RaspberryPI | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/3.html">Archived: General Discussion</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">emoncms onto RaspberryPI</h3>
        <span class="submitted">Submitted by <a href="../user/885.html" title="View user profile.">logic</a> on Wed, 24/10/2012 - 20:37</span>
        <div class="content"><p>I&#39;ve been following this guide -&nbsp;http://wiki.openenergymonitor.org/index.php?title=Raspberry_Pi &nbsp;and <a href="../emoncms/installing-ubuntu-debian-pi.html" title="http://openenergymonitor.org/emon/emoncms/installing-ubuntu-debian-pi">http://openenergymonitor.org/emon/emoncms/installing-ubuntu-debian-pi</a> - for installing emoncms on my RaspberryPi and all is going well except for the bit about SSH keys (<a href="../emoncms/installing-ubuntu-debian-pi.html" title="http://openenergymonitor.org/emon/emoncms/installing-ubuntu-debian-pi">http://openenergymonitor.org/emon/emoncms/installing-ubuntu-debian-pi</a> section 6).</p>
<p>In the helpful tip:</p>
<p>Helpful tip: If doing this via SSH use $ cat /home/pi/.ssh/id_rsa.pub to display the SSH key in the terminal window. then select and [Ctrl + Shift + C] to copy to clipboard ready to paste into Github setting page.</p>
<p>Can anyone explain more about this - is it on the Raspberry, or PC? &nbsp;I&#39;ve tried typing that into the Raspberry and also following this guide&nbsp;https://help.github.com/articles/generating-ssh-keys but I can&#39;t figure what to do.</p>
<p>Incase it matters, I am controlling the Raspberry from my laptop using Putty</p>
<p>I have tried going further without this SSH keys bit and everything appears to work, until i type my IP address into my browser - I get nothing. &nbsp;I guess this is related to the SSH keys?</p>
<p>&nbsp;</p>
<p>I may just be getting a little out of my depth, but I have one of Martin Harizanov&#39;s&nbsp;RFM12B to raspberry boards which I hope to get all setup.</p>
<p>&nbsp;</p>
<p>Thanks</p>
<p>Dennis</p>
  <div class="forum-topic-navigation clear-block">
          <a href="958.html" class="topic-previous" title="Go to previous forum topic">‹ New System Design: Distance between DS18B20s, Data Logging</a>
              <a href="1243.html" class="topic-next" title="Go to next forum topic">utility meter response to triac control ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-6851"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Thu, 25/10/2012 - 07:36.</div>
    <div class="content">
     <p>I am thinking of creating a SD image with emoncms all set up, you will just have to plug in the RFM2Pi board. How does that sound?</p>
<p>I will be making step by step notes in the process and also make these available.</p>
<p>&nbsp;</p>
<p>As per using git: you can also just download emoncms as a .zip and unzip it in /var/www&nbsp;</p>
<p>&nbsp;</p>
<p>Also, note that latest emoncms (<a href="https://github.com/emoncms/emoncms" title="https://github.com/emoncms/emoncms">https://github.com/emoncms/emoncms</a>) doeas have an add-on module for the rfm2pi board (<a href="https://github.com/emoncms/raspberrypi" title="https://github.com/emoncms/raspberrypi">https://github.com/emoncms/raspberrypi</a>)</p>
<p>There is no documentation on how to&nbsp;install it yet, I am planning of creating such these days.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6852"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1958.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1958.png" alt="fluppie007&#039;s picture" title="fluppie007&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/1958.html" title="View user profile.">fluppie007</a> on Thu, 25/10/2012 - 08:28.</div>
    <div class="content">
     <p>That&#39;s very cool!<br />
	The only problem left is getting a Raspberry Pi :-). Waiting times are&nbsp;like 3 weeks (I live in the EU)...&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6858"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/885.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="logic&#039;s picture" title="logic&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/885.html" title="View user profile.">logic</a> on Thu, 25/10/2012 - 21:16.</div>
    <div class="content">
     <p>A ready loaded SD card sounds an excellent idea - I for one would certainly be interested.</p>
<p>&nbsp;</p>
<p>As it is, I followed all the installation steps as per my initial post and all appeared to go well, except for the bit about SSH keys (it did say optional anyway so I initially carried on past it) and then at the bit where I type in my RaspberryPI IP address.&nbsp; Am I correct in that <a href="http://192.168.1.199/emoncms3" title="http://192.168.1.199/emoncms3">http://192.168.1.199/emoncms3</a> is what I type - 192.168.1.199 is definately the RaspberryIP LAN IP, although it does have a wifi adaptor but I tried it&#39;s IP address aswell with no luck (it appears intermittent whether it works or not when accessing with Putty).</p>
<p>&nbsp;</p>
<p>Dennis</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6859"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/885.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="logic&#039;s picture" title="logic&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/885.html" title="View user profile.">logic</a> on Thu, 25/10/2012 - 22:56.</div>
    <div class="content">
     <p>I&#39;m in!</p>
<p>Closer reading explains all - I was trying to change the settings for the non-modular version when I had installed the modular.</p>
<p>My IP address part was correct except&nbsp;the url&nbsp;ends in emoncms instead of emoncms3.</p>
<p>&nbsp;</p>
<p>So I&#39;ve logged into emoncms, ran minicom and I see serial data received so all looks good so far.&nbsp; I&#39;ll now wait patiently for the rest of the quide to complete.</p>
<p>&nbsp;</p>
<p>Thanks</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6860"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 26/10/2012 - 00:24.</div>
    <div class="content">
     <p>Documentation for rm12pi is slowly taking shape: <a href="http://wiki.openenergymonitor.org/index.php?title=Raspberry_Pi">http://wiki.openenergymonitor.org/index.php?title=Raspberry_Pi</a>, not quite complete yet. Trystran is working on making the modular emoncms easier to setup with auto module detection. Should be on github soon.</p>
<p>Yes, releasing a ready to go SD card image is on the plan.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6861"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="PeterN&#039;s picture" title="PeterN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by PeterN (not verified) on Fri, 26/10/2012 - 07:18.</div>
    <div class="content">
     <p>Hi,</p>
<p>thanks all, at same stage as Denis above,</p>
<p>I followed instructions and receiving fine (serial port RPi) from two nodes (emontx and emonglcd) see attached screen shots.</p>
<p>I also installed modular emoncms as described and can now register and login etc. ok</p>
<p>Looking forward to next instructions, in the mean time is there any point in trying to use script at</p>
<p><a href="https://github.com/mharizanov/TinySensor/blob/42208d23cdc8d3308a844b8909a5bfbd11a88b8f/perl_gateway/serial.pl" title="https://github.com/mharizanov/TinySensor/blob/42208d23cdc8d3308a844b8909a5bfbd11a88b8f/perl_gateway/serial.pl">https://github.com/mharizanov/TinySensor/blob/42208d23cdc8d3308a844b8909...</a> or other - more as a learning curve then to preempt proper solution.</p>
<p>Cheers</p>
<p>Peter</p>
<p>P.S. Anyone got description of serial input, with exception on first part on each line which is node ID it doesn&#39;t make much sense to me refer attached screenshots, tried changing temp and power to see which changed but not much clarity.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6865"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Fri, 26/10/2012 - 10:26.</div>
    <div class="content">
     <p>I am correcting the link to the wiki in Glyn&#39;s post, it should be:</p>
<p><a href="http://wiki.openenergymonitor.org/index.php?title=Raspberry_Pi" title="http://wiki.openenergymonitor.org/index.php?title=Raspberry_Pi">http://wiki.openenergymonitor.org/index.php?title=Raspberry_Pi</a></p>
<p>Great work there Glyn!</p>
<p>Just a comment on those that don&#39;t want to use or install git, you can use this alternative method to pull the latest emoncms and raspberrypi module:</p>
<p>cd /var/www/<br />
	sudo wget -O emoncms.tar.gz <a href="https://github.com/emoncms/emoncms/tarball/master" title="https://github.com/emoncms/emoncms/tarball/master">https://github.com/emoncms/emoncms/tarball/master</a><br />
	tar xvfz emoncms.tar.gz<br />
	sudo mv -i emoncms-emoncms-96885fe emoncms</p>
<p>cd /var/www/Modules/</p>
<p>sudo wget -O raspberrypi.tar.gz <a href="https://github.com/emoncms/raspberrypi/tarball/master" title="https://github.com/emoncms/raspberrypi/tarball/master">https://github.com/emoncms/raspberrypi/tarball/master</a><br />
	tar xvfz raspberrypi.tar.gz<br />
	sudo mv -i emoncms-raspberrypi-b9703b5 raspberrypi</p>
<p>NOTE that the bold part will change with every new version on github so you need to replace with the correct value</p>
<p>I added these ti the wiki</p>
<p>Also, you can create the tables required for the raspberrypi module by simply visiting the ADMIN tab, so that won&#39;t require any modification in index.php</p>
<p>&nbsp;</p>
<p>I have the SD card image ready, but it is a 8GB one, this is the size of my SD card. I will see how large it is when zipped, and need to think of a way to share that over the interned without&nbsp; spending al my site allowed traffic ..</p>
<p>I will post details on my experience with setting the cron job for the raspberrypi module later today.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6870"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="PeterN&#039;s picture" title="PeterN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by PeterN (not verified) on Fri, 26/10/2012 - 15:28.</div>
    <div class="content">
     <p>Great thanks Martin.</p>
<p>I followed link above and it all seems to work fine, the&nbsp;serial port on Pi is reading from RFM12&nbsp; you sent for both my emontx and emonglcd. The emoncms modular version is&nbsp;working on Raspberry Pi&nbsp; as per instructions above.</p>
<p>But what now? Where do I put API code for my emoncms and how do I use data received. Lots of questions if the answer is wait that&#39;s no problem but if you can advise I would like to try over weekend &nbsp;- great learning curve ( but don&#39;t want to waste your valuable time).</p>
<p>Cheer</p>
<p>Peter</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6876"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Fri, 26/10/2012 - 17:15.</div>
    <div class="content">
     <p>The rest is pretty easy, here is how I got it to work, maybe not the best way. No need to put the API anywhere, it already knows it as it is part of emoncms now.</p>
<p>Edit crontab this way:</p>
<pre>
sudo nano /etc/crontab</pre><p>&nbsp;</p>
<p>and add this line to the end of it:</p>
<p>*/1 * * * * root cd /var/www/emoncms/Modules/raspberrypi &amp;&amp; php&nbsp;raspberrypi_run.php</p>
<p>&nbsp;</p>
<p>then reboot and you will start seeing data being fed in emoncms.</p>
<p>From there on it is the standard stuff, identify the inputs and log them to feeds.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6879"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Sat, 27/10/2012 - 13:04.</div>
    <div class="content">
     <p>The original raspberrypi_run.php file runs too slow and omits transmissions. Here is my fix for those eager to test it out</p>
<p>&nbsp;</p>
<pre>
&lt;?php
<p>&nbsp; /*<br />
	<br />
	&nbsp; All Emoncms code is released under the GNU Affero General Public License.<br />
	&nbsp; See COPYRIGHT.txt and LICENSE.txt.<br />
	<br />
	&nbsp; ---------------------------------------------------------------------<br />
	&nbsp; Emoncms - open source energy visualisation<br />
	&nbsp; Part of the OpenEnergyMonitor project:<br />
	&nbsp; <a href="http://openenergymonitor.org/" title="http://openenergymonitor.org">http://openenergymonitor.org</a><br />
	<br />
	&nbsp; */<br />
	<br />
	&nbsp; define(&#39;EMONCMS_EXEC&#39;, 1);<br />
	<br />
	&nbsp; $fp = fopen(&quot;importlock&quot;, &quot;w&quot;);<br />
	&nbsp; if (! flock($fp, LOCK_EX | LOCK_NB)) { echo &quot;Already running\n&quot;; die; }<br />
	<br />
	&nbsp; chdir(dirname(__FILE__));<br />
	<br />
	&nbsp; require &quot;../../settings.php&quot;;<br />
	&nbsp; include &quot;../../db.php&quot;;<br />
	&nbsp; db_connect();<br />
	<br />
	&nbsp; include &quot;raspberrypi_model.php&quot;;<br />
	&nbsp; raspberrypi_running();<br />
	<br />
	&nbsp; $settings = raspberrypi_get();<br />
	&nbsp; $apikey = $settings[&#39;apikey&#39;];<br />
	&nbsp; $group = $settings[&#39;sgroup&#39;];<br />
	&nbsp; $frequency = $settings[&#39;frequency&#39;];<br />
	&nbsp; $baseid = $settings[&#39;baseid&#39;];<br />
	<br />
	<br />
	&nbsp; // Create a stream context that configures the serial port<br />
	&nbsp; // And enables canonical input.<br />
	&nbsp; $c = stream_context_create(array(&#39;dio&#39; =&gt;<br />
	&nbsp;&nbsp;&nbsp; array(&#39;data_rate&#39; =&gt; 9600,<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39;data_bits&#39; =&gt; 8,<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39;stop_bits&#39; =&gt; 1,<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39;parity&#39; =&gt; 0,<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39;flow_control&#39; =&gt; 0,<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39;is_canonical&#39; =&gt; 1)));<br />
	<br />
	&nbsp; // Are we POSIX or Windows?&nbsp; POSIX platforms do not have a<br />
	&nbsp; // Standard port naming scheme so it could be /dev/ttyUSB0<br />
	&nbsp; // or some long /dev/tty.serial_port_name_thingy on OSX.<br />
	&nbsp; if (PATH_SEPARATOR != &quot;;&quot;) {<br />
	&nbsp;&nbsp;&nbsp; $filename = &quot;dio.serial:///dev/ttyAMA0&quot;;<br />
	&nbsp; } else {<br />
	&nbsp;&nbsp;&nbsp; $filename = &quot;dio.serial://dev/ttyAMA0&quot;;<br />
	&nbsp; }<br />
	<br />
	&nbsp; // Open the stream for read and write and use it.<br />
	&nbsp; $f = fopen($filename, &quot;r+&quot;, false, $c);<br />
	&nbsp; if ($f)<br />
	&nbsp; {<br />
	&nbsp;&nbsp;&nbsp; //fprintf($f,&quot;\r\n&quot;);<br />
	&nbsp;&nbsp;&nbsp; sleep(1);<br />
	&nbsp;&nbsp;&nbsp; fprintf($f,$baseid.&quot;i&quot;);<br />
	&nbsp;&nbsp;&nbsp; sleep(1);<br />
	&nbsp;&nbsp;&nbsp; fprintf($f,$frequency.&quot;b&quot;);<br />
	&nbsp;&nbsp;&nbsp; sleep(1);<br />
	&nbsp;&nbsp;&nbsp; fprintf($f,$group.&quot;g&quot;);<br />
	&nbsp;&nbsp;&nbsp; sleep(1);<br />
	<br />
	&nbsp;&nbsp;&nbsp; $start = time();<br />
	<br />
	&nbsp;&nbsp;&nbsp; while(true)<br />
	&nbsp;&nbsp;&nbsp; {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (time()-$start&gt;10)<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $start = time();<br />
	<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $settings = raspberrypi_get();<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($settings[&#39;apikey&#39;] !=$apikey) $apikey = $settings[&#39;apikey&#39;];<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($settings[&#39;sgroup&#39;] !=$group) {$group = $settings[&#39;sgroup&#39;]; fprintf($f,$group.&quot;g&quot;);}<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($settings[&#39;frequency&#39;] !=$frequency) {$frequency = $settings[&#39;frequency&#39;]; fprintf($f,$frequency.&quot;b&quot;); }<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($settings[&#39;baseid&#39;] !=$baseid) {$baseid = $settings[&#39;baseid&#39;]; fprintf($f,$baseid.&quot;i&quot;);}<br />
	<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; raspberrypi_running();<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
	<br />
	<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $data = fgets($f);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($data &amp;&amp; $data!=&quot;\n&quot;)<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &quot;SERIAL RX:&quot;.$data;<br />
	<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($data[0]!=&quot;&gt;&quot;)<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $values = explode(&#39; &#39;,$data);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $msubs = &quot;&quot;;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for($i=2; $i&lt;(count($values)-1); $i+=2){<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($i&gt;2) $msubs .= &quot;,&quot;;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $msubs .= $values[$i] + $values[$i+1]*256;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo $msubs.&quot;\n&quot;;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $url = &quot;/emoncms/input/post?apikey=&quot;.$apikey.&quot;&amp;node=&quot;.$values[1].&quot;&amp;csv=&quot;.$msubs;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; getcontent(&quot;localhost&quot;,80,$url);<br />
	<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
	<br />
	<br />
	<br />
	&nbsp;&nbsp;&nbsp; }<br />
	&nbsp; }<br />
	&nbsp; fclose($f);<br />
	<br />
	function getcontent($server, $port, $file)<br />
	{<br />
	&nbsp;&nbsp; $cont = &quot;&quot;;<br />
	&nbsp;&nbsp; $ip = gethostbyname($server);<br />
	&nbsp;&nbsp; $fp = fsockopen($ip, $port);<br />
	&nbsp;&nbsp; if (!$fp)<br />
	&nbsp;&nbsp; {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return &quot;Unknown&quot;;<br />
	&nbsp;&nbsp; }<br />
	&nbsp;&nbsp; else<br />
	&nbsp;&nbsp; {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $com = &quot;GET $file HTTP/1.1\r\nAccept: */*\r\nAccept-Language: de-ch\r\nAccept-Encoding: gzip, deflate\r\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\r\nHost: $server:$port\r\nConnection: Keep-Alive\r\n\r\n&quot;;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fputs($fp, $com);<br />
	/* Don&#39;t realy need to fetch output as it slows us down<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (!feof($fp))<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $cont .= fread($fp, 500);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
	*/<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fclose($fp);<br />
	//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $cont = substr($cont, strpos($cont, &quot;\r\n\r\n&quot;) + 4);<br />
	//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return $cont;<br />
	&nbsp;&nbsp; }<br />
	}<br />
	?&gt;</p>
</pre>         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6881"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 26/10/2012 - 19:54.</div>
    <div class="content">
     <p>Thanks Martin. I'll add your non git based setup info to the wiki and get Trystan to take a look at the php script and your fix. </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6882"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/10.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-10.jpg" alt="glyn.hudson&#039;s picture" title="glyn.hudson&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/10.html" title="View user profile.">glyn.hudson</a> on Fri, 26/10/2012 - 19:59.</div>
    <div class="content">
     <p>If anyone notices any errors on the wiki. Feel free to edit. Your openenergymonitor.org login details should carry over. You might need to logout then log back in before loading the wiki for it to work. </p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6888"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="PeterN&#039;s picture" title="PeterN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by PeterN (not verified) on Sat, 27/10/2012 - 09:09.</div>
    <div class="content">
     <p>Hello again. Hope you can assist me a bit more please I&#39;m a bit stuck.</p>
<p>Getting the following in emoncms &quot;Message: The RFM12 to PI interface script is not running, you may need to configure cron&quot;</p>
<p>&nbsp;Cron file below: I added job (php raspberrypi_run.php) correct I hope???? and reboot</p>
<p># /etc/crontab: system-wide crontab<br />
	# Unlike any other crontab you don&#39;t have to run the `crontab&#39;<br />
	# command to install the new version when you edit this file<br />
	# and files in /etc/cron.d. These files also have username fields,<br />
	# that none of the other crontabs do.</p>
<p>SHELL=/bin/sh<br />
	PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</p>
<p># m h dom mon dow user&nbsp; command<br />
	17 *&nbsp;&nbsp;&nbsp; * * *&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp; cd / &amp;&amp; run-parts --report /etc/cron.hourly<br />
	25 6&nbsp;&nbsp;&nbsp; * * *&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp; test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )<br />
	47 6&nbsp;&nbsp;&nbsp; * * 7&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp; test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )<br />
	52 6&nbsp;&nbsp;&nbsp; 1 * *&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp; test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )<br />
	*/1 * * * * root cd /var/www/emoncms/Modules/raspberrypi &amp;&amp; php raspberrypi_run.php<br />
	#</p>
<p>Also question about&nbsp;base id in emoncms - see screen shot. Is the id given to raspberry pi (RF12 module)</p>
<p>Cheers</p>
<p>Peter</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6890"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Sat, 27/10/2012 - 11:13.</div>
    <div class="content">
     <p>I get that from time to time, yet the INPUTS tab shows data is incomming. Do you have data beinf fed?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6891"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="PeterN&#039;s picture" title="PeterN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by PeterN (not verified) on Sat, 27/10/2012 - 12:39.</div>
    <div class="content">
     <p>Hi Martin,</p>
<p>I can use API help in emoncms&nbsp;&nbsp;using <u><em>Set the input entry time manually</em></u>: to send data ok see screen&nbsp;print attached.</p>
<p>As&nbsp;discusse I am receiving data on minicom ok for two nodes node =10 (emontx) and node =20 (emonglcd) both on group 210. A screen shot minicom is in my earlier post above.</p>
<p>Do I have to customize the file you provided above<em><u> php raspberrypi_run.php</u></em>&nbsp;&nbsp;???&nbsp; OR OTHER fILES</p>
<p>Cheers</p>
<p>Peter</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6892"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Sat, 27/10/2012 - 12:53.</div>
    <div class="content">
     <p>Yes please replace the raspberrypi_run.php with the content as shown above. The original file didn&#39;t work for me well as it was skipping most of the incoming messages. Simply copy/paste the content and save.</p>
<p>&nbsp;</p>
<p>sudo nano /var/www/emoncms/Modules/raspberrypi/raspberrypi_run.php&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6893"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="PeterN&#039;s picture" title="PeterN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by PeterN (not verified) on Sat, 27/10/2012 - 13:03.</div>
    <div class="content">
     <p>I already did this. My question is do I need to customize any part of the file&nbsp;for my nodes or my API key?</p>
<p>Thanks</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6894"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Sat, 27/10/2012 - 13:10.</div>
    <div class="content">
     <p>Great Martin, thanks for the speed improvements and working out the cron&nbsp;setup. I have updated your changes to the raspberrypi_run.php script to the repo. I&#39;ve also updated the wiki documentation with the setup steps.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6895"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Sat, 27/10/2012 - 13:42.</div>
    <div class="content">
     <p>Sorry Peter, I am reading between the lines :(</p>
<p>&nbsp;</p>
<p>No, no need to set-up the API. The raspberrypi_run.php script pulls it out of the database. The script works by just capturing incoming packets from whatever node id. It expects that the node is sending payload of&nbsp;INT values only (no limit in the number of int values). Then it creates an input for that node in the form</p>
<p>node#_@ &nbsp;where # is the id of the remote node and @ is the payload int index. For emonTx we have a structure of this sort:</p>
<p>typedef struct { int power1, power2, power3, battery; } PayloadTX;</p>
<p>so you will receive something like this:</p>
<p>node10_1= power 1 reading</p>
<p>node10_2=power2 reading</p>
<p>node10_3=power3 reading</p>
<p>node10_4=battery</p>
<p>&nbsp;</p>
<p>This is possible because all the values in the payload are ints. This is the part of the code that takes care of it:</p>
<p>$values = explode(&#39; &#39;,$data);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $msubs = &quot;&quot;;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for($i=2; $i&lt;(count($values)-1); $i+=2){<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($i&gt;2) $msubs .= &quot;,&quot;;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $msubs .= $values[$i] + $values[$i+1]*256;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>This approach utilizes the newly introduces CSV multinode&nbsp;concept, where you don&#39;t need to re-program the gateway (nanode or raspberry) with each additional node that you add to your system, as it automatically recognizes it and adds it to the list of inputs. quite neat, but at the cost of expecting only ints as payload. Not that this is a big problem, because lots of readings can be fit in an int. Temperatures multiplied by 100 also fit in int and then in emoncms&nbsp;you simply add a rule to multiply the incomng value by 0.01 to get the actual value.</p>
<p>If you still want to decode the incoming packets and make a good old json post, I have example of that in PHP here:&nbsp;https://github.com/mharizanov/TinySensor/blob/master/PHP_gateway/serial.php</p>
<p>it is pretty easy, and then you can have any type of packet, but will require script modification with the addition of each new node. Still I recommend to use the CSV approach.</p>
<p>Maybe in the future emoncms will support node configuration, where one of the settings will be a string to identify the incoming packet data structure types.</p>
<p>The ID of the RFM2Pi board should be some available number, 25 seems fine. It only matters, if you send packets. That&#39;s useful when you have the EMONGLCD for example, and need to send out the current time. I have example of this in my perl script, but I guess this is something yet to be added to the raspberrypi_run.php</p>
<p>&nbsp;</p>
<p>I hope this helps&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6896"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="PeterN&#039;s picture" title="PeterN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by PeterN (not verified) on Sat, 27/10/2012 - 14:52.</div>
    <div class="content">
     <p>Hi&nbsp;Martin/Trystan. Thanks a mil Martin for detailed explanation, helped a lot. I&#39;ve reinstalled&nbsp;using latest&nbsp;files and followed new instructions&nbsp;published by&nbsp;Trystan.&nbsp;</p>
<p>Making progress, I can now see<u><em> RFM12 to PI interface script is up and running</em></u> in&nbsp;emoncms panel. I have verified again rf12 receiving ok</p>
<p>[RF12demo.Attiny84]</p>
<p>Available commands:<br />
	&nbsp; &lt;nn&gt; i&nbsp;&nbsp;&nbsp;&nbsp; - set node ID (standard node ids are 1..26)<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (or enter an uppercase &#39;A&#39;..&#39;Z&#39; to set id)<br />
	&nbsp; &lt;n&gt; b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - set MHz band (4 = 433, 8 = 868, 9 = 915)<br />
	&nbsp; &lt;nnn&gt; g&nbsp;&nbsp;&nbsp; - set network group (RFM12 only allows 212, 0 = any)<br />
	&nbsp; &lt;n&gt; c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - set collect mode (advanced, normally 0)<br />
	&nbsp; ...,&lt;nn&gt; a - send data packet to node &lt;nn&gt;, with ack<br />
	&nbsp; ...,&lt;nn&gt; s - send data packet to node &lt;nn&gt;, no ack<br />
	&nbsp; &lt;n&gt; l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - turn activity LED on DIG8 on or off<br />
	&nbsp; &lt;n&gt; q&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - set quiet mode (1 = don&#39;t report bad packets)<br />
	Current configuration:<br />
	88 i24 g210 @ 868 MHz<br />
	10 60 0 62 0 14 0 231 101 26 5 60 0<br />
	10 61 0 63 0 11 0 228 101 26 5 60 0<br />
	10 61 0 62 0 17 0 172 101 26 5 61 0</p>
<p>No inputs yet for node10&nbsp;- will keep you posted on progress, thanks again.</p>
<p>Cheers</p>
<p>Peter</p>
<p>P.S. From your post above &quot;No, no need to set-up the API&quot;&nbsp; can you please explain how&nbsp;script knows where to send inputs e.g. in the case were I have numerous registered users and API keys.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6900"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Sat, 27/10/2012 - 16:55.</div>
    <div class="content">
     <p>Lets try couple things:</p>
<p>can you do the following from the console:</p>
<p>$ mysql -u root -p</p>
<p>it will ask for your password, enter the one you used when setting up emoncms.</p>
<p>Then change the database by typing:</p>
<p>mysql&gt; use emoncms;&nbsp; &lt;enter&gt;</p>
<p>next, lets see what users you have in the system, we need the ID:</p>
<pre>
mysql&gt; select id,username from users;
+----+------------+
| id | username   |
+----+------------+
|  1 | mharizanov |
+----+------------+
1 row in set (0.00 sec)</pre><p>lets see what you have in the raspberrypi table:</p>
<p>mysql&gt; select * from raspberrypi;</p>
<pre>

here is what I have:
+--------+----------------------------------+--------+-----------+--------+------------+
| userid | apikey                           | sgroup | frequency | baseid | running    |
+--------+----------------------------------+--------+-----------+--------+------------+
|      1 | 60f8dc0e2323363d32c0ca5707f60b5c |    210 |         8 |     22 | 1351356024 |
+--------+----------------------------------+--------+-----------+--------+------------+
1 row in set (0.00 sec)</pre><p></p>
<p>So for user ID (mharizanov) I do have all that is necessary - api key and settings.</p>
<p>
	can you repeat these steps and post the result? I suspect that if you have more than one user registered, it may be picking the wrong api key.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6902"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="PeterN&#039;s picture" title="PeterN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by PeterN (not verified) on Sat, 27/10/2012 - 18:36.</div>
    <div class="content">
     <p>4Here you go.</p>
<p>mysql&gt; select id,username from users;<br />
	+----+----------+<br />
	| id | username |<br />
	+----+----------+<br />
	|&nbsp; 1 | root&nbsp;&nbsp;&nbsp;&nbsp; |<br />
	|&nbsp; 2 | peter&nbsp;&nbsp;&nbsp; |<br />
	+----+----------+<br />
	2 rows in set (0.00 sec)</p>
<p>mysql&gt; select * from raspberrypi;<br />
	+--------+----------------------------------+--------+-----------+--------+-----&nbsp;-------+<br />
	| userid | apikey&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | sgroup | frequency | baseid | runn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ing&nbsp;&nbsp;&nbsp; |<br />
	+--------+----------------------------------+--------+-----------+--------+-----&nbsp; -------+<br />
	|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 | d92bd75a12b5bb2b567fd339320078d0 |&nbsp;&nbsp;&nbsp; 210 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8 |&nbsp;&nbsp;&nbsp;&nbsp; 24 | 1351&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 360262 |<br />
	+--------+----------------------------------+--------+-----------+--------+-----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
	1 row in set (0.01 sec)</p>
<p>APIKEY above is same as root user in emoncms.</p>
<p>checked script was now updated version&nbsp;using&nbsp;&nbsp;sudo nano /var/www/emoncms/Modules/raspberrypi $ sudo nano raspberrypi_run.php - looks same.</p>
<p>I added second user peter to try something,&nbsp;I was&nbsp;not receiving input data before either.</p>
<p>Cheers</p>
<p>Peter</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6903"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Sat, 27/10/2012 - 18:45.</div>
    <div class="content">
     <p>ok from what you post, yser &#39;root&#39; should be seeing inputs.</p>
<p>I am slowly running out of ideas what could be wrong, one more thing to try direct output from the rasperrypi_run.php:</p>
<p>can you please do the following:</p>
<p>cd &nbsp;/var/www/emoncms/Modules/raspberrypi/</p>
<p>php raspberrypi_run.php</p>
<p>let it run for a minute then copy/paste the output. You may get &quot;already running&quot;, which will make the puzzle even more puzzling :)</p>
<p>I get this:</p>
<pre>
pi@raspberrypi ~ $ cd  /var/www/emoncms/Modules/raspberrypi/
pi@raspberrypi /var/www/emoncms/Modules/raspberrypi $ php raspberrypi_run.php
SERIAL RX:&gt; 22i
SERIAL RX:&gt; 8b
SERIAL RX:&gt; 210g
SERIAL RX: 10 146 2 191 2 249 0 93 0 73 163 52 64
658,703,249,93,41801,16436
SERIAL RX: 10 147 2 190 2 249 0 93 0 192 234 51 64
659,702,249,93,60096,16435</pre><p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6904"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="PeterN&#039;s picture" title="PeterN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by PeterN (not verified) on Sat, 27/10/2012 - 19:02.</div>
    <div class="content">
     <p>Here you go</p>
<p>Thanks</p>
<p>Peter</p>
<p>pi@raspberrypi /var/www/emoncms/Modules/raspberrypi $ php raspberrypi_run.php</p>
<p>PHP Warning:&nbsp; fopen(): Unable to find the wrapper &quot;dio.serial&quot; - did you forget to enable it when you configured PHP? in /var/www/emoncms/Modules/raspberrypi/raspberrypi_run.php on line 54</p>
<p>PHP Warning:&nbsp; fopen(dio.serial:///dev/ttyAMA0): failed to open stream: No such file or directory in /var/www/emoncms/Modules/raspberrypi/raspberrypi_run.php on line 54</p>
<p>PHP Warning:&nbsp; fclose() expects parameter 1 to be resource,<br />
	boolean given in /var/www/emoncms/Modules/raspberrypi/raspberrypi_run.php on line 105</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6905"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="PeterN&#039;s picture" title="PeterN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by PeterN (not verified) on Sat, 27/10/2012 - 19:40.</div>
    <div class="content">
     <p>Hi Martin,</p>
<p>Thanks a mil, learned loads and its now working thanks to your great effort, much appreciated.</p>
<p>Here&#39;s the printouts you requested which pointed to mistake I made.</p>
<p class="rteindent1">pi@raspberrypi /var/www/emoncms/Modules/raspberrypi $ php raspberrypi_run.php</p>
<p class="rteindent1">PHP Warning: fopen(): Unable to find the wrapper &quot;dio.serial&quot; - did you forget to enable it when you configured PHP? in /var/www/emoncms/Modules/raspberrypi/raspberrypi_run.php on line 54</p>
<p class="rteindent1">PHP Warning: fopen(dio.serial:///dev/ttyAMA0): failed to open stream: No such file or directory in /var/www/emoncms/Modules/raspberrypi/raspberrypi_run.php on line 54</p>
<p class="rteindent1">PHP Warning: fclose() expects parameter 1 to be resource,<br />
	boolean given in /var/www/emoncms/Modules/raspberrypi/raspberrypi_run.php on line 105</p>
<p>My mistake due to inexperience was in process: <a href="http://wiki.openenergymonitor.org/index.php?title=Raspberry_Pi" title="http://wiki.openenergymonitor.org/index.php?title=Raspberry_Pi">http://wiki.openenergymonitor.org/index.php?title=Raspberry_Pi</a></p>
<p>Step 3 $ sudo nano /etc/php5/cli/php.ini add extension=dio.so to file in the beginning of the ;Dynamic Extensions; section on line 843 [Ctrl+X] then [y] then [Enter] to save and exit</p>
<p>I placed code as described but never removed &quot;;&quot; obvious to a programmer but I thought about it and decided to leave &quot;;&quot; for some reason. &quot;;&quot; now removed and it&#39;s working now.</p>
<p>&nbsp;</p>
<p>Peter</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6906"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Sat, 27/10/2012 - 19:29.</div>
    <div class="content">
     <p>gotcha :)</p>
<p>the PHP serial library isn&#39;t installed. Carefully follow this:</p>
<pre>
Install serial PHP libraries
$ sudo apt-get install php-pear php5-dev
$ sudo pecl install channel://pecl.php.net/dio-0.0.6
$ sudo nano /etc/php5/cli/php.ini add extension=dio.so to file in the beginning of the ;Dynamic Extensions; section on line 843 [Ctrl+X] then [y] then [Enter] to save and exit
Restart apache $ sudo /etc/init.d/apache2 restart</pre>         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6910"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/885.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="logic&#039;s picture" title="logic&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/885.html" title="View user profile.">logic</a> on Sun, 28/10/2012 - 01:08.</div>
    <div class="content">
     <p>I&#39;ve been working through this again tonight and I cannot get the script to run - Message: The RFM12 to PI interface script is not running, you may need to configure cron</p>
<p>
	What I have done is reinstalled Modular emoncms &amp; raspberrypi.</p>
<p>Added the line */1 * * * * root cd /var/www/emoncms/Modules/raspberrypi &amp;&amp; php raspberrypi_run.php at the end of crontab</p>
<p>Minicom is showing nodes and data which looks ok.</p>
<p>I have set the RaspberryPI and emoncms to the same BaseID, frequency and group etc.</p>
<p>
	When I follow the above thread advice, when I get to the bit where I type mysql&gt; select * from raspberrypi;, then the last box &#39;Running&#39; displays NULL (everything else looks as it should).</p>
<p>Any idea&#39;s what I&#39;ve missed/where I&#39;ve gone worng?</p>
<p>Thanks</p>
<p>Dennis</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6911"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="PeterN&#039;s picture" title="PeterN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by PeterN (not verified) on Sun, 28/10/2012 - 12:26.</div>
    <div class="content">
     <p>&nbsp;</p>
<p>Hi Martin, Like I said in above post , when I removed the &nbsp;; from start of&nbsp;code line 843 in php5/cli/php.ini, it started to work e.g. receiving input data from RF12 to emoncms.</p>
<p>Anyway I followed your instructions above and here is results.</p>
<p>See comments below:<br />
	Install serial PHP libraries<br />
	$ sudo apt-get install php-pear php5-dev<br />
	result<br />
	Reading package lists... Done<br />
	Building dependency tree<br />
	Reading state information... Done<br />
	php-pear is already the newest version.<br />
	php5-dev is already the newest version.<br />
	0 upgraded, 0 newly installed, 0 to remove and 55 not upgraded.</p>
<p>$ sudo pecl install channel://pecl.php.net/dio-0.0.6<br />
	result:<br />
	pecl/dio is already installed and is the same as the released version 0.0.6<br />
	install failed</p>
<p>Checkek below and already complete<br />
	$ sudo nano /etc/php5/cli/php.ini add extension=dio.so to file in the beginning of the ;Dynamic Extensions; section on line 843 [Ctrl+X] then [y] then [Enter] to save and exit</p>
<p>Restart apache $ sudo /etc/init.d/apache2 restart<br />
	result<br />
	[....] Restarting web server: apache2apache2: Could not reliably determine the server&#39;s fully qualified domain name, using 127.0.1.1 for ServerName<br />
	... waiting apache2: Could not reliably determine the server&#39;s fully qualified domain name, using 127.0.1.1 for ServerName<br />
	. ok</p>
<p>Then checked script:</p>
<p>pi@raspberrypi /var/www/emoncms/Modules/raspberrypi $ php raspberrypi_run.php<br />
	Already running</p>
<p>&nbsp;</p>
<p>Note that RF12 is&nbsp;still sending input data to emoncms.</p>
<p>Cheers</p>
<p>Peter</p>
<p>&nbsp;</p>
<p>
	&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6912"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="PeterN&#039;s picture" title="PeterN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by PeterN (not verified) on Sun, 28/10/2012 - 12:33.</div>
    <div class="content">
     <p>&nbsp;</p>
<p>Cheers</p>
<p>Peter</p>
<p>&nbsp;</p>
<p>
	&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6913"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Sun, 28/10/2012 - 04:44.</div>
    <div class="content">
     <p>Dennis, looks like the raspberrypi_run.php is not being run for some reason.</p>
<p>&nbsp;</p>
<p>Lets try the same as we did for Peter: can you please do the following:</p>
<p>&nbsp;</p>
<p>cd&nbsp; /var/www/emoncms/Modules/raspberrypi/</p>
<p>php raspberrypi_run.php</p>
<p>let it run for a minute then copy/paste the output.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6914"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/885.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="logic&#039;s picture" title="logic&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/885.html" title="View user profile.">logic</a> on Sun, 28/10/2012 - 09:22.</div>
    <div class="content">
     <p>Thanks Martin</p>
<p>&nbsp;</p>
<p>I ran the file and here is the result:</p>
<p>pi@raspberrypi /var/www/emoncms/Modules/raspberrypi $ php raspberrypi_run.php<br />
	SERIAL RX: 10 38 1 78 0 0 0 62 94 13 4 195 6 2 11 184 13 3 14 240 10 134 13 146 10 74 0<br />
	294,78,0,24126,1037,1731,2818,3512,3587,2800,3462,2706,74<br />
	SERIAL RX:&gt; 16i<br />
	SERIAL RX: 10 40 1 76 0 0 0 57 94 13 4 195 6 2 11 184 13 3 14 240 10 134 13 146 10 73 0<br />
	296,76,0,24121,1037,1731,2818,3512,3587,2800,3462,2706,73<br />
	SERIAL RX:&gt; 4b<br />
	SERIAL RX: 10 30 1 76 0 0 0 57 94 13 4 195 6 2 11 184 13 3 14 240 10 134 13 146 10 72 0<br />
	286,76,0,24121,1037,1731,2818,3512,3587,2800,3462,2706,72<br />
	SERIAL RX: 20 152 6 9 0<br />
	1688,9<br />
	SERIAL RX:&gt; 210g<br />
	SERIAL RX: 10 29 1 82 0 0 0 29 94 13 4 195 6 2 11 184 13 3 14 240 10 134 13 146 10 72 0<br />
	285,82,0,24093,1037,1731,2818,3512,3587,2800,3462,2706,72<br />
	SERIAL RX: 10 31 1 79 0 0 0 33 94 13 4 195 6 2 11 184 13 3 14 240 10 134 13 146 10 72 0<br />
	287,79,0,24097,1037,1731,2818,3512,3587,2800,3462,2706,72<br />
	SERIAL RX: 10 35 1 83 0 0 0 45 94 13 4 195 6 2 11 184 13 3 14 240 10 134 13 146 10 72 0<br />
	291,83,0,24109,1037,1731,2818,3512,3587,2800,3462,2706,72<br />
	SERIAL RX: 10 33 1 79 0 0 0 17 94 13 4 195 6 2 11 184 13 3 14 240 10 134 13 146 10 73 0<br />
	289,79,0,24081,1037,1731,2818,3512,3587,2800,3462,2706,73<br />
	SERIAL RX: 10 34 1 79 0 0 0 26 94 13 4 195 6 2 11 184 13 3 14 240 10 134 13 146 10 72 0<br />
	290,79,0,24090,1037,1731,2818,3512,3587,2800,3462,2706,72</p>
<p>&nbsp;</p>
<p>Dennis</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6917"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Mon, 29/10/2012 - 06:28.</div>
    <div class="content">
     <p>hmm it looks exactly as it should.&nbsp;</p>
<p>&nbsp;</p>
<p>Can you edit the raspberrypi_run.php to add the text in bold. That will print out the POST string and maybe it will ring a bell:</p>
<p>&nbsp;</p>
<p>cd&nbsp; /var/www/emoncms/Modules/raspberrypi/</p>
<p>sudo nano raspberrypi_run.php</p>
<p>&nbsp;</p>
<p><strike>dnf </strike>then scroll to find this function:</p>
<pre>
function getcontent($server, $port, $file)
{
   $cont = &quot;&quot;;
   $ip = gethostbyname($server);
   $fp = fsockopen($ip, $port);
   if (!$fp)
   {
       return &quot;Unknown&quot;;
   }
   else
   {
       <em><u><strong>echo $ip . &quot;:&quot; . $port . $file . &quot;\n&quot;;</strong></u></em></pre><p>&nbsp;</p>
<p>Add the text in bold, underlined.</p>
<p>&nbsp;</p>
<p>Then run the raspberrypi_run.php to see what it outputs. Try the address that it outputs in your laptop browser, just replace 127.0.0.1 with whatever IP address your PI has and report what happens</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6918"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/885.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="logic&#039;s picture" title="logic&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/885.html" title="View user profile.">logic</a> on Sun, 28/10/2012 - 17:04.</div>
    <div class="content">
     <p>I&#39;m on my mobile just now so will have to try this a bit later, but to ensure I do it right can I as what you mean by &#39;dnf&#39; then scroll to find this function:?</p>
<p>On raspberry boot up I have seen reference to 127.0.0.1, but where exactly to I change this?</p>
<p>Sorry if this is simple questions but I&#39;ve just recovered from hours of fixing my networking after setting up auto wlan login (not much fun!), so I just want to be sure....</p>
<p>thanks again</p>
<p>Dennis</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6919"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Sun, 28/10/2012 - 18:29.</div>
    <div class="content">
     <p>sorry the &#39;dnf&#39; was unintentional, probably copy/paste thing, ignore it.</p>
<p>What I meant is that the raspberry will print out a message like this &quot;127.0.0.1:80/emoncms/............&quot; so in order to test that this works, you will have to replace the 127.0.0.1 with the IP of the Raspberry as 127.0.0.1 is a loopback IP address and you can&#39;t see that from another computer. The idea was to simulate a data post.</p>
<p>No problem just to let me know what the script outputs, we will try figure it out and you don&#39;t have tow worry about the 127.0.0.1</p>
<p>I very much wanted to release my SD card image to make it easier for all, but I am having one heck of a time to save it, I get some weird errors</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6923"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/885.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="logic&#039;s picture" title="logic&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/885.html" title="View user profile.">logic</a> on Sun, 28/10/2012 - 21:13.</div>
    <div class="content">
     <p>I&#39;ve added that line and below is what is on screen:</p>
<p>&nbsp;</p>
<p>pi@raspberrypi /var/www/emoncms/Modules/raspberrypi $ php raspberrypi_run.php<br />
	SERIAL RX:&gt; 16i<br />
	SERIAL RX:&gt; 4b<br />
	SERIAL RX:&gt; 210g<br />
	SERIAL RX: 10 50 2 0 0 0 0 138 93 219 2 108 7 196 10 28 13 209 12 29 17 87 25 171 11 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8 0<br />
	562,0,0,23946,731,1900,2756,3356,3281,4381,6487,2987,88<br />
	127.0.0.1:80/emoncms/input/post?apikey=6001ab5423cf985b5f1e3d151d904b08&amp;node=10&amp;csv=56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2,0,0,23946,731,1900,2756,3356,3281,4381,6487,2987,88<br />
	SERIAL RX: 10 71 11 0 0 0 0 182 92 219 2 108 7 196 10 28 13 209 12 29 17 87 25 171 11 93 0<br />
	2887,0,0,23734,731,1900,2756,3356,3281,4381,6487,2987,93<br />
	127.0.0.1:80/emoncms/input/post?apikey=6001ab5423cf985b5f1e3d151d904b08&amp;node=10&amp;csv=2887,0,0,23734,731,1900,2756,3356,3281,4381,6487,2987,93<br />
	SERIAL RX: 10 3 11 0 0 0 0 161 92 219 2 108 7 196 10 28 13 209 12 29 17 87 25 171 11 95 0<br />
	2819,0,0,23713,731,1900,2756,3356,3281,4381,6487,2987,95<br />
	127.0.0.1:80/emoncms/input/post?apikey=6001ab5423cf985b5f1e3d151d904b08&amp;node=10&amp;csv=2819,0,0,23713,731,1900,2756,3356,3281,4381,6487,2987,95<br />
	SERIAL RX: 10 189 10 0 0 0 0 7 93 219 2 114 7 196 10 28 13 203 12 60 17 131 25 184 11 94 0<br />
	2749,0,0,23815,731,1906,2756,3356,3275,4412,6531,3000,94<br />
	127.0.0.1:80/emoncms/input/post?apikey=6001ab5423cf985b5f1e3d151d904b08&amp;node=10&amp;csv=2749,0,0,23815,731,1906,2756,3356,3275,4412,6531,3000,94</p>
<p>&nbsp;</p>
<p>Hopefully this will give some tell tale info?</p>
<p>&nbsp;</p>
<p>Thanks</p>
<p>Dennis</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6924"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/885.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="logic&#039;s picture" title="logic&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/885.html" title="View user profile.">logic</a> on Sun, 28/10/2012 - 21:50.</div>
    <div class="content">
     <p>Everything now appears to be working, and the usual typo was to blame.</p>
<p>Up until a few minutes ago I was manually typing everything into the raspberrypi&nbsp;via Putty, but I&#39;ve just figured how to copy/paste (simple, but true...).</p>
<p>I had missed several spaces in the line - &nbsp;*/1 * * * * root cd /var/www/emoncms/Modules/raspberrypi &amp;&amp; php raspberrypi_run.php</p>
<p>Once this was corrected, all is now working correctly.</p>
<p>&nbsp;</p>
<p>I&#39;m sorry for your troubles, and thank you very much once again for helping me.</p>
<p>Dennis</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6926"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/885.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="logic&#039;s picture" title="logic&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/885.html" title="View user profile.">logic</a> on Mon, 29/10/2012 - 00:58.</div>
    <div class="content">
     <p>Now when I&#39;m trying to setup feeds from the inputs I only have an option to select the process, and I have no options for the argument or actions. &nbsp;The attached screenshot should explain.</p>
<p>&nbsp;I&#39;m sure it&#39;ll probably be something simple, but I really cannot figure it. &nbsp;Any idea&#39;s.</p>
<p>&nbsp;</p>
<p>EDIT: Figured it out - it&#39;s different from the online emoncms as you need to setup inputs with&nbsp;http://IPADDRESS/emoncms/input/process/add?inputid=1&amp;type=1&amp;arg=-1&amp;arg2=power. &nbsp;</p>
<p>&nbsp;</p>
<p>Thanks</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6927"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="PeterN&#039;s picture" title="PeterN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by PeterN (not verified) on Sun, 28/10/2012 - 23:42.</div>
    <div class="content">
     <p>Hi, Dispite&nbsp;getting&nbsp;RPi working above with the help of Martin,&nbsp;I decided to&nbsp;begin fresh install&nbsp;equipped with my new gained knowledge. Followed Documentation for rm12pi <u><em>http://wiki.openenergymonitor.org/index.php?title=Raspberry_Pi</em> </u>and using Martin Harizanov&#39;s RFM12B module I got my&nbsp;Raspberry pi&nbsp;&nbsp;working with two modules (emontx and emonglcd).</p>
<p>Great work guys.</p>
<p>Cheers</p>
<p>Peter</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6928"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="PeterN&#039;s picture" title="PeterN&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by PeterN (not verified) on Mon, 29/10/2012 - 10:01.</div>
    <div class="content">
     <p>Hi, Getting some very unusual behavior on inputs. I&#39;ve started getting input data for many different nodes with node1_x, nodes2_x and CSV. I have attached PDF.&nbsp; minicom -b 9600 -o -D /dev/ttyAMA0 seems very slow and doesn&#39;t reflect inputs received as attached.</p>
<p>Cheers</p>
<p>Peter</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6930"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/380.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-380.jpg" alt="mharizanov&#039;s picture" title="mharizanov&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/380.html" title="View user profile.">mharizanov</a> on Mon, 29/10/2012 - 12:37.</div>
    <div class="content">
     <p>Yes, I noticed that myself. It happens when the PHP tryis to interpret the help messages that are shown then the RFM2Pi board starts up.</p>
<p>&nbsp;</p>
<p>Here is a fix, just look up that section in the code in raspberrypi_run.php and replace:</p>
<p>&nbsp;</p>
<p>if ($data[0]!=&quot;&gt;&quot;)<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $values = explode(&#39; &#39;,$data);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($values &amp;&amp; is_numeric($values[1]))<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $msubs = &quot;&quot;;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for($i=2; $i&lt;(count($values)-1); $i+=2){<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($i&gt;2) $msubs .= &quot;,&quot;;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $msubs .= $values[$i] + $values[$i+1]*256;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo $msubs.&quot;\n&quot;;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $url = &quot;/emoncms/input/post?apikey=&quot;.$apikey.&quot;&amp;node=&quot;.$values[1].&quot;&amp;csv=&quot;.$msubs;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; getcontent(&quot;localhost&quot;,80,$url);<br />
	&nbsp;&nbsp;<strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</strong><br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;</p>
<p>Then remove the &#39;dirty&#39; inputs by deleting them in the INPUTS tab.</p>
<p>Glyn, Trystan: can you also fix this on&nbsp;Github?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6939"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/885.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="logic&#039;s picture" title="logic&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/885.html" title="View user profile.">logic</a> on Mon, 29/10/2012 - 21:41.</div>
    <div class="content">
     <p>Ok, I&#39;ve broke it!</p>
<p>As I was having similar problems to above then I updated the raspberrypi_run.php but now nothing works again. &nbsp;I&#39;ve tried working through the checks as above and it will not run php&nbsp;raspberrypi_run.php. &nbsp;It displays:</p>
<p>pi@raspberrypi /var/www/emoncms/Modules/raspberrypi $ php raspberrypi_run.php<br />
	PHP Parse error:&nbsp; syntax error, unexpected end of file in /var/www/emoncms/Modules/raspberrypi/raspberrypi_run.php on line 133</p>
<p>&nbsp;</p>
<p>Below is a copy/paste of the section in raspberrypi_run.php, incase I have done something silly:</p>
<p>{<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &quot;SERIAL RX:&quot;.$data;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($data[0]!=&quot;&gt;&quot;)<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $values = explode(&#39; &#39;,$data);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($values &amp;&amp; is_numeric($values[1]))<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $msubs = &quot;&quot;;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for($i=2; $i&lt;(count($values)-1); $i+=2){<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ($i&gt;2) $msubs .= &quot;,&quot;;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $msubs .= $values[$i] + $values[$i+1]*256;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo $msubs.&quot;\n&quot;;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $url = &quot;/emoncms/input/post?apikey=&quot;.$apikey.&quot;&amp;node=&quot;.$values[1].&quot;&amp;csv=&quot;.$msubs;<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; getcontent(&quot;localhost&quot;,80,$url);<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp; }<br />
	&nbsp; }<br />
	&nbsp; fclose($f);</p>
<p>&nbsp;</p>
<p>Any idea&#39;s?</p>
<p>&nbsp;</p>
<p>Also when something is updated in github/emoncms, how do we do an update on the RaspberryPI?</p>
<p>&nbsp;</p>
<p>Dennis</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6941"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 29/10/2012 - 23:30.</div>
    <div class="content">
     <p>Unbalanced parentheses!&nbsp; Either one too many closing, or a missing opening, but I don&#39;t know which or where.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6951"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Tue, 30/10/2012 - 18:43.</div>
    <div class="content">
     <p>Hello all, thanks Martin, just uploaded your fix.</p>
<p>Dennis I think you might &nbsp;one additional } before fclose($f).</p>
<p>PS: wrote a bit of info on the new modular&nbsp;emoncms&nbsp;version in the blog today which hopefully gives a bit more context and detail on the changes.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-6957"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/885.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="logic&#039;s picture" title="logic&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: emoncms onto RaspberryPI</h3>

    <div class="submitted">Submitted by <a href="../user/885.html" title="View user profile.">logic</a> on Tue, 30/10/2012 - 21:50.</div>
    <div class="content">
     <p>Thanks for that</p>
<p>&nbsp;</p>
<p>I manually copy/pasted the updated git&nbsp;changes and it now works again. &nbsp;When I figures how to &#39;git pull&#39; I got the below:</p>
<p>pi@raspberrypi /var/www/emoncms/Modules/raspberrypi $ git pull<br />
	Updating 28dcdc3..2937e12<br />
	error: Your local changes to the following files would be overwritten by merge:<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; raspberrypi_run.php<br />
	Please, commit your changes or stash them before you can merge.<br />
	Aborting<br />
	pi@raspberrypi /var/www/emoncms/Modules/raspberrypi $</p>
<p>&nbsp;</p>
<p>I assume this was because I had done a manual update, but is there an easy way to get it back able to update via git pull?</p>
<p>Many thanks again to all who have helped me.</p>
<p>&nbsp;</p>
<p>Dennis</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/1236"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-agjuJwDr_hBjhbOpV3aVMAOK6kBiRdxh-3kLknLJgs8" value="form-agjuJwDr_hBjhbOpV3aVMAOK6kBiRdxh-3kLknLJgs8"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
