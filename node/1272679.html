<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Emoncms overview | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/emon/sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="/emon/modules/node/node.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/defaults.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/system.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/system/system-menus.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/user/user.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/modules/mollom/mollom.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/forum/forum.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/modules/views/css/views.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/modules/comment/comment.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="/emon/sites/all/themes/emon3/style.css?r" />
<style type="text/css" media="all">@import "/emon/sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="/emon/" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="/emon/">Home</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
          <span class="submitted"></span>
      <div class="taxonomy"></div>
      <div class="content"><h2>Archived page - for new setup overview see <a href="http://openenergymonitor.org/emon/node/339">home energy monitor build</a>&nbsp;step 5</h2>
<h2>Emoncms overview</h2>
<h2>Create an account</h2>
<p>Emoncms has multi-user functionality built in, so the first step after installation is to create/register your account via the GUI.</p>
<p><a href="http://openenergymonitor.org/emon/sites/default/files/register_emoncms.png"><img width="450" height="284" alt="" src="http://openenergymonitor.org/emon/sites/default/files/register_emoncms.png" /></a></p>
<h2>Inputs, input processing and feeds</h2>
<p>There are 3 parts to the flow of sensing data in emoncms. Rather than just log incoming data straight away, the idea is to have the option to process this input data as it comes in and then log/store it.&nbsp;</p>
<ol>
<li>Inputs</li>
<li>Input processing</li>
<li>Feeds</li>
</ol>
<p>At the moment using input processing you can:</p>
<ul>
<li>Multiply the input by a scalar</li>
<li>Add an offset</li>
<li>Multiply the input with another input</li>
<li>log the input to a feed</li>
<li>convert a power input to kwh per day and log to a feed</li>
<li>convert a kwh increment to kwh per day&nbsp;<br />
    <meta http-equiv="content-type" content="text/html; charset=utf-8">and log to a feed                                                                      </meta>
    </li>
<li>count the length of time an input is 1 or 0 per day (useful for counting the length of time a solar HW pump is on for)</li>
<li>convert accumulated kwh updates to kwh per day and log to a feed</li>
</ul>
<p>See full input processing descriptions <a href="http://openenergymonitor.org/emon/node/297">here</a>.</p>
<h3>1)&nbsp;Sending a JSON string</h3>
<p>The first step is to send some data to emoncms, this is done by sending a HTTP request with the data in the url to the emoncms API. For example:</p>
<pre>
emoncms/api/post?apikey=YOURAPIKEY&amp;json={power:200.2}</pre><p>The data needs to be sent in json form with a tag for the variable you want to send and the variable value, for example: {testA:200} or 2 variables {testA:200,testB:400} and so on for as many variables as you want to send.</p>
<p><strong>You also need to include your apikey</strong> that can be found at the top of your feeds page.</p>
<p>Try copying the example URL at the top of the feeds page into your browser to see this stage in action.</p>
<p><a href="http://openenergymonitor.org/emon/sites/default/files/feeds01.png"><img width="600" height="216" alt="" src="http://openenergymonitor.org/emon/sites/default/files/feed_part1.png" /></a></p>
<h3>2) The variables should now appear in inputs:</h3>
<p><a href="http://openenergymonitor.org/emon/sites/default/files/feed_part2.png"><img width="600" height="186" alt="" src="http://openenergymonitor.org/emon/sites/default/files/feed_part2.png" /></a></p>
<h3>3) Click on the arrow to bring up the input configuration box.</h3>
<p>Lets create a log of the input (a feed). Click on the drop down menu and select log and in the arg edit box enter a name for the log you would like to create. Then click add.</p>
<p><a href="http://openenergymonitor.org/emon/sites/default/files/feed_part3.png"><img width="600" height="153" alt="" src="http://openenergymonitor.org/emon/sites/default/files/feed_part3.png" /></a></p>
<h3>4) The feed should now appear in the feeds list and the data will be logging.</h3>
<p><a href="http://openenergymonitor.org/emon/sites/default/files/feed_part4.png"><img width="600" height="156" alt="" src="http://openenergymonitor.org/emon/sites/default/files/feed_part4.png" /><br />
</a></p>
<h3>5) Standard Visualisations</h3>
<p>Once you have been logging for a little while, click on the drop down menu to see your feed visualised. The following options are available:</p>
<p>
<meta content="text/html; charset=utf-8" http-equiv="content-type">            </meta>
</p>
<div style="border-collapse: collapse; font-family: arial,sans-serif; font-size: 13px;"><strong>Raw data</strong> = level of detail, for viewing really large datasets (power data over long windows of time)</div>
<div style="border-collapse: collapse; font-family: arial,sans-serif; font-size: 13px;"><strong>Bar graph</strong></div>
<div style="border-collapse: collapse; font-family: arial,sans-serif; font-size: 13px;"><strong>realtime</strong> = the graph auto updates every 5s so that you can watch data coming in!</div>
<p><a href="http://openenergymonitor.org/emon/sites/default/files/bargraph.png"><img width="297" height="350" alt="" src="http://openenergymonitor.org/emon/sites/default/files/bargraph.png" /></a><a href="http://openenergymonitor.org/emon/sites/default/files/feedgraph01.png"><img width="281" hspace="10" height="350" alt="" src="http://openenergymonitor.org/emon/sites/default/files/feedgraph01.png" /></a></p>
<p>These visualisations can also be embedded outside of emoncms using the embedd link.</p>
<h3>6) Get at your data for external use via the API using the following API call:</h3>
<pre>
emoncms/api/getfeed?apikey=YOURAPIKEY&amp;feedid= &amp;start= &amp;end= &amp;resolution=<b><br /></b></pre></div>
    
    
      </div>
<div id="comments">
  <div class="indented"><a id="comment-1780"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Guest&#039;s picture" title="Guest&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms overview</h3>

    <div class="submitted">Submitted by Guest (not verified) on Wed, 18/05/2011 - 21:09.</div>
    <div class="content">
     <p>excellent, but not the epoch time I hope :-)</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-1781"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Guest&#039;s picture" title="Guest&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms overview</h3>

    <div class="submitted">Submitted by Guest (not verified) on Wed, 18/05/2011 - 21:11.</div>
    <div class="content">
     <p>you're quicker than Lucky luck :-)</p>
<p>I will try it first thing tomorrow with some feedback.</p>
<p>Wim.</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-1782"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms overview</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3" title="View user profile.">TrystanLea</a> on Wed, 18/05/2011 - 21:18.</div>
    <div class="content">
     <p>No problem, I guess it is epoch time right: php function time(). Let me know if you have better ideas, i dont have strong preferences.</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-1791"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Guest&#039;s picture" title="Guest&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms overview</h3>

    <div class="submitted">Submitted by Guest (not verified) on Sun, 22/05/2011 - 16:18.</div>
    <div class="content">
     <p>Hello Trystan,</p>
<p>I've made some test graphs in jpgraph (php). It works like a charm.</p>
<p>But, I thing there is a small bug in emoncms.<br />
When I load 1 record via post.php (with a time in the json string), the record is double in the table feed_1. So it must be inserted twice. I tested it a couple of times but always double in the feed_1 table.</p>
<p>Any idea ?</p>
<p>Thanks a lot,<br />
Wim</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-1784"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Guest&#039;s picture" title="Guest&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms overview</h3>

    <div class="submitted">Submitted by Guest (not verified) on Thu, 19/05/2011 - 17:38.</div>
    <div class="content">
     <p>Hello Trystan.</p>
<p>The time enhancement works like a charm (loaded 3600 records (more than 5 months power data)).</p>
<p>I would like to ask for some enhancement requests:</p>
<p>1. when viewing in kwhd, you can't select 1 week, 1 month ... You always see everything, whats not clarifying on the graph (if data for several months). Is it possible to forsee this ?</p>
<p>I now use a commercial energy product (energy-lens). Very good, but from excel. </p>
<p>The purpose of my energy monitor is:</p>
<p>2. trend and forecast analyse, therefor I need to compare weeks and months (even years)> Graphs per month and weeks (consumed kwh) should be great.</p>
<p>3. look for defect machines (leaking electricity) and therefor I compare the average kwh/h for month (so fe. a graph with avg kwh/h for januari, avg kwh/h for febr...).</p>
<p>I think in sql it is not difficult for these data to group and order, but I don't know the application to show it (ajax?)</p>
<p>Is it something you also see the benefit in ?</p>
<p>Wim.</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-1822"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms overview</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3" title="View user profile.">TrystanLea</a> on Mon, 06/06/2011 - 10:27.</div>
    <div class="content">
     <p>Good ideas for features.</p>
<p>Viewing kWh/d in different time windows is definetly one that I would like to do soon. I will create a future features list above so that we can keep a note of these.</p>
<p>Trystan</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
</div></div></div></div></div></div><a id="comment-1763"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Guest&#039;s picture" title="Guest&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms overview</h3>

    <div class="submitted">Submitted by Guest (not verified) on Tue, 17/05/2011 - 20:53.</div>
    <div class="content">
     <p>hello,</p>
<p>I try to install the lastest emoncms version.<br />
setup (tables) are ok<br />
When I try to insert a feed (with the correct apikey), I get the following error:<br />
Undefined variable: title in C:\wamp\www\emoncms\theme\theme.php on line 38</p>
<p>( ! ) Notice: Undefined variable: title in C:\wamp\www\emoncms\theme\theme.php on line 38</p>
<p>Call Stack</p>
<p>#</p>
<p>Time</p>
<p>Memory</p>
<p>Function</p>
<p>Location</p>
<p>1</p>
<p>0.0029</p>
<p>388472</p>
<p>{main}( )</p>
<p>..\index.php:0</p>
<p>2</p>
<p>0.0190</p>
<p>442576</p>
<p>theme_render_template( )</p>
<p>..\index.php:83</p>
<p>3</p>
<p>0.0204</p>
<p>490568</p>
<p>include( 'C:\wamp\www\emoncms\theme\theme.php' )</p>
<p>..\index.php:89</p>
<p>( ! ) Notice: Undefined variable: content in C:\wamp\www\emoncms\theme\theme.php on line 39</p>
<p>Call Stack</p>
<p>#</p>
<p>Time</p>
<p>Memory</p>
<p>Function</p>
<p>Location</p>
<p>1</p>
<p>0.0029</p>
<p>388472</p>
<p>{main}( )</p>
<p>..\index.php:0</p>
<p>2</p>
<p>0.0190</p>
<p>442576</p>
<p>theme_render_template( )</p>
<p>..\index.php:83</p>
<p>3</p>
<p>0.0204</p>
<p>490568</p>
<p>include( 'C:\wamp\www\emoncms\theme\theme.php' )</p>
<p>..\index.php:89</p>
<p>I can't figure out why.</p>
<p>ANy idea ?</p>
<p>PS: please keep up the fantastic work</p>
<p>THanks,<br />
Wim</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-1764"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms overview</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3" title="View user profile.">TrystanLea</a> on Tue, 17/05/2011 - 21:55.</div>
    <div class="content">
     <p>Hello Wim, just so I can be clear do you get this error when you call the emoncms/api/post.php script? or when you are on the emoncms feeds page? Thanks Trystan</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-1770"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/default_0.png" alt="Guest&#039;s picture" title="Guest&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms overview</h3>

    <div class="submitted">Submitted by Guest (not verified) on Wed, 18/05/2011 - 18:01.</div>
    <div class="content">
     <p>when I try your link : <a href="http://localhost/emoncms/api/post.php" title="http://localhost/emoncms/api/post.php">http://localhost/emoncms/api/post.php</a></p>
<p>I just get the string "crap"</p>
<p>Thanks</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
<div class="indented"><a id="comment-1773"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="/emon/user/3" title="View user profile."><img src="http://openenergymonitor.org/emon/sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Emoncms overview</h3>

    <div class="submitted">Submitted by <a href="/emon/user/3" title="View user profile.">TrystanLea</a> on Wed, 18/05/2011 - 19:46.</div>
    <div class="content">
     <p>&nbsp;Sure, it will need a correct api key before it gives an ok. Which reminds me I should change the word 'crap' for something more suitable.</p>
         </div>
    <div class="links">&raquo; </div>
  </div>
</div></div></div><div class="item-list"><ul class="pager"><li class="pager-first first"><a href="/emon/node/127" title="Go to first page" class="active">« first</a></li>
<li class="pager-previous"><a href="/emon/node/127" title="Go to previous page" class="active">‹ previous</a></li>
<li class="pager-item"><a href="/emon/node/127" title="Go to page 1" class="active">1</a></li>
<li class="pager-current">2</li>
<li class="pager-item"><a href="/emon/node/127?page=2" title="Go to page 3" class="active">3</a></li>
<li class="pager-item"><a href="/emon/node/127?page=3" title="Go to page 4" class="active">4</a></li>
<li class="pager-next"><a href="/emon/node/127?page=2" title="Go to next page" class="active">next ›</a></li>
<li class="pager-last last"><a href="/emon/node/127?page=3" title="Go to last page" class="active">last »</a></li>
</ul></div></div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org">https://community.openenergymonitor.org</a></p>
   
</div>

<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
