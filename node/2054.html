<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/2054 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:53:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>PHASECAL calibration tool | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">PHASECAL calibration tool</h3>
        <span class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Mon, 25/02/2013 - 23:02</span>
        <div class="content"><p>I&rsquo;ve been gradually refining my phase-locked loop code for emonTx and I think it&rsquo;s probably as good as it&rsquo;s going to get now so I&rsquo;ve decided to make it into a library.</p>
<p>As an example included with this library is a short sketch which will measure the phase difference between current and voltage on an emonTx, or any other board with access to both signals.</p>
<p>Here&rsquo;s an example of it in action...</p>
<p><img alt="" src="../sites/default/files/phasecal_real.png" /></p>
<p>This was taken using a Mascot a/c adaptor and 9kW of floor heating as the load. Initially no phase correction is applied and the power factor is 0.9978. The phase difference is then measured and shows that current leads voltage by 207&micro;s, or 3.74 degrees (note that the cosine of 3.74 is 0.99787 so this agrees very well with the measurement). This correction is then applied and the power factor goes to 0.9999, which is probably as close to 1 as you are going to get in a real-word situation.</p>
<p>To prove the software works correctly when the inputs are perfect, here&rsquo;s another example. This time the voltage is sourced from a signal generator and the current is derived from an RC network which gives a fixed delay of 193&micro;s as shown on this oscilloscope trace (my scope can only resolve 2&micro;s at this timebase)...</p>
<p><img alt="" src="../sites/default/files/phasecal_sg_scope.png" style="width: 320px; height: 240px;" /></p>
<p>Here you can see that the sketch correctly measures this current lag and the power factor becomes unity when the phase adjustment&nbsp; is applied...</p>
<p><img alt="" src="../sites/default/files/phasecal_sig_gen.png" /></p>
<p>The PHASECAL values are calculated from the current lead/lag using the values given in <a href="https://learn.openenergymonitor.org/?redirect=explanation-of-the-phase-correction-algorithm">this building block article</a> for emonLib timing.</p>
<p>Here&#39;s the library...</p>
<p><a href="../sites/default/files/PLL50Hz.zip">http://openenergymonitor.org/emon/sites/default/files/PLL50Hz.zip</a></p>
  <div class="forum-topic-navigation clear-block">
          <a href="2193.html" class="topic-previous" title="Go to previous forum topic">‹ RRDTool</a>
              <a href="2147.html" class="topic-next" title="Go to next forum topic">Upgrading to Dev Branch ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-10120"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Tue, 26/02/2013 - 12:15.</div>
    <div class="content">
     <p>This nicely shows the benefit of sampling at a fixed rate, such as 50 times per mains cycle.&nbsp; By measuring the phase difference between the two waveforms, the correct value of phaseCal can then be calculated directly rather than by looking for the best result from a range of settings.&nbsp;</p>
<p>My <a href="870.html#comment-5927">equivalent tool</a> requires a bit more effort from the user but works with any rate of sampling, including free-running.&nbsp; The ADC operates at its fastest when in free-running mode, but it is possible that the sampling intervals may not be quite as even as when using a fixed rate timer.&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10121"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/450.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="stuart&#039;s picture" title="stuart&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by <a href="../user/450.html" title="View user profile.">stuart</a> on Tue, 26/02/2013 - 12:46.</div>
    <div class="content">
     <p>Nice piece of work/code MartinR</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10126"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Tue, 26/02/2013 - 14:52.</div>
    <div class="content">
     <p>thanks stuart - it took far too many hours to get to this point!</p>
<p>Robin - the theory behind PHASECAL is only really valid for a fixed sampling rate. You are calculating the voltage by interpolating at a constant percentage&nbsp;between 2 samples. If the interval between samples&nbsp;changes then the interpolated value will not be correct. The effect may be small but it is still an avoidable error.&nbsp;Have you measured any increase in accuracy by sampling above 50 times per cycle?</p>
<p>Edited to say: I should probably also point out that a value for PHASECAL derived from your sketch won&#39;t be valid for emonTx if sampling rate and time between voltage and current samples is not the same as for EmonLib. The phase delay I measure is an absolute value so independent of the sampling rate. As I mentioned, the PHASECAL value is based on EmonLib timing in the Building Blocks article.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10133"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 26/02/2013 - 16:40.</div>
    <div class="content">
     <p>It might be worth pointing out that you shouldn&#39;t get too carried away with accuracy - the phase shift of both transformers - current and voltage - changes with the operating point (the current and the system voltage) by a few degrees - see the test reports for actual measured values. So unless you want to adjust PHASECAL with a two-dimensional lookup table, it&#39;s going to be wrong. The trick will be to run the calibration and set the value so that it&#39;s nearly right most of the time.</p>
<p>Or you could use rather more expensive transducers than the cheap and cheerful recommended ones.</p>
<p>Nevertheless, congratulations, Martin.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10136"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Tue, 26/02/2013 - 18:06.</div>
    <div class="content">
     <p>Thanks Robert and a good point regarding the variation with operating point.</p>
<p>One thing I did notice, although I didn&#39;t fully investigate it, is that wrapping multiple turns around the CT appeared to cause a significant phase shift that wasn&#39;t present when the same current passed through a single wire. I assumed this was due to the inductance of the multiple turns. If this is indeed a real effect then it would distort your phase shift plot for the CT (unless of course you accounted for it?)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10146"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Tue, 26/02/2013 - 20:52.</div>
    <div class="content">
     <p><em>Robin - the theory behind PHASECAL is only really valid for a fixed sampling rate. You are calculating the voltage by interpolating at a constant percentage&nbsp;between 2 samples. If the interval between samples&nbsp;changes then the interpolated value will not be correct. The effect may be small but it is still an avoidable error.&nbsp;Have you measured any increase in accuracy by sampling above 50 times per cycle?</em></p>
<p>Yes, Martin, I&#39;d agree with all those points.&nbsp; When you first pointed out that my Mk2 code was suspect, your constructive criticism was entirely valid (even if it took me a while to accept it!).&nbsp; Since then, I&#39;ve moved on to using interrupts with either a fixed rate timer or free-running.&nbsp; In both cases, I would hope that the sampling rate is pretty constant, but don&#39;t have any specialised equipment with which to check this.&nbsp; My &quot;Tallymode&quot; results never differ by much between consecutive runs.&nbsp; This displays the average number of sample pairs per mains cycle.</p>
<p>Although you say that &quot;the PHASECAL value is based on EmonLib timing in the Building Blocks article&quot;, your logic seems able to pinpoint the optimal phaseCal value with some accuracy, at its first attempt.&nbsp; Which is impressive.</p>
<p>When just diverting surplus power, this value seems to make very little difference.&nbsp; It would be interesting to hear from anyone for whom the correct value of phaseCal is important (but preferably not on this thread).</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10151"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Wed, 27/02/2013 - 14:35.</div>
    <div class="content">
     <p>You&#39;re right of course Robin, small errors in PHASECAL make little difference due to the cosine relationship between phase shift and power. I&#39;m sure your latest sketches are more than accurate enough for the job they are required to do.</p>
<p>
	I ended up with this sketch after I tried to determine phase shift by measuring the time between voltage and current zero crossings and quickly discovered that it doesn&#39;t work. The distortion in the voltage waveform as it passes through 0 can be greater than the phase shift you are trying to measure!</p>
<p>
	In the end I took advantage of the fact that with the PLL all the samples are at a known angle, so I directly calculated the phase shift that gives the best fit (in the mathematical meaning of the term) to a pure sine wave aligned to the PLL. It surprised me how well it works.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10156"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 27/02/2013 - 15:45.</div>
    <div class="content">
     <p>Here&#39;s a quick measurement (i.e. one set of readings, no averaging) of one c.t. with a primary winding of 6 turns (5 A per turn max), over a 100:1 range; and then 3 turns. The burden was 18 Ohms.&nbsp; It does look to me as if the basic shape of the curve is unchanged, and there is indeed a small difference of around &frac12;&deg; between the curves. It is however overshadowed by the variation due to the magnetic properties as the flux in the core changes due to current.</p>
<p>I measured the c.t phase shift directly, i.e. with a &#39;scope in X-Y mode and plotted voltage across the burden against&nbsp;primary current (voltage measured across a series resistor) .</p>
<p><img alt="" src="data:image/png;base64,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" /></p>
<p>As inductance is proportional to n<sup>2</sup> and n<sup>2</sup> has changed by a factor of 4, it would appear that the primary inductance is not having a major effect on the phase shift.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10158"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Wed, 27/02/2013 - 16:23.</div>
    <div class="content">
     <p>Interesting. Half a degree does seem quite significant for a change from 3 to 6 turns. I&nbsp;tried 30 turns when I was trying to create a resistive load to test my sketch and the current trace disappeared off my scope so I decided that was a bad idea. I&#39;ll repeat the test when I get chance and measure the actual shift.</p>
<p>I&#39;m starting to have trouble with this whole concept of phase shift. I was just looking at the diagrams in the Mascot report and the idea that there is a 5.7 degree phase shift in this one troubles me....</p>
<p><img alt="" src="../sites/default/files/mascotreport/mascot_report03.jpg" /></p>
<p>Isn&#39;t this just a distortion? If it truly was a phase shift then the waveform would be shifted at the peaks too. Assuming the current followed the green line then shifting the voltage by 5.7 degrees would probably reduce the power factor as the peaks would not then align.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10159"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Wed, 27/02/2013 - 18:38.</div>
    <div class="content">
     <p>The real question is, can the distorted waveform actually be improved by applying phasecal.&nbsp; If you can get a PF of 1.000 then it appears the phasecal correction is doing its job nicely.&nbsp; But anything less than this might suggest that it isn&#39;t.</p>
<p>For comparison, here&#39;s a couple of sinusoids with a small phase shift between them.</p>
<p>&nbsp;</p>
<p><a href="../sites/default/files/PhaseShift_1.jpg"><img alt="" height="300" src="../sites/default/files/PhaseShift_1.jpg" width="500" /></a></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10167"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Wed, 27/02/2013 - 23:41.</div>
    <div class="content">
     <p><em>Isn&#39;t this just a distortion?&nbsp; </em></p>
<p>It&#39;s both. Either the middle part is shifted to the left and the peaks stay in place, or the whole wave has a shift to the left and the peaks lean to the right! Thinking in terms of the B-H curve, I favour the latter.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10175"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Thu, 28/02/2013 - 10:34.</div>
    <div class="content">
     <p>If you compare the two diagrams at 185.5V and 253V the peaks don&#39;t change, it&#39;s just the middle part that moves. Doesn&#39;t this suggest that the peaks don&#39;t lean to the right?</p>
<p>It looks to my untrained eye more like the result of increased harmonic distortion than phase shift.</p>
<p>I assume the measure of phase shift is how far the fundamental 50Hz component has shifted. With the data you have it would be possible to perform Fourier analysis and find out exactly what the waveform consists of - whether it&#39;s worth it though is a different matter!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10176"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Thu, 28/02/2013 - 10:37.</div>
    <div class="content">
     <p>When calculating real power, this calls into question whether it&#39;s best to leave the peaks in alignment, and suffer a negative energy content near the z/c points; or to align the z/c points and suffer some loss of calculated energy near the peaks.</p>
<p>&nbsp;</p>
<p><a href="../sites/default/files/PhaseShift_1a.jpg"><img alt="" height="300" src="../sites/default/files/PhaseShift_1a.jpg" width="500" /></a></p>
<p>Seems to me that it&#39;s probably best to leave the peaks aligned and ignore any distortion near the z/c points.&nbsp; A good quality CT, preferably used within its intended operating range, should minimise this unwanted effect.</p>
<p>In the absence of a scope, my phasecalChecker (or Martin&#39;s) will identify the value that gives a Power Factor of closest to unity.&nbsp; When calculating real power, which is what the meter measures, this is probably the optimal setting.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10181"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Thu, 28/02/2013 - 15:59.</div>
    <div class="content">
     <p>There&#39;s just one problem here: I don&#39;t know what phase means when the waves are not sinusoids. If you&#39;re talking voltage and current waves, what I can understand is the phase relationship between the two fundamentals, between harmonics of the same order, and between the fundamental and its own harmonics. But between the two complex waves, no.</p>
<p>Generally, Martin, you&#39;re right: people generally mean the 50 Hz fundamental when you&#39;re talking about power components.</p>
<p>Without distortion-free transducers, it all adds up to measurement errors and the best you can do is adjust everything to give the smallest overall error. So I&#39;d suggest you need to calibrate the voltage to give the same answer as a true rms meter, likewise the current and then you adjust the &quot;phase&quot; - actually the timing - relationship to show unity power factor on a resistive load. And that&#39;s exactly the recommended calibration procedure if you can measure the current. If you can&#39;t, then you infer current from real power and need to iterate around the loop a few times because there is a degree of interaction.</p>
<p>If you wish to do the Fourier analysis, here&#39;s the data for the Ideal voltage adapter at 240 V. Col 1 is time, Col 2 is mains input and Col 3 is the adapter output.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10194"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1824.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="MartinR&#039;s picture" title="MartinR&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by <a href="../user/1824.html" title="View user profile.">MartinR</a> on Thu, 28/02/2013 - 22:10.</div>
    <div class="content">
     <p><em>If you wish to do the Fourier analysis, here&#39;s the data for the Ideal voltage adapter at 240 V. Col 1 is time, Col 2 is mains input and Col 3 is the adapter output.</em></p>
<p>Just tried this but there isn&#39;t really enough samples for the low frequency involved. Each step in the FFT output is 44.1kHz/1024=43Hz so we&#39;d need a lot more samples.&nbsp;Here&#39;s the output for the first 10 steps..<img alt="" src="../sites/default/files/ideal_fft.png" /></p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10813"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="gnumengor&#039;s picture" title="gnumengor&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by gnumengor (not verified) on Mon, 01/04/2013 - 18:11.</div>
    <div class="content">
     <p>Hi guys!</p>
<p>I don&#39;t want to make a stupid question, but will <strong>PHASECAL</strong> be the parameter that is specified in the call to the function:</p>
<p>emon1.voltage(2, 234.26, 1.7);&nbsp; // Voltage: input pin, calibration, <strong>phase_shift</strong> ?</p>
<p>I read a lot of posts about the phase shift, and you always refer in the forums to PHASECAL variable... so I couldn&#39;t find any place where you refer to both variables being the same!</p>
<p>Thanks a lot for all your work :)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10819"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/956.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-956.jpg" alt="calypso_rae&#039;s picture" title="calypso_rae&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by <a href="../user/956.html" title="View user profile.">calypso_rae</a> on Mon, 01/04/2013 - 19:51.</div>
    <div class="content">
     <p>Yes, that function is indeed setting the value of phaseCal to 1.7.&nbsp; What this means is that that every voltage sample will be extrapolated from the previous two to a point that is seven tenths of the way to the next one (the sample that has not yet been taken).</p>
<p>Changing the order of the V and I measurements in calcVI() would most likely bring the optimal value of phaseCal back into the 0 - 1 range where the appropriate value can be interpolated rather than extrapolated..</p>
<p>For &quot;real power&quot; calculations, the value of phasecal (or the phase-shift between V and I waveforms), seems to make virtually no difference to the result.</p>
<p>PHASECAL is not a #define, so I now prefer to write it with lowerCaseLetters :)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10825"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="gnumengor&#039;s picture" title="gnumengor&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: PHASECAL calibration tool</h3>

    <div class="submitted">Submitted by gnumengor (not verified) on Mon, 01/04/2013 - 21:11.</div>
    <div class="content">
     <p>Nice! Thanks for the clarification.</p>
<p>My arduino is power rocking now :)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/2054"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-wmxdhfiEdfNTKNNELjQC5jYugPUYXnlrpFwJMalfmGU" value="form-wmxdhfiEdfNTKNNELjQC5jYugPUYXnlrpFwJMalfmGU"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
