<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/5563 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:41:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Use EmonTx V3 in the U.S. | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/4.html">Archived: Hardware</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Use EmonTx V3 in the U.S.</h3>
        <span class="submitted">Submitted by <a href="../user/6792.html" title="View user profile.">amailtoaben</a> on Fri, 15/08/2014 - 18:40</span>
        <div class="content"><p>Hi There,</p>
<p>When I use&nbsp;EmonTx V3&nbsp;in the U.S. do I need to change VRMS contstant in the default firmware that comes with the&nbsp;EmonTx V3? I read the source code in the Github that it was 230V and that&#39;s for the UK right? also, besides that, Do I also need to re-calibrate other calibration constants?</p>
<p>&nbsp;</p>
<p>Best,</p>
<p>Ben</p>
  <div class="forum-topic-navigation clear-block">
          <a href="5855.html" class="topic-previous" title="Go to previous forum topic">‹ CT Question</a>
              <a href="5876.html" class="topic-next" title="Go to next forum topic">V2 Vs V3 Hardware ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-23096"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Fri, 15/08/2014 - 20:57.</div>
    <div class="content">
     <p>If you got your adapter from the shop, there should be no need to change anything. Otherwise, if you bought an adapter locally, you will probably need to change the voltage calibration, but that will be because the ratio of mains voltage to output voltage of the adapter will be different, not because the mains voltage itself is different.</p>
<p>If you are using the 100 A YHDC ct, you should not need to change the current calibration. The phase calibration should be close provided you are using the YHDC ct and your ac adapter has a similar phase error to ours.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23166"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6792.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="amailtoaben&#039;s picture" title="amailtoaben&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/6792.html" title="View user profile.">amailtoaben</a> on Mon, 18/08/2014 - 14:39.</div>
    <div class="content">
     <p>Thanks Robert.</p>
<p>I know that by using a AC-AC adapter, emonTx would automatically detects it is a AC power source and it would adjust the voltage to 120V as in US that&#39;s what we have. But I was thinking just to use a battery to power emonTx&nbsp;V3, therefore I&#39;d like to double check to see if I need to upload a new Sketch because I checked the code for the default emonTx V3 on github and it had a hard coded Votage of 240V as it is for the UK. (I know that it is better to use a AC-AC power adapter as it would be more accurate anyway, but I don&#39;t have to place near by the switch box in my house to plug AC-AC adapter)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23167"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 18/08/2014 - 16:41.</div>
    <div class="content">
     <p>Ah, I see what you&#39;re saying. If you&#39;re on battery power, then you are assuming a voltage and yes, you do need to change that number in the sketch to your normal voltage, and that multiplied by the measured current gives you apparent power (volt-amperes), not real power (watts).</p>
<p>To edit and upload the sketch, you will need to install the Arduino IDE and you&#39;ll need <a href="http://shop.openenergymonitor.com/programmers/">a programmer</a> too.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23313"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6827.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6827.jpg" alt="yourenergycube&#039;s picture" title="yourenergycube&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/6827.html" title="View user profile.">yourenergycube</a> on Sat, 23/08/2014 - 20:38.</div>
    <div class="content">
     <p>Ahhh&nbsp;I too have the same issue.... and i am using the provided ac to ac adapter here in the US. when i monitor the data from the Arduino i get</p>
<p>monTx V3 Discrete Sampling V1.3<br />
	OpenEnergyMonitor.org<br />
	Performing power-on tests.....please wait 10s<br />
	CT 1 Calibration: 90.90<br />
	CT 2 Calibration: 90.90<br />
	CT 3 Calibration: 90.90<br />
	CT 4 Calibration: 16.60<br />
	RMS Voltage on AC-AC Adapter input is: ~247V<br />
	AC-AC adapter detected - Real Power measurements enabled<br />
	assuming powering from AC-AC adapter (jumper closed)<br />
	Vcal: 138.40<br />
	Phase Shift: 1.70<br />
	CT 1 detected<br />
	Unable to detect DS18B20 temperature sensor<br />
	RFM12B Initiated:<br />
	Node: 10 Freq: 433Mhz Network: 210<br />
	23 12785<br />
	44 12766<br />
	28 12813<br />
	40 12785<br />
	33 12787<br />
	46 12831<br />
	36 12779<br />
	33 12814<br />
	22 12788<br />
	43 12789<br />
	37 12789<br />
	41 12826</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23318"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sat, 23/08/2014 - 23:31.</div>
    <div class="content">
     <p>So what is your issue? You think you are using an AC adapter and that indeed appears to be the case. The voltage it is measuring is varying between 127.66 V and 128.31 V - if that is not correct, what is the actual voltage you have? - and the power is reading between 22 and 46 W, so essentially there&#39;s no significant load. In your case, there&#39;s no need to change the constant &quot;230 V&quot; that&#39;s used for apparent power calculations as it seems to be getting the true voltage from the adapter, but if it&#39;s not reading the true voltage, then it&#39;s the voltage calibration constant &#39;Vcal&#39; (line 62)&nbsp; that you need to change.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23337"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6827.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6827.jpg" alt="yourenergycube&#039;s picture" title="yourenergycube&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/6827.html" title="View user profile.">yourenergycube</a> on Mon, 25/08/2014 - 22:33.</div>
    <div class="content">
     <p>Thanks for your reply.... I seemed to have solved to issue by adjusting the vcal&nbsp;to 138.4. However I have now developed a new issue... The Emon tx V3&nbsp;is no longer connecting to the Pi with the RFM12B.&nbsp;</p>
<p>&nbsp;</p>
<p>When the Pi boot the led on the RFM12b flashes once then once more after boot.... then nothing.... sigh</p>
<p>&nbsp;</p>
<p>Please note the data i displayed in my previous post above is with the adjustments made to the Vcal. &nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23338"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Mon, 25/08/2014 - 23:04.</div>
    <div class="content">
     <p>OK, so you don&#39;t have an issue with calibration. You changed the calibration constant according to the calibration instructions. Big deal. What was the point in misleading everybody by saying you <strong><u><em>have</em></u></strong> an issue?</p>
<p>Do you really mean you now have a problem with the RF, or are you using &quot;issue&quot; to mean something different to the normal meaning?</p>
<p>Assuming this time you do mean you have a problem, you need to check everything associated with the RFM12B. My guess is you changed something else as well as the calibration. What frequency is the RFM12B in your emonTx?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23341"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6827.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6827.jpg" alt="yourenergycube&#039;s picture" title="yourenergycube&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/6827.html" title="View user profile.">yourenergycube</a> on Mon, 25/08/2014 - 23:17.</div>
    <div class="content">
     <p>I double check both the frequency on the Sketch :</p>
<p>&nbsp;</p>
<p>#define RF_freq RF12_433MHZ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Frequency of RF12B module can be RF12_433MHZ, RF12_868MHZ or RF12_915MHZ. You should use the one matching the module you have.<br />
	const int nodeID = 10;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // emonTx RFM12B node ID<br />
	const int networkGroup = 210;&nbsp;<br />
	typedef struct { int power1, power2, power3, power4, Vrms, temp; } PayloadTX;&nbsp;&nbsp;&nbsp;&nbsp; // create structure - a neat way of packaging data for RF comms<br />
	&nbsp; PayloadTX emontx</p>
<p>and</p>
<p>The the frequency on the Pi config file</p>
<p>####################</p>
<p># Gateway settings #<br />
	####################<br />
	[gateway]<br />
	# loglevel must be one of DEBUG, INFO, WARNING, ERROR, and CRITICAL<br />
	# see here : <a href="http://docs.python.org/2/library/logging.html" title="http://docs.python.org/2/library/logging.html">http://docs.python.org/2/library/logging.html</a><br />
	loglevel = DEBUG</p>
<p>#############<br />
	# Listeners #<br />
	#############<br />
	[listeners]</p>
<p># This listener manages the RFM2Pi module<br />
	[[RFM2Pi]]<br />
	&nbsp;&nbsp;&nbsp; type = OemGatewayRFM2PiListener<br />
	&nbsp;&nbsp;&nbsp; [[[init_settings]]]<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; com_port = /dev/ttyAMA0<br />
	&nbsp;&nbsp;&nbsp; [[[runtime_settings]]]<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sgroup = 210<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; frequency = 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; baseid = 15<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sendtimeinterval = 300</p>
<p># This listener gets data from a socket<br />
	[[Socket]]<br />
	&nbsp;&nbsp;&nbsp; type = OemGatewaySocketListener<br />
	&nbsp;&nbsp;&nbsp; [[[init_settings]]]<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; port_nb = 50011<br />
	&nbsp;&nbsp;&nbsp; [[[runtime_settings]]]</p>
<p>###########<br />
	# Buffers #<br />
	###########<br />
	[buffers]</p>
<p># The two following buffers instantiate the same class,<br />
	# that formats the data for an emoncms instance.<br />
	# One sends the data to a local instance, the other one<br />
	# to a distant one.<br />
	# If active is set to False, the buffer neither records nor sends any data,<br />
	# but it holds unsent data until active becomes True.<br />
	[[emoncms_local]]<br />
	&nbsp;&nbsp;&nbsp; type = OemGatewayEmoncmsBuffer<br />
	&nbsp;&nbsp;&nbsp; [[[init_settings]]]<br />
	&nbsp;&nbsp;&nbsp; [[[runtime_settings]]]<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; domain = localhost<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; apikey = xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protocol = http://<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; active = False<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; path = /emoncms</p>
<p>[[emoncms_remote]]<br />
	&nbsp;&nbsp;&nbsp; type = OemGatewayEmoncmsBuffer<br />
	&nbsp;&nbsp;&nbsp; [[[init_settings]]]<br />
	&nbsp;&nbsp;&nbsp; [[[runtime_settings]]]<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; domain = emoncms.org<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; apikey = d0c3447c13714526a549800e45f2f583<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protocol = http://<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; active = True<br />
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; path =</p>
<p>Again I apologize for the error&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23356"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Tue, 26/08/2014 - 11:42.</div>
    <div class="content">
     <p>First, I have deleted 7 very similar posts to your response above. When you post, please look carefully to see how the site responds. You should have seen a message stating that your comment was held in the queue awaiting approval. This is a mechanism to hamper spammers. Your post clearly is not spam, but the automatic system was unsure.</p>
<p>When I asked if you checked the frequency, I meant the actual frequency to which the RFM12B module is tuned. It should be marked on the emonTx, but if not, look at the pictures <a href="https://learn.openenergymonitor.org/?redirect=rfm12b-wireless">here</a>. Am I right to think it has worked once? If so, I assume it is 433 MHz.&nbsp; Why is the frequency in the Pi configuration file &quot;4&quot; and not &quot;433&quot;?</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23359"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Tue, 26/08/2014 - 12:35.</div>
    <div class="content">
     <p>The OEM Gateway settings file is formatted in lines as that is how the settings are read, pythons ConfigObj&nbsp;may be misinterpreting&nbsp;the line&nbsp;</p>
<blockquote><p>frequency = 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; baseid = 15</p>
</blockquote>
<p>although &quot;4&quot; is actually correct for specifying&nbsp;433MHz in&nbsp;OEMG, that may not be what is actually being read, &quot;baseid = 15&quot; should be on a new line. <a href="https://github.com/Jerome-github/oem_gateway/blob/master/oemgateway.conf.dist#L35-L36">https://github.com/Jerome-github/oem_gateway/blob/master/oemgateway.conf.dist#L35-L36</a>, But since the RFM2Pi&nbsp;retains its settings, this doesn&#39;t explain how or why the setting could be incorrect, corrupt or forgotten (or where the new line went), only that it may not be able to correct the setting if that was the case.</p>
<p>Try putting the new line back in to see if it makes a difference.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23408"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6827.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6827.jpg" alt="yourenergycube&#039;s picture" title="yourenergycube&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/6827.html" title="View user profile.">yourenergycube</a> on Thu, 28/08/2014 - 23:59.</div>
    <div class="content">
     <p>Here I am again... i seemed to have solved the communication issue by using a completely different ready to go image for the Pi since is dated August 13 &nbsp;and located <a href="https://github.com/emoncms/emoncms/blob/bufferedwrite/docs/setup.md">https://github.com/emoncms/emoncms/blob/bufferedwrite/docs/setup.md</a> i said aha... it should work and it did. Yea for me.</p>
<p>Now with that said new issue has arisen.</p>
<p>When i use the tail -f /var/log/emonhub/emonhub.log command i get WARNING 153 RX data length: 12 is not valid for datacodes (See attached)</p>
<p>&nbsp;So i reviewed the output of the TX (see attached) and the conf file of the pi (see attached)... both look good. I even did a sudo service emonhub restart</p>
<p>&nbsp;where am I going wrong?</p>
<p>Regards</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23413"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4440.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-4440.jpg" alt="pb66&#039;s picture" title="pb66&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/4440.html" title="View user profile.">pb66</a> on Fri, 29/08/2014 - 08:41.</div>
    <div class="content">
     <p>The log entries that you see state the error as being</p>
<blockquote><p>&quot;RX data length: 12 is not valid for datacodes&nbsp;[&#39;l&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;h&#39;, &#39;l&#39;, &#39;l&#39;, &#39;l&#39;, &#39;l&#39;]</p>
</blockquote>
<p>This message indicates a problem with the received data&#39;s length and specifically 12 is not valid for the string of datacodes&nbsp;representing the data&#39;s structure, 5 x longs (l) and 4 x&nbsp;ints&nbsp;(h) requires 28 byte values (5x4 + 4x2) so the recieved&nbsp;sstring of 12 values will not allow the process to continue as it cannot map the data types.</p>
<p>In emonhub.conf you have added&nbsp;</p>
<blockquote><p>[[10]]</p>
</blockquote>
<p class="rteindent2">datacodes = l, h, h, h, h, l, l, l, l,</p>
<p>This defines node 10 as needing 28 byte values, I&#39;m entirely sure if that was intentional&nbsp;or not, I cannot see it in the guide you followed.</p>
<p>The serial monitor screen from your arduino&nbsp;IDE shows the default &quot;emonTx V3 Discrete Sampling V1.3&quot; sketch installed on the emonTx which transmits a packet consisting of 6 ints (6x2 = 12) which is why you are getting 12 not 28 values.</p>
<p>If you attempted to install a different sketch to the emonTx&nbsp;that appears to have failed and you should investigate that, or if you intend to use the default sketch you can just remove the node 10 datacodes&nbsp;from emonhub.conf and it will work using the default settings (which is why the guide doesn&#39;t tell you to edit the nodes section).</p>
<p>See &nbsp;<a href="5289.html">http://openenergymonitor.org/emon/node/5289</a>&nbsp;for&nbsp;more info on&nbsp;datacodes.</p>
<p>Paul</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-23464"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6827.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-6827.jpg" alt="yourenergycube&#039;s picture" title="yourenergycube&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/6827.html" title="View user profile.">yourenergycube</a> on Sun, 31/08/2014 - 16:04.</div>
    <div class="content">
     <p>Yep seems like i got it working. &nbsp;So for my friends in the US here is what i did</p>
<p>&nbsp;</p>
<p>used sd image located here&nbsp;https://github.com/emoncms/emoncms/blob/bufferedwrite/docs/setup.md and did the mods in the images attached thanks robert and pb66 for your help.....&nbsp;</p>
<p>Now i am off to configure emoncms @&nbsp;&nbsp;http://emoncms.org/yourenergycube</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24297"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6877.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="madas&#039;s picture" title="madas&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/6877.html" title="View user profile.">madas</a> on Sun, 05/10/2014 - 00:50.</div>
    <div class="content">
     <p>Question for yourenergycude</p>
<p>&nbsp;</p>
<p>Why did you use 110V in your calculation of the Vcal?</p>
<p>&nbsp;</p>
<p>my line voltage is 120V, and the rated voltage on the provided AC-AC adapter is 120V also. &nbsp;What am i missing?</p>
<p>&nbsp;</p>
<p>Thanks</p>
<p>&nbsp;</p>
<p>M</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24298"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 05/10/2014 - 01:24.</div>
    <div class="content">
     <p>It&#39;s quite possible that you&#39;re missing nothing. The point about Vcal is it relates the line voltage to the number that comes out of the rms average calculation. As long as you use a consistent set of numbers, it should be correct. It is:</p>
<p class="rteindent1">voltage constant = alternating mains voltage &divide; alternating voltage at ADC input pin</p>
<p>For us here in the UK using the adapter from the shop which is rated for 230 V input, 9 V output and has 20% regulation, the numbers are:</p>
<p class="rteindent1">voltage constant = 230 &times; 11 &divide; (9 &times; 1.20) = 234.26</p>
<p>The components of that, which might cause confusion - but which are explained in Building Blocks - are:</p>
<p class="rteindent1">11 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; - the inverse of the ratio of the resistive voltage divider<br />
	(9 &times; 1.20) - the actual ac adapter output at 230 V</p>
<p>So if you know your adapter gives you 9.72 V with a line voltage of 118.5 V, you&#39;d use those numbers:</p>
<p class="rteindent1">voltage constant = 118.5 &times; 11 &divide; 9.72 = 134.105</p>
<p>but if you have the same mains voltage (118.5 V) but your adapter says it is 120 V in, 9 V out with 25% regulation, you&#39;d either use:</p>
<p class="rteindent1">voltage constant = 120 &times; 11 &divide; (9 &times; 1.25) = 117.333</p>
<p>or measure the actual values!</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24299"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6877.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="madas&#039;s picture" title="madas&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/6877.html" title="View user profile.">madas</a> on Sun, 05/10/2014 - 01:37.</div>
    <div class="content">
     <p>Just to confirm - you mean measure the voltage provided from the AC-AC adapter (around 9v) and measure the line voltage directly (which I get 118-120 depending on how the wind blows!)</p>
<p>&nbsp;</p>
<p>Real Line voltage * 11 / Output of AC-AC Adapter = VCal?</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24300"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 05/10/2014 - 01:50.</div>
    <div class="content">
     <p>Indeed - except I&#39;ve just looked at the thread title and you&#39;re using the emonTx V3, and the resistive divider in that is 120 k&Omega; and 10 k&Omega;, so the ratio there is 13, not 11.</p>
<p>(Building Blocks was written before the emonTx V3!)</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24310"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/6877.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="madas&#039;s picture" title="madas&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/6877.html" title="View user profile.">madas</a> on Sun, 05/10/2014 - 18:06.</div>
    <div class="content">
     <p>OK my volt meter shows exactly 120Vac on the phase I connect the AC-AC adapter to</p>
<p>The AC-AC adapter shows an output of 11.84Vac</p>
<p>Vcal=120V * 13 / 11.84 = 131.76</p>
<p>After using this Vcal Input 5 on the EmonTx V3 is showing around 121 - which is pretty close.</p>
<p>Am i missing anything or do you think i&#39;m good to go?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-24314"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/924.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="Robert Wall&#039;s picture" title="Robert Wall&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Use EmonTx V3 in the U.S.</h3>

    <div class="submitted">Submitted by <a href="../user/924.html" title="View user profile.">Robert Wall</a> on Sun, 05/10/2014 - 20:44.</div>
    <div class="content">
     <p>You could tweak Vcal to make the EmonTx read exactly the same as your voltmeter. It&#39;s for you to decide whether you think that is close enough. What some users have done in the past is compare the energy recorded over a long period against the supplier&#39;s meter, and adjusted the calibration to make the numbers agree. I think better than 1% is a probably as close as you&#39;ll get.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/5563"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-EyUt5KBbcjSky97s9MXnuW2Ght4EdIF16rjCZseGKVo" value="form-EyUt5KBbcjSky97s9MXnuW2Ght4EdIF16rjCZseGKVo"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
