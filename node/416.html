<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/416 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:52:57 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>EmonCMS changes - Add draw_led and rate of change | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">EmonCMS changes - Add draw_led and rate of change</h3>
        <span class="submitted">Submitted by Guest on Fri, 17/02/2012 - 06:22</span>
        <div class="content"><p>I've been making some changes to the emonCMS software to fit with what I want it to do. Some of the changes have also been requested by people, so I thought I would share the changes for others to use.</p>
<ul>
<li>Add led.js to Vis/Dashboard/widgets/led.js</li>
<li>Overide dashboard_view.php in Views (make sure you backup the old file first )</li>
<li>Override style.css in Views/theme/dark (make sure you backup the old file first)</li>
<li>Override process_model.php in Models (make sure you backup the old file first)</li>
</ul>
<p>First addition is the ability to draw a LED with different colours depending on the feed value.</p>
<p>To use this edit your dashboard and add the following line into your widget div definition</p>
<p>&lt;div class=&quot;led&quot; feed=&quot;feedname&quot;&gt;&lt;/div&gt;</p>
<p>Change feedname to the name of the feed that is an integer of a status you wish to display using the LED.</p>
<p>The feed value can be one of the following values. Next to teh value I have shown which colour LED will be shown</p>
<ul>
<li>0 &nbsp;- Red</li>
<li>1 - &nbsp;Green</li>
<li>2 - &nbsp;Grey</li>
<li>3 - &nbsp;Blue</li>
<li>4 - &nbsp;Purple</li>
<li>5 - &nbsp;Yellow</li>
<li>any Other value - Black</li>
</ul>
<p>e.g. This is my JSON post command to create a green LED</p>
<p><a href="http://192.168.1.200/powermon/api/post?apikey=ad08c02fa96c53f5a45073a84ca41f9c&amp;json={led:0}">http://192.168.1.200/powermon/api/post?apikey=ad08c02fa96c53f5a45073a84ca41f9c&amp;json={led:0}</a></p>
<p>I created a feed from this input called LEDstatus which uses the Log to Feed process</p>
<p>&nbsp;</p>
<p>The second addition is the ability to calculate the rate of change for a givern input.</p>
<p>To use this click on one of the inputs you wish to calculate the rate of change for.</p>
<p>Then create a new feed, choosing 'rate of change' as the Process and give it a feedname in the Arg column. Ensure that this is after your Log to Feed process. This process works by taking the current value and subtracting the previous value. This way you get the rate of change since your last measurement.</p>
<p>My plan is to use this new process to determine if a givern input has increased or decreased in value and is so by how much. So if I was to use the JSON api to get this rate of change I could feed it into growler or similar to notify me if a large power hungry device had suddenly turned itself on or off. Dont know how useful this will be yet.</p>
<p>Thanks</p>
<p>Nathan</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
  <div class="forum-topic-navigation clear-block">
          <a href="3203.html" class="topic-previous" title="Go to previous forum topic">‹ Rpi and db on hd</a>
              <a href="3192.html" class="topic-next" title="Go to next forum topic">Best strategy for handling rain fall recording on emoncms ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-3200"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonCMS changes - Add draw_led and rate of change</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Fri, 17/02/2012 - 09:01.</div>
    <div class="content">
     <p>&nbsp;Wow, this is great! Just copied in the files and it worked straight away!</p>
<p><img width="300" height="273" alt="" src="../sites/default/files/image/emoncms_leds.png" /></p>
<p>Love the rate of change processor too!</p>
<p>can I update this to the github version?</p>
<p>Thanks a lot,&nbsp;Trystan</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-3205"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="ndsit&#039;s picture" title="ndsit&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonCMS changes - Add draw_led and rate of change</h3>

    <div class="submitted">Submitted by ndsit (not verified) on Fri, 17/02/2012 - 10:16.</div>
    <div class="content">
     <p>&nbsp;Yep add it if you feel the code is upto scratch&nbsp;<img alt="" src="../sites/all/modules/fckeditor/fckeditor/editor/images/smiley/msn/regular_smile.html" /></p>
<p>I think some the code can probably be tweaked, but appears to work.</p>
<p>Next task is to tie the rate of change into using the LED . i.e. a large rate increase will generate a red led and a large negative rate of change will generate a green LED.</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-3207"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/3.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-3.jpg" alt="TrystanLea&#039;s picture" title="TrystanLea&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonCMS changes - Add draw_led and rate of change</h3>

    <div class="submitted">Submitted by <a href="../user/3.html" title="View user profile.">TrystanLea</a> on Fri, 17/02/2012 - 11:35.</div>
    <div class="content">
     <p>Great, its now up on github and vis.openenergymonitor, I have added it to my dashboard to show if the solar hot water pump is on or off, take a look here&nbsp;<a href="../emoncms/showcase.html">http://openenergymonitor.org/emon/emoncms/showcase</a></p>
<p>Thanks a lot, its a great feature</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-5125"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="rechena&#039;s picture" title="rechena&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonCMS changes - Add draw_led and rate of change</h3>

    <div class="submitted">Submitted by rechena (not verified) on Fri, 06/07/2012 - 14:37.</div>
    <div class="content">
     <p>Greetings, </p>
<p>I'm currently starting to use the LED widget, but by some reason there's seem to be appearing a &quot;grey&quot; frame arround my led. I've been looking at the code, but haven't managed to discover how to turn it transparent. </p>
<p>Can you help me? </p>
<p>Attaching a screenshot of my dashboard.</p>
<p><img src="../../../www.rechena.com/images/LED12.jpg" alt="" /></p>
<p>Thanks</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-9252"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <img src="../sites/default/files/imagecache/avatar/default_0.png" alt="messen&#039;s picture" title="messen&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonCMS changes - Add draw_led and rate of change</h3>

    <div class="submitted">Submitted by messen (not verified) on Sun, 20/01/2013 - 09:55.</div>
    <div class="content">
     <p><span id="result_box" lang="en" tabindex="-1"><span class="hps">How</span> <span class="hps">do I show</span> <span class="hps">the</span> <span class="hps">ethernet</span> <span class="hps">status</span> <span class="hps">and</span> <span class="hps">the</span> <span class="hps">RF</span> <span class="hps">module</span> <span class="hps">via LED</span> <span class="hps">like in the picture</span> <span class="hps">here</span> <span class="hps">...</span> <span class="hps">?</span></span></p>
<p>&nbsp;</p>
<p><span lang="en" tabindex="-1"><span class="hps">Thanks</span></span></p>
<p><span lang="en" tabindex="-1"><span class="hps">Matthias</span></span></p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-16331"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/4611.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/default_0.png" alt="deeaitch&#039;s picture" title="deeaitch&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: EmonCMS changes - Add draw_led and rate of change</h3>

    <div class="submitted">Submitted by <a href="../user/4611.html" title="View user profile.">deeaitch</a> on Fri, 15/11/2013 - 16:23.</div>
    <div class="content">
     <p>I can&#39;t seem to get rate of change to work for me. &nbsp;I&#39;ve got a temperature input that updates every 60 seconds:</p>
<p>x 0.01 to get Celcius</p>
<p>Log to feed &#39;temperature&#39;&nbsp;logging every 2 minutes.</p>
<p>Rate of change to feed &#39;Temperature Rate&#39; logging every 10 minutes.</p>
<p>&nbsp;</p>
<p>The problem is the Temerature Rate feed just stays inactive. &nbsp;I&#39;ve tried this a few time with different parameters and can&#39;t work out what I&#39;m dong wrong.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/416"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-af9ztJ19wvMMYv7AGeeKtwywKSGlaU9n4crd2kbh9rc" value="form-af9ztJ19wvMMYv7AGeeKtwywKSGlaU9n4crd2kbh9rc"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
<div style="margin:0 auto;width:1000px;">
  <div style ="float:right;width:400px;padding-right:20px;">
    <script>
      (function() {
        var cx = '006198118389747886812:rtaoc3wurta';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
    <gcse:searchbox-only></gcse:searchbox-only>
  </div>
</div>

</body>
</html>
