<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr">


<!-- Mirrored from openenergymonitor.org/emon/node/2030 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:53:26 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Why is emoncms.org server doing port scanning of my IP | Archived Forum</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="../sites/default/files/emon3_favicon.png" type="image/x-icon" />
  <link type="text/css" rel="stylesheet" media="all" href="../modules/node/node4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/defaults4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/system/system-menus4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/user/user4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/mollom/mollom4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/forum/forum4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/modules/views/css/views4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../modules/comment/comment4b43.css?r" />
<link type="text/css" rel="stylesheet" media="all" href="../sites/all/themes/emon3/style4b43.css?r" />
<style type="text/css" media="all">@import "../sites/all/themes/emon3/user_bar.css";</style>
    <script type="text/javascript"> </script>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>

<body>

<div id="box">

<table border="0" cellpadding="0" cellspacing="0" id="header">
  <tr>
    <td id="logo">
       <h1 class='site-name'><a href="../index.html" title="Home">Archived Forum</a></h1>    </td>
    <td id="menu">
      
                  
      
    </td>
  </tr>
  <tr>
    <td colspan="2"><div></div></td>
</tr>
</table>
<!--<div style="background-color:#444444; border-top: 1px solid #888; height:32px;">-->

<table border="0" cellpadding="0" cellspacing="0" id="content">
  <tr>
        <td valign="top">
            <div id="main">
        <div class="breadcrumb"><a href="../index.html">Home</a> » <a href="../forum.html">Forums</a> » <a href="../forum/5.html">Archived: Software</a></div>     
        <div class="tabs"></div>
                          <div class="node">

    
    
          <div class="comment" >
                <h3 class="title" style="">Why is emoncms.org server doing port scanning of my IP</h3>
        <span class="submitted">Submitted by <a href="../user/1747.html" title="View user profile.">Petrik</a> on Tue, 19/02/2013 - 14:43</span>
        <div class="content"><p>Wasnt&nbsp;emoncms supposed to be only one way for the client/nanoderf to send, not to listen any ports and now seeing several port scan (attempts) from emoncms server coming towards my IP...</p>
<p>Address <a href="tel:213.138.101.177">213.138.101.177</a> -&gt;&nbsp;emonvm.default.openenergymon.uk0.bigv.io</p>
<p>Feb 19 15:53:24 HackAttack: [SPI:Illegal connection state attack] TCP packet from [brwan] 213.138.101.177:80 to 89:3057<br />
	Feb 19 15:53:29 HackAttack: [SPI:Illegal connection state attack] TCP packet from [brwan] 213.138.101.177:80 to 89:2876<br />
	Feb 19 15:53:35 HackAttack: [SPI:Illegal connection state attack] TCP packet from [brwan] 213.138.101.177:80 to 89:2876<br />
	Feb 19 15:53:36 HackAttack: [SPI:Illegal connection state attack] TCP packet from [brwan] 213.138.101.177:80 to 89:3057<br />
	Feb 19 15:53:47 HackAttack: [SPI:Illegal connection state attack] TCP packet from [brwan] 213.138.101.177:80 to 89:2876<br />
	Feb 19 15:54:00 HackAttack: [SPI:Illegal connection state attack] TCP packet from [brwan] 213.138.101.177:80 to 89:3057</p>
<p>First three digits of my own ip address removed. I have not opened any ports back to nanode rf - so is there a virus in emoncms server or whats going on here ????</p>
  <div class="forum-topic-navigation clear-block">
          <a href="2106.html" class="topic-previous" title="Go to previous forum topic">‹ EmonCMS inactive feed</a>
              <a href="2083.html" class="topic-next" title="Go to next forum topic">rate-of-change process.... ›</a>
      </div>
</div>
      </div>
    
    <div class="links">&raquo; <ul class="links inline"><li class="comment_forbidden first last"></li>
</ul></div>  </div>
<div id="comments">
  <a id="comment-10004"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1747.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1747.jpg" alt="Petrik&#039;s picture" title="Petrik&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Why is emoncms.org server doing port scanning of my IP</h3>

    <div class="submitted">Submitted by <a href="../user/1747.html" title="View user profile.">Petrik</a> on Tue, 19/02/2013 - 17:59.</div>
    <div class="content">
     <p>Did some snooping around. The requets from public hosted opencms.org are not in synch what my nanoderf is sendin so either there is a bug in the emoncms code or <strong>alternatively there is a virus on the hosted public opencms.org server</strong>.</p>
<p>The row with HackAttack is an unexpected reply from public emoncms.org. Others are just normal replies returned by a request from nanoderf.</p>
<p>Feb 19 19:39:25 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2925<br />
	Feb 19 19:39:27 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2925<br />
	Feb 19 19:39:27 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2925<br />
	Feb 19 19:39:30 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2925<br />
	Feb 19 19:39:36 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2925<br />
	Feb 19 19:39:39 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:3037<br />
	Feb 19 19:39:43 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2881<br />
	Feb 19 19:39:48 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2925<br />
	Feb 19 19:39:53 HackAttack: [SPI:Illegal connection state attack] TCP packet from [brwan] 213.138.101.177:80 to xx.xx.xx.xx:2837<br />
	Feb 19 19:40:00 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2925<br />
	Feb 19 19:40:12 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2925<br />
	Feb 19 19:40:24 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2925<br />
	Feb 19 19:40:36 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2925<br />
	Feb 19 19:40:48 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2925<br />
	Feb 19 19:41:00 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2925<br />
	...<br />
	Feb 19 19:53:44 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2924<br />
	Feb 19 19:53:46 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2825<br />
	Feb 19 19:53:47 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2858<br />
	Feb 19 19:53:50 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2924<br />
	Feb 19 19:53:54 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:3014<br />
	Feb 19 19:53:57 HackAttack: [SPI:Illegal connection state attack] TCP packet from [brwan] 213.138.101.177:80 to xx.xx.xx.xx:2986<br />
	Feb 19 19:53:58 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2825<br />
	Feb 19 19:53:59 HackAttack: [SPI:Illegal connection state attack] TCP packet from [brwan] 213.138.101.177:80 to xx.xx.xx.xx:3019<br />
	Feb 19 19:53:59 PacketFilter: Forward TCP packet from [brwan] 213.138.101.177:80 to 192.168.0.100:2858</p>
<p><strong>The frequency this happens is often enough to trigger a hack attack algorithm on my firewall as this happens almost every couple of seconds.</strong></p>
<p>Feb 19 19:57:01 HackAttack: [SPI:Illegal connection state attack] TCP packet from [brwan] 213.138.101.177:80 to xx.xx.xx.xx:2845<br />
	Feb 19 19:57:07 HackAttack: [SPI:Illegal connection state attack] TCP packet from [brwan] 213.138.101.177:80 to xx.xx.xx.xx:2879<br />
	Feb 19 19:57:13 HackAttack: [SPI:Illegal connection state attack] TCP packet from [brwan] 213.138.101.177:80 to xx.xx.xx.xx:2879<br />
	Feb 19 19:57:15 HackAttack: [SPI:Illegal connection state attack] TCP packet from [brwan] 213.138.101.177:80 to xx.xx.xx.xx:2889<br />
	Feb 19 19:57:21 HackAttack: [SPI:Illegal connection state attack] TCP packet from [brwan] 213.138.101.177:80 to xx.xx.xx.xx:2889<br />
	Feb 19 19:57:25 HackAttack: [SPI:Illegal connection state attack] TCP packet from [brwan] 213.138.101.177:80 to xx.xx.xx.xx:2879</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10007"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/783.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-783.gif" alt="Lloyd&#039;s picture" title="Lloyd&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Why is emoncms.org server doing port scanning of my IP</h3>

    <div class="submitted">Submitted by <a href="../user/783.html" title="View user profile.">Lloyd</a> on Tue, 19/02/2013 - 18:50.</div>
    <div class="content">
     <p>I think you need to see what is in those packets. &nbsp;When I build my NanodeRF it was rubbish at closing connections down properly (the library may have moved on since then), and I found I was getting packets coming back from servers when they finally decided to time out a connection. &nbsp;It seemed random, but in fact was not.</p>
<p>Lloyd</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10009"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1747.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1747.jpg" alt="Petrik&#039;s picture" title="Petrik&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Why is emoncms.org server doing port scanning of my IP</h3>

    <div class="submitted">Submitted by <a href="../user/1747.html" title="View user profile.">Petrik</a> on Tue, 19/02/2013 - 19:14.</div>
    <div class="content">
     <p>&nbsp;</p>
<p>Hmm - that could be a reason. Then its partially an emoncms.org server configuration error if it holds a transactional server port open for more than a couple of seconds. Too long timeout on server side would explain mismatch on numbers.</p>
<p>Unfortunately dont have a packet sniffer at hand - any recommendations for windows workstation ?</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10010"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/783.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-783.gif" alt="Lloyd&#039;s picture" title="Lloyd&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Why is emoncms.org server doing port scanning of my IP</h3>

    <div class="submitted">Submitted by <a href="../user/783.html" title="View user profile.">Lloyd</a> on Tue, 19/02/2013 - 19:19.</div>
    <div class="content">
     <p>Wireshark&nbsp;is usually the packet sniffer of choice. &nbsp;And it is free.</p>
<p>Lloyd</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10012"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/783.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-783.gif" alt="Lloyd&#039;s picture" title="Lloyd&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Why is emoncms.org server doing port scanning of my IP</h3>

    <div class="submitted">Submitted by <a href="../user/783.html" title="View user profile.">Lloyd</a> on Tue, 19/02/2013 - 19:40.</div>
    <div class="content">
     <p>But don&#39;t forget your firewall may not be letting the packets through,so you may have to disable it to capture anything.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10013"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1747.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1747.jpg" alt="Petrik&#039;s picture" title="Petrik&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Why is emoncms.org server doing port scanning of my IP</h3>

    <div class="submitted">Submitted by <a href="../user/1747.html" title="View user profile.">Petrik</a> on Tue, 19/02/2013 - 19:56.</div>
    <div class="content">
     <p>&nbsp;</p>
<p>Of course firewall will not let unauthorized return packets through. So for this experiment I can allow everything from emoncms.org to my nanoderf. Will try when have some time to look into wireshark.</p>
<p>Read some time ago nanoderf hangups. Have not had any for me so maybe firewall can prevent this?</p>
<p>Also have raspberry pi waiting just to figure out how to copy my users emoncms.org contents to raspberry pi installed version. Should be easy, but not for a first timer.</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<a id="comment-10381"></a>
  <div class="comment comment-published" >
    <div class="picture">
  <a href="../user/1747.html" title="View user profile."><img src="../sites/default/files/imagecache/avatar/pictures/picture-1747.jpg" alt="Petrik&#039;s picture" title="Petrik&#039;s picture" width="50" height="50" class="imagecache imagecache-avatar"/></a></div>

<h3 class="title" style="padding-bottom:5px">Re: Why is emoncms.org server doing port scanning of my IP</h3>

    <div class="submitted">Submitted by <a href="../user/1747.html" title="View user profile.">Petrik</a> on Fri, 08/03/2013 - 17:46.</div>
    <div class="content">
     <p>&nbsp;</p>
<p>Thanks to Lloyd&#39;s feedback spent just a couple of hours with Nanode RF and looks like it resets due to not receiving OK from emoncms.org. Changed the script to have small delays and added more wait time (20 transmits). Additionally changed MAC code to a known unused device that I had.</p>
<p>Looks like the amount of resets reduced unrecognized return packages settling the firewall.</p>
<p><strong>Also tried to hook up the nanodeRF to public internet using a bridged port but then could not get IP address. Any hints how to get nanodeRF DHCP to work with public internet and get IP address ? </strong>When hooked up in LAN it gets the address just nicely...</p>
<p>&nbsp;</p>
         </div>
    <div class="links">&raquo; <ul class="links"><li class="comment_forbidden first last"></li>
</ul></div>
  </div>
<form action="https://openenergymonitor.org/emon/node/2030"  accept-charset="UTF-8" method="post" id="comment-controls">
<div>  <div class="box">
    <h2 class="title">Comment viewing options</h2>    <div class="content"><div class="container-inline"><input type="hidden" name="form_build_id" id="form-PxpYF3TZxLNIGamND9iKLt0tcAjOze5kWLoQOSulgLE" value="form-PxpYF3TZxLNIGamND9iKLt0tcAjOze5kWLoQOSulgLE"  />
<input type="hidden" name="form_id" id="edit-comment-controls" value="comment_controls"  />
<div class="form-item" id="edit-mode-wrapper">
 <select name="mode" class="form-select" id="edit-mode" ><option value="1">Flat list - collapsed</option><option value="2" selected="selected">Flat list - expanded</option><option value="3">Threaded list - collapsed</option><option value="4">Threaded list - expanded</option></select>
</div>
<div class="form-item" id="edit-order-wrapper">
 <select name="order" class="form-select" id="edit-order" ><option value="1">Date - newest first</option><option value="2" selected="selected">Date - oldest first</option></select>
</div>
<div class="form-item" id="edit-comments-per-page-wrapper">
 <select name="comments_per_page" class="form-select" id="edit-comments-per-page" ><option value="10">10 comments per page</option><option value="30">30 comments per page</option><option value="50">50 comments per page</option><option value="70">70 comments per page</option><option value="90">90 comments per page</option><option value="150">150 comments per page</option><option value="200">200 comments per page</option><option value="250">250 comments per page</option><option value="300" selected="selected">300 comments per page</option></select>
</div>
<input type="submit" name="op" id="edit-submit" value="Save settings"  class="form-submit" />
</div><div class="description">Select your preferred way to display the comments and click "Save settings" to activate your changes.</div></div>
 </div>


</div></form>
</div>
      
              </div>
    </td>
      </tr>
</table>

<div id="footer">
  <p>Open-source tools for energy monitoring and analysis.&nbsp;Forum has moved to: <a href="https://community.openenergymonitor.org/">https://community.openenergymonitor.org</a></p>
   
</div>


</div>
</body>


<!-- Mirrored from openenergymonitor.org/emon/node/2030 by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 20 Feb 2017 15:53:26 GMT -->
</html>
